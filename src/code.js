var uiscript;
!function(t) {
    var e = function() {
        function e(e) {
            this.me = e,
            this.img_head = new t.UI_Character_Skin(e.getChildAt(0)),
            this.img_emo = this.img_head.me.getChildAt(0)
        }
        return Object.defineProperty(e.prototype, "id", {
            get: function() {
                return this._id
            },
            set: function(t) {
                this._id = t,
                this.img_head.setSkin(t, "smallhead")
            },
            enumerable: !0,
            configurable: !0
        }),
        e.prototype.setEmo = function(t, e) {
            var i = this;
            void 0 === e && (e = -1),
            Laya.timer.clearAll(this),
            this.img_emo && (t && "" != t ? (this.img_emo.visible = !0,
            e > 0 && Laya.timer.once(e, this, function() {
                i.img_emo.visible = !1
            })) : this.img_emo.visible = !1)
        }
        ,
        e
    }();
    t.UI_Head = e
}(uiscript || (uiscript = {}));
var uiscript;
!function(t) {
    var e = function() {
        function e(e) {
            this.change_id = 0,
            this.skin_path = "",
            this.loaded = !1,
            this.me = e,
            this.img = e,
            this.origin_rect = t.UIRect.CreateFromSprite(this.img),
            this.img.skin = ""
        }
        return e.prototype.setSkin = function(t, e) {
            var i = this
              , n = cfg.item_definition.skin.get(t);
            if (n) {
                var a = n.path + "/" + e + ".png";
                if (a != this.skin_path) {
                    this.skin_path = a,
                    this.change_id++;
                    var r = this.change_id;
                    "" == game.LoadMgr.getResImageSkin(a) ? (this._setLoadedTexture(4e5, e),
                    this.loaded = !1,
                    game.LoadMgr.loadResImage([this.skin_path], Laya.Handler.create(this, function() {
                        r == i.change_id && (i.loaded = !0,
                        i._setLoadedTexture(t, e))
                    }))) : (this.loaded = !0,
                    this._setLoadedTexture(t, e))
                }
            } else
                this.clear()
        }
        ,
        e.prototype.clear = function() {
            this.change_id++,
            this.loaded && "" != this.skin_path && (Laya.loader.clearTextureRes(game.LoadMgr.getResImageSkin(this.skin_path)),
            this.loaded = !1,
            this.skin_path = "")
        }
        ,
        e.prototype._setLoadedTexture = function(t, e) {
            var i = cfg.item_definition.skin.get(t);
            "full" == e || "half" == e ? game.Tools.charaPart(t, this.img, e, this.origin_rect) : this.img.skin = game.LoadMgr.getResImageSkin(i.path + "/" + e + ".png")
        }
        ,
        e
    }();
    t.UI_Character_Skin = e
}(uiscript || (uiscript = {}));
var uiscript;
!function(t) {
    var e = function() {
        function t(t) {
            this.change_id = 0,
            this.skin_path = "",
            this.loaded = !1,
            this.me = t,
            this.me.skin = ""
        }
        return t.prototype.setSkin = function(t, e) {
            var i = this
              , n = cfg.item_definition.character.get(t);
            if (n) {
                var a = n.emo + "/" + e.toString() + ".png";
                if (a != this.skin_path) {
                    this.skin_path = a,
                    this.change_id++;
                    var r = this.change_id
                      , s = game.LoadMgr.getResImageSkin(a);
                    "" == s ? (this.me.skin = game.LoadMgr.getResImageSkin("extendRes/emo/default.png"),
                    this.loaded = !1,
                    game.LoadMgr.loadResImage([this.skin_path], Laya.Handler.create(this, function() {
                        r == i.change_id && (i.loaded = !0,
                        i.me.skin = game.LoadMgr.getResImageSkin(i.skin_path))
                    }))) : (this.loaded = !0,
                    this.me.skin = s)
                }
            } else
                this.clear()
        }
        ,
        t.prototype.clear = function() {
            this.change_id++,
            this.loaded && "" != this.skin_path && (Laya.loader.clearTextureRes(this.skin_path),
            this.loaded = !1,
            this.skin_path = "")
        }
        ,
        t
    }();
    t.UI_Character_Emo = e
}(uiscript || (uiscript = {}));
var uiscript;
!function(t) {
    var e = function() {
        function t(t) {
            this.me = null,
            this.info = null,
            this._info = "",
            this._index = 0,
            this._start_time = 0,
            this._word_span = 50,
            this._speed = 1,
            this.me = t,
            this.info = this.me.getChildByName("info")
        }
        return t.prototype.show = function(t, e) {
            var i = this;
            void 0 === e && (e = 1),
            Laya.timer.clearAll(this),
            this._speed = e,
            this.info.text = "",
            this._info = t,
            this._index = 0,
            this.me.visible = !0,
            this.me.alpha = 0,
            Laya.Tween.to(this.me, {
                alpha: 1
            }, 200, null, null, 0, !0),
            this._start_time = Laya.timer.currTimer,
            this._word_span = 50,
            Laya.timer.once(200, this, function() {
                i._nextchar()
            })
        }
        ,
        t.prototype._nextchar = function() {
            if (!(this._info.length <= this._index))
                if ("[" == this._info[this._index]) {
                    for (var t = -1, e = this._index + 1; e < this._info.length; e++)
                        if ("]" == this._info[e]) {
                            t = e;
                            break
                        }
                    if (-1 == t)
                        return;
                    n = parseInt(this._info.substring(this._index + 1, t));
                    this._index = t + 1;
                    var i = Laya.timer.currTimer - this._start_time;
                    i >= n ? this._nextchar() : Laya.timer.once(n - i, this, this._nextchar)
                } else if ("<" == this._info[this._index]) {
                    for (var t = -1, e = this._index + 1; e < this._info.length; e++)
                        if (">" == this._info[e]) {
                            t = e;
                            break
                        }
                    if (-1 == t)
                        return;
                    var n = parseInt(this._info.substring(this._index + 1, t));
                    this._index = t + 1,
                    this._word_span = n,
                    this._nextchar()
                } else {
                    var a = this.info.text
                      , r = this._speed
                      , s = function(t) {
                        return " " != t && "\t" != t && "\r" != t && "\n" != t
                    };
                    if ("en" == GameMgr.client_language)
                        for (; this._index < this._info.length && r > 0 && "[" != this._info[this._index] && "<" != this._info[this._index]; )
                            if (s(this._info[this._index])) {
                                for (var o = "", e = this._index; e < this._info.length && s(this._info[e]); )
                                    o += this._info[e++];
                                this.info.text = a;
                                var l = this.info.textField.textHeight;
                                this.info.text = a + o + " ";
                                var h = this.info.textField.textHeight;
                                if (a.length > 0 && l != h && (a += "\n"),
                                o.length > r) {
                                    a += o.substr(0, r),
                                    this._index += r,
                                    r = 0;
                                    break
                                }
                                a += o,
                                r -= o.length,
                                this._index += o.length
                            } else
                                a += this._info[this._index],
                                this._index++,
                                r--;
                    else
                        for (e = 0; e < this._speed && this._index < this._info.length && ("[" != this._info[this._index] && "<" != this._info[this._index]); e++)
                            a += this._info[this._index],
                            this._index++;
                    this.info.text = a,
                    Laya.timer.once(this._word_span, this, this._nextchar)
                }
        }
        ,
        t.prototype.close = function(t) {
            var e = this;
            t ? (this.me.visible = !1,
            Laya.timer.clearAll(this)) : (Laya.Tween.to(this.me, {
                alpha: 0
            }, 200, null, null, 0, !0),
            Laya.timer.once(200, this, function() {
                e.me.visible = !1,
                Laya.timer.clearAll(e)
            }))
        }
        ,
        t
    }();
    t.UI_Character_Chat = e
}(uiscript || (uiscript = {}));
var uiscript;
!function(t) {
    var e = function() {
        function t(t, e, i) {
            var n = this;
            this._func_locking = null,
            this._func_hide = null,
            this._func_locking = e,
            this._func_hide = i,
            this.me = t;
            var a = this.me.getChildByName("unhit");
            this.me.getChildByName("btn").clickHandler = Laya.Handler.create(this, function() {
                n._func_locking && n._func_locking.run() || (a.mouseX < 0 || a.mouseX > a.width || a.mouseY < 0 || a.mouseY > a.height) && (n._func_hide && n._func_hide.run(),
                n.hide())
            }, null, !1)
        }
        return t.prototype.show = function() {
            Laya.timer.clearAll(this),
            this.me.visible = !0,
            this.me.alpha = 0,
            Laya.Tween.to(this.me, {
                alpha: .3
            }, 150)
        }
        ,
        t.prototype.hide = function() {
            Laya.timer.clearAll(this),
            Laya.Tween.to(this.me, {
                alpha: 0
            }, 150)
        }
        ,
        t
    }();
    t.UI_BlackMask = e
}(uiscript || (uiscript = {}));
var uiscript;
!function(t) {
    var e = function() {
        function e(t) {
            this.items = [],
            this.me = t,
            this.scrollview = t.scriptMap["capsui.CScrollView"],
            this.scrollview.init_scrollview(new Laya.Handler(this,this.render_item), -1, 6, 10),
            this.scrollview.reset()
        }
        return e.prototype.show = function(e) {
            this.category = e,
            this.me.visible = !0,
            this.scrollview.reset(),
            this.items = t.UI_Bag.find_items_by_category(e),
            this.scrollview.addItem(this.items.length)
        }
        ,
        e.prototype.close = function() {
            this.me.visible = !1,
            this.items = [],
            this.scrollview.reset()
        }
        ,
        e.prototype.render_item = function(e) {
            var i = e.index
              , n = e.container
              , a = e.cache_data;
            a.skin || (a.skin = new t.UI_Item_Skin(n.getChildByName("btn_detail").getChildByName("content").getChildByName("icon")));
            var r = this.items[i]
              , s = cfg.item_definition.item.get(r.item_id)
              , o = n.getChildByName("btn_detail");
            o.clickHandler = Laya.Handler.create(this, function() {
                t.UI_ItemDetail.Inst.show(r.item_id)
            }, null, !1),
            o.getChildByName("count").visible = !1,
            o.getChildByName("btn_del").visible = !1,
            a.skin.setSkin(s.icon);
            var l = o.getChildByName("content").getChildByName("num");
            r.count <= 1 ? l.visible = !1 : (l.visible = !0,
            l.text = r.count.toString())
        }
        ,
        e.prototype.when_update_data = function() {
            this.scrollview.reset(),
            this.items = t.UI_Bag.find_items_by_category(this.category),
            this.scrollview.addItem(this.items.length)
        }
        ,
        e
    }();
    t.UI_Bag_PageItem = e
}(uiscript || (uiscript = {}));
var uiscript;
!function(t) {
    var e = function() {
        function e(e) {
            this.stardust_icon = null,
            this.stardust_count = 0,
            this.stardust_detail = 0,
            this.items = [],
            this.choose_count = {},
            this.during_sell = !1,
            this.me = e,
            this.scrollview = e.scriptMap["capsui.CScrollView"],
            this.scrollview.init_scrollview(new Laya.Handler(this,this.render_item), -1, 6, 10),
            this.scrollview.reset(),
            this.stardust_icon = new t.UI_Item_Skin(this.me.getChildByName("stardust")),
            this.label_stardust_count = this.me.getChildByName("stardust").getChildByName("count"),
            this.label_stardust_delta = this.me.getChildByName("stardust").getChildByName("delta"),
            this.btn_sell = this.me.getChildByName("btn_sell"),
            this.btn_sell.clickHandler = new Laya.Handler(this,this.open_sell),
            this.label_huanqu = this.me.getChildByName("label_huanqu"),
            this.container_sell = this.me.getChildByName("container_sell"),
            this.container_sell.getChildByName("btn_clear").clickHandler = new Laya.Handler(this,this.clear_choose),
            this.container_sell.getChildByName("btn_back").clickHandler = new Laya.Handler(this,this.close_sell),
            this.container_sell.getChildByName("btn_sell").clickHandler = new Laya.Handler(this,this.on_btn_sell),
            this.btn_sell2 = this.container_sell.getChildByName("btn_sell"),
            this.btn_clear_choose = this.container_sell.getChildByName("btn_clear")
        }
        return e.prototype.show = function() {
            this.me.visible = !0,
            this.during_sell = !1,
            this.btn_sell.visible = !0,
            this.label_huanqu.visible = !0,
            this.container_sell.visible = !1,
            this.label_stardust_delta.visible = !1,
            this.choose_count = {},
            this.stardust_icon.setSkin(cfg.item_definition.item.get(302004).icon_transparent),
            this.stardust_count = t.UI_Bag.get_item_count(game.stardust_id),
            this.stardust_detail = 0,
            this.refresh_stardust(),
            this.scrollview.reset(),
            this.items = t.UI_Bag.find_items_by_category(t.EItemCategory.gift),
            this.scrollview.addItem(this.items.length),
            0 == this.items.length && (this.btn_sell.visible = !1)
        }
        ,
        e.prototype.close = function() {
            this.me.visible = !1,
            this.items = [],
            this.scrollview.reset()
        }
        ,
        e.prototype.render_item = function(e) {
            var i = this
              , n = e.index
              , a = e.container
              , r = e.cache_data
              , s = this.items[n]
              , o = cfg.item_definition.item.get(s.item_id)
              , l = a.getChildByName("btn_detail")
              , h = l.getChildByName("content").getChildByName("num")
              , c = function() {
                var t = s.count;
                if (i.during_sell) {
                    var e = i.choose_count[s.item_id];
                    null == e || 0 == e ? (a.getChildByName("count").visible = !1,
                    a.getChildByName("btn_del").visible = !1) : (a.getChildByName("count").visible = !0,
                    a.getChildByName("count").getChildAt(0).text = e.toString(),
                    a.getChildByName("btn_del").visible = !0,
                    t -= e)
                } else
                    a.getChildByName("count").visible = !1,
                    a.getChildByName("btn_del").visible = !1;
                t <= 1 ? h.visible = !1 : (h.visible = !0,
                h.text = t.toString())
            };
            c(),
            l.clickHandler = Laya.Handler.create(this, function() {
                if (i.during_sell) {
                    var e = 0;
                    i.choose_count.hasOwnProperty(s.item_id.toString()) ? (e = i.choose_count[s.item_id],
                    i.choose_count[s.item_id]++) : (e = 0,
                    i.choose_count[s.item_id] = 1),
                    i.choose_count[s.item_id] > s.count && (i.choose_count[s.item_id] = s.count),
                    i.stardust_detail += (i.choose_count[s.item_id] - e) * o.sell_reward_count,
                    i.refresh_stardust(),
                    c()
                } else
                    t.UI_ItemDetail.Inst.show(s.item_id)
            }, null, !1),
            a.getChildByName("btn_del").clickHandler = Laya.Handler.create(this, function() {
                i.during_sell && i.choose_count[s.item_id] && (i.choose_count[s.item_id]--,
                c(),
                i.stardust_detail -= o.sell_reward_count,
                i.refresh_stardust())
            }, null, !1),
            r.skin || (r.skin = new t.UI_Item_Skin(l.getChildByName("content").getChildByName("icon"))),
            r.skin.setSkin(o.icon);
            var u = l.getChildByName("content");
            this.during_sell ? u.scaleX = u.scaleY = .9 : u.scaleX = u.scaleY = 1.1
        }
        ,
        e.prototype.open_sell = function() {
            this.during_sell = !0,
            this.btn_sell.visible = !1,
            this.label_huanqu.visible = !1,
            this.container_sell.visible = !0,
            this.label_stardust_delta.visible = !0,
            this.label_stardust_delta.text = "",
            this.choose_count = {},
            this.stardust_detail = 0,
            this.refresh_stardust(),
            this.scrollview.wantToRefreshAll()
        }
        ,
        e.prototype.close_sell = function() {
            this.during_sell = !1,
            this.btn_sell.visible = !0,
            this.label_huanqu.visible = !0,
            this.container_sell.visible = !1,
            this.label_stardust_delta.visible = !1,
            this.clear_choose(),
            this.scrollview.wantToRefreshAll()
        }
        ,
        e.prototype.on_btn_sell = function() {
            var e = [];
            for (var i in this.choose_count)
                this.choose_count[i] > 0 && e.push({
                    item_id: parseInt(i),
                    count: this.choose_count[i]
                });
            t.UI_SecondConfirm.Inst.show(game.Tools.strOfLocalization(2036), Laya.Handler.create(this, function() {
                app.NetAgent.sendReq2Lobby("Lobby", "sellItem", {
                    sells: e
                }, function(e, i) {
                    e || i.error ? t.UIMgr.Inst.showNetReqError("sellItem", e, i) : t.UI_LightTips.Inst.show(game.Tools.strOfLocalization(2037))
                })
            }), Laya.Handler.create(this, function() {}))
        }
        ,
        e.prototype.clear_choose = function() {
            for (var t in this.choose_count) {
                this.choose_count[t] = 0;
                for (var e = 0; e < this.items.length; e++)
                    this.items[e].item_id.toString() == t && this.scrollview.wantToRefreshItem(e)
            }
            this.stardust_detail = 0,
            this.refresh_stardust()
        }
        ,
        e.prototype.refresh_stardust = function() {
            this.label_stardust_count.text = "x" + this.stardust_count,
            this.stardust_detail > 0 ? (this.label_stardust_delta.text = "+" + this.stardust_detail.toString(),
            this.label_stardust_delta.x = this.label_stardust_count.textField.textWidth + 55,
            this.label_stardust_delta.visible = !0,
            this.btn_sell2.visible = !0,
            this.btn_clear_choose.visible = !0) : (this.label_stardust_delta.visible = !1,
            this.btn_sell2.visible = !1,
            this.btn_clear_choose.visible = !1)
        }
        ,
        e.prototype.when_update_data = function() {
            this.close_sell(),
            this.scrollview.reset(),
            this.items = t.UI_Bag.find_items_by_category(t.EItemCategory.gift),
            this.scrollview.addItem(this.items.length),
            0 == this.items.length && (this.btn_sell.visible = !1),
            this.stardust_count = t.UI_Bag.get_item_count(game.stardust_id),
            this.refresh_stardust()
        }
        ,
        e
    }();
    t.UI_Bag_PageGift = e
}(uiscript || (uiscript = {}));
var uiscript;
!function(t) {
    var e = function() {
        function e(t) {
            var e = this;
            this.desktop_default = "myres2/tablecloth/tablecloth_default/preview.jpg",
            this.mjp_defalut = "myres2/mjp/mjp_default/preview.png",
            this.tab_index = 0,
            this.select_index = 0,
            this.items = [],
            this.img_desktop = null,
            this.img_mjp = null,
            this.btn_save = null,
            this.me = t,
            this.scrollview = t.getChildByName("items").scriptMap["capsui.CScrollView"],
            this.scrollview.init_scrollview(new Laya.Handler(this,this.render_item), -1, 3, 10),
            this.scrollview.reset(),
            this.btn_tablecloth = t.getChildByName("items").getChildByName("btn_tablecloth"),
            this.btn_tablecloth.clickHandler = Laya.Handler.create(this, function() {
                1 != e.tab_index && e.change_tab(1)
            }, null, !1),
            this.btn_cardback = t.getChildByName("items").getChildByName("btn_cardback"),
            this.btn_cardback.clickHandler = Laya.Handler.create(this, function() {
                2 != e.tab_index && e.change_tab(2)
            }, null, !1);
            var i = this.me.getChildByName("preview");
            this.img_desktop = i.getChildByName("desktop"),
            this.img_mjp = i.getChildByName("mjp"),
            this.btn_save = i.getChildByName("btn_use"),
            this.btn_save.clickHandler = Laya.Handler.create(this, this.save_change, null, !1)
        }
        return e.prototype.show = function() {
            this.me.visible = !0,
            this.items = t.UI_Bag.find_items_by_category(t.EItemCategory.common_view),
            this.items = this.items.sort(function(t, e) {
                return t.item_id - e.item_id
            }),
            this.scrollview.reset(),
            this.scrollview.addItem(this.items.length),
            this.btn_save.visible = !1,
            this.change_tab(1)
        }
        ,
        e.prototype.close = function() {
            this.me.visible = !1,
            this.items = [],
            this.scrollview.reset(),
            Laya.loader.clearTextureRes(this.img_desktop.skin),
            Laya.loader.clearTextureRes(this.img_mjp.skin),
            this.img_desktop.skin = "",
            this.img_mjp.skin = "",
            game.LoadMgr.clearImgSkin(this.img_desktop),
            game.LoadMgr.clearImgSkin(this.img_mjp)
        }
        ,
        e.prototype.change_tab = function(e) {
            var i = t.UI_Bag.find_items_by_category(t.EItemCategory.common_view);
            i = i.sort(function(t, e) {
                return t.item_id - e.item_id
            }),
            this.tab_index = e,
            this.items = [],
            this.scrollview.reset(),
            this.select_index = -1,
            this.btn_tablecloth.getChildByName("inchoose").visible = 1 == e,
            this.btn_cardback.getChildByName("inchoose").visible = 2 == e;
            for (var n = 0; n < i.length; n++) {
                cfg.item_definition.item.get(i[n].item_id).type == e && (this.items.push(i[n]),
                i[n].item_id == game.GameUtility.get_common_view_id(e) && (this.select_index = this.items.length - 1))
            }
            this.scrollview.addItem(this.items.length),
            this._on_select_change(),
            1 == e ? this._refresh_mjp_view(game.GameUtility.get_common_view_id(game.ECommonView.mjp)) : this._refresh_desktop_view(game.GameUtility.get_common_view_id(game.ECommonView.desktop))
        }
        ,
        e.prototype.render_item = function(e) {
            var i = this
              , n = e.index
              , a = e.container
              , r = e.cache_data
              , s = this.items[n]
              , o = cfg.item_definition.item.get(s.item_id)
              , l = a.getChildByName("btn").getChildByName("inchoose");
            this.select_index == n ? l.visible = !0 : l.visible = !1;
            var h = a.getChildByName("btn");
            h.clickHandler = Laya.Handler.create(this, function() {
                if (i.select_index != n) {
                    var e = i.select_index;
                    i.select_index = n,
                    l.visible = !0,
                    e >= 0 && e < i.items.length && i.scrollview.wantToRefreshItem(e),
                    i._on_select_change()
                } else
                    t.UI_ItemDetail.Inst.show(s.item_id)
            }, null, !1);
            var c = a.getChildByName("useing");
            GameMgr.Inst.commonview_slot[o.type] == s.item_id ? c.visible = !0 : c.visible = !1,
            r.skin || (r.skin = new t.UI_Item_Skin(h.getChildByName("icon"))),
            r.skin.setSkin(o.icon)
        }
        ,
        e.prototype._on_select_change = function() {
            if (this.select_index >= 0 && this.select_index < this.items.length) {
                var t = this.items[this.select_index];
                game.GameUtility.get_common_view_id(this.tab_index) == t.item_id ? this.btn_save.getChildByName("info").text = game.Tools.strOfLocalization(2034) : this.btn_save.getChildByName("info").text = game.Tools.strOfLocalization(2035),
                this.btn_save.visible = !0,
                1 == this.tab_index ? this._refresh_desktop_view(t.item_id) : this._refresh_mjp_view(t.item_id)
            } else
                this.btn_save.visible = !1,
                1 == this.tab_index ? this._refresh_desktop_view(0) : this._refresh_mjp_view(0)
        }
        ,
        e.prototype._refresh_desktop_view = function(t) {
            var e = cfg.item_definition.view.get(t)
              , i = this.desktop_default;
            e && (i = "myres2/tablecloth/" + e.res_name + "/preview.jpg"),
            game.LoadMgr.clearImgSkin(this.img_desktop),
            "" != this.img_desktop.skin && (Laya.loader.clearTextureRes(this.img_desktop.skin),
            this.img_desktop.skin = ""),
            game.LoadMgr.setImgSkin(this.img_desktop, i)
        }
        ,
        e.prototype._refresh_mjp_view = function(t) {
            var e = cfg.item_definition.view.get(t)
              , i = this.mjp_defalut;
            e && (i = "myres2/mjp/" + e.res_name + "/preview.png"),
            game.LoadMgr.clearImgSkin(this.img_mjp),
            "" != this.img_mjp.skin && (Laya.loader.clearTextureRes(this.img_mjp.skin),
            this.img_mjp.skin = ""),
            game.LoadMgr.setImgSkin(this.img_mjp, i)
        }
        ,
        e.prototype.save_change = function() {
            var t = this.items[this.select_index]
              , e = 0;
            game.GameUtility.get_common_view_id(this.tab_index) == t.item_id ? (e = 0,
            this.select_index = -1) : e = t.item_id,
            GameMgr.Inst.commonview_slot[this.tab_index] = e,
            app.NetAgent.sendReq2Lobby("Lobby", "changeCommonView", {
                slot: this.tab_index,
                value: e
            }, function(t, e) {
                t ? app.Log.log(t) : app.Log.log(e)
            }),
            2 == this.tab_index && GameMgr.Inst.load_mjp_view(e);
            for (var i = 0; i < this.items.length; i++)
                this.scrollview.wantToRefreshItem(i);
            this._on_select_change()
        }
        ,
        e
    }();
    t.UI_Bag_PageDesktop = e
}(uiscript || (uiscript = {}));
var uiscript;
!function(t) {
    var e = function() {
        function t() {}
        return t.CreateFromSprite = function(e) {
            var i = new t;
            return i.x = e.x,
            i.y = e.y,
            i.width = e.width,
            i.height = e.height,
            i
        }
        ,
        t
    }();
    t.UIRect = e
}(uiscript || (uiscript = {}));
var uiscript;
!function(t) {
    t.GRAY_FILTER = [.3086, .6094, .082, 0, 0, .3086, .6094, .082, 0, 0, .3086, .6094, .082, 0, 0, 0, 0, 0, 1, 0],
    t.DARK_FILTER = [.3, 0, 0, 0, 0, 0, .3, 0, 0, 0, 0, 0, .3, 0, 0, 0, 0, 0, 1, 0];
    var e = function() {
        function e() {
            this._root = null,
            this._mj_root = null,
            this._lobby_root = null,
            this._both_root = null,
            this._common_root = null,
            this._error_root = null,
            this._mj_inited = !1,
            this._lobby_inited = !1,
            this._uis = new Array,
            this._lobby_uis = [],
            this._mj_uis = [],
            this._common_uis = [],
            this._both_uis = [],
            this._ui_chipenghu = null,
            this._ui_desktop = null,
            this._ui_liqizimo = null,
            this._ui_win = null,
            this._ui_gameend = null,
            this._ui_liuju = null,
            this._ui_lobby = null,
            this._ui_entrance = null,
            this._ui_waitingroom = null,
            this._ui_preventaddiction = null,
            this._ui_scale = -1
        }
        return e.prototype.init = function() {
            e.Inst = this,
            this._root = new Laya.Sprite,
            GameMgr.Inst.addUI(this._root),
            this._root.addChild(this._lobby_root = new Laya.Sprite),
            this._root.addChild(this._mj_root = new Laya.Sprite),
            this._root.addChild(GameMgr.Inst.root_front_scene_effect = new Laya.Sprite),
            this._root.addChild(this._both_root = new Laya.Sprite),
            this._root.addChild(this._common_root = new Laya.Sprite),
            this._root.addChild(this._error_root = new Laya.Sprite),
            this._ui_scale = -1,
            this.RefreshShow(),
            Laya.timer.frameLoop(1, this, this.RefreshShow)
        }
        ,
        e.prototype.openLobbyUI = function(e, i) {
            var n = this;
            this._lobby_inited ? (i && i.runWith(1),
            e && e.run()) : game.Scene_Lobby.Inst.addLoadListenter(Laya.Handler.create(this, function() {
                n._lobby_inited = !0,
                n.AddLobbyUI(n._ui_lobby = new t.UI_Lobby),
                n.AddBothUI(new t.UI_XinShouYinDao),
                n.AddLobbyUI(n._ui_waitingroom = new t.UI_WaitingRoom),
                n.AddLobbyUI(new t.UI_PaiPu),
                n.AddLobbyUI(new t.UI_Sushe),
                n.AddLobbyUI(new t.UI_Ob),
                n.AddLobbyUI(new t.UI_Shop),
                n.AddLobbyUI(new t.UI_Friend),
                n.AddLobbyUI(new t.UI_Recharge),
                n.AddLobbyUI(new t.UI_Create_Room),
                n.AddLobbyUI(new t.UI_Bag),
                n.AddLobbyUI(new t.UI_Match_Lobby),
                n.AddLobbyUI(new t.UI_Match_Room),
                n.AddLobbyUI(new t.UI_Treasure),
                n.AddLobbyUI(new t.UI_TanfangRoot),
                n.AddLobbyUI(new t.UI_PiPeiYuYue),
                n.AddLobbyUI(new t.UI_PlayerInfo),
                n.AddLobbyUI(new t.UI_Introduce),
                n.AddLobbyUI(new t.UI_TitleBook),
                n.AddLobbyUI(new t.UI_Activity),
                n.AddLobbyUI(new t.UI_Rank),
                n.AddLobbyUI(new t.UI_NumberInput),
                n.AddLobbyUI(new t.UI_PiPei),
                n.AddLobbyUI(new t.UI_WaitOb),
                n.AddLobbyUI(new t.UI_Change_Nickname),
                n.AddLobbyUI(new t.UI_Info),
                n.AddLobbyUI(new t.UI_PiPeiChengGong),
                n.AddLobbyUI(new t.UI_checkhuiyu),
                n.AddLobbyUI(new t.UI_Agepending),
                n.AddLobbyUI(new t.UI_Ageconfirm),
                n.AddLobbyUI(new t.UI_Agesuccess),
                n.AddLobbyUI(new t.UI_Agexiane),
                n.AddBothUI(new t.UI_Character_star_up),
                n.AddBothUI(new t.UI_Config),
                n.AddBothUI(new t.UI_Giftcode),
                n.AddBothUI(new t.UI_Rules),
                n.AddBothUI(new t.UI_OtherPlayerInfo),
                n.AddBothUI(new t.UI_Gettitle),
                n.AddBothUI(new t.UI_Getrewardextends),
                n.AddBothUI(new t.UI_ItemDetail),
                n.AddBothUI(new t.UI_InfoLite),
                n.AddBothUI(new t.UI_SecondConfirm),
                n.AddBothUI(new t.UI_Popout),
                n.AddBothUI(new t.UI_Invite),
                n.AddBothUI(new t.UI_LightTips),
                n.AddBothUI(new t.UI_FlyTips),
                n.AddCommonUI(new t.UI_ShiMingRenZheng),
                n.AddCommonUI(new t.UI_Reconnect),
                n.AddCommonUI(new t.UI_Hanguplogout),
                n.AddCommonUI(new t.UI_AnotherLogin),
                n.AddCommonUI(new t.UI_Disconnect),
                n.AddCommonUI(new t.UI_RollNotice),
                n.AddCommonUI(new t.UI_CloseApp),
                t.UI_Loading.Inst.me.parent.setChildIndex(t.UI_Loading.Inst.me, t.UI_Loading.Inst.me.parent.numChildren - 2),
                t.UI_CloseApp.Inst.me.parent.setChildIndex(t.UI_CloseApp.Inst.me, t.UI_CloseApp.Inst.me.parent.numChildren - 1),
                Laya.timer.frameOnce(6, n, function() {
                    e && e.run()
                })
            }), i)
        }
        ,
        e.prototype.openMjDesktopUI = function(e, i) {
            var n = this;
            this._mj_inited ? (i && i.runWith(1),
            e && e.run()) : game.LoadMgr.loadRes(game.E_LoadType.ui_mj, Laya.Handler.create(this, function() {
                n._mj_inited = !0,
                n.AddMJUI(new t.UI_Live_Broadcast),
                n.AddMJUI(new t.UI_ReplayWheel),
                n.AddMJUI(n._ui_desktop = new t.UI_DesktopInfo),
                n.AddMJUI(n._ui_chipenghu = new t.UI_ChiPengHu),
                n.AddMJUI(n._ui_liqizimo = new t.UI_LiQiZiMo),
                n.AddMJUI(new t.UI_TingPai),
                n.AddMJUI(n._ui_liuju = new t.UI_LiuJu),
                n.AddMJUI(new t.UI_Huleshow),
                n.AddMJUI(new t.UI_Replay),
                n.AddMJUI(new t.UI_Info_MD5),
                n.AddMJUI(new t.UI_Hangup_Warn),
                n.AddMJUI(n._ui_win = new t.UI_Win),
                n.AddMJUI(n._ui_gameend = new t.UI_GameEnd),
                n.AddMJUI(new t.UI_RankChange),
                n.AddMJUI(new t.UI_ScoreChange),
                n.AddMJUI(new t.UI_MJReward),
                n.AddMJUI(new t.UI_MJTask_Progress),
                n.AddMJUI(new t.UI_MJReward_Activity),
                n.AddMJUI(new t.UI_GameStop),
                n._mj_root.visible = !1,
                Laya.timer.frameOnce(6, n, function() {
                    e && e.run()
                })
            }), i)
        }
        ,
        e.prototype.disableMouse = function() {
            this._mj_root.mouseEnabled = !1,
            this._lobby_root.mouseEnabled = !1
        }
        ,
        e.prototype.enableMouse = function() {
            this._mj_root.mouseEnabled = !0,
            this._lobby_root.mouseEnabled = !0
        }
        ,
        e.prototype.closeUIWithTag_Lobby = function() {
            for (var e = 0; e < this._lobby_uis.length; e++)
                this._lobby_uis[e] !== t.UI_PiPeiYuYue.Inst && this._lobby_uis[e] !== t.UI_PiPeiChengGong.Inst && this._lobby_uis[e] && this._lobby_uis[e].enable && (this._lobby_uis[e].enable = !1)
        }
        ,
        e.prototype.closeUIWithTag_Both = function() {
            for (var e = 0; e < this._both_uis.length; e++)
                this._both_uis[e] && this._both_uis[e].enable && (this._both_uis[e].enable = !1);
            t.UI_ShiMingRenZheng.Inst && t.UI_ShiMingRenZheng.Inst.enable && (t.UI_ShiMingRenZheng.Inst.enable = !1)
        }
        ,
        e.prototype.showLobby = function() {
            this._lobby_root.visible = !0,
            t.UI_Ob.Inst.enable || t.UI_PaiPu.Inst.enable || (t.UI_Lobby.Inst.enable = !0)
        }
        ,
        e.prototype.intoMJDesktop = function() {
            this._lobby_root.visible = !1
        }
        ,
        e.prototype.onSceneMJ_Enable = function() {
            this._mj_root.visible = !0,
            this.CloseLiuJu(),
            this.CloseWin(),
            this.CloseChipenghu(),
            this.CloseLiqiZimo()
        }
        ,
        e.prototype.onSceneMJ_Disable = function() {
            this._mj_root.visible = !1,
            t.UI_Replay.Inst.enable = !1,
            t.UI_Live_Broadcast.Inst.enable = !1
        }
        ,
        e.prototype.onSceneLobby_Enable = function() {
            this._lobby_root.visible = !0
        }
        ,
        e.prototype.onSceneLobby_Disable = function() {
            this._lobby_root.visible = !1
        }
        ,
        e.prototype.showRemind = function() {
            null == t.UI_Remind.Inst ? (this.AddLobbyUI(new t.UI_Remind),
            Laya.timer.frameOnce(5, this, function() {
                t.UI_Remind.Inst && !t.UI_Remind.Inst.me.destroyed && (t.UI_Remind.Inst.enable = !0)
            })) : t.UI_Remind.Inst.enable = !0
        }
        ,
        e.prototype.showEntrance = function() {
            var e = this;
            null == this._ui_entrance ? Laya.timer.frameOnce(1, this, function() {
                "chs" == GameMgr.client_language ? null == t.UI_User_Xieyi.Inst && e.AddCommonUI(new t.UI_User_Xieyi) : null == t.UI_User_Xieyi_enjp.Inst && (e.AddCommonUI(new t.UI_User_Xieyi),
                e.AddCommonUI(new t.UI_User_Xieyi_enjp)),
                null == t.UI_Loading.Inst && e.AddCommonUI(new t.UI_Loading),
                null == t.UI_Common.Inst && (e.AddCommonUI(new t.UI_Common),
                Laya.timer.frameOnce(5, e, function() {
                    GameMgr.inRelease || (t.UI_Common.Inst.enable = !0)
                })),
                t.UI_Remind.Inst && t.UI_Remind.Inst.setprocess(10),
                e.AddLobbyUI(e._ui_entrance = new t.UI_Entrance),
                Laya.timer.frameOnce(5, e, function() {
                    e._ui_entrance.show();
                    var i = "res/atlas" + ("chs" == GameMgr.client_language ? "" : "/" + GameMgr.client_language) + "/myres/start_show.atlas";
                    Laya.loader.clearTextureRes(i),
                    null != t.UI_Remind.Inst && t.UI_Remind.Inst.destroy()
                })
            }) : this._ui_entrance.enable = !0
        }
        ,
        e.prototype.ShowChipenghu = function(t) {
            this._ui_chipenghu && this._ui_chipenghu.show(t)
        }
        ,
        e.prototype.CloseChipenghu = function() {
            this._ui_chipenghu && (this._ui_chipenghu.enable = !1)
        }
        ,
        e.prototype.ShowLiqiZimo = function(t) {
            this._ui_liqizimo.show(t)
        }
        ,
        e.prototype.CloseLiqiZimo = function() {
            this._ui_liqizimo.enable = !1
        }
        ,
        e.prototype.ShowWin = function(t, e) {
            this._ui_win.show(t, e)
        }
        ,
        e.prototype.CloseWin = function() {
            this._ui_win.enable = !1
        }
        ,
        e.prototype.ShowPreventAddiction = function() {
            var e = this;
            null == this._ui_preventaddiction && (this.AddCommonUI(this._ui_preventaddiction = new t.UI_PreventAddiction),
            Laya.timer.frameOnce(10, this, function() {
                e._ui_preventaddiction.enable = !0
            }))
        }
        ,
        e.prototype.ShowLiuJu = function(t) {
            this._ui_liuju.Show(t)
        }
        ,
        e.prototype.CloseLiuJu = function() {
            this._ui_liuju.enable = !1
        }
        ,
        e.prototype.ShowGameEnd = function() {
            this._ui_gameend.show()
        }
        ,
        e.prototype.ShowWaitingRoom = function() {
            this._ui_waitingroom.show()
        }
        ,
        e.prototype.ShowErrorInfo = function(e) {
            var i = new t.UI_ErrorInfo;
            this._error_root.addChild(i.me),
            Laya.timer.frameOnce(10, this, function() {
                i.showStr(e)
            })
        }
        ,
        e.prototype.showNetReqError = function(e, i, n) {
            var a = new t.UI_ErrorInfo;
            this._error_root.addChild(a.me),
            Laya.timer.frameOnce(5, this, function() {
                a.showNetReqError(e, i, n)
            })
        }
        ,
        e.prototype.showFatalError = function() {
            var e = new t.UI_ErrorInfo;
            this._error_root.addChild(e.me),
            Laya.timer.frameOnce(5, this, function() {
                e.showFatalError()
            })
        }
        ,
        e.prototype.RefreshShow = function() {
            var t = Laya.stage.height / 1080;
            if (Math.abs(t - this._ui_scale) > .01) {
                this._ui_scale = t;
                var e = .5 * (Laya.stage.width - 1920 * t);
                this._root.scale(t, t),
                this._root.x = e
            }
        }
        ,
        e.prototype.onUIDestory = function(t) {
            var e = [];
            e.push(this._uis),
            e.push(this._lobby_uis),
            e.push(this._mj_uis),
            e.push(this._both_uis),
            e.push(this._common_uis);
            for (var i = 0; i < e.length; i++)
                for (var n = 0; n < e[i].length; n++) {
                    if (e[i][n] === t) {
                        e[i][n] = e[i][e[i].length - 1],
                        e.pop();
                        break
                    }
                }
        }
        ,
        e.prototype.AddLobbyUI = function(t) {
            this._lobby_root.addChild(t.me),
            this._uis.push(t),
            this._lobby_uis.push(t)
        }
        ,
        e.prototype.AddMJUI = function(t) {
            this._mj_root.addChild(t.me),
            this._uis.push(t),
            this._mj_uis.push(t)
        }
        ,
        e.prototype.AddBothUI = function(t) {
            this._both_root.addChild(t.me),
            this._uis.push(t),
            this._both_uis.push(t)
        }
        ,
        e.prototype.AddCommonUI = function(t) {
            this._common_root.addChild(t.me),
            this._uis.push(t),
            this._common_uis.push(t)
        }
        ,
        e.prototype.getWorldPosition = function(t, e) {
            var i = new Laya.Point(t.x + e.x,t.y + e.y);
            if (t && t !== this._root)
                for (t = t.parent; t && t !== this._root; )
                    i = t.toParentPoint(i),
                    t = t.parent;
            return i.x /= 1920,
            i.y /= 1080,
            i
        }
        ,
        e.Inst = null,
        e
    }();
    t.UIMgr = e
}(uiscript || (uiscript = {}));
var caps;
!function(t) {
    var e = function() {
        function t() {}
        return Object.defineProperty(t, "filename", {
            get: function() {
                return "shader_ranshao"
            },
            enumerable: !0,
            configurable: !0
        }),
        Object.defineProperty(t, "attributeMap", {
            get: function() {
                return {
                    a_BoneIndices: Laya.VertexElementUsage.BLENDINDICES0,
                    a_BoneWeights: Laya.VertexElementUsage.BLENDWEIGHT0,
                    a_Position: Laya.VertexElementUsage.POSITION0,
                    a_Normal: Laya.VertexElementUsage.NORMAL0,
                    a_Texcoord: Laya.VertexElementUsage.TEXTURECOORDINATE0
                }
            },
            enumerable: !0,
            configurable: !0
        }),
        Object.defineProperty(t, "uniformMap", {
            get: function() {
                return {
                    u_CameraPos: [Laya.BaseCamera.CAMERAPOS, Laya.Shader3D.PERIOD_CAMERA],
                    u_MvpMatrix: [Laya.Sprite3D.MVPMATRIX, Laya.Shader3D.PERIOD_SPRITE],
                    u_WorldMat: [Laya.Sprite3D.WORLDMATRIX, Laya.Shader3D.PERIOD_SPRITE],
                    u_texture1: [this.TEXTURE1, Laya.Shader3D.PERIOD_MATERIAL],
                    u_texture2: [this.TEXTURE2, Laya.Shader3D.PERIOD_MATERIAL],
                    u_texture_mask: [this.TEXTURE_MASK, Laya.Shader3D.PERIOD_MATERIAL],
                    u_alpha_clip: [this.ALPHA_CLIP, Laya.Shader3D.PERIOD_MATERIAL],
                    "u_DirectionLight.Direction": [Laya.Scene.LIGHTDIRECTION, Laya.Shader3D.PERIOD_SCENE],
                    "u_DirectionLight.Diffuse": [Laya.Scene.LIGHTDIRCOLOR, Laya.Shader3D.PERIOD_SCENE],
                    u_bound: [this.BOUND, Laya.Shader3D.PERIOD_MATERIAL]
                }
            },
            enumerable: !0,
            configurable: !0
        }),
        t.TEXTURE1 = 1,
        t.TEXTURE2 = 2,
        t.TEXTURE_MASK = 3,
        t.ALPHA_CLIP = 4,
        t.BOUND = 5,
        t
    }();
    t.Shader_RanShao = e
}(caps || (caps = {}));
var caps;
!function(t) {
    var e = function() {
        function e() {
            this._init_state = 0,
            this._items = [],
            this._loading_num = 0
        }
        return e.filterString = function(t) {
            for (var e = "", i = 0; i < t.length; ) {
                var n = t.indexOf("\r", i);
                if (-1 == n) {
                    e += t.substring(i, t.length);
                    break
                }
                i < n && (e += t.substring(i, n)),
                i = n + 1
            }
            return e
        }
        ,
        e.prototype.init = function(e) {
            this._complete = e,
            2 != this._init_state ? 0 == this._init_state && (this._init_state = 1,
            this._loading_num = 0,
            this._init(t.Shader_RanShao.filename, t.Shader_RanShao.attributeMap, t.Shader_RanShao.uniformMap),
            this._init(t.Cartoon.filename, t.Cartoon.attributeMap, t.Cartoon.uniformMap),
            this._init(t.Outline.filename, t.Outline.attributeMap, t.Outline.uniformMap)) : this._complete && this._complete.run()
        }
        ,
        e.prototype._create_complete = function(t) {
            this._loading_num--,
            0 == this._loading_num && (this._init_state = 2,
            this._complete && this._complete.run())
        }
        ,
        e.prototype._init = function(t, i, n) {
            function a() {
                if (null != o && null != l) {
                    var e = Laya.Shader3D.nameKey.add(t);
                    Laya.ShaderCompile3D.add(e, l, o, i, n),
                    s._create_complete(t)
                }
            }
            var r = this
              , s = this
              , o = null
              , l = null;
            this._loading_num++;
            var h = "shader/" + t + "/" + t + ".vs";
            Laya.loader.load(h, Laya.Handler.create(this, function() {
                Laya.timer.frameOnce(1, r, function() {
                    l = e.filterString(Laya.loader.getRes(h)),
                    a()
                })
            }));
            var c = "shader/" + t + "/" + t + ".ps";
            Laya.loader.load(c, Laya.Handler.create(this, function() {
                Laya.timer.frameOnce(1, r, function() {
                    o = e.filterString(Laya.loader.getRes(c)),
                    a()
                })
            }))
        }
        ,
        e
    }();
    t.ShaderInitor = e
}(caps || (caps = {}));
var caps;
!function(t) {
    var e = function() {
        function t() {}
        return Object.defineProperty(t, "filename", {
            get: function() {
                return "outline"
            },
            enumerable: !0,
            configurable: !0
        }),
        Object.defineProperty(t, "attributeMap", {
            get: function() {
                return {
                    a_BoneIndices: Laya.VertexElementUsage.BLENDINDICES0,
                    a_BoneWeights: Laya.VertexElementUsage.BLENDWEIGHT0,
                    a_Position: Laya.VertexElementUsage.POSITION0,
                    a_Normal: Laya.VertexElementUsage.NORMAL0,
                    a_Texcoord: Laya.VertexElementUsage.TEXTURECOORDINATE0
                }
            },
            enumerable: !0,
            configurable: !0
        }),
        Object.defineProperty(t, "uniformMap", {
            get: function() {
                return {
                    u_Bones: [Laya.SkinnedMeshSprite3D.BONES, Laya.Shader3D.PERIOD_RENDERELEMENT],
                    u_CameraPos: [Laya.BaseCamera.CAMERAPOS, Laya.Shader3D.PERIOD_CAMERA],
                    u_MvpMatrix: [Laya.Sprite3D.MVPMATRIX, Laya.Shader3D.PERIOD_SPRITE],
                    u_WorldMat: [Laya.Sprite3D.WORLDMATRIX, Laya.Shader3D.PERIOD_SPRITE],
                    "u_SpotLight.Position": [Laya.Scene.SPOTLIGHTPOS, Laya.Shader3D.PERIOD_SCENE],
                    "u_DirectionLight.Diffuse": [Laya.Scene.LIGHTDIRCOLOR, Laya.Shader3D.PERIOD_SCENE],
                    u_outline: [this.OUTLINE, Laya.Shader3D.PERIOD_MATERIAL],
                    u_outline_color: [this.OUTLINE_COLOR, Laya.Shader3D.PERIOD_MATERIAL],
                    u_outline_alpha: [this.OUTLINE_ALPHA, Laya.Shader3D.PERIOD_MATERIAL]
                }
            },
            enumerable: !0,
            configurable: !0
        }),
        t.OUTLINE = 1,
        t.OUTLINE_COLOR = 2,
        t.OUTLINE_ALPHA = 3,
        t
    }();
    t.Outline = e
}(caps || (caps = {}));
var caps;
!function(t) {
    var e = function() {
        function t() {}
        return Object.defineProperty(t, "filename", {
            get: function() {
                return "cartoon"
            },
            enumerable: !0,
            configurable: !0
        }),
        Object.defineProperty(t, "attributeMap", {
            get: function() {
                return {
                    a_BoneIndices: Laya.VertexElementUsage.BLENDINDICES0,
                    a_BoneWeights: Laya.VertexElementUsage.BLENDWEIGHT0,
                    a_Position: Laya.VertexElementUsage.POSITION0,
                    a_Normal: Laya.VertexElementUsage.NORMAL0,
                    a_Texcoord: Laya.VertexElementUsage.TEXTURECOORDINATE0
                }
            },
            enumerable: !0,
            configurable: !0
        }),
        Object.defineProperty(t, "uniformMap", {
            get: function() {
                return {
                    u_Bones: [Laya.SkinnedMeshSprite3D.BONES, Laya.Shader3D.PERIOD_RENDERELEMENT],
                    u_CameraPos: [Laya.BaseCamera.CAMERAPOS, Laya.Shader3D.PERIOD_CAMERA],
                    u_MvpMatrix: [Laya.Sprite3D.MVPMATRIX, Laya.Shader3D.PERIOD_SPRITE],
                    u_WorldMat: [Laya.Sprite3D.WORLDMATRIX, Laya.Shader3D.PERIOD_SPRITE],
                    u_texture: [this.TEXTURE, Laya.Shader3D.PERIOD_MATERIAL],
                    "u_DirectionLight.Direction": [Laya.Scene.LIGHTDIRECTION, Laya.Shader3D.PERIOD_SCENE],
                    "u_DirectionLight.Diffuse": [Laya.Scene.LIGHTDIRCOLOR, Laya.Shader3D.PERIOD_SCENE],
                    u_split: [this.SPLIT, Laya.Shader3D.PERIOD_MATERIAL],
                    u_color: [this.COLOR, Laya.Shader3D.PERIOD_MATERIAL],
                    u_color_light: [this.COLOR_LIGHT, Laya.Shader3D.PERIOD_MATERIAL],
                    u_color_unlight: [this.COLOR_UNLIGHT, Laya.Shader3D.PERIOD_MATERIAL]
                }
            },
            enumerable: !0,
            configurable: !0
        }),
        t.TEXTURE = 1,
        t.COLOR = 2,
        t.SPLIT = 10,
        t.COLOR_LIGHT = 30,
        t.COLOR_UNLIGHT = 31,
        t
    }();
    t.Cartoon = e
}(caps || (caps = {}));
var app;
!function(t) {
    var e;
    !function(t) {
        t[t.None = 0] = "None",
        t[t.CompleteRegistration = 1] = "CompleteRegistration",
        t[t.CompleteTutorial = 2] = "CompleteTutorial",
        t[t.Level_1 = 3] = "Level_1",
        t[t.Level_2 = 4] = "Level_2",
        t[t.Level_3 = 5] = "Level_3",
        t[t.Get_The_Title1 = 6] = "Get_The_Title1",
        t[t.Purchase_Click = 7] = "Purchase_Click",
        t[t.Purchase = 8] = "Purchase",
        t[t.XinShouYinDao = 10] = "XinShouYinDao"
    }(e = t.EBehaviorType || (t.EBehaviorType = {}));
    var i = function() {
        function i() {}
        return i.init = function() {
            var e = this;
            t.NetAgent.sendReq2Lobby("Lobby", "fetchClientValue", {}, function(t, i) {
                if (t || i.error)
                    ;
                else {
                    if (e._datas = {},
                    i.datas)
                        for (var n in i.datas)
                            e._datas[parseInt(n)] = i.datas[n];
                    e.recharged_count = i.recharged_count
                }
            })
        }
        ,
        i._get_type_str = function(t) {
            switch (t) {
            case e.CompleteRegistration:
                return "CompleteRegistration";
            case e.CompleteTutorial:
                return "CompleteTutorial";
            case e.Level_1:
                return "Level_1";
            case e.Level_2:
                return "Level_2";
            case e.Level_3:
                return "Level_3";
            case e.Get_The_Title1:
                return "Get_The_Title1";
            case e.Purchase_Click:
                return "Purchase_Click";
            case e.Purchase:
                return "Purchase"
            }
            return "unkown"
        }
        ,
        i.fb_trace_force = function(t) {
            "en" == GameMgr.client_language && fbq("track", this._get_type_str(t))
        }
        ,
        i.fb_trace_pending = function(t, e) {
            if ("en" == GameMgr.client_language && this._datas) {
                var i = 0;
                this._datas[t] && (i = this._datas[t]);
                for (var n = 0; n < e - i; n++)
                    fbq("track", this._get_type_str(t));
                this.update_val(t, e)
            }
        }
        ,
        i.get_val = function(t) {
            return this._datas && this._datas[t] ? this._datas[t] : 0
        }
        ,
        i.update_val = function(e, i) {
            this._datas && (this._datas[e] = i,
            t.NetAgent.sendReq2Lobby("Lobby", "updateClientValue", {
                key: e,
                value: i
            }, function() {}))
        }
        ,
        i._datas = null,
        i.recharged_count = 0,
        i
    }();
    t.PlayerBehaviorStatistic = i
}(app || (app = {}));
var app;
!function(t) {
    var e = function() {
        function e() {}
        return Object.defineProperty(e, "lobby_ip", {
            get: function() {
                return this._lobby_ip
            },
            enumerable: !0,
            configurable: !0
        }),
        Object.defineProperty(e, "mj_ip", {
            get: function() {
                return this._mj_ip
            },
            enumerable: !0,
            configurable: !0
        }),
        Object.defineProperty(e, "lobby_network_delay", {
            get: function() {
                return this._socket_lobby ? this._socket_lobby.getNetworkDelay() : 1e7
            },
            enumerable: !0,
            configurable: !0
        }),
        Object.defineProperty(e, "mj_network_delay", {
            get: function() {
                return this._socket_mj ? this._socket_mj.getNetworkDelay() : 1e7
            },
            enumerable: !0,
            configurable: !0
        }),
        e.init = function() {
            this._socket_lobby = new net.Socket(["Lobby"],Laya.Handler.create(this, this.onReceiveMsgError, null, !1)),
            this._socket_mj = new net.Socket(["FastTest"],Laya.Handler.create(this, this.onReceiveMsgError, null, !1))
        }
        ,
        e.connect2Lobby = function(t, e) {
            this._socket_lobby.addSocketLister(e),
            this._socket_lobby.connect((GameMgr.inHttps ? "wss://" : "ws://") + t),
            this._lobby_ip = t
        }
        ,
        e.sendMsg2Lobby = function(t, e) {
            this._socket_lobby.sendMessage(".lq." + t, e)
        }
        ,
        e.isLobbyConnectOK = function() {
            return !!game.LobbyNetMgr.Inst && game.LobbyNetMgr.Inst.connect_state == game.EConnectState.connecting
        }
        ,
        e.sendReq2Lobby = function(e, i, n, a) {
            if (game.LobbyNetMgr.Inst) {
                if (game.LobbyNetMgr.Inst.connect_state != game.EConnectState.connecting) {
                    r = "发送" + i + "时,";
                    switch (game.LobbyNetMgr.Inst.connect_state) {
                    case game.EConnectState.none:
                        r += "连接不存在";
                        break;
                    case game.EConnectState.tryconnect:
                        r += "连接正在尝试";
                        break;
                    case game.EConnectState.reconnecting:
                        r += "连接重试重连";
                        break;
                    case game.EConnectState.disconnect:
                        r += "连接已断开"
                    }
                    return t.Log.log(r),
                    uiscript.UIMgr.Inst && (GameMgr.inRelease ? uiscript.UIMgr.Inst.ShowErrorInfo(game.Tools.strOfLocalization(2006)) : uiscript.UIMgr.Inst.ShowErrorInfo(r)),
                    !1
                }
                return this._socket_lobby.sendRequest(e, i, n, a),
                !0
            }
            var r = "发送" + i + "时LobbyNetMgr不存在";
            return t.Log.log(r),
            uiscript.UIMgr.Inst && !GameMgr.inRelease && uiscript.UIMgr.Inst.ShowErrorInfo(r),
            !1
        }
        ,
        e.AddListener2Lobby = function(t, e) {
            e.once = !1,
            this._socket_lobby.addMsgListener(".lq." + t, e)
        }
        ,
        e.RemoveListener2Lobby = function(t, e) {
            this._socket_lobby.removeMsgListener(".lq." + t, e)
        }
        ,
        e.connect2MJ = function(t, e) {
            this._socket_mj.addSocketLister(e),
            this._socket_mj.connect((GameMgr.inHttps ? "wss://" : "ws://") + t),
            this._mj_ip = t
        }
        ,
        e.sendMsg2MJ = function(t, e) {
            this._socket_mj.sendMessage(".lq." + t, e)
        }
        ,
        e.isMJConnectOK = function() {
            return game.MJNetMgr.Inst && game.MJNetMgr.Inst.connect_state == game.EConnectState.connecting
        }
        ,
        e.sendReq2MJ = function(e, i, n, a) {
            if (game.MJNetMgr.Inst) {
                if (game.MJNetMgr.Inst.connect_state != game.EConnectState.connecting) {
                    r = "发送" + i + "时,";
                    switch (game.MJNetMgr.Inst.connect_state) {
                    case game.EConnectState.none:
                        r += "连接不存在";
                        break;
                    case game.EConnectState.tryconnect:
                        r += "连接正在尝试";
                        break;
                    case game.EConnectState.reconnecting:
                        r += "连接重试重连";
                        break;
                    case game.EConnectState.disconnect:
                        r += "连接已断开"
                    }
                    return t.Log.log(r),
                    GameMgr.inRelease ? "checkNetworkDelay" != i && uiscript.UIMgr.Inst.ShowErrorInfo(game.Tools.strOfLocalization(2006)) : uiscript.UIMgr.Inst.ShowErrorInfo(r),
                    !1
                }
                return this._socket_mj.sendRequest(e, i, n, a),
                !0
            }
            var r = "发送" + i + "时MJNetMgr不存在";
            return t.Log.log(r),
            uiscript.UIMgr.Inst && !GameMgr.inRelease && uiscript.UIMgr.Inst.ShowErrorInfo(r),
            !1
        }
        ,
        e.AddListener2MJ = function(t, e) {
            e.once = !1,
            this._socket_mj.addMsgListener(".lq." + t, e)
        }
        ,
        e.Close2MJ = function() {
            this._socket_mj && (this._socket_mj.close(),
            this._mj_ip = "")
        }
        ,
        e.Close2Lobby = function() {
            t.Log.info_net("NetAgent Close2Lobby"),
            this._socket_lobby && (this._socket_lobby.close(),
            this._lobby_ip = "")
        }
        ,
        e.onReceiveMsgError = function(e) {
            if (game.LobbyNetMgr.Inst.isOK) {
                var i = "";
                i += "acc:" + GameMgr.Inst.account_id,
                i += ",处理[" + e.method + "]代码出错:{" + e.info + "}",
                i += ",deviceinfo:" + JSON.stringify(game.Tools.deviceInfo),
                t.NetAgent.sendReq2Lobby("Lobby", "clientMessage", {
                    timestamp: Math.floor(Date.now() / 1e3),
                    message: i
                }, function(t, e) {})
            }
        }
        ,
        e._lobby_ip = "",
        e._mj_ip = "",
        e._socket_lobby = null,
        e._socket_mj = null,
        e
    }();
    t.NetAgent = e
}(app || (app = {}));
var net;
!function(t) {
    var e = function() {
        function e(e, i) {
            var n = this;
            if (this.network_delay = 0,
            this.byte_ = new Laya.Byte,
            this.byte_.endian = Laya.Byte.LITTLE_ENDIAN,
            this.socket_ = new Laya.Socket,
            this.socket_.endian = Laya.Byte.LITTLE_ENDIAN,
            this.messages_ = [],
            this.workingMessage_ = null,
            this.requestIndex_ = 0,
            this.requestClientHandle_ = new t.RequestClientHandle(i,new Laya.Handler(this,function(t) {
                n.network_delay = t
            }
            )),
            this.handler_ = {},
            this.services_ = {},
            this.socket_.on(Laya.Event.OPEN, this, this._onOpen),
            this.socket_.on(Laya.Event.MESSAGE, this, this._onReceiveMsg),
            this.socket_.on(Laya.Event.CLOSE, this, this._onClose),
            this.socket_.on(Laya.Event.ERROR, this, this._onError),
            e)
                for (var a = 0; a < e.length; a++)
                    this._registerService(e[a])
        }
        return e.prototype.connect = function(t) {
            this.socket_.connectByUrl(t)
        }
        ,
        Object.defineProperty(e.prototype, "connected", {
            get: function() {
                return this.socket_.connected
            },
            enumerable: !0,
            configurable: !0
        }),
        e.prototype._onOpen = function(t) {
            void 0 === t && (t = null),
            app.Log.log("socket连接建立成功"),
            app.Log.info_net("socket open success"),
            this.when_socket_event && this.when_socket_event.runWith(Laya.Event.OPEN)
        }
        ,
        e.prototype._onReceiveMsg = function(t) {
            if (void 0 === t && (t = null),
            !t || 0 === t.length)
                return app.Log.Error("!data || data.length === 0"),
                void app.Log.info_net("error receive msg: !data || data.length === 0");
            this.messages_.push(new Uint8Array(t)),
            this._checkMessage()
        }
        ,
        e.prototype._onClose = function(t) {
            void 0 === t && (t = null),
            app.Log.log("socket关闭 e:" + t),
            app.Log.info_net("socket关闭 e:" + JSON.stringify(t) + ", code:" + t.code + ", reason:" + t.reason + ", wasClean:" + t.wasClean),
            this.when_socket_event && this.when_socket_event.runWith(Laya.Event.CLOSE)
        }
        ,
        e.prototype._onError = function(t) {
            void 0 === t && (t = null),
            app.Log.log("socket错误 e:" + t),
            app.Log.info_net("socket错误 e:" + JSON.stringify(t)),
            this.when_socket_event && this.when_socket_event.runWith(Laya.Event.ERROR)
        }
        ,
        e.prototype._checkMessage = function() {
            if (!this.workingMessage_ && 0 !== this.messages_.length)
                return this.workingMessage_ = this.messages_.shift(),
                this._handleMsg(this.workingMessage_),
                this.workingMessage_ = null,
                this._checkMessage()
        }
        ,
        e.prototype._handleMsg = function(e) {
            var i = {
                type: e[0]
            };
            switch (i.type) {
            case t.HeaderType.REQUEST:
            case t.HeaderType.RESPONSE:
                if (e.length < 3)
                    throw new Error("ERR_INVALID_MESSAGE_LENGTH");
                i.reqIndex = e[1] + (e[2] << 8),
                e = e.slice(3);
                break;
            case t.HeaderType.NOTIFY:
                e = e.slice(1);
                break;
            default:
                return void console.error("net", "unknown headerType: " + i.type)
            }
            switch (i.type) {
            case t.HeaderType.REQUEST:
                throw new Error("ERR_CLIENT_UNABLE_TO_HANDLE_REQUEST");
            case t.HeaderType.RESPONSE:
                var n = t.MessageWrapper.decodeRpc(e);
                return this.requestClientHandle_.emitResponse(i.reqIndex, n.data);
            case t.HeaderType.NOTIFY:
                var a = t.MessageWrapper.decodeMessage(e)
                  , r = this.handler_[a.$type.fullName];
                if (!r)
                    return void app.Log.Error("消息:" + a.$type.fullName + "未被监听");
                for (var s = 0; s < r.length; s++)
                    try {
                        r[s].runWith(a)
                    } catch (t) {
                        app.Log.Error("message " + a.$type.fullName + " handle error info:" + t),
                        this.code_error_handler && this.code_error_handler.runWith({
                            method: a.$type.fullName,
                            info: t
                        })
                    }
                return;
            default:
                return void console.error("net", "unknown headerType: " + i.type)
            }
        }
        ,
        e.prototype._requestMessage = function(e, i, n) {
            this.requestIndex_ = (this.requestIndex_ + 1) % 60007,
            app.Log.info_net("_requestMessage method:" + e + ", index:" + this.requestIndex_),
            this._sendRpc(e, {
                header: {
                    type: t.HeaderType.REQUEST,
                    reqIndex: this.requestIndex_
                },
                packet: i
            }),
            this.requestClientHandle_.waitResponseCb(e, this.requestIndex_, n)
        }
        ,
        e.prototype._registerService = function(e) {
            var i = this
              , n = t.ProtobufManager.lookupService("lq." + e);
            if (!n)
                throw new Error("ERR_SERVICE_NOT_FOUND, name=" + e);
            var a = n.create(function(t, e, n) {
                i._requestMessage(t.fullName, e, n)
            });
            this.services_[e] = a
        }
        ,
        e.prototype._sendMessage = function(e) {
            if (!this.socket_)
                throw new Error("ERR_SOCKET_NOT_CONNECT");
            var i = t.MessageWrapper.encodeHeaderData(e.header)
              , n = t.MessageWrapper.encodeMessage(e.packet)
              , a = new Laya.Byte;
            a.writeArrayBuffer(i),
            a.writeArrayBuffer(n),
            this.socket_.send(a.buffer),
            app.Log.info_net("socket _sendMessage")
        }
        ,
        e.prototype._sendRpc = function(e, i) {
            if (!this.socket_)
                throw new Error("ERR_SOCKET_NOT_CONNECT");
            var n = t.MessageWrapper.encodeHeaderData(i.header)
              , a = t.MessageWrapper.encodeRpc(e, i.packet)
              , r = new Laya.Byte;
            r.writeArrayBuffer(n),
            r.writeArrayBuffer(a),
            this.socket_.send(r.buffer),
            app.Log.info_net("socket _sendRpc")
        }
        ,
        e.prototype.sendMessage = function(e, i) {
            app.Log.info_net("socket sendMessage msg_type:" + e);
            var n = t.ProtobufManager.lookupType(e);
            n ? this._sendMessage({
                header: {
                    type: t.HeaderType.NOTIFY
                },
                packet: n.create(i)
            }) : app.Log.Error("sendMessage msg_type:" + e + "未找到")
        }
        ,
        e.prototype.sendRequest = function(t, e, i, n) {
            app.Log.info_net("socket sendRequest service_name:" + t + ", rpc_name:" + e);
            var a = this.services_[t];
            if (!a)
                throw new Error("ERR_SERVICE_NOT_FOUND, name=FastTest");
            a[e](i, n)
        }
        ,
        e.prototype.addMsgListener = function(t, e) {
            this.handler_[t] || (this.handler_[t] = []),
            this.handler_[t].push(e)
        }
        ,
        e.prototype.removeMsgListener = function(t, e) {
            if (this.handler_[t]) {
                for (var i = this.handler_[t], n = [], a = 0; a < i.length; a++)
                    i[a] !== e && n.push(e);
                this.handler_[t] = n
            }
        }
        ,
        e.prototype.addSocketLister = function(t) {
            this.when_socket_event = t
        }
        ,
        e.prototype.close = function() {
            app.Log.info_net("socket close"),
            this.socket_ && this.socket_.close()
        }
        ,
        e.prototype.getNetworkDelay = function() {
            return this.network_delay
        }
        ,
        e
    }();
    t.Socket = e
}(net || (net = {}));
var net;
!function(t) {
    var e = function() {
        return function() {}
    }();
    t.WaitingEvent = e;
    var i = function() {
        function t(t, e) {
            this._delay = 0,
            this.waitingData = {},
            this.checkArray = [],
            this.delayLst = [],
            this._responseErrorHandler = t,
            this._networkDelayHandler = e,
            Laya.timer.loop(500, this, this.loop)
        }
        return t.prototype.emitResponse = function(t, e) {
            var i = this.waitingData[t];
            if (i) {
                var n = Date.now();
                if (this.delayLst.push({
                    timestamp: n,
                    delay: n - i.requestTime
                }),
                this.waitingData[t] = null,
                GameMgr.inRelease)
                    try {
                        i.cb(null, e)
                    } catch (t) {
                        app.Log.Error("net request handle error:" + t),
                        this._responseErrorHandler && this._responseErrorHandler.runWith({
                            method: i.method,
                            info: t
                        })
                    }
                else
                    i.cb(null, e)
            }
        }
        ,
        t.prototype.waitResponseCb = function(t, e, i) {
            var n = {
                method: t,
                index: e,
                requestTime: Date.now(),
                cb: i
            };
            this.waitingData[e] = n,
            this.checkArray.push({
                timeout: n.requestTime + 15e3,
                index: n.index
            })
        }
        ,
        t.prototype.loop = function() {
            var t = this.calcu_preresponse_delay()
              , e = this.check_waiting_response()
              , i = 0
              , n = 0;
            t >= 0 && (i += .3 * t,
            n += .3),
            e >= 0 && (i += e,
            n += 1),
            n > 0 && (i /= n,
            this._delay = i),
            this._networkDelayHandler && this._networkDelayHandler.runWith(this._delay)
        }
        ,
        t.prototype.calcu_preresponse_delay = function() {
            for (var t = Date.now(), e = 0, i = 0, n = 0, a = 0; a < this.delayLst.length; a++)
                this.delayLst[a].timestamp + 2e3 < t ? n++ : (e += this.delayLst[a].delay,
                i++);
            return n > 0 && (n == this.delayLst.length ? this.delayLst = [] : this.delayLst.slice(n)),
            i > 0 ? e / i : -1
        }
        ,
        t.prototype.check_waiting_response = function() {
            for (var t = Date.now(), e = 0, i = -1, n = 0; n < this.checkArray.length; n++) {
                var a = this.checkArray[n];
                if (this.waitingData[a.index]) {
                    if (t < a.timeout) {
                        i < 0 && (i = t - this.waitingData[a.index].requestTime);
                        break
                    }
                    e += 1;
                    var r = this.waitingData[a.index];
                    this.waitingData[a.index] = null,
                    i = 5e3,
                    this.delayLst.push({
                        delay: 1e4,
                        timestamp: t
                    }),
                    r.cb(new Error("TIMEOUT"))
                } else
                    e += 1
            }
            return e > 0 && (e == this.checkArray.length ? this.checkArray = [] : this.checkArray = this.checkArray.slice(e)),
            i
        }
        ,
        t
    }();
    t.RequestClientHandle = i
}(net || (net = {}));
var net;
!function(t) {
    var e = function() {
        function t() {}
        return t.loadProto = function(t) {
            this.root = protobuf.Root.fromJSON(t),
            this.root.resolveAll(),
            console.log("loadProto finished")
        }
        ,
        t.lookup = function(t, e) {
            return this.root.lookup(t, e)
        }
        ,
        t.lookupType = function(t) {
            return this.root.lookupType(t)
        }
        ,
        t.lookupEnum = function(t) {
            return this.root.lookupEnum(t)
        }
        ,
        t.lookupTypeOrEnum = function(t) {
            return this.root.lookupTypeOrEnum(t)
        }
        ,
        t.lookupService = function(t) {
            return this.root.lookupService(t)
        }
        ,
        t.lookupMethod = function(t) {
            if ("string" == typeof t && (t = t.split(".")),
            0 === t.length)
                return null;
            var e = this.lookupService(t.slice(0, -1));
            if (!e)
                return null;
            var i = t[t.length - 1];
            return e.methods[i]
        }
        ,
        t
    }();
    t.ProtobufManager = e
}(net || (net = {}));
var net;
!function(t) {
    var e;
    !function(t) {
        t[t.NULL = 0] = "NULL",
        t[t.NOTIFY = 1] = "NOTIFY",
        t[t.REQUEST = 2] = "REQUEST",
        t[t.RESPONSE = 3] = "RESPONSE"
    }(e = t.HeaderType || (t.HeaderType = {}));
    var i = function() {
        return function() {}
    }();
    t.HeaderData = i;
    var n = function() {
        function i() {}
        return i.initWrapper = function() {
            this.WrapperCtor = t.ProtobufManager.lookupType("lq.Wrapper"),
            console.log("Wrapper is " + JSON.stringify(this.WrapperCtor))
        }
        ,
        i.encodeHeaderData = function(t) {
            switch (t.type) {
            case e.REQUEST:
            case e.RESPONSE:
                return Uint8Array.from([t.type, 255 & t.reqIndex, t.reqIndex >> 8]);
            case e.NOTIFY:
                return Uint8Array.from([t.type])
            }
            return Uint8Array.from([])
        }
        ,
        i.encodeMessage = function(t) {
            var e = t.$type;
            return this.wrap(e.fullName, e.encode(t).finish())
        }
        ,
        i.decodeMessage = function(t) {
            var e = this.unwrap(t);
            return this.decode(e.name, e.data)
        }
        ,
        i.encodeRpc = function(t, e) {
            return this.wrap(t, e)
        }
        ,
        i.decodeRpc = function(t) {
            return this.unwrap(t)
        }
        ,
        i.wrap = function(t, e) {
            var i = this.WrapperCtor
              , n = i.create({
                name: t,
                data: e
            });
            return i.encode(n).finish()
        }
        ,
        i.unwrap = function(t) {
            return i.WrapperCtor.decode(t)
        }
        ,
        i.decode = function(e, i) {
            var n = t.ProtobufManager.lookupType(e);
            if (!n)
                throw new Error("ERR_CANNOT_FIND_MESSAGE_TYPE, " + e);
            return n.decode(i)
        }
        ,
        i
    }();
    t.MessageWrapper = n
}(net || (net = {}));
var app;
!function(t) {
    var e = function() {
        function t() {}
        return t._getDate = function() {
            var t = new Date;
            return t.getFullYear() + "/" + (t.getMonth() + 1) + "/" + t.getDate() + " " + t.getHours() + ":" + t.getMinutes() + ":" + t.getSeconds() + "." + t.getMilliseconds()
        }
        ,
        t._insertCacheLog = function(t) {
            this._cache_logs.length < 40 ? this._cache_logs.push(t) : this._cache_logs[this._ceche_index++] = t
        }
        ,
        t.log = function(t) {
            var e = "[" + this._getDate() + " f:" + Laya.timer.currFrame + "]log: " + t;
            GameMgr.inRelease || console.log(e),
            this._insertCacheLog(e)
        }
        ,
        t.info = function(t) {
            var e = "[" + this._getDate() + " f:" + Laya.timer.currFrame + "]info: " + t;
            GameMgr.inRelease || console.info(e),
            this._insertCacheLog(e)
        }
        ,
        t.Error = function(t) {
            var e = "[" + this._getDate() + " f:" + Laya.timer.currFrame + "]error: " + t;
            GameMgr.inRelease || console.error(e),
            this._insertCacheLog(e)
        }
        ,
        t.info_net = function(t) {
            var e = "[" + this._getDate() + " f:" + Laya.timer.currFrame + "]info_net: " + t;
            GameMgr.inRelease || console.info(e)
        }
        ,
        t.getCacheLog = function() {
            if (0 == this._cache_logs.length)
                return "nolog";
            for (var t = "", e = 0; e < this._cache_logs.length; e++) {
                var i = (this._ceche_index + e) % this._cache_logs.length;
                0 != e && (t += "\n"),
                t += this._cache_logs[i]
            }
            return t
        }
        ,
        t.getFunctionName = function(t) {
            if ("function" == typeof t || "object" == typeof t)
                var e = ("" + t).match(/function\s*([\w\$]*)\s*\(/);
            return e && e[1]
        }
        ,
        t.trace = function() {
            for (var t = "", e = arguments.callee.caller, i = 10; e && i > 0; )
                "" != t && (t += "\n"),
                t += e.toString(),
                e = e.caller,
                i--;
            return t
        }
        ,
        t._cache_logs = [],
        t._ceche_index = 0,
        t
    }();
    t.Log = e
}(app || (app = {}));
var view;
!function(t) {
    var e = function() {
        function e(t, e) {
            this.val = null,
            this.model = null,
            this.ismoqie = !1,
            this.ispaopai = !1,
            this.isDora = !1,
            this.val = t,
            this.model = e,
            this.isDora = !1,
            this.RefreshDora()
        }
        return e.prototype.ShowUp = function() {
            this.model.transform.localRotationEuler = new Laya.Vector3(90,0,0)
        }
        ,
        e.prototype.ShowBack = function() {
            this.model.transform.localRotationEuler = new Laya.Vector3(-90,0,0)
        }
        ,
        e.prototype.ShowRot = function() {
            this.model.transform.localRotationEuler = new Laya.Vector3(90,-90,0)
        }
        ,
        e.prototype.RefreshDora = function() {
            if (t.DesktopMgr.bianjietishi && !this.isDora) {
                if (this.val.dora && (this.isDora = !0),
                !this.isDora)
                    for (var e = 0; e < t.DesktopMgr.Inst.dora.length; e++)
                        if (mjcore.MJPai.DoraMet(this.val, t.DesktopMgr.Inst.dora[e])) {
                            this.isDora = !0;
                            break
                        }
                if (this.isDora) {
                    var i = t.DesktopMgr.Inst.effect_dora3D.clone();
                    this.model.addChild(i),
                    i.transform.localPosition = new Laya.Vector3(0,0,0),
                    i.transform.localScale = new Laya.Vector3(1,1,1),
                    i.transform.localRotationEuler = new Laya.Vector3(0,0,0),
                    i.active = !0;
                    i.getChildAt(0).addComponent(anim.RunUV)
                }
            }
        }
        ,
        e.prototype.OnChoosedPai = function() {
            if (t.DesktopMgr.bianjietishi) {
                var e = t.DesktopMgr.Inst.choosed_pai;
                null == e || 0 != mjcore.MJPai.Distance(this.val, e) ? this.ispaopai ? this.model.meshRender.sharedMaterial.setColor(caps.Cartoon.COLOR, new Laya.Vector4(1,.78,.78,1)) : this.ismoqie ? this.model.meshRender.sharedMaterial.setColor(caps.Cartoon.COLOR, new Laya.Vector4(.8,.8,.8,1)) : this.model.meshRender.sharedMaterial.setColor(caps.Cartoon.COLOR, new Laya.Vector4(1,1,1,1)) : this.model.meshRender.sharedMaterial.setColor(caps.Cartoon.COLOR, new Laya.Vector4(.615,.827,.976,1))
            } else
                this.model.meshRender.sharedMaterial.setColor(caps.Cartoon.COLOR, new Laya.Vector4(1,1,1,1))
        }
        ,
        e
    }();
    t.ViewPai = e
}(view || (view = {}));
var view;
!function(t) {
    var e = function() {
        function t() {}
        return t.init_data = function() {
            var t = this;
            this._loaded || (this._loaded = !0,
            cfg.animation.animation.forEach(function(e) {
                var i = e.name
                  , n = e.type
                  , a = e;
                if (a.lifetime /= a.speed,
                a.keypoint)
                    for (var r = 0; r < a.keypoint.length; r++)
                        a.keypoint[r] /= a.speed;
                t._map_anim.hasOwnProperty(i) || (t._map_anim[i] = {}),
                t._map_anim[i][n] = a
            }))
        }
        ,
        t.get_anim_config = function(t, e) {
            return this._map_anim[t] ? this._map_anim[t][e] : null
        }
        ,
        t._loaded = !1,
        t._map_anim = {},
        t
    }();
    t.ModelAnimationController = e
}(view || (view = {}));
var view;
!function(t) {
    var e = function() {
        function e(e) {
            this.val = null,
            this.model = null,
            this.contianer_pai = null,
            this.pai3D = null,
            this.shadow = null,
            this._starttime = 0,
            this._lifetime = 150,
            this._index = 0,
            this._isnew = !1,
            this.model = new Laya.Sprite3D,
            e.addChild(this.model),
            this.model.transform.localPosition = new Laya.Vector3(0,.5 * -t.PAIMODEL_HEIGHT,0),
            this.model.transform.localRotationEuler = new Laya.Vector3(0,0,0),
            this.model.transform.localScale = new Laya.Vector3(1,1,1),
            this.model.active = !0,
            this.contianer_pai = new Laya.Sprite3D,
            this.model.addChild(this.contianer_pai),
            this.contianer_pai.transform.localPosition = new Laya.Vector3(0,0,0),
            this.contianer_pai.transform.localRotationEuler = new Laya.Vector3(0,0,0),
            this.contianer_pai.transform.localScale = new Laya.Vector3(1,1,1),
            this.contianer_pai.active = !0,
            this.shadow = t.DesktopMgr.Inst.effect_shadow.clone(),
            this.model.addChild(this.shadow),
            this.shadow.transform.localPosition = new Laya.Vector3(0,0,0),
            this.shadow.transform.localScale = new Laya.Vector3(1,1,1),
            this.shadow.transform.localRotationEuler = new Laya.Vector3(0,0,0),
            this.shadow.active = !0
        }
        return e.prototype.SetVal = function(e) {
            try {
                null != this.pai3D && (this.pai3D.model.destroy(),
                this.pai3D = null),
                this.val = e,
                this.pai3D = new t.ViewPai(e,t.DesktopMgr.Inst.CreatePai3D(e)),
                this.contianer_pai.addChild(this.pai3D.model),
                this.pai3D.model.transform.localPosition = new Laya.Vector3(0,0,0),
                this.pai3D.model.transform.localScale = new Laya.Vector3(1,1,1),
                this.pai3D.model.transform.localRotationEuler = new Laya.Vector3(0,180,0),
                this.pai3D.model.active = !0
            } catch (t) {
                var i = {};
                i.error = t.message,
                i.stack = t.stack,
                i.method = "HandPai3D",
                i.name = "SetVal";
                var n = "";
                this.pai3D && (n += "pai3D",
                this.pai3D.model && (n += " model",
                this.pai3D.model.transform && (n += " transform"))),
                this.contianer_pai && (n += " contianer_pai"),
                i.iinfo = n,
                GameMgr.Inst.onFatalError(i)
            }
        }
        ,
        e.prototype.SetIndex = function(e, i) {
            this.model ? this.model.destroyed ? app.Log.Error("SetIndex index:" + e + " model已经被删除") : this.model.transform || app.Log.Error("SetIndex index:" + e + " model.transform不存在") : app.Log.Error("SetIndex index:" + e + " model不存在"),
            this._isnew = i,
            this._index = e,
            this.model.transform.localPosition = new Laya.Vector3(-t.PAIMODEL_WIDTH * (e + (i ? .5 : 0)) * 1.01,.5 * -t.PAIMODEL_HEIGHT,0)
        }
        ,
        e.prototype.Stand = function() {
            this.contianer_pai.transform.localPosition = new Laya.Vector3(0,0,0),
            this.contianer_pai.transform.localRotationEuler = new Laya.Vector3(0,0,0),
            this.pai3D.model.transform.localPosition = new Laya.Vector3(0,.5 * t.PAIMODEL_HEIGHT,0),
            this.shadow.transform.localScale = new Laya.Vector3(.53 * t.PAIMODEL_WIDTH,1,.53 * t.PAIMODEL_THICKNESS),
            this.shadow.transform.localPosition = new Laya.Vector3(0,0,0),
            this.shadow.active = !0
        }
        ,
        e.prototype.FullDown = function() {
            this.contianer_pai.transform.localPosition = new Laya.Vector3(0,0,.5 * t.PAIMODEL_THICKNESS),
            this.contianer_pai.transform.localRotationEuler = new Laya.Vector3(90,0,0),
            this.pai3D.model.transform.localPosition = new Laya.Vector3(0,.5 * t.PAIMODEL_HEIGHT,.5 * -t.PAIMODEL_THICKNESS),
            this.shadow.transform.localScale = new Laya.Vector3(.53 * t.PAIMODEL_WIDTH,1,.53 * t.PAIMODEL_HEIGHT),
            this.shadow.transform.localPosition = new Laya.Vector3(0,0,.5 * (t.PAIMODEL_HEIGHT + t.PAIMODEL_THICKNESS)),
            this.shadow.active = !0
        }
        ,
        e.prototype.Cover = function() {
            this.contianer_pai.transform.localPosition = new Laya.Vector3(0,0,.5 * -t.PAIMODEL_THICKNESS),
            this.contianer_pai.transform.localRotationEuler = new Laya.Vector3(-90,0,0),
            this.pai3D.model.transform.localPosition = new Laya.Vector3(0,.5 * t.PAIMODEL_HEIGHT,.5 * t.PAIMODEL_THICKNESS),
            this.shadow.transform.localScale = new Laya.Vector3(.53 * t.PAIMODEL_WIDTH,1,.53 * t.PAIMODEL_HEIGHT),
            this.shadow.transform.localPosition = new Laya.Vector3(0,0,.5 * -(t.PAIMODEL_HEIGHT + t.PAIMODEL_THICKNESS)),
            this.shadow.active = !0
        }
        ,
        e.prototype.DoAnim_FullDown = function() {
            var t = this;
            this.FullDown(),
            this._lifetime = 120,
            this._starttime = Laya.timer.currTimer,
            this.contianer_pai.transform.localRotationEuler = new Laya.Vector3(0,0,0),
            this.shadow.active = !1,
            Laya.timer.clearAll(this),
            Laya.timer.frameLoop(1, this, function() {
                var e = Laya.timer.currTimer - t._starttime;
                if (e >= t._lifetime)
                    t.FullDown(),
                    Laya.timer.clearAll(t);
                else {
                    var i = e / t._lifetime;
                    t.contianer_pai.transform.localRotationEuler = new Laya.Vector3(90 * i * i,0,0)
                }
            })
        }
        ,
        e.prototype.DoAnim_Cover = function() {
            var t = this;
            this.Cover(),
            this._lifetime = 120,
            this._starttime = Laya.timer.currTimer,
            this.contianer_pai.transform.localRotationEuler = new Laya.Vector3(0,0,0),
            this.shadow.active = !1,
            Laya.timer.clearAll(this),
            Laya.timer.frameLoop(1, this, function() {
                var e = Laya.timer.currTimer - t._starttime;
                if (e >= t._lifetime)
                    t.Cover(),
                    Laya.timer.clearAll(t);
                else {
                    var i = e / t._lifetime;
                    t.contianer_pai.transform.localRotationEuler = new Laya.Vector3(-90 * i * i,0,0)
                }
            })
        }
        ,
        e.prototype.DoAnim_Stand = function() {
            var t = this;
            this.Cover(),
            this._lifetime = 150,
            this._starttime = Laya.timer.currTimer,
            this.shadow.active = !1,
            Laya.timer.clearAll(this),
            Laya.timer.frameLoop(1, this, function() {
                var e = Laya.timer.currTimer - t._starttime - 300;
                if (e >= t._lifetime)
                    t.Stand(),
                    Laya.timer.clearAll(t);
                else if (e >= 0) {
                    var i = e / t._lifetime;
                    t.contianer_pai.transform.localRotationEuler = new Laya.Vector3(90 * i - 90,0,0)
                }
            })
        }
        ,
        e.prototype.Destory = function() {
            null != this.contianer_pai && (Laya.timer.clearAll(this),
            this.contianer_pai.destroy(!0),
            this.pai3D.model.destroy(!0),
            this.shadow.destroy(!0),
            this.model.destroy(!0),
            this.contianer_pai = null,
            this.pai3D = null)
        }
        ,
        e
    }();
    t.HandPai3D = e
}(view || (view = {}));
var view;
!function(t) {
    var e = function() {
        function e(e, i) {
            this.player = null,
            this.origin = null,
            this.pais = null,
            this.cx = 0,
            this.cy = 0,
            this.x_count = 0,
            this.last_pai = null,
            this.last_is_liqi = !1,
            this.after_liqi = !1,
            this.waiting_offset = new Laya.Vector2(.4 * t.PAIMODEL_WIDTH,.4 * t.PAIMODEL_HEIGHT),
            this.xwidth = 0,
            this.origin = e,
            this.pais = new Array,
            this.player = i
        }
        return e.prototype.AddQiPai = function(e, i, n, a) {
            var r = this;
            void 0 === a && (a = !0),
            this.QiPaiPass();
            var s = new t.ViewPai(e,t.DesktopMgr.Inst.CreatePai3D(e));
            t.DesktopMgr.Inst.showingPaopai && (s.ismoqie = n,
            s.ispaopai = t.DesktopMgr.Inst.isPaoPai(s.val)),
            s.OnChoosedPai(),
            this.origin.parent.addChild(s.model),
            this.last_is_liqi && !i && (i = !0);
            var o = Math.atan(t.PAIMODEL_HEIGHT / t.PAIMODEL_WIDTH)
              , l = 2 * (Math.random() - .5) * 2
              , h = 0
              , c = 0;
            i ? (s.model.transform.localRotationEuler = new Laya.Vector3(90,90 + l,0),
            c = ((h = Math.sqrt(t.PAIMODEL_HEIGHT * t.PAIMODEL_HEIGHT + t.PAIMODEL_WIDTH * t.PAIMODEL_WIDTH) / 2 * Math.cos(1.5707963 - o - 3.1415926 * Math.abs(l) / 180) * 2 + .01 * t.PAIMODEL_WIDTH) - t.PAIMODEL_WIDTH) / 2) : (s.model.transform.localRotationEuler = new Laya.Vector3(90,l,0),
            c = ((h = Math.sqrt(t.PAIMODEL_HEIGHT * t.PAIMODEL_HEIGHT + t.PAIMODEL_WIDTH * t.PAIMODEL_WIDTH) / 2 * Math.cos(o - 3.1415926 * Math.abs(l) / 180) * 2 + .01 * t.PAIMODEL_WIDTH) - t.PAIMODEL_WIDTH) / 2);
            var u = 0
              , _ = 0
              , d = this.cx + c
              , f = this.cy;
            if (Math.random() < .2 && (h += u = Math.random() * t.PAIMODEL_WIDTH * .025,
            d += u),
            this.xwidth = h,
            _ = 2 * (Math.random() - .5) * t.PAIMODEL_HEIGHT * .025,
            f += _,
            s.model.transform.localPosition = this.origin.transform.localPosition.clone(),
            s.model.active = !0,
            s.model.transform.localPosition.x += d,
            s.model.transform.localPosition.z -= f,
            a) {
                var p = s.model.transform.position.clone();
                this.player.hand3d.transform.position = p.clone();
                this.player.hand3d.getChildAt(0).getChildByName("node_tile").addChild(s.model),
                s.model.transform.localPosition = new Laya.Vector3(0,0,0),
                s.model.transform.localRotationEuler = new Laya.Vector3(0,0,-((i ? 90 : 0) + l));
                var m = null;
                if (i) {
                    var g = t.DesktopMgr.Inst.player_effects[this.player.seat].effect_liqi;
                    g && "" != g ? "scene/effect_liqi_ice.lh" == g ? (m = t.ModelAnimationController.get_anim_config("Dapai", this.player.hand_type),
                    Laya.timer.once(m.keypoint[0], this, function() {
                        var e = game.EffectMgr.create_d3_effect(g);
                        r.origin.parent.addChild(e);
                        var i = -1;
                        switch (g) {
                        case "scene/effect_liqi_ice.lh":
                            i = 235
                        }
                        i > 0 && t.AudioMgr.PlayAudio(i),
                        Laya.timer.frameLoop(1, e, function() {
                            s && s.model && !s.model.destroyed ? e.transform.worldMatrix = s.model.transform.worldMatrix.clone() : (Laya.timer.clearAll(e),
                            e.destroy(!0))
                        }),
                        Laya.timer.once(5e3, r, function() {
                            e && !e.destroyed && (Laya.timer.clearAll(e),
                            e.destroy(!0))
                        })
                    })) : (m = t.ModelAnimationController.get_anim_config("LiQiPai", this.player.hand_type),
                    Laya.timer.once(m.keypoint[0], this, function() {
                        var e = game.EffectMgr.create_d3_effect(g);
                        r.origin.parent.addChild(e);
                        var i = -1;
                        switch (g) {
                        case "scene/effect_liqi_fire.lh":
                            i = 236
                        }
                        i > 0 && t.AudioMgr.PlayAudio(i),
                        Laya.timer.frameLoop(1, e, function() {
                            s && s.model && !s.model.destroyed ? e.transform.worldMatrix = s.model.transform.worldMatrix.clone() : (Laya.timer.clearAll(e),
                            e.destroy(!0))
                        }),
                        Laya.timer.once(1500, r, function() {
                            e && !e.destroyed && (Laya.timer.clearAll(e),
                            e.destroy(!0))
                        })
                    })) : m = t.ModelAnimationController.get_anim_config("Dapai", this.player.hand_type)
                } else
                    m = t.ModelAnimationController.get_anim_config("Dapai", this.player.hand_type);
                this.player.playHandAnimtion(m),
                Laya.timer.once(m.keypoint[0], this, function() {
                    t.AudioMgr.PlayAudio(207)
                }),
                Laya.timer.once(m.keypoint[1], this, function() {
                    s && s.model && !s.model.destroyed && (r.origin.parent.addChild(s.model),
                    s.model.transform.localRotationEuler = i ? new Laya.Vector3(90,90 + l,0) : new Laya.Vector3(90,l,0),
                    r.last_pai.model.transform.localPosition = r.origin.transform.localPosition.clone(),
                    r.last_pai.model.transform.localPosition.x += d,
                    r.last_pai.model.transform.localPosition.z -= f)
                })
            }
            this.last_pai = s,
            this.last_is_liqi = i,
            t.DesktopMgr.Inst.SetLastQiPai(this.player.seat, s);
            var y = t.DesktopMgr.Inst.effect_shadow.clone();
            s.model.addChild(y),
            y.transform.localPosition = new Laya.Vector3(0,0,.5 * -t.PAIMODEL_THICKNESS),
            y.transform.localScale = new Laya.Vector3(.53 * t.PAIMODEL_WIDTH,1,.53 * t.PAIMODEL_HEIGHT),
            y.transform.localRotationEuler = new Laya.Vector3(90,0,0),
            y.active = !0
        }
        ,
        e.prototype.QiPaiPass = function() {
            null != this.last_pai && (this.pais.push(this.last_pai),
            this.x_count++,
            6 == this.x_count && this.pais.length <= 12 ? (this.cx = 0,
            this.cy += 1.05 * t.PAIMODEL_HEIGHT,
            this.x_count = 0) : this.cx += this.xwidth,
            this.last_pai = null,
            this.last_is_liqi = !1)
        }
        ,
        e.prototype.QiPaiNoPass = function() {
            this.last_pai && this.last_pai.model.destroy(),
            this.last_pai = null
        }
        ,
        e.prototype.Reset = function() {
            if (this.pais.length > 0) {
                for (var t = 0; t < this.pais.length; t++)
                    this.pais[t].model.destroy();
                this.pais = new Array
            }
            this.cx = this.cy = 0,
            this.x_count = 0,
            null != this.last_pai && this.last_pai.model.destroy(),
            this.last_pai = null,
            this.last_is_liqi = !1,
            this.after_liqi = !1,
            Laya.timer.clearAll(this)
        }
        ,
        e.prototype.OnDoraRefresh = function() {
            if (null != this.last_pai && this.last_pai.RefreshDora(),
            null != this.pais)
                for (var t = 0; t < this.pais.length; t++)
                    this.pais[t].RefreshDora()
        }
        ,
        e.prototype.OnChoosedPai = function() {
            if (null != this.last_pai && this.last_pai.OnChoosedPai(),
            null != this.pais)
                for (var t = 0; t < this.pais.length; t++)
                    this.pais[t].OnChoosedPai()
        }
        ,
        e
    }();
    t.Block_QiPai = e
}(view || (view = {}));
var view;
!function(t) {
    var e = function() {
        function e(t, e) {
            this.origin = null,
            this.player = null,
            this.xOffset = 0,
            this.mings = new Array,
            this.pais = new Array,
            this.hengs = new Array,
            this.origin = t,
            this.xOffset = 0,
            this.player = e
        }
        return Object.defineProperty(e.prototype, "seat", {
            get: function() {
                return this.player.seat
            },
            enumerable: !0,
            configurable: !0
        }),
        e.prototype.Reset = function() {
            if (Laya.timer.clearAll(this),
            this.pais.length > 0) {
                for (var t = 0; t < this.pais.length; t++)
                    this.pais[t].model.destroy();
                this.pais = []
            }
            this.mings = [],
            this.hengs = [],
            this.xOffset = 0
        }
        ,
        e.prototype.AddMing = function(e, i) {
            var n = this;
            void 0 === i && (i = !0);
            try {
                this.mings.push(e);
                for (var a = 0, r = new Array, s = 0; s < e.pais.length; s++) {
                    r.push(new t.ViewPai(e.pais[s],t.DesktopMgr.Inst.CreatePai3D(e.pais[s]))),
                    this.pais.push(r[s]),
                    t.DesktopMgr.Inst.showingPaopai && (r[s].ispaopai = t.DesktopMgr.Inst.isPaoPai(r[s].val)),
                    r[s].OnChoosedPai();
                    var o = t.DesktopMgr.Inst.effect_shadow.clone();
                    r[s].model.addChild(o),
                    o.transform.localPosition = new Laya.Vector3(0,0,.5 * -t.PAIMODEL_THICKNESS),
                    o.transform.localScale = new Laya.Vector3(.53 * t.PAIMODEL_WIDTH,1,.53 * t.PAIMODEL_HEIGHT),
                    o.transform.localRotationEuler = new Laya.Vector3(90,0,0),
                    o.active = !0
                }
                var l = 0;
                if (e.type == mjcore.E_Ming.shunzi) {
                    for (var h = new Array, c = -1, s = 0; s < 3; s++)
                        e.from[s] != this.seat ? c = s : h.push(s);
                    h = h.sort(function(t, i) {
                        return -mjcore.MJPai.Distance(e.pais[t], e.pais[i])
                    }),
                    -1 != c && h.push(c),
                    l = h[0];
                    for (s = 0; s < 3; s++) {
                        var u = h[s]
                          , _ = r[u];
                        this.origin.parent.addChild(_.model),
                        _.model.transform.localPosition = this.origin.transform.localPosition.clone(),
                        e.from[u] != this.seat ? (this.xOffset += .5 * t.PAIMODEL_HEIGHT * 1.02,
                        _.ShowRot(),
                        _.model.transform.localPosition.x -= this.xOffset,
                        _.model.transform.localPosition.z -= .5 * (t.PAIMODEL_HEIGHT - t.PAIMODEL_WIDTH),
                        a = this.xOffset,
                        this.xOffset += .5 * t.PAIMODEL_HEIGHT * 1.02) : (this.xOffset += .5 * t.PAIMODEL_WIDTH * 1.02,
                        _.ShowUp(),
                        _.model.transform.localPosition.x -= this.xOffset,
                        this.xOffset += .5 * t.PAIMODEL_WIDTH * 1.02)
                    }
                } else if (e.type == mjcore.E_Ming.kezi || e.type == mjcore.E_Ming.gang_ming) {
                    for (var h = new Array, s = 0; s < e.pais.length; s++)
                        h.push(s);
                    for (s = 0; s < e.pais.length; s++)
                        if (e.from[s] != this.seat) {
                            var d = 0
                              , f = t.DesktopMgr.Inst.seat2LocalPosition(this.seat);
                            switch ((t.DesktopMgr.Inst.seat2LocalPosition(e.from[s]) - f + 4) % 4) {
                            case 1:
                                d = 0;
                                break;
                            case 2:
                                d = e.pais.length - 2;
                                break;
                            case 3:
                                d = e.pais.length - 1
                            }
                            var p = h[s];
                            h[s] = h[d],
                            h[d] = p;
                            break
                        }
                    l = h[0];
                    for (s = 0; s < e.pais.length; s++) {
                        var u = h[s]
                          , _ = r[u];
                        this.origin.parent.addChild(_.model),
                        _.model.transform.localPosition = this.origin.transform.localPosition.clone(),
                        e.from[u] != this.seat ? (this.xOffset += .5 * t.PAIMODEL_HEIGHT * 1.02,
                        _.ShowRot(),
                        _.model.transform.localPosition.x -= this.xOffset,
                        _.model.transform.localPosition.z -= .5 * (t.PAIMODEL_HEIGHT - t.PAIMODEL_WIDTH) * 1.02,
                        a = this.xOffset,
                        this.xOffset += .5 * t.PAIMODEL_HEIGHT * 1.02) : (this.xOffset += .5 * t.PAIMODEL_WIDTH * 1.02,
                        _.model.transform.localPosition.x -= this.xOffset,
                        _.ShowUp(),
                        this.xOffset += .5 * t.PAIMODEL_WIDTH * 1.02)
                    }
                } else {
                    l = 0;
                    for (s = 0; s < 4; s++) {
                        _ = r[u = s];
                        1 == s && t.DesktopMgr.Inst.SetLastQiPai(this.player.seat, _),
                        this.origin.parent.addChild(_.model),
                        _.model.transform.localPosition = this.origin.transform.localPosition.clone(),
                        1 == s || 2 == s ? (this.xOffset += .5 * t.PAIMODEL_WIDTH * 1.02,
                        _.ShowUp(),
                        _.model.transform.localPosition.x -= this.xOffset,
                        a = this.xOffset,
                        this.xOffset += .5 * t.PAIMODEL_WIDTH * 1.02) : (this.xOffset += .5 * t.PAIMODEL_WIDTH * 1.02,
                        _.model.transform.localPosition.x -= this.xOffset,
                        _.ShowBack(),
                        this.xOffset += .5 * t.PAIMODEL_WIDTH * 1.02)
                    }
                }
                if (this.hengs.push(a),
                i) {
                    t.AudioMgr.PlayAudio(209);
                    var m = new Laya.Sprite3D;
                    this.origin.parent.addChild(m),
                    m.transform.localPosition = r[l].model.transform.localPosition.clone(),
                    m.transform.localRotationEuler = new Laya.Vector3(90,0,0),
                    m.transform.localScale = new Laya.Vector3(1,1,1);
                    for (var g = [], y = r[l].model.transform.localPosition.clone(), s = 0; s < r.length; s++) {
                        var v = r[s].model.transform.localPosition.clone();
                        g.push(new Laya.Vector3(v.x - y.x,v.y - y.y,v.z - y.z))
                    }
                    for (s = 0; s < r.length; s++)
                        m.addChild(r[s].model),
                        r[s].model.transform.localPosition = g[s].clone();
                    var b = m.transform.position.clone();
                    this.player.hand3d.transform.position = b.clone();
                    this.player.hand3d.getChildAt(0).getChildByName("node_tile").addChild(m),
                    m.transform.localPosition = new Laya.Vector3(0,0,0),
                    m.transform.localRotationEuler = new Laya.Vector3(-90,0,0);
                    var x = t.ModelAnimationController.get_anim_config("Fulu", this.player.hand_type);
                    this.player.playHandAnimtion(x),
                    m.active = !1,
                    Laya.timer.once(x.keypoint[0], this, function() {
                        m.active = !0
                    }),
                    Laya.timer.once(x.keypoint[1], this, function() {
                        try {
                            n.origin.parent.addChild(m),
                            m.transform.localRotationEuler = new Laya.Vector3(90,0,0),
                            m.transform.position = b;
                            for (var i = 0; i < r.length; i++) {
                                n.origin.parent.addChild(r[i].model);
                                var a = r[i].model.transform.localPosition.clone();
                                a.x += y.x,
                                a.y += y.y,
                                a.z += y.z,
                                r[i].model.transform.localPosition = a
                            }
                            m.destroy(),
                            t.DesktopMgr.Inst.ActionRunComplete()
                        } catch (t) {
                            var s = {};
                            s.error = t.message,
                            s.stack = t.stack,
                            s.method = "AddMing2",
                            s.ming = e.toString(),
                            s.class = "Block_Ming",
                            GameMgr.Inst.onFatalError(s)
                        }
                    }),
                    Laya.timer.once(33, this, function() {
                        try {
                            if (null == m || m.destroyed)
                                return;
                            var i = game.EffectMgr.create_d3_effect("scene/effect_chipeng.lh");
                            t.DesktopMgr.Inst.trans_container_effect.parent.addChild(i);
                            var a = m.transform.position.clone();
                            a.x -= .04,
                            i.transform.position = a,
                            i.active = !0,
                            Laya.timer.once(1e3, n, function() {
                                i && i.destroy()
                            })
                        } catch (t) {
                            var r = {};
                            r.error = t.message,
                            r.stack = t.stack,
                            r.method = "AddMing4",
                            r.ming = e.toString(),
                            r.class = "Block_Ming",
                            GameMgr.Inst.onFatalError(r)
                        }
                    })
                }
            } catch (t) {
                var w = {};
                w.error = t.message,
                w.stack = t.stack,
                w.method = "AddMing",
                w.ming = e.toString(),
                w.class = "Block_Ming",
                GameMgr.Inst.onFatalError(w)
            }
        }
        ,
        e.prototype.AddGang = function(e, i) {
            var n = this;
            void 0 === i && (i = !0);
            for (var a = function(a) {
                if (r.mings[a].type == mjcore.E_Ming.kezi && 0 == mjcore.MJPai.Distance(r.mings[a].pais[0], e)) {
                    r.mings[a].type = mjcore.E_Ming.gang_ming,
                    r.mings[a].pais.push(e.Clone()),
                    r.mings[a].from.push(r.player.seat);
                    var s = new t.ViewPai(e,t.DesktopMgr.Inst.CreatePai3D(e));
                    r.origin.parent.addChild(s.model),
                    s.model.transform.localPosition = r.origin.transform.localPosition.clone(),
                    s.ShowRot(),
                    s.model.transform.localPosition.x -= r.hengs[a],
                    s.model.transform.localPosition.z = s.model.transform.localPosition.z - .5 * (t.PAIMODEL_HEIGHT - t.PAIMODEL_WIDTH) * 1.02 + 1.02 * t.PAIMODEL_WIDTH,
                    t.DesktopMgr.Inst.SetLastQiPai(r.player.seat, s),
                    r.pais.push(s),
                    t.DesktopMgr.Inst.showingPaopai && (s.ispaopai = t.DesktopMgr.Inst.isPaoPai(s.val)),
                    s.OnChoosedPai();
                    var o = t.DesktopMgr.Inst.effect_shadow.clone();
                    if (s.model.addChild(o),
                    o.transform.localPosition = new Laya.Vector3(0,0,.5 * -t.PAIMODEL_THICKNESS),
                    o.transform.localScale = new Laya.Vector3(.53 * t.PAIMODEL_WIDTH,1,.53 * t.PAIMODEL_HEIGHT),
                    o.transform.localRotationEuler = new Laya.Vector3(90,0,0),
                    o.active = !0,
                    i) {
                        t.AudioMgr.PlayAudio(209);
                        var l = new Laya.Sprite3D;
                        r.origin.parent.addChild(l),
                        l.transform.localPosition = s.model.transform.localPosition.clone(),
                        l.transform.localRotationEuler = new Laya.Vector3(90,0,0),
                        l.transform.localScale = new Laya.Vector3(1,1,1);
                        var h = s.model.transform.localPosition.clone();
                        l.addChild(s.model),
                        s.model.transform.localPosition = new Laya.Vector3(0,0,0);
                        var c = l.transform.position.clone();
                        r.player.hand3d.transform.position = c.clone();
                        r.player.hand3d.getChildAt(0).getChildByName("node_tile").addChild(l),
                        l.transform.localPosition = new Laya.Vector3(0,0,0),
                        l.transform.localRotationEuler = new Laya.Vector3(-90,0,0);
                        var u = t.ModelAnimationController.get_anim_config("Fulu", r.player.hand_type);
                        r.player.playHandAnimtion(u),
                        l.active = !1,
                        Laya.timer.once(u.keypoint[0], r, function() {
                            l.active = !0
                        }),
                        Laya.timer.once(u.keypoint[1], r, function() {
                            n.origin.parent.addChild(l),
                            l.transform.localRotationEuler = new Laya.Vector3(90,0,0),
                            l.transform.position = c,
                            n.origin.parent.addChild(s.model),
                            s.model.transform.localPosition = h,
                            t.DesktopMgr.Inst.lastqipai === s && t.DesktopMgr.Inst.effect_pai_canchi.active && t.DesktopMgr.Inst.ShowChiPengEffect(),
                            l.destroy(),
                            t.DesktopMgr.Inst.ActionRunComplete()
                        }),
                        Laya.timer.once(33, r, function() {
                            if (null != l && !l.destroyed) {
                                var e = game.EffectMgr.create_d3_effect("scene/effect_chipeng.lh");
                                t.DesktopMgr.Inst.trans_container_effect.parent.addChild(e);
                                var i = l.transform.position.clone();
                                i.x -= .04,
                                e.transform.position = i,
                                e.active = !0,
                                Laya.timer.once(1e3, n, function() {
                                    e.destroy()
                                })
                            }
                        })
                    }
                    return "break"
                }
            }, r = this, s = 0; s < this.mings.length; s++) {
                if ("break" === a(s))
                    break
            }
        }
        ,
        e.prototype.OnDoraRefresh = function() {
            if (null != this.pais)
                for (var t = 0; t < this.pais.length; t++)
                    this.pais[t].RefreshDora()
        }
        ,
        e.prototype.OnChoosedPai = function() {
            if (null != this.pais)
                for (var t = 0; t < this.pais.length; t++)
                    this.pais[t].OnChoosedPai()
        }
        ,
        e
    }();
    t.Block_Ming = e
}(view || (view = {}));
var view;
!function(t) {
    var e = function() {
        function e(t, e) {
            this.origin = null,
            this.player = null,
            this.xOffset = 0,
            this.pais = new Array,
            this.origin = t,
            this.xOffset = 0,
            this.player = e
        }
        return Object.defineProperty(e.prototype, "seat", {
            get: function() {
                return this.player.seat
            },
            enumerable: !0,
            configurable: !0
        }),
        e.prototype.Reset = function() {
            if (Laya.timer.clearAll(this),
            this.pais.length > 0) {
                for (var t = 0; t < this.pais.length; t++)
                    this.pais[t].model.destroy();
                this.pais = []
            }
            this.xOffset = 0
        }
        ,
        e.prototype.AddBabei = function(e, i, n) {
            var a = this;
            void 0 === n && (n = !0);
            try {
                var r = new t.ViewPai(e,t.DesktopMgr.Inst.CreatePai3D(e));
                this.pais.push(r),
                t.DesktopMgr.Inst.showingPaopai && (r.ismoqie = i,
                r.ispaopai = t.DesktopMgr.Inst.isPaoPai(r.val)),
                r.OnChoosedPai();
                var s = t.DesktopMgr.Inst.effect_shadow.clone();
                r.model.addChild(s),
                s.transform.localPosition = new Laya.Vector3(0,0,.5 * -t.PAIMODEL_THICKNESS),
                s.transform.localScale = new Laya.Vector3(.53 * t.PAIMODEL_WIDTH,1,.53 * t.PAIMODEL_HEIGHT),
                s.transform.localRotationEuler = new Laya.Vector3(90,0,0),
                s.active = !0;
                if (this.origin.parent.addChild(r.model),
                r.model.transform.localPosition = this.origin.transform.localPosition.clone(),
                this.xOffset += .5 * t.PAIMODEL_WIDTH * 1.02,
                r.ShowUp(),
                r.model.transform.localPosition.x -= this.xOffset,
                this.xOffset += .5 * t.PAIMODEL_WIDTH * 1.02,
                t.DesktopMgr.Inst.SetLastQiPai(this.player.seat, r),
                n) {
                    var o = r.model.transform.localPosition.clone()
                      , l = r.model.transform.position.clone();
                    this.player.hand3d.transform.position = l.clone();
                    this.player.hand3d.getChildAt(0).getChildByName("node_tile").addChild(r.model),
                    r.model.transform.localPosition = new Laya.Vector3(0,0,0),
                    r.model.transform.localRotationEuler = new Laya.Vector3(0,0,0);
                    var h = t.ModelAnimationController.get_anim_config("Dapai", this.player.hand_type);
                    this.player.playHandAnimtion(h),
                    Laya.timer.once(h.keypoint[0], this, function() {
                        t.AudioMgr.PlayAudio(207)
                    }),
                    Laya.timer.once(h.keypoint[1], this, function() {
                        r && r.model && !r.model.destroyed && (a.origin.parent.addChild(r.model),
                        r.ShowUp(),
                        r.model.transform.localPosition = o)
                    }),
                    t.DesktopMgr.Inst.ActionRunComplete()
                }
            } catch (t) {
                var c = {};
                c.error = t.message,
                c.stack = t.stack,
                c.method = "Babei",
                c.class = "Block_Babei",
                GameMgr.Inst.onFatalError(c)
            }
        }
        ,
        e.prototype.OnDoraRefresh = function() {
            if (null != this.pais)
                for (var t = 0; t < this.pais.length; t++)
                    this.pais[t].RefreshDora()
        }
        ,
        e.prototype.OnChoosedPai = function() {
            if (null != this.pais)
                for (var t = 0; t < this.pais.length; t++)
                    this.pais[t].OnChoosedPai()
        }
        ,
        e
    }();
    t.Block_Babei = e
}(view || (view = {}));
var view;
!function(t) {
    var e;
    !function(t) {
        t[t.none = 0] = "none",
        t[t.start = 1] = "start",
        t[t.during = 2] = "during",
        t[t.end = 3] = "end"
    }(e || (e = {}));
    var i = function() {
        function t() {}
        return Object.defineProperty(t, "suffix", {
            get: function() {
                return Laya.Browser.window.conch ? ".ogg" : ".mp3"
            },
            enumerable: !0,
            configurable: !0
        }),
        t.init = function() {
            GameMgr.iniOSWebview ? Laya.SoundManager.autoStopMusic = !0 : Laya.SoundManager.autoStopMusic = !1,
            Laya.SoundManager.autoReleaseSound = !1;
            var t = Laya.LocalStorage.getItem("audioVolume");
            if (t && "" != t) {
                (n = parseFloat(t)) < 0 ? n = 0 : n > 1 && (n = 1),
                this._audioVolume = n
            } else
                this._audioVolume = 1;
            var e = Laya.LocalStorage.getItem("musicVolume");
            if (e && "" != e) {
                (n = parseFloat(e)) < 0 ? n = 0 : n > 1 && (n = 1),
                this._music_volume = n
            } else
                this._music_volume = 1;
            var i = Laya.LocalStorage.getItem("lizhiVolume");
            if (i && "" != i) {
                var n = parseFloat(i);
                n < 0 ? n = 0 : n > 1 && (n = 1),
                this._lizhiVolume = n
            } else
                this._lizhiVolume = 1;
            var a = Laya.LocalStorage.getItem("audioMute");
            this._audioMuted = !(!a || "" == a) && "true" == a;
            var r = Laya.LocalStorage.getItem("musicMute");
            this.musicMuted = !(!r || "" == r) && "true" == r;
            var s = Laya.LocalStorage.getItem("lizhiMute");
            this._lizhiMuted = !(!s || "" == s) && "true" == s,
            this._map_character_mute = {},
            this._map_character_volume = {},
            Laya.timer.frameLoop(1, this, this._update)
        }
        ,
        t.PlayCharactorSound = function(t, e, i) {
            var n = t.charid
              , a = cfg.item_definition.character.get(n);
            if (!a)
                return null;
            for (var r = t.level, s = cfg.voice.sound.findGroup(a.sound), o = [], l = 0; l < s.length; l++)
                s[l].type == e && s[l].level_limit <= r && o.push(l);
            if (0 == o.length)
                return null;
            var h = o[Math.floor(Math.random() * o.length)]
              , c = a.sound_volume;
            return c *= this.getCVvolume(n),
            this.getCVmute(n) && (c = 0),
            {
                words: s[h]["words_" + GameMgr.client_language],
                sound: this.PlaySound(s[h].path, c, i)
            }
        }
        ,
        t.PlaySound = function(t, e, i) {
            this._audio_id;
            this._audio_id++;
            var n = this.suffix
              , a = Laya.SoundManager.playSound(t + n, 1, Laya.Handler.create(this, function() {
                i && i.run(),
                Laya.SoundManager.removeChannel(a)
            }));
            return a && (a.volume = e),
            a
        }
        ,
        t.PlayAudio = function(t, e, i) {
            var n = this;
            if (void 0 === e && (e = 1),
            void 0 === i && (i = 1),
            this._audioMuted || 0 == this._audioVolume)
                return -1;
            var a = cfg.audio.audio.get(t);
            if (!a)
                return -1;
            var r = this._audio_id;
            this._audio_id++;
            var s = this.suffix
              , o = Laya.SoundManager.playSound(a.path + s, e, new Laya.Handler(this,function() {
                n._RemoveAudio(r)
            }
            ));
            return o && (o.volume = this._audioVolume * i),
            this._audio_list.push({
                id: r,
                audio: o
            }),
            r
        }
        ,
        t._RemoveAudio = function(t) {
            for (var e = 0; e < this._audio_list.length; e++)
                if (this._audio_list[e].id == t) {
                    var i = this._audio_list[e];
                    this._audio_list[e] = this._audio_list[this._audio_list.length - 1],
                    this._audio_list[this._audio_list.length - 1] = i,
                    i.audio.stop(),
                    Laya.SoundManager.removeChannel(i.audio),
                    this._audio_list.pop()
                }
        }
        ,
        t.StopAudio = function(t) {
            this._RemoveAudio(t)
        }
        ,
        t.PlayMusic = function(t, e, i) {
            void 0 === e && (e = 1e3),
            void 0 === i && (i = !1),
            (i || this._current_music != t) && (this._current_music = t,
            this.onMusicChange(e))
        }
        ,
        t.StopMusic = function(t) {
            void 0 === t && (t = 1e3),
            this._current_music = "",
            this._current_lizhi_bgm = "",
            this._music && (t <= 0 ? (this._music.stop(),
            this._music = null,
            this._music_state = e.none) : (this._music_state = e.end,
            this._music_state_starttime = Laya.timer.currTimer,
            this._music_state_lifetime = t))
        }
        ,
        t.PlayLiqiBgm = function(t, e, i) {
            void 0 === e && (e = 1e3),
            void 0 === i && (i = !1),
            (i || this._current_lizhi_bgm != t) && (this._current_lizhi_bgm = t,
            this.onMusicChange(e))
        }
        ,
        Object.defineProperty(t, "lizhiVolume", {
            get: function() {
                return this._lizhiVolume
            },
            set: function(t) {
                t = t < 0 ? 0 : t > 1 ? 1 : t,
                this._lizhiVolume = t,
                this._music && this._music_state == e.during && this._playing_music == this._current_lizhi_bgm && (this._music.volume = t),
                Laya.LocalStorage.setItem("lizhiVolume", t.toString())
            },
            enumerable: !0,
            configurable: !0
        }),
        t.setCVvolume = function(t, e) {
            e = e < 0 ? 0 : e > 1 ? 1 : e,
            this._map_character_volume[t] = e,
            Laya.LocalStorage.setItem("characterVolume" + t, e.toString())
        }
        ,
        t.getCVvolume = function(t) {
            if (!this._map_character_volume.hasOwnProperty(t.toString())) {
                var e = Laya.LocalStorage.getItem("characterVolume" + t);
                this._map_character_volume[t] = e && "" != e ? parseFloat(e) : 1
            }
            return this._map_character_volume[t]
        }
        ,
        t.setCVmute = function(t, e) {
            this._map_character_mute[t] = e ? "true" : "false",
            Laya.LocalStorage.setItem("characterMute" + t, e ? "true" : "false")
        }
        ,
        t.getCVmute = function(t) {
            if (!this._map_character_mute.hasOwnProperty(t.toString())) {
                var e = Laya.LocalStorage.getItem("characterMute" + t);
                this._map_character_mute[t] = e && "" != e ? e : "false"
            }
            return "true" == this._map_character_mute[t]
        }
        ,
        Object.defineProperty(t, "audioVolume", {
            get: function() {
                return this._audioVolume
            },
            set: function(t) {
                t = t < 0 ? 0 : t > 1 ? 1 : t,
                this._audioVolume = t,
                Laya.LocalStorage.setItem("audioVolume", t.toString())
            },
            enumerable: !0,
            configurable: !0
        }),
        Object.defineProperty(t, "musicVolume", {
            get: function() {
                return this._music_volume
            },
            set: function(t) {
                this._music_volume = t,
                Laya.LocalStorage.setItem("musicVolume", t.toString()),
                this._music && this._music_state == e.during && this._playing_music == this._current_music && (this._music.volume = t)
            },
            enumerable: !0,
            configurable: !0
        }),
        Object.defineProperty(t, "lizhiMuted", {
            get: function() {
                return this._lizhiMuted
            },
            set: function(t) {
                this._lizhiMuted = t,
                Laya.LocalStorage.setItem("lizhiMute", t ? "true" : "false"),
                this.onMusicChange()
            },
            enumerable: !0,
            configurable: !0
        }),
        Object.defineProperty(t, "musicMuted", {
            get: function() {
                return this._musicMuted
            },
            set: function(t) {
                this._musicMuted = t,
                Laya.LocalStorage.setItem("musicMute", t ? "true" : "false"),
                this.onMusicChange()
            },
            enumerable: !0,
            configurable: !0
        }),
        Object.defineProperty(t, "audioMuted", {
            get: function() {
                return this._audioMuted
            },
            set: function(t) {
                this._audioMuted = t,
                Laya.LocalStorage.setItem("audioMute", t ? "true" : "false")
            },
            enumerable: !0,
            configurable: !0
        }),
        t.refresh_music_volume = function(t) {
            this._music && this._music_state == e.during && (this._music.volume = t ? .1 * this.musicVolume : this.musicVolume)
        }
        ,
        t.onMusicChange = function(t) {
            void 0 === t && (t = 1e3);
            var i = ""
              , n = 0;
            "" == i && !this.lizhiMuted && this._current_lizhi_bgm && (i = this._current_lizhi_bgm,
            n = this.lizhiVolume),
            "" == i && !this.musicMuted && this._current_music && (i = this._current_music,
            n = this.musicVolume),
            this._music ? i == this._playing_music || (this._music.stop(),
            this._music = null,
            i && (this._music = Laya.SoundManager.playMusic("audio/" + i, 0),
            this._music && (this._playing_music = i,
            this._playing_music_volume = n,
            this._music.volume = 0,
            this._music_state = e.start,
            this._music_state_starttime = Laya.timer.currTimer,
            this._music_state_lifetime = t))) : i && (this._music = Laya.SoundManager.playMusic("audio/" + i, 0),
            this._music && (this._playing_music = i,
            this._playing_music_volume = n,
            this._music.volume = 0,
            this._music_state = e.start,
            this._music_state_starttime = Laya.timer.currTimer,
            this._music_state_lifetime = t))
        }
        ,
        t._update = function() {
            if (this._music && this._music_state != e.none) {
                var t = Laya.timer.currTimer - this._music_state_starttime;
                if (this._music_state == e.start)
                    if (t >= this._music_state_lifetime)
                        this._music_state = e.during,
                        this._music.volume = this._playing_music_volume;
                    else {
                        i = t / this._music_state_lifetime;
                        this._music.volume = this._playing_music_volume * i
                    }
                else if (this._music_state == e.end)
                    if (t >= this._music_state_lifetime)
                        this._music_state = e.none,
                        Laya.SoundManager.stopMusic(),
                        this._music = null;
                    else {
                        var i = t / this._music_state_lifetime;
                        this._music.volume = this._playing_music_volume * (1 - i)
                    }
            }
        }
        ,
        t._audio_id = 0,
        t._audio_list = [],
        t._audioVolume = 0,
        t._audioMuted = !1,
        t._music = null,
        t._playing_music = "",
        t._playing_music_volume = 0,
        t._music_volume = 1,
        t._musicMuted = !1,
        t._current_music = "",
        t._lizhiVolume = 0,
        t._lizhiMuted = !1,
        t._current_lizhi_bgm = "",
        t._music_state = e.none,
        t._music_state_starttime = 0,
        t._music_state_lifetime = 0,
        t._map_character_mute = {},
        t._map_character_volume = {},
        t
    }();
    t.AudioMgr = i
}(view || (view = {}));
var game;
!function(t) {
    var e = function() {
        function e() {}
        return Object.defineProperty(e, "currentTime", {
            get: function() {
                return Math.floor(Date.now() / 1e3)
            },
            enumerable: !0,
            configurable: !0
        }),
        e.time2YearMounthDate = function(t) {
            var e = new Date(1e3 * t)
              , i = "";
            return i += e.getFullYear() + "/",
            i += (e.getMonth() < 9 ? "0" : "") + (e.getMonth() + 1).toString() + "/",
            i += (e.getDate() < 10 ? "0" : "") + e.getDate()
        }
        ,
        e.time2HourMinute = function(t, e) {
            void 0 === e && (e = !1);
            var i = new Date(1e3 * t)
              , n = "";
            return n += (i.getHours() < 10 ? "0" : "") + i.getHours() + ":",
            n += (i.getMinutes() < 10 ? "0" : "") + i.getMinutes(),
            e && (n += ":",
            n += (i.getSeconds() < 10 ? "0" : "") + i.getSeconds()),
            n
        }
        ,
        e.time2Desc = function(e) {
            var i = Math.floor(Date.now() / 1e3) - e;
            if (i < 600)
                return t.Tools.strOfLocalization(2013);
            if (i < 3600) {
                return (n = Math.floor(i / 10 / 60)).toString() + "0" + t.Tools.strOfLocalization(2014)
            }
            if (i < 86400) {
                return (n = Math.floor(i / 60 / 60)).toString() + t.Tools.strOfLocalization(2015)
            }
            if (i < 604800) {
                return (n = Math.floor(i / 24 / 60 / 60)).toString() + t.Tools.strOfLocalization(2016)
            }
            if (i < 2419200) {
                var n = Math.floor(i / 7 / 24 / 60 / 60);
                return n.toString() + t.Tools.strOfLocalization(2017)
            }
            return "1" + t.Tools.strOfLocalization(2018)
        }
        ,
        e.timelength2Desc = function(e) {
            var i = ""
              , n = e;
            return n % 60 > 0 && (i = n % 60 + t.Tools.strOfLocalization(2019)),
            (n = Math.floor(n / 60)) % 60 > 0 && (i = n % 60 + t.Tools.strOfLocalization(2020) + i),
            (n = Math.floor(n / 60)) % 24 > 0 && (i = n % 24 + t.Tools.strOfLocalization(2021) + i),
            (n = Math.floor(n / 24)) > 0 && (i = n + t.Tools.strOfLocalization(2022) + i),
            "" == i && (i = "0" + t.Tools.strOfLocalization(2019)),
            i
        }
        ,
        e.playState2Desc = function(e) {
            if (!e)
                return "";
            if (!e.game_uuid || "" == e.game_uuid)
                return "";
            if (1 == e.category)
                return t.Tools.strOfLocalization(2023);
            if (2 == e.category && e.meta) {
                var i = cfg.desktop.matchmode.get(e.meta.mode_id);
                if (i)
                    return i["room_name_" + GameMgr.client_language]
            }
            return ""
        }
        ,
        e.setGrayDisable = function(t, e) {
            e ? (t.mouseEnabled = !1,
            t.filters = [new Laya.ColorFilter(uiscript.GRAY_FILTER)]) : (t.mouseEnabled = !0,
            t.filters = [])
        }
        ,
        e.generateUUID = function() {
            var t = (new Date).getTime();
            return "xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g, function(e) {
                var i = (t + 16 * Math.random()) % 16 | 0;
                return t = Math.floor(t / 16),
                ("x" == e ? i : 3 & i | 8).toString(16)
            })
        }
        ,
        Object.defineProperty(e, "deviceInfo", {
            get: function() {
                var e = {};
                e["client-version"] = t.ResourceVersion.version;
                var i = [];
                if (Laya.Browser.onIOS && i.push("onIOS"),
                Laya.Browser.onMac && i.push("onMac"),
                Laya.Browser.onIPad && i.push("onIPad"),
                (Laya.Browser.onAndriod || Laya.Browser.onAndroid) && i.push("onAndroid"),
                Laya.Browser.onSafari && i.push("onSafari"),
                Laya.Browser.onFirefox && i.push("onFirefox"),
                Laya.Browser.onEdge && i.push("onEdge"),
                Laya.Browser.onWeiXin && i.push("onWeiXin"),
                Laya.Browser.onMiniGame && i.push("onMiniGame"),
                Laya.Browser.onMQQBrowser && i.push("onMQQBrowser"),
                Laya.Render.isConchApp ? i.push("onApp") : Laya.Browser.onPC && i.push("onPC"),
                i.length > 0) {
                    for (var n = "", a = 0; a < i.length; a++)
                        0 != a && (n += "|"),
                        n += i[a];
                    e.device = n
                } else
                    e.device = "unknown";
                return e
            },
            enumerable: !0,
            configurable: !0
        }),
        e.strWithoutForbidden = function(t) {
            var e = t;
            return cfg.info.forbidden.forEach(function(t, i) {
                if ("" != t.word)
                    for (; ; ) {
                        if (!(e.indexOf(t.word) >= 0))
                            break;
                        for (var n = "", a = 0; a < t.word.length; a++)
                            n += "*";
                        e = e.replace(t.word, n)
                    }
            }),
            e
        }
        ,
        e.faceOn = function(e, i, n, a, r) {
            a.visible = !1;
            var s = cfg.item_definition.skin.get(e);
            if (s) {
                a.skin = t.LoadMgr.getResImageSkin(s.path + "/" + i + ".png");
                var o = r.width / s[n + "_width"]
                  , l = r.height / s[n + "_height"];
                a.anchorX = 0,
                a.anchorY = 0,
                a.width = s.face_width * o,
                a.height = s.face_height * l,
                a.x = (s.face_x - s[n + "_x"]) * o,
                a.y = (s.face_y - s[n + "_y"]) * l,
                a.visible = !0
            }
        }
        ,
        e.charaPart = function(e, i, n, a) {
            var r = cfg.item_definition.skin.get(400101);
            if (r) {
                var s = cfg.item_definition.skin.get(e);
                s && (i.skin = t.LoadMgr.getResImageSkin(s.path + "/" + n + ".png"),
                i.width = a.width * s[n + "_width"] / r[n + "_width"],
                i.height = a.height * s[n + "_height"] / r[n + "_height"],
                i.x = a.x + (s[n + "_x"] - r[n + "_x"]) * a.width / r[n + "_width"] * i.scaleX,
                i.y = a.y + (s[n + "_y"] - r[n + "_y"]) * a.height / r[n + "_height"] * i.scaleY)
            }
        }
        ,
        e.showRewards = function(e, i) {
            for (var n = this, a = [], r = [], s = 0; s < e.rewards.length; s++)
                100099 != e.rewards[s].id && (100098 != e.rewards[s].id ? 6 == Math.floor(e.rewards[s].id / 1e5) ? r.push(e.rewards[s].id) : a.push(e.rewards[s]) : uiscript.UI_LightTips.Inst.show(t.Tools.strOfLocalization(2024)));
            var o = !1
              , l = 0
              , h = function() {
                if (!o && a.length > 0)
                    return uiscript.UI_Getrewardextends.Inst.show(a, Laya.Handler.create(n, function() {
                        h()
                    })),
                    void (o = !0);
                l < r.length ? uiscript.UI_Gettitle.Inst.show(r[l++], Laya.Handler.create(n, function() {
                    h()
                })) : i && i.run()
            };
            h()
        }
        ,
        e.debugFetchMultiAccountBrief = function(t, e, i, n) {
            if (!(Laya.timer.currTimer < this.debugfetchcd)) {
                this.debugfetchcd = Laya.timer.currTimer + 3e5;
                var a = {};
                a.type = "debugFetchMultiAccountBrief",
                a.pos = t,
                a.index = e,
                a.total = i,
                a.value_count = n;
                (new Laya.HttpRequest).send(GameMgr.error_url, "data=" + JSON.stringify(a), "post")
            }
        }
        ,
        e.room_mode_desc = function(e) {
            var i = "";
            switch (e) {
            case 0:
                i = t.Tools.strOfLocalization(2026);
                break;
            case 1:
                i = t.Tools.strOfLocalization(2027);
                break;
            case 2:
                i = t.Tools.strOfLocalization(2028);
                break;
            case 3:
                i = t.Tools.strOfLocalization(2029);
                break;
            case 4:
                i = t.Tools.strOfLocalization(2026);
                break;
            case 10:
                i = t.Tools.strOfLocalization(2030);
                break;
            case 11:
                i = t.Tools.strOfLocalization(2031);
                break;
            case 12:
                i = t.Tools.strOfLocalization(2032);
                break;
            case 13:
                i = t.Tools.strOfLocalization(2033);
                break;
            case 14:
                i = t.Tools.strOfLocalization(2030)
            }
            return i
        }
        ,
        e.get_room_desc = function(e) {
            if (!e)
                return {
                    text: "",
                    isSimhei: !1
                };
            var i = "";
            if (e.meta && e.meta.tournament_id) {
                var n = cfg.tournament.tournaments.get(e.meta.tournament_id);
                return n && (i = n.name),
                {
                    text: i,
                    isSimhei: !0
                }
            }
            if (1 == e.category)
                i += t.Tools.strOfLocalization(2023) + "·";
            else if (4 == e.category)
                i += t.Tools.strOfLocalization(2025) + "·";
            else if (2 == e.category) {
                var a = e.meta;
                if (a) {
                    var r = cfg.desktop.matchmode.get(a.mode_id);
                    r && (i += r["room_name_" + GameMgr.client_language] + "·")
                }
            }
            var s = e.mode.mode;
            return i += this.room_mode_desc(s),
            {
                text: i,
                isSimhei: !1
            }
        }
        ,
        e.get_chara_audio = function(t, e) {
            if (e && "" != e) {
                var i = t.charid
                  , n = cfg.item_definition.character.get(i);
                if (!n)
                    return null;
                for (var a = t.level, r = cfg.voice.sound.findGroup(n.sound), s = [], o = 0; o < r.length; o++)
                    r[o].type == e && r[o].level_limit <= a && s.push(o);
                if (0 == s.length)
                    return null;
                var l = s[Math.floor(Math.random() * s.length)];
                return {
                    path: r[l].path,
                    volume: view.AudioMgr.getCVmute(n.id) ? 0 : view.AudioMgr.getCVvolume(n.id) * n.sound_volume,
                    time_length: r[l].time_length
                }
            }
        }
        ,
        e.encode_account_id2 = function(t) {
            var e = 67108863 & (t ^= 6139246);
            return e = (511 & e) << 17 | e >> 9,
            e = (511 & e) << 17 | e >> 9,
            e = (511 & e) << 17 | e >> 9,
            e = (511 & e) << 17 | e >> 9,
            (e = (511 & e) << 17 | e >> 9) + (-67108864 & t) + 1e7
        }
        ,
        e.decode_account_id2 = function(t) {
            var e = 67108863 & (t -= 1e7);
            return e = (131071 & e) << 9 | e >> 17,
            e = (131071 & e) << 9 | e >> 17,
            e = (131071 & e) << 9 | e >> 17,
            e = (131071 & e) << 9 | e >> 17,
            e = (131071 & e) << 9 | e >> 17,
            (-67108864 & t) + e ^ 6139246
        }
        ,
        e.encode_account_id = function(t) {
            return 1358437 + (7 * t + 1117113 ^ 86216345)
        }
        ,
        e.decode_account_id = function(t) {
            return ((t - 1358437 ^ 86216345) - 1117113) / 7
        }
        ,
        e.child_align_center = function(t, e) {
            for (var i = [], n = 0; n < t.numChildren; n++) {
                if ((l = t.getChildAt(n)).visible) {
                    var a = l.width;
                    l instanceof Laya.Text ? a = l.textWidth : l instanceof Laya.Label && (a = l.textField.textWidth),
                    i.push(a * l.scaleX)
                }
            }
            for (var r = 0, n = 0; n < i.length; n++)
                r += i[n],
                e && n < e.length && (r += e[n]);
            for (var s = t.width / 2 - r / 2, o = 0, n = 0; n < t.numChildren; n++) {
                var l = t.getChildAt(n);
                l.visible && (l.x = s + l.pivotX * l.scaleX,
                s += i[o],
                e && o < e.length && (s += e[o]),
                o++)
            }
        }
        ,
        e.sprite_align_center = function(t, e, i) {
            for (var n = [], a = 0; a < t.length; a++) {
                if ((h = t[a]).visible) {
                    var r = h.width;
                    h instanceof Laya.Text ? r = h.textWidth : h instanceof Laya.Label && (r = h.textField.textWidth),
                    n.push(r * h.scaleX)
                }
            }
            for (var s = 0, a = 0; a < n.length; a++)
                s += n[a],
                i && a < i.length && (s += i[a]);
            for (var o = e - s / 2, l = 0, a = 0; a < t.length; a++) {
                var h = t[a];
                h.visible && (h.x = o + h.pivotX * h.scaleX,
                o += n[l],
                i && l < i.length && (o += i[l]),
                l++)
            }
        }
        ,
        e.build_char_map = function() {
            if (!this.char_map) {
                for (var t = [], e = "a".charCodeAt(0), i = 0; i < 26; i++)
                    t.push(String.fromCharCode(e + i));
                for (var n = "A".charCodeAt(0), i = 0; i < 26; i++)
                    t.push(String.fromCharCode(n + i));
                for (i = 0; i < 10; i++)
                    t.push(i.toString());
                for (var a = "!@#$%^&*()-_=+{}[]|:;<>,.?/~", i = 0; i < a.length; i++)
                    t.push(a[i]);
                this.char_lst = t,
                this.char_map = {};
                for (i = 0; i < t.length; i++)
                    this.char_map[t[i]] = i
            }
        }
        ,
        e.eeesss = function(t) {
            this.build_char_map();
            for (var e = "", i = (Math.floor(t.length / 3) + 17) % t.length, n = 0; n < t.length; n++) {
                var a = 2 + 3 * n ^ 11
                  , r = t[(i - n + t.length) % t.length]
                  , s = this.char_map[r];
                e += null != s ? this.char_lst[(s + a) % this.char_lst.length] : r
            }
            return e
        }
        ,
        e.dddsss = function(t) {
            this.build_char_map();
            for (var e = "", i = (Math.floor(t.length / 3) + 17) % t.length, n = [], a = 0; a < t.length; a++) {
                var r = 2 + 3 * a ^ 11
                  , s = t[a]
                  , o = this.char_map[s];
                null != o ? n.push(this.char_lst[(o - r + this.char_lst.length) % this.char_lst.length]) : n.push(s)
            }
            for (a = i; a >= 0; a--)
                e += n[a];
            for (a = t.length - 1; a > i; a--)
                e += n[a];
            return e
        }
        ,
        e.open_new_window = function(t) {
            var e = document.createElement("a");
            e.href = t,
            e.target = "_blank",
            e.click(),
            e.remove()
        }
        ,
        e.base64ToBlob = function(t, e) {
            for (var i = t.split(","), n = i[0].match(/:(.*?);/)[1] || e, a = window.atob(i[1]), r = new ArrayBuffer(a.length), s = new Uint8Array(r), o = 0; o < a.length; o++)
                s[o] = a.charCodeAt(o);
            return new Blob([r],{
                type: n
            })
        }
        ,
        e.stringContainerSub = function(t, e) {
            if (!e || "" == e)
                return !0;
            if (!t || "" == t)
                return !1;
            for (var i = 0, n = 0; n < t.length; n++)
                if (t.charAt(n) == e.charAt(i) && ++i >= e.length)
                    return !0;
            return !1
        }
        ,
        e.strOfLocalization = function(t, e) {
            void 0 === e && (e = []);
            var i = cfg.str.str.find(t)[GameMgr.client_language];
            if (e)
                for (var n = 0; n < e.length; n++) {
                    var a = "{" + n + "}";
                    i = i.replace(a, e[n])
                }
            return i
        }
        ,
        e.deal_gateway = function(t) {
            for (var e = [], i = 0; i < t.length; i++) {
                var n = Math.floor(Math.random() * (i + 1));
                e.push(i),
                e[i] = e[n],
                e[n] = i
            }
            for (var a = {}, r = [], i = 0; i < t.length; i++) {
                var s = t[e[i]]
                  , o = s.split(":");
                if (2 == o.length) {
                    var l = o[0];
                    a[l] || (a[l] = 0),
                    a[l] < 2 && (a[l]++,
                    r.push(s))
                }
            }
            return r
        }
        ,
        e.localUISrc = function(t) {
            return "chs" != GameMgr.client_language && (t = GameMgr.client_language + "/" + t),
            t
        }
        ,
        e.labelLocalizationPosition = function(t, e, i, n) {
            var a = t.textField.textWidth;
            t.x = a > i ? e + (a - i) / 2 * t.scaleX * (n ? 1 : -1) : e
        }
        ,
        e.labelLocalizationSize = function(t, e, i) {
            var n = t.textField.textWidth;
            if (n > e) {
                var a = n / e;
                t.width = e * a,
                t.scaleX = t.scaleY = i / a
            } else
                t.width = e,
                t.scaleX = t.scaleY = i
        }
        ,
        e.ToDBC = function(t) {
            for (var e = "", i = 0; i < t.length; i++)
                32 == t.charCodeAt(i) && (e += String.fromCharCode(12288)),
                t.charCodeAt(i) < 127 && (e += String.fromCharCode(t.charCodeAt(i) + 65248));
            return e
        }
        ,
        e.titleLocalization = function(t, e) {
            if (!e)
                return 0;
            var i = GameMgr.Inst.account_id >> 23
              , n = t >> 23;
            return i <= 6 ? n <= 6 ? e : 0 : i <= 12 ? n <= 12 ? e : 0 : i <= 15 && n <= 15 ? e : 0
        }
        ,
        e.debugfetchcd = 0,
        e.char_lst = null,
        e.char_map = null,
        e
    }();
    t.Tools = e
}(game || (game = {}));
var game;
!function(t) {
    var e;
    !function(t) {
        t[t.none = 0] = "none",
        t[t.loading = 1] = "loading",
        t[t.loaded = 2] = "loaded"
    }(e = t.E_LoadState || (t.E_LoadState = {}));
    var i = function() {
        function t() {
            this._active = !1,
            this._load_state = e.none
        }
        return Object.defineProperty(t.prototype, "active", {
            get: function() {
                return this._active
            },
            set: function(t) {
                this._active = t,
                this._active ? this.onEnable() : this.onDisable()
            },
            enumerable: !0,
            configurable: !0
        }),
        Object.defineProperty(t.prototype, "load_state", {
            get: function() {
                return this._load_state
            },
            enumerable: !0,
            configurable: !0
        }),
        t
    }();
    t.SceneBase = i
}(game || (game = {}));
var game;
!function(t) {
    var e = function() {
        function e() {}
        return Object.defineProperty(e, "version", {
            get: function() {
                return this._version
            },
            enumerable: !0,
            configurable: !0
        }),
        e.init = function(e) {
            this._manifest = {},
            t.LoadMgr.httpload("version.json", "json", !0, Laya.Handler.create(this, this.onManifestLoaded, [e])),
            Laya.URL.customFormat = this.formatURL
        }
        ,
        e.onManifestLoaded = function(e, i) {
            if (i.success) {
                app.Log.log("version.json加载成功");
                var n = i.data;
                this._version = n.version,
                t.LoadMgr.httpload("resversion" + this._version + ".json", "json", !1, Laya.Handler.create(this, this.onResVersionLoaded, [e]))
            } else
                app.Log.log("version.json加载失败"),
                e.run()
        }
        ,
        e.onResVersionLoaded = function(t, e) {
            if (e.success) {
                app.Log.log("Resversion.json加载成功");
                var i = e.data;
                for (var n in i.res)
                    this._manifest[n] = i.res[n].prefix
            } else
                app.Log.log("Resversion.json加载失败");
            t.run()
        }
        ,
        e.formatURL = function(t) {
            return e._manifest.hasOwnProperty(t) ? e._manifest[t] + "/" + t : t
        }
        ,
        e._manifest = {},
        e._version = "0.0.0",
        e
    }();
    t.ResourceVersion = e
}(game || (game = {}));
var game;
!function(t) {
    var e = function() {
        function e() {
            var e = this;
            this.urls = [],
            this.link_index = -1,
            this.connect_state = t.EConnectState.none,
            this.reconnect_count = 0,
            this.reconnect_span = [500, 1e3, 3e3, 6e3, 1e4, 15e3],
            this.playerreconnect = !1,
            this.lasterrortime = 0,
            this.load_over = !1,
            this.loaded_player_count = 0,
            this.real_player_count = 0,
            app.NetAgent.AddListener2MJ("NotifyPlayerLoadGameReady", Laya.Handler.create(this, function(t) {
                app.Log.log("NotifyPlayerLoadGameReady: " + JSON.stringify(t)),
                e.loaded_player_count = t.ready_id_list.length,
                e.load_over && uiscript.UI_Loading.Inst.enable && uiscript.UI_Loading.Inst.showLoadCount(e.loaded_player_count, e.real_player_count)
            }))
        }
        return Object.defineProperty(e, "Inst", {
            get: function() {
                return null == this._Inst ? this._Inst = new e : this._Inst
            },
            enumerable: !0,
            configurable: !0
        }),
        e.prototype.OpenConnect = function(e, i, n, a, r) {
            var s = this;
            uiscript.UI_Loading.Inst.show("enter_mj"),
            this.Close(),
            view.AudioMgr.StopMusic(),
            Laya.timer.once(500, this, function() {
                s.url = "",
                s.token = e,
                s.game_uuid = i,
                s.server_location = n,
                GameMgr.Inst.ingame = !0,
                GameMgr.Inst.mj_server_location = n,
                GameMgr.Inst.mj_game_token = e,
                GameMgr.Inst.mj_game_uuid = i,
                s.playerreconnect = a,
                s._setState(t.EConnectState.tryconnect),
                s.load_over = !1,
                s.loaded_player_count = 0,
                s.real_player_count = 0,
                s._fetch_gateway(0)
            })
        }
        ,
        e.prototype.Close = function() {
            this.load_over = !1,
            app.Log.log("MJNetMgr close"),
            this._setState(t.EConnectState.none),
            app.NetAgent.Close2MJ(),
            this.url = ""
        }
        ,
        e.prototype._OnConnent = function(e) {
            app.Log.log("MJNetMgr _OnConnent event:" + e),
            e == Laya.Event.CLOSE || e == Laya.Event.ERROR ? Laya.timer.currTimer - this.lasterrortime > 100 && (this.lasterrortime = Laya.timer.currTimer,
            this.connect_state == t.EConnectState.tryconnect ? this._try_to_linknext() : this.connect_state == t.EConnectState.connecting ? view.DesktopMgr.Inst.active ? (view.DesktopMgr.Inst.duringReconnect = !0,
            this._setState(t.EConnectState.reconnecting),
            this.reconnect_count = 0,
            this._Reconnect()) : (this._setState(t.EConnectState.disconnect),
            uiscript.UIMgr.Inst.ShowErrorInfo(t.Tools.strOfLocalization(2008)),
            t.Scene_MJ.Inst.ForceOut()) : this.connect_state == t.EConnectState.reconnecting && this._Reconnect()) : e == Laya.Event.OPEN && (this.connect_state == t.EConnectState.tryconnect ? (this._setState(t.EConnectState.connecting),
            this._ConnectSuccess()) : this.connect_state == t.EConnectState.reconnecting && (this._setState(t.EConnectState.connecting),
            this._ConnectSuccess()))
        }
        ,
        e.prototype._Reconnect = function() {
            var e = this;
            t.LobbyNetMgr.Inst.connect_state == t.EConnectState.none || t.LobbyNetMgr.Inst.connect_state == t.EConnectState.disconnect ? this._setState(t.EConnectState.disconnect) : t.LobbyNetMgr.Inst.connect_state == t.EConnectState.connecting && GameMgr.Inst.logined ? this.reconnect_count >= this.reconnect_span.length ? this._setState(t.EConnectState.disconnect) : (Laya.timer.once(this.reconnect_span[this.reconnect_count], this, function() {
                e.connect_state == t.EConnectState.reconnecting && (app.Log.log("MJNetMgr reconnect count:" + e.reconnect_count),
                app.NetAgent.connect2MJ(e.url, Laya.Handler.create(e, e._OnConnent, null, !1)))
            }),
            this.reconnect_count++) : Laya.timer.once(1e3, this, this._Reconnect)
        }
        ,
        e.prototype._try_to_linknext = function() {
            this.link_index++,
            this.url = "",
            app.Log.log("mj _try_to_linknext(" + this.link_index + ") url.length=" + this.urls.length),
            this.link_index < 0 || this.link_index >= this.urls.length ? (this._setState(t.EConnectState.none),
            uiscript.UIMgr.Inst.ShowErrorInfo(t.Tools.strOfLocalization(59)),
            this._SendDebugInfo(),
            view.DesktopMgr.Inst && !view.DesktopMgr.Inst.active && t.Scene_MJ.Inst.ForceOut()) : (app.NetAgent.connect2MJ(this.urls[this.link_index].url, Laya.Handler.create(this, this._OnConnent, null, !1)),
            this.url = this.urls[this.link_index].url)
        }
        ,
        e.prototype._fetch_gateway = function(e) {
            var i = this;
            this.urls = [],
            this.link_index = -1,
            app.Log.log("mj _fetch_gateway retry_count:" + e);
            !function(n) {
                var a = new Laya.HttpRequest;
                a.once(Laya.Event.COMPLETE, i, function(n) {
                    !function(n) {
                        var a = JSON.parse(n);
                        if (app.Log.log("mj _fetch_gateway func_success data = " + n),
                        a.maintenance)
                            i._setState(t.EConnectState.none),
                            uiscript.UIMgr.Inst.ShowErrorInfo(t.Tools.strOfLocalization(2009)),
                            view.DesktopMgr.Inst.active || t.Scene_MJ.Inst.ForceOut();
                        else if (a.servers && a.servers.length > 0) {
                            for (var r = a.servers, s = t.Tools.deal_gateway(r), o = 0; o < s.length; o++)
                                i.urls.push({
                                    name: t.LobbyNetMgr.gateway_name + "_" + o,
                                    url: s[o]
                                });
                            i.link_index = -1,
                            i._try_to_linknext()
                        } else
                            e < 1 ? Laya.timer.once(1e3, i, function() {
                                i._fetch_gateway(e + 1)
                            }) : (uiscript.UIMgr.Inst.ShowErrorInfo(t.Tools.strOfLocalization(60)),
                            i._SendDebugInfo(),
                            view.DesktopMgr.Inst && !view.DesktopMgr.Inst.active && t.Scene_MJ.Inst.ForceOut(),
                            i._setState(t.EConnectState.none))
                    }(n)
                }),
                a.once(Laya.Event.ERROR, i, function(n) {
                    app.Log.log("mj _fetch_gateway func_error"),
                    e < 1 ? Laya.timer.once(500, i, function() {
                        i._fetch_gateway(e + 1)
                    }) : (uiscript.UIMgr.Inst.ShowErrorInfo(t.Tools.strOfLocalization(58)),
                    i._SendDebugInfo(),
                    view.DesktopMgr.Inst.active || t.Scene_MJ.Inst.ForceOut(),
                    i._setState(t.EConnectState.none))
                });
                var r = [];
                r.push("If-Modified-Since"),
                r.push("0"),
                n += "?service=ws-game-gateway",
                GameMgr.inHttps ? n += "&protocol=ws&ssl=true" : n += "&protocol=ws&ssl=false",
                n += "&location=" + i.server_location,
                a.send(n, "", "get", "text", r),
                app.Log.log("mj _fetch_gateway func_fetch url = " + n)
            }(t.LobbyNetMgr.gateway_url)
        }
        ,
        e.prototype._setState = function(e) {
            this.connect_state = e,
            GameMgr.inRelease || null != uiscript.UI_Common.Inst && (e == t.EConnectState.none ? uiscript.UI_Common.Inst.label_net_mj.text = "" : e == t.EConnectState.tryconnect ? (uiscript.UI_Common.Inst.label_net_mj.text = "尝试连接麻将服务器",
            uiscript.UI_Common.Inst.label_net_mj.color = "#000000") : e == t.EConnectState.connecting ? (uiscript.UI_Common.Inst.label_net_mj.text = "麻将服务器：正常",
            uiscript.UI_Common.Inst.label_net_mj.color = "#00ff00") : e == t.EConnectState.disconnect ? (uiscript.UI_Common.Inst.label_net_mj.text = "麻将服务器：断开连接",
            uiscript.UI_Common.Inst.label_net_mj.color = "#ff0000",
            uiscript.UI_Disconnect.Inst && uiscript.UI_Disconnect.Inst.show()) : e == t.EConnectState.reconnecting && (uiscript.UI_Common.Inst.label_net_mj.text = "麻将服务器：正在重连",
            uiscript.UI_Common.Inst.label_net_mj.color = "#ff0000",
            uiscript.UI_Disconnect.Inst && uiscript.UI_Disconnect.Inst.show()))
        }
        ,
        e.prototype._ConnectSuccess = function() {
            var e = this;
            app.Log.log("MJNetMgr _ConnectSuccess "),
            this.load_over = !1,
            app.NetAgent.sendReq2MJ("FastTest", "authGame", {
                account_id: GameMgr.Inst.account_id,
                token: this.token,
                game_uuid: this.game_uuid
            }, function(i, n) {
                if (i || n.error)
                    uiscript.UIMgr.Inst.showNetReqError("authGame", i, n),
                    t.Scene_MJ.Inst.GameEnd(),
                    view.AudioMgr.PlayMusic("music/lobby.mp3");
                else {
                    app.Log.log("麻将桌验证通过：" + JSON.stringify(n)),
                    uiscript.UI_Loading.Inst.setProgressVal(.1);
                    var a = [];
                    view.DesktopMgr.player_link_state = n.state_list;
                    var r = t.Tools.strOfLocalization(2003)
                      , s = n.game_config.mode;
                    view.ERuleMode.Liqi4;
                    s.mode < 10 ? (view.ERuleMode.Liqi4,
                    e.real_player_count = 4) : s.mode < 20 && (view.ERuleMode.Liqi3,
                    e.real_player_count = 3);
                    for (h = 0; h < e.real_player_count; h++)
                        a.push(null);
                    s.extendinfo && (r = t.Tools.strOfLocalization(2004)),
                    s.detail_rule && s.detail_rule.ai_level && (1 === s.detail_rule.ai_level && (r = t.Tools.strOfLocalization(2003)),
                    2 === s.detail_rule.ai_level && (r = t.Tools.strOfLocalization(2004)));
                    for (h = 0; h < n.seat_list.length; h++) {
                        var o = n.seat_list[h];
                        if (0 == o)
                            a[h] = {
                                nickname: r,
                                avatar_id: 400101,
                                level: {
                                    id: 10101
                                },
                                character: {
                                    charid: 200001,
                                    level: 0,
                                    exp: 0,
                                    views: [],
                                    skin: 400101,
                                    is_upgraded: !1
                                }
                            };
                        else {
                            0;
                            for (var l = 0; l < n.players.length; l++)
                                if (n.players[l].account_id == o) {
                                    a[h] = n.players[l];
                                    break
                                }
                        }
                    }
                    for (var h = 0; h < e.real_player_count; h++)
                        null == a[h] && (a[h] = {
                            account: 0,
                            nickname: t.Tools.strOfLocalization(2010),
                            avatar_id: 400101,
                            level: {
                                id: 10101
                            },
                            character: {
                                charid: 200001,
                                level: 0,
                                exp: 0,
                                views: [],
                                skin: 400101,
                                is_upgraded: !1
                            }
                        });
                    e.loaded_player_count = n.ready_id_list.length,
                    e._AuthSuccess(a, n.is_game_start, n.game_config.toJSON())
                }
            })
        }
        ,
        e.prototype._AuthSuccess = function(e, i, n) {
            var a = this;
            view.DesktopMgr.Inst && view.DesktopMgr.Inst.active ? (this.load_over = !0,
            Laya.timer.once(500, this, function() {
                app.Log.log("重连信息1 round_id:" + view.DesktopMgr.Inst.round_id + " step:" + view.DesktopMgr.Inst.current_step),
                view.DesktopMgr.Inst.Reset(),
                view.DesktopMgr.Inst.duringReconnect = !0,
                uiscript.UI_Loading.Inst.setProgressVal(.2),
                app.NetAgent.sendReq2MJ("FastTest", "syncGame", {
                    round_id: view.DesktopMgr.Inst.round_id,
                    step: view.DesktopMgr.Inst.current_step
                }, function(e, i) {
                    e || i.error ? (uiscript.UIMgr.Inst.showNetReqError("syncGame", e, i),
                    t.Scene_MJ.Inst.ForceOut()) : (app.Log.log("[syncGame] " + JSON.stringify(i)),
                    i.isEnd ? (uiscript.UIMgr.Inst.ShowErrorInfo(t.Tools.strOfLocalization(2011)),
                    t.Scene_MJ.Inst.GameEnd()) : (uiscript.UI_Loading.Inst.setProgressVal(.3),
                    view.DesktopMgr.Inst.fetchLinks(),
                    view.DesktopMgr.Inst.Reset(),
                    view.DesktopMgr.Inst.duringReconnect = !0,
                    view.DesktopMgr.Inst.syncGameByStep(i.game_restore)))
                })
            })) : t.Scene_MJ.Inst.openMJRoom(e, Laya.Handler.create(this, function() {
                view.DesktopMgr.Inst.initRoom(n, e, GameMgr.Inst.account_id, view.EMJMode.play, Laya.Handler.create(a, function() {
                    i ? Laya.timer.frameOnce(10, a, function() {
                        app.Log.log("重连信息2 round_id:-1 step:" + 1e6),
                        view.DesktopMgr.Inst.Reset(),
                        view.DesktopMgr.Inst.duringReconnect = !0,
                        app.NetAgent.sendReq2MJ("FastTest", "syncGame", {
                            round_id: "-1",
                            step: 1e6
                        }, function(e, i) {
                            app.Log.log("syncGame " + JSON.stringify(i)),
                            e || i.error ? (uiscript.UIMgr.Inst.showNetReqError("syncGame", e, i),
                            t.Scene_MJ.Inst.ForceOut()) : (uiscript.UI_Loading.Inst.setProgressVal(1),
                            view.DesktopMgr.Inst.fetchLinks(),
                            a._PlayerReconnectSuccess(i))
                        })
                    }) : Laya.timer.frameOnce(10, a, function() {
                        app.Log.log("send enterGame"),
                        view.DesktopMgr.Inst.Reset(),
                        view.DesktopMgr.Inst.duringReconnect = !0,
                        app.NetAgent.sendReq2MJ("FastTest", "enterGame", {}, function(e, i) {
                            e || i.error ? (uiscript.UIMgr.Inst.showNetReqError("enterGame", e, i),
                            t.Scene_MJ.Inst.ForceOut()) : (uiscript.UI_Loading.Inst.setProgressVal(1),
                            app.Log.log("enterGame"),
                            a._EnterGame(i),
                            view.DesktopMgr.Inst.fetchLinks())
                        })
                    })
                }))
            }), Laya.Handler.create(this, function(t) {
                return uiscript.UI_Loading.Inst.setProgressVal(.1 + .8 * t)
            }, null, !1))
        }
        ,
        e.prototype._EnterGame = function(e) {
            app.Log.log("正常进入游戏: " + JSON.stringify(e)),
            e.is_end ? (uiscript.UIMgr.Inst.ShowErrorInfo(t.Tools.strOfLocalization(2011)),
            t.Scene_MJ.Inst.GameEnd()) : e.game_restore ? view.DesktopMgr.Inst.syncGameByStep(e.game_restore) : (console.log("正常进入游戏：" + Laya.Stat.currentMemorySize / 1024 / 1024 + " MB"),
            this.load_over = !0,
            this.load_over && uiscript.UI_Loading.Inst.enable && uiscript.UI_Loading.Inst.showLoadCount(this.loaded_player_count, this.real_player_count),
            view.DesktopMgr.Inst.duringReconnect = !1,
            view.DesktopMgr.Inst.StartChainAction(0))
        }
        ,
        e.prototype._PlayerReconnectSuccess = function(e) {
            app.Log.log("_PlayerReconnectSuccess data:" + JSON.stringify(e)),
            e.isEnd ? (uiscript.UIMgr.Inst.ShowErrorInfo(t.Tools.strOfLocalization(2011)),
            t.Scene_MJ.Inst.GameEnd()) : e.game_restore ? view.DesktopMgr.Inst.syncGameByStep(e.game_restore) : (uiscript.UIMgr.Inst.ShowErrorInfo(t.Tools.strOfLocalization(2012)),
            t.Scene_MJ.Inst.ForceOut())
        }
        ,
        e.prototype._SendDebugInfo = function() {
            var t = {};
            t.type = "未连接了!!!!!!",
            t.logs = app.Log.getCacheLog(),
            GameMgr.Inst.postInfo2Server(t)
        }
        ,
        e._Inst = null,
        e
    }();
    t.MJNetMgr = e
}(game || (game = {}));
var game;
!function(t) {
    var e = function() {
        function e() {}
        return e.setItem = function(e, i) {
            var n = t.Tools.eeesss("e__" + e);
            Laya.LocalStorage.setItem(e, "FKU!!!"),
            Laya.LocalStorage.setItem(n, t.Tools.eeesss(i))
        }
        ,
        e.getItem = function(e) {
            var i = t.Tools.eeesss("e__" + e)
              , n = Laya.LocalStorage.getItem(e);
            return null != n && "FKU!!!" != n ? (Laya.LocalStorage.setItem(e, "FKU!!!"),
            Laya.LocalStorage.setItem(i, t.Tools.eeesss(n)),
            n) : (null != (n = Laya.LocalStorage.getItem(i)) && (n = t.Tools.dddsss(n)),
            n)
        }
        ,
        e
    }();
    t.LocalStorage = e
}(game || (game = {}));
var game;
!function(t) {
    var e;
    !function(t) {
        t[t.none = 0] = "none",
        t[t.tryconnect = 1] = "tryconnect",
        t[t.connecting = 2] = "connecting",
        t[t.reconnecting = 3] = "reconnecting",
        t[t.disconnect = 4] = "disconnect"
    }(e = t.EConnectState || (t.EConnectState = {}));
    var i = function() {
        function i() {
            this.urls = [],
            this.link_index = -1,
            this.servername = "",
            this.connect_state = e.none,
            this.open_func = null,
            this.reconnect_count = 0,
            this.reconnect_span = [500, 1e3, 3e3, 6e3, 1e4, 15e3],
            this.lasterrortime = 0,
            this.inMaintenance = !1,
            this.maintenanceInfo = "",
            this._connect_listeners = []
        }
        return Object.defineProperty(i, "Inst", {
            get: function() {
                return null == this._Inst ? this._Inst = new i : this._Inst
            },
            enumerable: !0,
            configurable: !0
        }),
        Object.defineProperty(i.prototype, "isOK", {
            get: function() {
                return this.connect_state == e.connecting
            },
            enumerable: !0,
            configurable: !0
        }),
        i.prototype.OpenConnect = function(t, n) {
            var a = this;
            if (app.Log.log("LobbyNetMgr OpenConnect"),
            this.inMaintenance)
                n && n.runWith({
                    open: !1,
                    maintenance: this.maintenanceInfo
                });
            else if (this.connect_state != e.connecting || t != i.gateway_region_name && "" != t) {
                if (i.gateway_region_name = t,
                "" == (i.gateway_region_name = "mainland")) {
                    var r = Laya.LocalStorage.getItem("gateway_region");
                    r && "" != r || (r = GameMgr.ClientRegion),
                    i.gateway_region_name = r
                }
                i.gateway_regions[i.gateway_region_name] || (i.gateway_region_name = "mainland"),
                this.open_func = null,
                this.urls.length = 0,
                app.Log.info_net("LobbyNetMgr OpenConnect 2 close: " + this.connect_state),
                this.Close(),
                this.connect_state = e.none,
                this.open_func = n,
                Laya.timer.once(500, this, function() {
                    a._setState(e.tryconnect),
                    a._fetch_gateway()
                })
            } else
                n && n.runWith({
                    open: !0
                })
        }
        ,
        i.prototype.Close = function() {
            app.Log.log("LobbyNetMgr close "),
            app.Log.info_net("LobbyNetMgr Close connect_state:" + this.connect_state),
            GameMgr.Inst.logined = !1,
            this.open_func = null,
            this._setState(e.none),
            app.NetAgent.Close2Lobby()
        }
        ,
        i.prototype._OnConnent = function(i) {
            app.Log.log("LobbyNetMgr _OnConnent event:" + i),
            i == Laya.Event.CLOSE || i == Laya.Event.ERROR ? Laya.timer.currTimer - this.lasterrortime > 100 && (this.lasterrortime = Laya.timer.currTimer,
            this.connect_state == e.tryconnect ? this._try_to_linknext() : this.connect_state == e.connecting ? GameMgr.Inst.logined ? (GameMgr.Inst.logined = !1,
            this._setState(e.reconnecting),
            this.reconnect_count = 0,
            this._fetch_gateway(),
            this._trigger_connect_msg("reconnect")) : (this._setState(e.none),
            this.open_func && this.open_func.runWith({
                open: !1,
                info: t.Tools.strOfLocalization(11) + " tyr"
            }),
            this.open_func = null) : this.connect_state == e.reconnecting && this._try_to_linknext()) : i == Laya.Event.OPEN && (this.connect_state == e.tryconnect ? (this._setState(e.connecting),
            this.open_func && this.open_func.runWith({
                open: !0
            }),
            this.open_func = null) : this.connect_state == e.reconnecting && (this._setState(e.connecting),
            this._ReconnectSuccess()))
        }
        ,
        i.prototype._Reconnect = function() {
            var t = this;
            this.reconnect_count >= this.reconnect_span.length ? (app.Log.log("Lobby重连失败"),
            this._setState(e.disconnect)) : (Laya.timer.once(this.reconnect_span[this.reconnect_count], this, function() {
                t.connect_state == e.reconnecting && (app.Log.log("LobbyNetMgr _Reconnect  count:" + t.reconnect_count),
                t._fetch_gateway())
            }),
            this.reconnect_count++)
        }
        ,
        i.prototype._ReconnectSuccess = function() {
            var e = this
              , i = {};
            Laya.Browser.window.conch ? i.device_type = "app" : (Laya.Browser.onPC && (i.device_type = "pc"),
            Laya.Browser.onIPad && (i.device_type = "ipad"),
            Laya.Browser.onMobile && (i.device_type = "mobile")),
            Laya.Browser.onMac && (i.os = "mac"),
            Laya.Browser.onIOS && (i.os = "ios"),
            (Laya.Browser.onAndriod || Laya.Browser.onAndroid) && (i.os = "android"),
            Laya.Browser.onWeiXin && (i.browser = "weixin"),
            Laya.Browser.onSafari && (i.browser = "safari"),
            Laya.Browser.onFirefox && (i.browser = "firefox"),
            Laya.Browser.onEdge && (i.browser = "edge"),
            Laya.Browser.onMiniGame && (i.browser = "minigame");
            var n = [];
            GameMgr.inGooglePlay && n.push(1),
            GameMgr.inChina && n.push(2),
            -1 == GameMgr.Inst.sociotype ? app.NetAgent.sendReq2Lobby("Lobby", "login", {
                account: GameMgr.Inst.account,
                password: GameMgr.encodeP(GameMgr.Inst.password),
                reconnect: !0,
                device: i,
                random_key: GameMgr.device_id,
                client_version: t.ResourceVersion.version,
                currency_platforms: n
            }, function(e, i) {
                e || i.error ? uiscript.UIMgr.Inst.ShowErrorInfo(t.Tools.strOfLocalization(2007)) : (app.Log.log("LobbyNetMgr 重连成功"),
                GameMgr.Inst.logined = !0)
            }) : app.NetAgent.sendReq2Lobby("Lobby", "oauth2Login", {
                type: GameMgr.Inst.sociotype,
                access_token: GameMgr.Inst.access_token,
                reconnect: !0,
                device: i,
                random_key: GameMgr.device_id,
                client_version: t.ResourceVersion.version,
                currency_platforms: n
            }, function(i, n) {
                i || n.error ? uiscript.UIMgr.Inst.ShowErrorInfo(t.Tools.strOfLocalization(2007)) : (app.Log.log("LobbyNetMgr 重连成功"),
                GameMgr.Inst.logined = !0,
                e._trigger_connect_msg("reconnect_success"))
            })
        }
        ,
        i.prototype._setState = function(t) {
            this.connect_state = t,
            t == e.disconnect ? uiscript.UI_Disconnect.Inst && uiscript.UI_Disconnect.Inst.show() : t == e.reconnecting && uiscript.UI_Disconnect.Inst && uiscript.UI_Disconnect.Inst.show(),
            this.refreshCommonShow()
        }
        ,
        i.prototype.refreshCommonShow = function() {
            GameMgr.inRelease || null != uiscript.UI_Common.Inst && uiscript.UI_Common.Inst.label_net_lobby && (this.connect_state == e.none ? (uiscript.UI_Common.Inst.label_net_lobby.text = "未连接:" + this.servername,
            uiscript.UI_Common.Inst.label_net_lobby.color = "#ffffff") : this.connect_state == e.tryconnect ? (uiscript.UI_Common.Inst.label_net_lobby.text = "尝试连接:" + this.servername,
            uiscript.UI_Common.Inst.label_net_lobby.color = "#ffffff") : this.connect_state == e.connecting ? (uiscript.UI_Common.Inst.label_net_lobby.text = "大厅服务器:" + this.servername,
            uiscript.UI_Common.Inst.label_net_lobby.color = "#00ff00") : this.connect_state == e.disconnect ? (uiscript.UI_Common.Inst.label_net_lobby.text = "大厅服务器:" + this.servername + " 断开连接",
            uiscript.UI_Common.Inst.label_net_lobby.color = "#ff0000") : this.connect_state == e.reconnecting && (uiscript.UI_Common.Inst.label_net_lobby.text = "大厅服务器:" + this.servername + " 正在重连",
            uiscript.UI_Common.Inst.label_net_lobby.color = "#ff0000"))
        }
        ,
        i.prototype._fetch_gateway = function() {
            var n = this;
            app.Log.log("_fetch_gateway begin"),
            this.urls = [],
            this.link_index = -1;
            i.gateway_url = "",
            i.gateway_regions[i.gateway_region_name] && (i.gateway_url = i.gateway_regions[i.gateway_region_name]),
            app.Log.log(i.gateway_url + " " + i.gateway_region_name + " " + JSON.stringify(i.gateway_regions)),
            function(a) {
                var r = new Laya.HttpRequest;
                r.once(Laya.Event.COMPLETE, n, function(a) {
                    !function(a) {
                        app.Log.log("_fetch_gateway return:" + a);
                        var r = JSON.parse(a);
                        if (r.maintenance)
                            n.connect_state == e.tryconnect ? (n.inMaintenance = !0,
                            n.maintenanceInfo = r.maintenance.message,
                            n.open_func && n.open_func.runWith({
                                open: !1,
                                maintenance: n.maintenanceInfo
                            }),
                            n.open_func = null,
                            n._setState(e.none)) : n.connect_state == e.reconnecting && n._setState(e.disconnect);
                        else if (r.servers && r.servers.length > 0) {
                            for (var s = r.servers, o = t.Tools.deal_gateway(s), l = 0; l < o.length; l++)
                                n.urls.push({
                                    name: i.gateway_name + "_" + l,
                                    url: o[l]
                                });
                            n.link_index = -1,
                            n._try_to_linknext()
                        } else
                            n.open_func && n.open_func.runWith({
                                open: !1,
                                info: t.Tools.strOfLocalization(62)
                            }),
                            n.open_func = null,
                            n.connect_state == e.tryconnect ? n._setState(e.none) : n._setState(e.disconnect)
                    }(a)
                }),
                r.once(Laya.Event.ERROR, n, function(i) {
                    n.connect_state == e.tryconnect ? (n.open_func && n.open_func.runWith({
                        open: !1,
                        info: t.Tools.strOfLocalization(61)
                    }),
                    n.open_func = null,
                    n._setState(e.none)) : n.connect_state == e.reconnecting && n._Reconnect()
                });
                var s = [];
                s.push("If-Modified-Since"),
                s.push("0"),
                a += "?service=ws-gateway",
                GameMgr.inHttps ? a += "&protocol=ws&ssl=true" : a += "&protocol=ws&ssl=false",
                r.send(a, "", "get", "text", s)
            }(i.gateway_url)
        }
        ,
        i.prototype._try_to_linknext = function() {
            this.link_index++,
            this.link_index < 0 || this.link_index >= this.urls.length ? this.connect_state == e.tryconnect ? (this._setState(e.none),
            this.open_func && this.open_func.runWith({
                open: !1,
                info: t.Tools.strOfLocalization(11)
            }),
            this.open_func = null) : this.connect_state == e.reconnecting && this._Reconnect() : (this.servername = i.gateway_name,
            app.NetAgent.connect2Lobby(this.urls[this.link_index].url, Laya.Handler.create(this, this._OnConnent, null, !1)))
        }
        ,
        i.prototype.add_connect_listener = function(t) {
            this._connect_listeners.push(t)
        }
        ,
        i.prototype._trigger_connect_msg = function(t) {
            app.Log.info_net("触发重连");
            for (var e = 0; e < this._connect_listeners.length; e++)
                this._connect_listeners[e].runWith(t)
        }
        ,
        i.gateway_name = "",
        i.gateway_regions = null,
        i.gateway_region_name = "",
        i.gateway_url = "",
        i._Inst = null,
        i
    }();
    t.LobbyNetMgr = i
}(game || (game = {}));
var game;
!function(t) {
    var e;
    !function(t) {
        t[t.common = 0] = "common",
        t[t.scene_mj = 1] = "scene_mj",
        t[t.lobby = 2] = "lobby",
        t[t.ui_mj = 3] = "ui_mj",
        t[t.entrance = 4] = "entrance"
    }(e = t.E_LoadType || (t.E_LoadType = {}));
    var i = function() {
        function i() {}
        return i.loadConfig = function() {
            var t = this;
            Laya.loader.load("resconfig.json", Laya.Handler.create(this, function() {
                t._res_config = Laya.loader.getRes("resconfig.json")
            }))
        }
        ,
        i.getUrls = function(i) {
            var n = []
              , a = "res/atlas/";
            return "chs" != GameMgr.client_language && (a += GameMgr.client_language + "/"),
            i == e.entrance ? (n = [a + "myres/entrance.atlas", a + "myres/necessary.atlas"],
            "jp" == GameMgr.client_language ? n.push("scene/entrance_jp.ls") : "en" == GameMgr.client_language ? n.push("scene/entrance_en.ls") : n.push("scene/entrance.ls")) : i == e.common ? n = [a + "myres.atlas", a + "myres/bothui.atlas"] : i == e.scene_mj ? ("en" == GameMgr.client_language ? n.push("scene/mjdesktop_en.ls") : n.push("scene/mjdesktop.ls"),
            n.push("scene/mjhandpai.ls")) : i == e.lobby ? ((n = [a + "myres/room.atlas", a + "myres/shop.atlas", a + "myres/sushe.atlas", a + "myres/lobby.atlas", a + "myres/match_lobby.atlas", a + "myres/treasure.atlas"]).push(t.FrontEffect.scene_path),
            n.push(t.FrontEffect.scene2_path)) : i == e.ui_mj && (n = [a + "myres/mjdesktop.atlas", a + "myres/mjdesktop/shengduan.atlas"]),
            n
        }
        ,
        i._createItem = function(t) {
            function e(t) {
                if (h -= t,
                l >= o.length) {
                    if (h <= 0) {
                        r.loaded = !0,
                        r.precent = 1;
                        for (var e = 0; e < r.complete.length; e++)
                            r.complete[e] && r.complete[e].run()
                    }
                } else
                    n()
            }
            function i(e) {
                r.precent = (e * o.length + s.length) / t.length;
                for (var i = 0; i < r.progress.length; i++)
                    r.progress[i] && r.progress[i].runWith(r.precent)
            }
            function n() {
                if (o.length > 0) {
                    for (var t = []; h < 1e3 && l < o.length; )
                        t.push(o[l++]),
                        h++;
                    Laya.loader.create(t, Laya.Handler.create(this, e, [t.length], !1), Laya.Handler.create(this, i, null, !1))
                } else
                    e(1e5)
            }
            function a() {
                r.precent = s.length / t.length,
                n()
            }
            for (var r = {
                loaded: !1,
                precent: 0,
                urls: t,
                complete: [],
                progress: []
            }, s = [], o = [], l = 0, h = 0, c = 0; c < t.length; c++) {
                var u = t[c];
                ".ls" == u.substr(u.length - 3) ? s.push(u) : o.push(u)
            }
            return s.length > 0 ? Laya.loader.create(s, Laya.Handler.create(this, a), Laya.Handler.create(this, function(e) {
                r.precent = (e * o.length + s.length) / t.length;
                for (var i = 0; i < r.progress.length; i++)
                    r.progress[i] && r.progress[i].runWith(r.precent)
            })) : a(),
            r
        }
        ,
        i.loadRes = function(t, e, i) {
            for (var n = t; this._items.length <= n; )
                this._items.push(null);
            null == this._items[n] && (this._items[n] = this._createItem(this.getUrls(t))),
            this._items[n].loaded ? e && e.run() : (e && this._items[n].complete.push(e),
            i && (i.once = !1,
            this._items[n].progress.push(i)))
        }
        ,
        i.createResImage_web = function(e) {
            var i = this;
            if (!this._resimage.hasOwnProperty(e)) {
                var n = ""
                  , a = e.substr(e.length - 3);
                n = a.toLocaleLowerCase();
                var r = {
                    loaded: !1,
                    origin_url: e,
                    blob_url: null,
                    complete: [],
                    success: !1
                };
                this._resimage[e] = r;
                var s = new Laya.HttpRequest;
                s.once(Laya.Event.COMPLETE, this, function(t) {
                    for (var e = new Laya.Byte(t), a = new Laya.Byte, s = 0; s < e.length; s++)
                        GameMgr.inRelease ? a.writeByte(73 ^ e.readByte()) : a.writeByte(e.readByte());
                    var o = new Laya.Browser.window.Blob([a.buffer],{
                        type: "image/" + n
                    })
                      , l = Laya.Browser.window.URL.createObjectURL(o);
                    Laya.loader.load(l, Laya.Handler.create(i, function(t) {
                        r.blob_url = t,
                        r.loaded = !0,
                        r.success = !0;
                        for (var e = 0; e < r.complete.length; e++)
                            r.complete && r.complete[e].run();
                        r.complete = []
                    }, [l]), null, Laya.Loader.IMAGE)
                }),
                s.once(Laya.Event.ERROR, this, function(t) {
                    console.log("加载" + e + "失败"),
                    r.loaded = !0,
                    r.success = !1;
                    for (var i = 0; i < r.complete.length; i++)
                        r.complete[i] && r.complete[i].run();
                    r.complete = []
                }),
                s.send(t.ResourceVersion.formatURL(e), "", "get", "arraybuffer")
            }
        }
        ,
        i.createResImage_conch = function(t) {
            if (!this._resimage.hasOwnProperty(t)) {
                var e = {
                    loaded: !1,
                    origin_url: t,
                    blob_url: null,
                    complete: [],
                    success: !1
                };
                this._resimage[t] = e,
                Laya.loader.load(t, Laya.Handler.create(this, function() {
                    e.blob_url = t,
                    e.loaded = !0,
                    e.success = !0;
                    for (var i = 0; i < e.complete.length; i++)
                        e.complete && e.complete[i].run();
                    e.complete = []
                }), null, Laya.Loader.IMAGE)
            }
        }
        ,
        i.loadResImage = function(e, i, n) {
            var a = this;
            if (!e && 0 == e.length)
                return n && n.runWith(1),
                void (i && i.run());
            for (var r = 0, s = 0, o = 0, l = 0; l < e.length; l++)
                e[l] = t.Tools.localUISrc(e[l]);
            var h = function() {
                for (o = 0; o < 5 && s < e.length; ) {
                    var t = e[s++];
                    a._resimage.hasOwnProperty(t) || (GameMgr.inConch ? a.createResImage_conch(t) : a.createResImage_web(t));
                    var i = a._resimage[t];
                    i.loaded ? c(!1) : (o++,
                    i.complete.push(Laya.Handler.create(a, c, [!0])))
                }
            }
              , c = function(t) {
                t && 0 == --o && s < e.length && h(),
                ++r == e.length ? (n && n.runWith(1),
                i && i.run()) : n && n.runWith(r / e.length)
            };
            h()
        }
        ,
        i.getResImage = function(e) {
            if (e = t.Tools.localUISrc(e),
            !this._resimage.hasOwnProperty(e))
                return null;
            var i = this._resimage[e];
            return i.loaded && i.success ? Laya.loader.getRes(i.blob_url) : null
        }
        ,
        i.getResImageSkin = function(e) {
            if (e = t.Tools.localUISrc(e),
            !this._resimage.hasOwnProperty(e))
                return "";
            if (!this._resimage[e].loaded)
                return "";
            return this._resimage[e].blob_url
        }
        ,
        i.getItemSkin = function(e) {
            var i = t.GameUtility.get_item_view(e);
            return this.getResImageSkin(i.icon)
        }
        ,
        i.disposeSceneRes = function(t) {
            if (null != this._res_config)
                if (this._res_config.hasOwnProperty(t)) {
                    var e = this._res_config[t];
                    if (e.hasOwnProperty("atlas"))
                        for (var i = 0; i < e.atlas.length; i++)
                            Laya.Loader.clearTextureRes(e.atlas[i])
                } else
                    app.Log.Error("disposeSceneRes错误，场景不存在");
            else
                app.Log.Error("disposeSceneRes错误，未找到配置")
        }
        ,
        i.httpload = function(e, i, n, a) {
            var r = new Laya.HttpRequest;
            r.once(Laya.Event.COMPLETE, this, function(t) {
                a && ("json" == i ? a.runWith({
                    success: !0,
                    data: JSON.parse(t)
                }) : a.runWith({
                    success: !0,
                    data: t
                }))
            }),
            r.once(Laya.Event.ERROR, this, function(t) {
                console.log("httpload加载" + e + "失败"),
                a && a.runWith({
                    success: !1
                })
            });
            var s = t.ResourceVersion.formatURL(e)
              , o = [];
            n && (o.push("If-Modified-Since"),
            o.push("0"),
            s += "?randv=" + Math.floor(1e8 * Math.random()).toString() + Math.floor(1e8 * Math.random()).toString());
            var l = "text";
            switch (i) {
            case "json":
                l = "text";
                break;
            case "arraybuffer":
                l = "arraybuffer"
            }
            r.send(s, "", "get", l, o)
        }
        ,
        i.setImgSkin = function(e, i) {
            var n = this;
            if (i.indexOf("extendRes") >= 0) {
                "" != (a = this.getResImageSkin(i)) && null != a ? (e.skin = a,
                this.clearImgSkin(e)) : (e.skin = "",
                this.clearImgSkin(e),
                this._waiting_load_img_skins.push({
                    img: e,
                    src: i
                }),
                this.loadResImage([i], Laya.Handler.create(this, function() {
                    for (var t = 0; t < n._waiting_load_img_skins.length; t++)
                        if (n._waiting_load_img_skins[t].img === e && n._waiting_load_img_skins[t].src == i) {
                            e.skin = n.getResImageSkin(i),
                            n._waiting_load_img_skins[t] = n._waiting_load_img_skins[n._waiting_load_img_skins.length - 1],
                            n._waiting_load_img_skins.pop();
                            break
                        }
                })))
            } else {
                i = t.Tools.localUISrc(i);
                var a = Laya.loader.getRes(i);
                a ? (e.skin = i,
                this.clearImgSkin(e)) : (e.skin = "",
                this.clearImgSkin(e),
                this._waiting_load_img_skins.push({
                    img: e,
                    src: i
                }),
                Laya.loader.load(i, Laya.Handler.create(this, function() {
                    for (var t = 0; t < n._waiting_load_img_skins.length; t++)
                        if (n._waiting_load_img_skins[t].img === e && n._waiting_load_img_skins[t].src == i) {
                            e.skin = i,
                            n._waiting_load_img_skins[t] = n._waiting_load_img_skins[n._waiting_load_img_skins.length - 1],
                            n._waiting_load_img_skins.pop();
                            break
                        }
                })))
            }
        }
        ,
        i.clearImgSkin = function(t) {
            for (var e = 0; e < this._waiting_load_img_skins.length; e++)
                if (this._waiting_load_img_skins[e].img === t) {
                    this._waiting_load_img_skins[e] = this._waiting_load_img_skins[this._waiting_load_img_skins.length - 1],
                    this._waiting_load_img_skins.pop();
                    break
                }
        }
        ,
        i._items = [],
        i._resimage = {},
        i._res_config = null,
        i._waiting_load_img_skins = [],
        i
    }();
    t.LoadMgr = i
}(game || (game = {}));
var game;
!function(t) {
    t.stardust_id = 302004;
    var e;
    !function(t) {
        t[t.desktop = 1] = "desktop",
        t[t.mjp = 2] = "mjp"
    }(e = t.ECommonView || (t.ECommonView = {}));
    !function(t) {
        t[t.liqibang = 1] = "liqibang",
        t[t.hupai_effect = 2] = "hupai_effect",
        t[t.liqi_effect = 3] = "liqi_effect",
        t[t.hand_model = 4] = "hand_model",
        t[t.liqi_bgm = 5] = "liqi_bgm"
    }(t.EPlayerView || (t.EPlayerView = {}));
    var i;
    !function(t) {
        t[t.none = 0] = "none",
        t[t.currency = 1] = "currency",
        t[t.character = 2] = "character",
        t[t.item = 3] = "item",
        t[t.skin = 4] = "skin",
        t[t.title = 5] = "title"
    }(i = t.EIDType || (t.EIDType = {}));
    !function(t) {
        t[t.user_xieyi = 1] = "user_xieyi"
    }(t.EAccountSetKey || (t.EAccountSetKey = {}));
    var n = function() {
        function t() {}
        return t.get_common_view_id = function(t) {
            var e = t.toString();
            return GameMgr.Inst.commonview_slot.hasOwnProperty(e) ? GameMgr.Inst.commonview_slot[e] : 0
        }
        ,
        t.get_common_view_res_name = function(t) {
            var i = cfg.item_definition.view.get(this.get_common_view_id(t));
            if (i)
                return t == e.mjp && view.DesktopMgr.en_mjp ? i.res_name + "_0" : i.res_name;
            switch (t) {
            case e.desktop:
                return "tablecloth_default";
            case e.mjp:
                return view.DesktopMgr.en_mjp ? "mjp_default_0" : "mjp_default"
            }
            return "default"
        }
        ,
        t.get_id_type = function(t) {
            var e = Math.floor(t / 1e4);
            return 10 == e ? i.currency : 20 == e ? i.character : 30 == e ? i.item : 40 == e ? i.skin : 60 == e ? i.title : i.none
        }
        ,
        t.get_item_view = function(t) {
            var e = ""
              , n = ""
              , a = "";
            switch (this.get_id_type(t)) {
            case i.currency:
                var r = cfg.item_definition.currency.get(t);
                r && (e = r["name_" + GameMgr.client_language],
                n = r.icon,
                a = "");
                break;
            case i.character:
                var s = cfg.item_definition.character.get(t);
                s && (e = s["name_" + GameMgr.client_language],
                n = cfg.item_definition.skin.get(s.init_skin).path + "/bighead.png",
                a = "");
                break;
            case i.item:
                var o = cfg.item_definition.item.get(t);
                o && (e = o["name_" + GameMgr.client_language],
                n = o.icon,
                a = o["desc_" + GameMgr.client_language]);
                break;
            case i.skin:
                var l = cfg.item_definition.skin.get(t);
                l && (e = l["name_" + GameMgr.client_language],
                n = l.path + "/bighead.png",
                a = l["desc_" + GameMgr.client_language]);
                break;
            case i.title:
                var h = cfg.item_definition.title.get(t);
                h && (e = h["name_" + GameMgr.client_language],
                n = h.icon,
                a = h["desc_" + GameMgr.client_language])
            }
            return {
                name: e,
                icon: n,
                desc: a
            }
        }
        ,
        t.item_owned = function(t) {
            var e = this.get_id_type(t);
            if (e == i.character) {
                if (a = uiscript.UI_Sushe.characters)
                    for (r = 0; r < a.length; r++)
                        if (a[r] && a[r].charid == t)
                            return !0
            } else if (e == i.item) {
                var n = cfg.item_definition.item.get(t);
                if (n && (4 == n.category || 5 == n.category)) {
                    if (uiscript.UI_Bag.get_item_count(t) > 0)
                        return !0
                }
            } else {
                if (e == i.skin)
                    return uiscript.UI_Sushe.skin_owned(t);
                if (e == i.title) {
                    var a = uiscript.UI_TitleBook.owned_title;
                    if (a)
                        for (var r = 0; r < a.length; r++)
                            if (a[r] == t)
                                return !0
                }
            }
            return !1
        }
        ,
        t
    }();
    t.GameUtility = n
}(game || (game = {}));
var game;
!function(t) {
    var e = function() {
        function e(i, n, a, r, s) {
            void 0 === s && (s = !1),
            this.destoryed = !1,
            this.target = i,
            this.destoryed = !1,
            this.pos_offset = a,
            this.scale = r,
            this.effect = new t.EffectBase(n,s),
            e.effects.push(this),
            this._update()
        }
        return e.regist = function(t) {
            e.effects.push(t)
        }
        ,
        e.update = function() {
            for (var t = 0, e = 0; e < this.effects.length; e++)
                this.effects[e].destoryed || (this.effects[e]._update(),
                this.effects[t++] = this.effects[e]);
            for (e = this.effects.length - t; e >= 0; e--)
                this.effects.pop()
        }
        ,
        e.prototype._update = function() {
            if (!this.destoryed && this.target) {
                var t = uiscript.UIMgr.Inst.getWorldPosition(this.target, new Laya.Point(0,0));
                t.x = t.x - .5,
                t.y = .5 - t.y,
                this.effect && this.effect.root && (this.effect.root.transform.localPosition = new Laya.Vector3(t.x * i.scene_width,t.y * i.scene_height,0),
                0 != this.scale ? this.effect.root.transform.localScale = new Laya.Vector3(this.target.scaleX * this.scale,this.target.scaleY * this.scale,1) : this.effect.root.transform.localScale = new Laya.Vector3(1,1,1))
            }
        }
        ,
        e.prototype.destory = function() {
            this.destoryed || (this.destoryed = !0,
            this.effect.destory())
        }
        ,
        e.effects = [],
        e
    }();
    t.UIEffect = e;
    var i = function() {
        function i() {
            this._scene = null,
            this._root = null,
            this._scene2 = null,
            this._root2 = null,
            this._container_effect = null,
            this._effect_click = null,
            this._effects = {}
        }
        return Object.defineProperty(i.prototype, "root", {
            get: function() {
                return this._root
            },
            enumerable: !0,
            configurable: !0
        }),
        Object.defineProperty(i.prototype, "root2", {
            get: function() {
                return this._root2
            },
            enumerable: !0,
            configurable: !0
        }),
        i.init = function() {
            (i.Inst = new i)._scene = Laya.loader.getRes(i.scene_path),
            GameMgr.Inst.root_front_effect.addChild(i.Inst._scene),
            i.Inst._root = i.Inst._scene.getChildByName("root"),
            i.Inst._container_effect = i.Inst._scene.getChildByName("container_effect"),
            i.Inst._effect_click = i.Inst._container_effect.getChildByName("effect_click"),
            i.Inst._scene.visible = !0,
            Laya.stage.on(Laya.Event.MOUSE_DOWN, i.Inst, i.Inst.bangClickEffect),
            this.Inst._scene2 = Laya.loader.getRes(i.scene2_path),
            this.Inst._root2 = this.Inst._scene2.getChildByName("root"),
            GameMgr.Inst.root_front_scene_effect.addChild(this.Inst._scene2),
            this.Inst._scene2.visible = !0,
            Laya.timer.frameLoop(1, this, function() {
                e.update()
            })
        }
        ,
        i.prototype.bangClickEffect = function() {
            var e = Laya.MouseManager.instance.mouseX
              , n = Laya.MouseManager.instance.mouseY;
            (!t.Scene_MJ.Inst.active || uiscript.UI_GameEnd.Inst && uiscript.UI_GameEnd.Inst.enable) && view.AudioMgr.PlayAudio(103);
            var a = 0
              , r = 0;
            Laya.Browser.width / 1920 < Laya.Browser.height / 1080 ? r = (Laya.Browser.height - Laya.Browser.width / 1920 * 1080) / 2 : a = (Laya.Browser.width - Laya.Browser.height / 1080 * 1920) / 2;
            var s = e / (Laya.Browser.width - 2 * a) * i.scene_width - i.scene_width / 2
              , o = i.scene_height - n / (Laya.Browser.height - 2 * r) * i.scene_height - i.scene_height / 2
              , l = this._effect_click.clone();
            this._root.addChild(l),
            l.active = !1,
            l.active = !0,
            l.transform.localPosition = new Laya.Vector3(s,o,1),
            Laya.timer.once(1500, this, function() {
                l.destroy(!0)
            })
        }
        ,
        i.prototype.create_ui_effect = function(t, i, n, a, r) {
            void 0 === r && (r = !1);
            var s = new e(t,i,n,a,r);
            return this._root2.addChild(s.effect.root),
            s
        }
        ,
        i.Inst = null,
        i.scene_path = "scene/front_effect.ls",
        i.scene2_path = "scene/front_scene_effect.ls",
        i.scene_width = 32,
        i.scene_height = 18,
        i
    }();
    t.FrontEffect = i
}(game || (game = {}));
var game;
!function(t) {
    !function(t) {
        t[t.none = 0] = "none",
        t[t.room_invite = 1] = "room_invite"
    }(t.EFriendMsgType || (t.EFriendMsgType = {}));
    var e = function() {
        function t() {}
        return t.init = function() {
            var t = this;
            this._friend_list = [],
            app.NetAgent.sendReq2Lobby("Lobby", "fetchFriendList", {}, function(e, i) {
                if (e)
                    app.Log.log("获取好友列表时发生错误:" + e);
                else if (i.error)
                    app.Log.log("获取好友列表时发生错误，错误码：" + i.error.code);
                else {
                    if (app.Log.log(JSON.stringify(i)),
                    i.friends)
                        for (var n = 0; n < i.friends.length; n++) {
                            var a = i.friends[n];
                            t._friend_list.push(a)
                        }
                    t.friend_max_count = i.friend_max_count
                }
            }),
            this._friendapply_list = [],
            app.NetAgent.sendReq2Lobby("Lobby", "fetchFriendApplyList", {}, function(e, i) {
                if (e || i.error)
                    app.Log.log("获取好友申请列表发生错误");
                else if (app.Log.log(JSON.stringify(i)),
                i.applies)
                    for (var n = 0; n < i.applies.length; n++)
                        t._friendapply_list.push(i.applies[n])
            }),
            app.NetAgent.AddListener2Lobby("NotifyFriendViewChange", Laya.Handler.create(this, this._onFriendViewChange, null, !1)),
            app.NetAgent.AddListener2Lobby("NotifyFriendStateChange", Laya.Handler.create(this, this._onFriendStateChange, null, !1)),
            app.NetAgent.AddListener2Lobby("NotifyFriendChange", Laya.Handler.create(this, this._onFriendChange, null, !1)),
            app.NetAgent.AddListener2Lobby("NotifyNewFriendApply", Laya.Handler.create(this, this._onFriendApplyChange, null, !1))
        }
        ,
        Object.defineProperty(t, "friend_list", {
            get: function() {
                return this._friend_list
            },
            enumerable: !0,
            configurable: !0
        }),
        Object.defineProperty(t, "friendapply_list", {
            get: function() {
                return this._friendapply_list
            },
            enumerable: !0,
            configurable: !0
        }),
        t.find = function(t) {
            for (var e = 0; e < this._friend_list.length; e++)
                if (this._friend_list[e].base.account_id == t)
                    return this._friend_list[e];
            return null
        }
        ,
        t._onFriendStateChange = function(t) {
            app.Log.log(JSON.stringify(t));
            var e = this.find(t.target_id);
            null != e ? (t = t.active_state) && (null != t.login_time && void 0 != t.login_time && (e.state.login_time = t.login_time),
            null != t.logout_time && void 0 != t.logout_time && (e.state.logout_time = t.logout_time),
            e.state.playing = t.playing,
            null != t.is_online && void 0 != t.is_online && (e.state.is_online = t.is_online),
            this.triggerMsg({
                type: "singlechange",
                account_id: e.base.account_id
            })) : app.Log.Error("收到并非好友的人的信息:" + JSON.stringify(t))
        }
        ,
        t._onFriendViewChange = function(t) {
            var e = this.find(t.target_id);
            null != e ? (null != t.base.avatar_id && void 0 != t.base.avatar_id && (e.base.avatar_id = t.base.avatar_id),
            null != t.base.title && void 0 != t.base.title && (e.base.title = t.base.title),
            null != t.base.nickname && void 0 != t.base.nickname && (e.base.nickname = t.base.nickname),
            null != t.base.level && void 0 != t.base.level && (e.base.level = t.base.level),
            this.triggerMsg({
                type: "singlechange",
                account_id: e.base.account_id
            })) : app.Log.Error("收到并非好友的人的信息:" + JSON.stringify(t))
        }
        ,
        t.addListener = function(t) {
            this.removeListener(t),
            this._listener.push(t)
        }
        ,
        t.removeListener = function(t) {
            for (var e = 0; e < this._listener.length; e++)
                if (this._listener[e] === t) {
                    this._listener[e] = this._listener[this._listener.length - 1],
                    this._listener.pop();
                    break
                }
        }
        ,
        t.triggerMsg = function(t) {
            for (var e = 0; e < this._listener.length; e++)
                this._listener[e] && this._listener[e].runWith(t)
        }
        ,
        t.removeFriend = function(t) {
            for (var e = 0; e < this._friend_list.length; e++)
                if (this._friend_list[e].base.account_id == t) {
                    for (var i = e; i < this._friend_list.length - 1; i++)
                        this._friend_list[i] = this._friend_list[i + 1];
                    this._friend_list.pop();
                    break
                }
        }
        ,
        t._onFriendChange = function(t) {
            var e = t.account_id;
            1 == t.type ? this.find(e) || this.friend_list.push(t.friend) : 2 == t.type && this.removeFriend(e),
            this.triggerMsg({
                type: "listchange"
            })
        }
        ,
        t._onFriendApplyChange = function(t) {
            for (e = 0; e < this._friendapply_list.length; e++)
                if (this._friendapply_list[e].account_id == t.account_id)
                    return void (this._friendapply_list[e].apply_time = t.apply_time);
            if (this._friendapply_list.push({
                account_id: t.account_id,
                apply_time: t.apply_time
            }),
            t.removed_id)
                for (var e = 0; e < this._friendapply_list.length; e++)
                    if (this._friendapply_list[e].account_id == t.removed_id) {
                        for (var i = 0; i < this._friendapply_list.length - 1; i++)
                            this._friendapply_list[i] = this._friendapply_list[i + 1];
                        this._friendapply_list.pop();
                        break
                    }
        }
        ,
        t.delFriendApply = function(t) {
            for (var e = 0; e < this._friendapply_list.length; e++)
                if (this._friendapply_list[e].account_id == t) {
                    for (var i = e; i < this._friendapply_list.length - 1; i++)
                        this._friendapply_list[i] = this._friendapply_list[i + 1];
                    this._friendapply_list.pop();
                    break
                }
        }
        ,
        t._friend_list = [],
        t._listener = [],
        t._friendapply_list = [],
        t.friend_max_count = 0,
        t
    }();
    t.FriendMgr = e
}(game || (game = {}));
var game;
!function(t) {
    var e = function() {
        function t(e, n) {
            var a = this;
            this.id = 0,
            this._loaded = !1,
            this._destoryed = !1,
            this._root = null,
            this.id = t.IDcount++,
            this.url = e,
            this._loaded = !1,
            this._destoryed = !1,
            this._root = new Laya.Sprite3D,
            this._root.active = !0,
            this._root.on("undisplay", this, function() {
                a._root.destroyed && (a._destoryed || a.destory())
            });
            Laya.timer.currTimer;
            i.try2get_effect(e, Laya.Handler.create(this, function() {
                if (null == a._root || a._root.destroyed || a._destoryed)
                    ;
                else {
                    a._loaded = !0;
                    var t = Laya.loader.getRes(e);
                    t && t instanceof Laya.Sprite3D && (n && (t = t.clone()),
                    a._root.addChild(t),
                    t.transform.localPosition = new Laya.Vector3(0,0,0),
                    t.active = !0)
                }
            }))
        }
        return Object.defineProperty(t.prototype, "loaded", {
            get: function() {
                return this._loaded
            },
            enumerable: !0,
            configurable: !0
        }),
        Object.defineProperty(t.prototype, "destoryed", {
            get: function() {
                return this._destoryed
            },
            enumerable: !0,
            configurable: !0
        }),
        Object.defineProperty(t.prototype, "root", {
            get: function() {
                return this._root
            },
            enumerable: !0,
            configurable: !0
        }),
        t.prototype.destory = function() {
            this._destoryed || (this._destoryed = !0,
            this._root && !this._root.destroyed && this._root.destroy(!0),
            this._loaded && (this._destoryed = !0),
            i.on_effectbase_destory(this.url))
        }
        ,
        t.IDcount = 0,
        t
    }();
    t.EffectBase = e;
    var i = function() {
        function t() {}
        return t.init = function(t) {
            var e = this;
            Laya.loader.load("d3_prefab.json", Laya.Handler.create(this, function() {
                e.d3res_map = Laya.loader.getRes("d3_prefab.json"),
                t && t.run()
            }))
        }
        ,
        t.try2get_effect = function(t, e) {
            var i = this;
            this._preload_effects_count.hasOwnProperty(t) && this._preload_effects_count[t] > 0 ? (this._effect_status.hasOwnProperty(t) || (this._effect_status[t] = {
                status: 0,
                count: 0,
                listeners: []
            }),
            this._effect_status[t].count++,
            0 == this._effect_status[t].status ? (this._effect_status[t].listeners.push(e),
            this._effect_status[t].status = 1,
            Laya.loader.create(t, Laya.Handler.create(this, function() {
                i._effect_status[t].status = 2;
                for (var e = 0; e < i._effect_status[t].listeners.length; e++)
                    i._effect_status[t].listeners[e].run();
                i._effect_status[t].listeners = []
            }), null, null, [], 0)) : 1 == this._effect_status[t].status ? this._effect_status[t].listeners.push(e) : e.run()) : app.Log.Error("EffectMgr " + t + "使用前并未预热")
        }
        ,
        t.on_effectbase_destory = function(t) {
            if (this._effect_status.hasOwnProperty(t) && (this._effect_status[t].count--,
            this._effect_status[t].count <= 0)) {
                var e = Laya.loader.getRes(t);
                e && e.destroy(!0),
                this._effect_status[t].count = 0,
                this._effect_status[t].status = 0
            }
        }
        ,
        t.force_dispose_3d_res = function(t) {
            for (var e = this.d3res_map[t], i = 0; i < e.length; i++) {
                var n = Laya.loader.getRes(e[i]);
                n && n.dispose()
            }
        }
        ,
        t.preheat_3d_effect = function(t, e, i, n, a) {
            for (var r = [], s = 0; s < t.length; s++) {
                var o = t[s];
                if (this._preload_effects_count.hasOwnProperty(o) || (this._preload_effects_count[o] = 0),
                0 == this._preload_effects_count[o] && (r.push(o),
                this.d3res_map.hasOwnProperty(o)))
                    for (var l = this.d3res_map[o], h = 0; h < l.length; h++) {
                        var c = l[h];
                        this._res_count.hasOwnProperty(c) ? this._res_count[c]++ : this._res_count[c] = 1
                    }
                this._preload_effects_count[o]++
            }
            this._prehead_3d_effect(r, e, i, n, a)
        }
        ,
        t._prehead_3d_effect = function(t, e, i, n, a) {
            var r = this;
            if (0 == t.length)
                return a.runWith(1),
                void n.run();
            var s = 0
              , o = i ? 5 : 2;
            a.runWith(0);
            var l = function() {
                if (s >= t.length)
                    return a.runWith(1),
                    void n.run();
                a.runWith(s / t.length);
                for (var h = [], c = 0; c < o && s < t.length; c++)
                    h.push(t[s++]);
                for (var u = "", c = 0; c < h.length; c++)
                    0 != c && (u += ","),
                    u += h[c];
                app.Log.log("preheart_list:" + u),
                Laya.loader.create(h, Laya.Handler.create(r, function() {
                    Laya.timer.frameOnce(1, r, function() {
                        for (var t = function(t) {
                            var n = h[t].url
                              , a = Laya.loader.getRes(n);
                            if (a)
                                e.addChild(a),
                                a.transform.position = i ? new Laya.Vector3(1e4,1e4,1e4) : new Laya.Vector3(0,0,0),
                                a.active = !0,
                                Laya.timer.frameOnce(6, r, function() {
                                    var t = Laya.loader.getRes(n);
                                    t && t.destroy(!0)
                                });
                            else {
                                var s = {};
                                s.error = "preheart effect url:" + n + " =null",
                                s.stack = "",
                                s.method = "_prehead_3d_effect",
                                s.name = "_prehead_3d_effect",
                                GameMgr.Inst.onFatalError(s, !1)
                            }
                        }, n = 0; n < h.length; n++)
                            t(n);
                        Laya.timer.frameOnce(10, r, function() {
                            l()
                        })
                    })
                }))
            };
            l()
        }
        ,
        t.dispose_3d_effect = function(t) {
            for (var e = 0; e < t.length; e++) {
                var i = t[e];
                if (app.Log.log("dispose_3d_effect:" + i),
                this._preload_effects_count.hasOwnProperty(i) && this._preload_effects_count[i] > 0) {
                    if (this._preload_effects_count[i]--,
                    0 == this._preload_effects_count[i]) {
                        if (this.d3res_map.hasOwnProperty(i))
                            for (var n = this.d3res_map[i], a = 0; a < n.length; a++) {
                                var r = n[a];
                                if (this._res_count.hasOwnProperty(r) && this._res_count[r] > 0) {
                                    if (this._res_count[r]--,
                                    0 == this._res_count[r]) {
                                        var s = Laya.loader.getRes(r);
                                        s && (s.clearTexture ? s.clearTexture() : s.dispose())
                                    }
                                } else
                                    app.Log.Error("资源释放过多次1：" + i)
                            }
                        var o = Laya.loader.getRes(i);
                        o && o.destroy(!0)
                    }
                } else
                    app.Log.Error("资源释放过多次0：" + i)
            }
        }
        ,
        t.create_d3_effect = function(t, i) {
            void 0 === i && (i = !1);
            return new e(t,i).root
        }
        ,
        t.d3res_map = null,
        t._ui_effects = [],
        t._preload_effects_count = {},
        t._res_count = {},
        t._effect_status = {},
        t
    }();
    t.EffectMgr = i
}(game || (game = {}));
var mjcore;
!function(t) {
    var e;
    !function(t) {
        t[t.p = 0] = "p",
        t[t.m = 1] = "m",
        t[t.s = 2] = "s",
        t[t.z = 3] = "z"
    }(e = t.E_MJPai || (t.E_MJPai = {}));
    var i = function() {
        function t() {}
        return t.prototype.IsZ = function() {
            return this.type == e.z
        }
        ,
        t.prototype.IsLaoTou = function() {
            return this.type != e.z && (1 == this.index || 9 == this.index)
        }
        ,
        t.prototype.IsYao = function() {
            return this.IsZ() || this.IsLaoTou()
        }
        ,
        t.prototype.IsSiXi = function() {
            return this.IsZ() && this.index >= 1 && this.index <= 4
        }
        ,
        t.prototype.IsSanYan = function() {
            return this.IsZ() && this.index >= 5 && this.index <= 7
        }
        ,
        t.prototype.Clone = function() {
            var e = new t;
            return e.type = this.type,
            e.index = this.index,
            e.dora = this.dora,
            e
        }
        ,
        t.prototype.numValue = function() {
            var t = 0;
            switch (this.type) {
            case e.m:
                t = this.index;
                break;
            case e.p:
                t = 1e4 + this.index;
                break;
            case e.s:
                t = 2e4 + this.index;
                break;
            case e.z:
                t = 3e4 + 10 * this.index
            }
            return t
        }
        ,
        t.Create = function(i) {
            var n = new t;
            switch ("0" == i.charAt(0) ? (n.dora = !0,
            n.index = 5) : (n.dora = !1,
            n.index = +i.charAt(0)),
            i.charAt(1)) {
            case "z":
                n.type = e.z;
                break;
            case "m":
                n.type = e.m;
                break;
            case "s":
                n.type = e.s;
                break;
            case "p":
                n.type = e.p
            }
            return n
        }
        ,
        t.RandomCreate = function() {
            var i = new t
              , n = Math.random();
            return n < .22 ? (i.type = e.z,
            i.index = Math.floor(7 * Math.random()) + 1) : (i.type = n < .48 ? e.p : n < .74 ? e.s : e.m,
            i.index = Math.floor(9 * Math.random()) + 1),
            i
        }
        ,
        t.isSame = function(t, e) {
            return t.type == e.type && t.index == e.index && t.dora == e.dora
        }
        ,
        t.Distance = function(t, e) {
            return t.numValue() - e.numValue()
        }
        ,
        t.DoraMet = function(t, i) {
            if (t.type != i.type)
                return !1;
            var n = i.index + 1;
            return view.DesktopMgr.Inst.rule_mode == view.ERuleMode.Liqi4 ? i.type == e.z ? i.index <= 4 ? 5 == n && (n = 1) : 8 == n && (n = 5) : 10 == n && (n = 1) : view.DesktopMgr.Inst.rule_mode == view.ERuleMode.Liqi3 && (i.type == e.z ? i.index <= 4 ? 5 == n && (n = 1) : 8 == n && (n = 5) : i.type == e.s || i.type == e.p ? 10 == n && (n = 1) : (10 == n && (n = 1),
            2 == n && (n = 9))),
            n == t.index
        }
        ,
        t.prototype.toString = function() {
            var t = this.dora ? "0" : this.index.toString();
            switch (this.type) {
            case e.m:
                t += "m";
                break;
            case e.p:
                t += "p";
                break;
            case e.s:
                t += "s";
                break;
            default:
                t += "z"
            }
            return t
        }
        ,
        t
    }();
    t.MJPai = i;
    var n = function() {
        return function() {}
    }();
    t.MJQiPai = n;
    var a;
    !function(t) {
        t[t.shunzi = 0] = "shunzi",
        t[t.kezi = 1] = "kezi",
        t[t.gang_ming = 2] = "gang_ming",
        t[t.gang_an = 3] = "gang_an",
        t[t.babei = 4] = "babei"
    }(a = t.E_Ming || (t.E_Ming = {}));
    var r = function() {
        function t() {
            this.pais = [],
            this.from = []
        }
        return t.prototype.Clone = function() {
            var e = new t;
            e.type = this.type,
            e.pais = [];
            for (i = 0; i < this.pais.length; i++)
                e.pais.push(this.pais[i].Clone());
            e.from = [];
            for (var i = 0; i < this.from.length; i++)
                e.from.push(this.from[i]);
            return e
        }
        ,
        t.prototype.toString = function() {
            var t = "";
            switch (this.type) {
            case a.shunzi:
                t += "shunzi(";
                break;
            case a.kezi:
                t += "kezi(";
                break;
            case a.gang_ming:
                t += "minggang(";
                break;
            case a.gang_an:
                t += "angang(";
                break;
            case a.babei:
                t += "babei("
            }
            for (var e = 0; e < this.pais.length; e++)
                0 != e && (t += ","),
                t += this.pais[e].toString();
            return t += ")"
        }
        ,
        t
    }();
    t.MJMing = r;
    !function(t) {
        t[t.none = 0] = "none",
        t[t.dapai = 1] = "dapai",
        t[t.eat = 2] = "eat",
        t[t.peng = 3] = "peng",
        t[t.an_gang = 4] = "an_gang",
        t[t.ming_gang = 5] = "ming_gang",
        t[t.add_gang = 6] = "add_gang",
        t[t.liqi = 7] = "liqi",
        t[t.zimo = 8] = "zimo",
        t[t.rong = 9] = "rong",
        t[t.jiuzhongjiupai = 10] = "jiuzhongjiupai",
        t[t.babei = 11] = "babei"
    }(t.E_PlayOperation || (t.E_PlayOperation = {}));
    !function(t) {
        t[t.none = 0] = "none",
        t[t.jiuzhongjiupai = 1] = "jiuzhongjiupai",
        t[t.sifenglianda = 2] = "sifenglianda",
        t[t.sigangsanle = 3] = "sigangsanle",
        t[t.sijializhi = 4] = "sijializhi",
        t[t.sanjiahule = 5] = "sanjiahule"
    }(t.E_LiuJu || (t.E_LiuJu = {}));
    !function(t) {
        t[t.liuju = 0] = "liuju",
        t[t.shaoji = 1] = "shaoji",
        t[t.zimo = 2] = "zimo",
        t[t.rong = 3] = "rong",
        t[t.fangchong = 4] = "fangchong",
        t[t.beizimo = 5] = "beizimo"
    }(t.E_Round_Result || (t.E_Round_Result = {}));
    !function(t) {
        t[t.E_Dadian_Title_none = 0] = "E_Dadian_Title_none",
        t[t.E_Dadian_Title_manguan = 1] = "E_Dadian_Title_manguan",
        t[t.E_Dadian_Title_tiaoman = 2] = "E_Dadian_Title_tiaoman",
        t[t.E_Dadian_Title_beiman = 3] = "E_Dadian_Title_beiman",
        t[t.E_Dadian_Title_sanbeiman = 4] = "E_Dadian_Title_sanbeiman",
        t[t.E_Dadian_Title_yiman = 5] = "E_Dadian_Title_yiman",
        t[t.E_Dadian_Title_yiman2 = 6] = "E_Dadian_Title_yiman2",
        t[t.E_Dadian_Title_yiman3 = 7] = "E_Dadian_Title_yiman3",
        t[t.E_Dadian_Title_yiman4 = 8] = "E_Dadian_Title_yiman4",
        t[t.E_Dadian_Title_yiman5 = 9] = "E_Dadian_Title_yiman5",
        t[t.E_Dadian_Title_yiman6 = 10] = "E_Dadian_Title_yiman6",
        t[t.E_Dadian_Title_leijiyiman = 11] = "E_Dadian_Title_leijiyiman"
    }(t.E_Dadian_Title || (t.E_Dadian_Title = {}))
}(mjcore || (mjcore = {}));
var game;
!function(t) {
    var e = function() {
        function t() {}
        return t.prototype.recover_pre_order = function(t) {
            return !1
        }
        ,
        t.prototype.getGoodsInfo = function(t) {
            return null
        }
        ,
        t.prototype.onGameStart = function() {}
        ,
        t.prototype.want2BuyItem = function(t, e) {}
        ,
        t
    }();
    t.AppShop = e
}(game || (game = {}));
var app;
!function(t) {
    var e = function() {
        function t() {}
        return t._init = function() {
            if (null == this._tmpCookie) {
                this._tmpCookie = {};
                for (var t = document.cookie.split(";"), e = 0; e < t.length; e++) {
                    var i = t[e].split("=");
                    if (i && i.length >= 2) {
                        for (var n = i[0]; " " == n.charAt(0); )
                            n = n.substring(1);
                        this._tmpCookie[n] = i[1]
                    }
                }
            }
        }
        ,
        t.setCookie = function(t, e) {
            this._init();
            new Date;
            document.cookie = t + "=" + e + ";max-age=" + 2592e3.toString(),
            this._tmpCookie[t] = e
        }
        ,
        t.getCookie = function(t) {
            return this._init(),
            this._tmpCookie.hasOwnProperty(t) ? this._tmpCookie[t] : ""
        }
        ,
        t._tmpCookie = null,
        t
    }();
    t.CookieMgr = e
}(app || (app = {}));
var lqc;
!function(t) {
    function e(t, e) {
        var i = new Error(e);
        throw i.code = t,
        i
    }
    var i = function() {
        function t(t, e, i, n) {
            var a = this;
            this.table_ = t,
            this.sheet_ = e,
            this.rows_ = i || [],
            this.map_ = {},
            this.minKey_ = null,
            this.maxKey_ = null,
            i.sort(function(t, e) {
                return t[n] - e[n]
            }),
            i.length > 0 && (this.minKey_ = i[0][n],
            this.maxKey_ = i[i.length - 1][n]),
            i.forEach(function(t) {
                var e = t[n];
                a.map_[e] = t
            })
        }
        return t.prototype.get = function(t) {
            return this.map_[t]
        }
        ,
        t.prototype.find = function(t) {
            return this.map_[t] || e("ERR_CONFIG_ROW_NOT_FIND", "[unique] " + this.table_ + "." + this.sheet_ + "#" + t),
            this.map_[t]
        }
        ,
        t.prototype.forEach = function(t) {
            this.rows_.forEach(t)
        }
        ,
        Object.defineProperty(t.prototype, "table", {
            get: function() {
                return this.table_
            },
            enumerable: !0,
            configurable: !0
        }),
        Object.defineProperty(t.prototype, "sheet", {
            get: function() {
                return this.sheet_
            },
            enumerable: !0,
            configurable: !0
        }),
        Object.defineProperty(t.prototype, "count", {
            get: function() {
                return this.rows_.length
            },
            enumerable: !0,
            configurable: !0
        }),
        Object.defineProperty(t.prototype, "minKey", {
            get: function() {
                return this.minKey_
            },
            enumerable: !0,
            configurable: !0
        }),
        Object.defineProperty(t.prototype, "maxKey", {
            get: function() {
                return this.maxKey_
            },
            enumerable: !0,
            configurable: !0
        }),
        t
    }();
    t.UniqueSheet = i;
    var n = function() {
        function t(t, e, i) {
            this.table_ = t,
            this.sheet_ = e,
            this.rows_ = i || []
        }
        return t.prototype.forEach = function(t) {
            this.rows_.forEach(t)
        }
        ,
        Object.defineProperty(t.prototype, "table", {
            get: function() {
                return this.table_
            },
            enumerable: !0,
            configurable: !0
        }),
        Object.defineProperty(t.prototype, "sheet", {
            get: function() {
                return this.sheet_
            },
            enumerable: !0,
            configurable: !0
        }),
        Object.defineProperty(t.prototype, "count", {
            get: function() {
                return this.rows_.length
            },
            enumerable: !0,
            configurable: !0
        }),
        t
    }();
    t.NoKeySheet = n;
    var a = function() {
        function t(t, e, i, n) {
            var a = this;
            this.table_ = t,
            this.sheet_ = e,
            this.rows_ = i || [],
            this.groups_ = {},
            this.rows_.forEach(function(t) {
                var e = t[n];
                a.groups_[e] || (a.groups_[e] = []);
                a.groups_[e].push(t)
            })
        }
        return t.prototype.getGroup = function(t) {
            return this.groups_[t]
        }
        ,
        t.prototype.findGroup = function(t) {
            return this.groups_[t] || e("ERR_CONFIG_ROW_NOT_FIND", "[unique] " + this.table_ + "." + this.sheet_ + "#" + t),
            this.groups_[t]
        }
        ,
        t.prototype.forEach = function(t) {
            this.rows_.forEach(t)
        }
        ,
        t.prototype.forEachGroup = function(t) {
            var e = this;
            Object.keys(this.groups_).forEach(function(i) {
                t(e.groups_[i], i)
            })
        }
        ,
        Object.defineProperty(t.prototype, "table", {
            get: function() {
                return this.table_
            },
            enumerable: !0,
            configurable: !0
        }),
        Object.defineProperty(t.prototype, "sheet", {
            get: function() {
                return this.sheet_
            },
            enumerable: !0,
            configurable: !0
        }),
        Object.defineProperty(t.prototype, "count", {
            get: function() {
                return this.rows_.length
            },
            enumerable: !0,
            configurable: !0
        }),
        t
    }();
    t.GroupSheet = a;
    var r = function() {
        function t(t) {
            this.value_ = t,
            this.ref_ = null
        }
        return t.prototype.resolve = function(t) {
            this.ref_ = t
        }
        ,
        Object.defineProperty(t.prototype, "value", {
            get: function() {
                return this.value_
            },
            enumerable: !0,
            configurable: !0
        }),
        Object.defineProperty(t.prototype, "ref", {
            get: function() {
                return this.ref_
            },
            enumerable: !0,
            configurable: !0
        }),
        t
    }();
    t.ReferenceField = r
}(lqc || (lqc = {}));
var cfg = function() {
    function t() {}
    return t.load = function(t) {
        var e = this
          , i = {};
        t.forEach(function(t) {
            i[t.table] || (i[t.table] = {});
            var e = [];
            t.rows.forEach(function(i) {
                var n = {};
                t.header.forEach(function(t) {
                    n[t.field_name] = i[t.field_name]
                }),
                e.push(n)
            });
            var n = null;
            switch (t.meta.category) {
            case "unique":
                n = new lqc.UniqueSheet(t.table,t.sheet,e,t.meta.key);
                break;
            case "nokey":
                n = new lqc.NoKeySheet(t.table,t.sheet,e);
                break;
            case "group":
                n = new lqc.GroupSheet(t.table,t.sheet,e,t.meta.key);
                break;
            case "kv":
                n = {},
                e.forEach(function(e) {
                    var i = e[t.meta.key];
                    n[i] = e
                })
            }
            n && (i[t.table][t.sheet] = n)
        }),
        Object.keys(i).forEach(function(t) {
            e[t] = i[t]
        })
    }
    ,
    t
}(), bin;
!function(t) {
    var e = function() {
        function t() {}
        return t.prototype.mini_info = function() {
            return {
                table: this.table,
                sheet: this.sheet,
                meta: this.meta,
                fields: this.fields.map(function(t) {
                    return {
                        field_name: t.field_name,
                        pb_type: t.pb_type,
                        array_length: t.array_length
                    }
                }),
                kvs: this.kvs
            }
        }
        ,
        t
    }()
      , i = function() {
        return function(t) {
            this.name = t,
            this.sheets = []
        }
    }()
      , n = function() {
        return function(t) {
            this.name = t,
            this.sheets = {}
        }
    }()
      , a = function() {
        function t() {
            this.root = new protobuf.Root,
            this.schemas = [],
            this.datas = []
        }
        return t.pb_classname = function(t, e) {
            return t + "_" + e
        }
        ,
        t.prototype.parseSync = function(a, r) {
            this.root = protobuf.parse(a, {
                keepCase: !0
            }).root;
            for (var s = this.root.lookupType("lq.config.ConfigTables").decode(r), o = s.schemas, l = {}, h = 0, c = o; h < c.length; h++)
                for (var u = (O = c[h]).name, _ = 0, d = O.sheets; _ < d.length; _++) {
                    I = (F = d[_]).name;
                    l[S = t.pb_classname(u, I)] = F;
                    for (var f = new protobuf.Type(S), p = 0, m = F.fields; p < m.length; p++) {
                        var g = m[p]
                          , y = g.array_length > 0 ? "repeated" : "optional"
                          , v = new protobuf.Field(g.field_name,g.pb_index,g.pb_type,y);
                        f.add(v)
                    }
                    this.root.add(f)
                }
            for (var b = {}, x = 0, w = s.datas; x < w.length; x++) {
                var C = w[x]
                  , u = C.table
                  , I = C.sheet
                  , S = t.pb_classname(u, I);
                if (f = this.root.lookupType(S)) {
                    if (l[S]) {
                        b[S] || (b[S] = []);
                        for (var T = 0, M = C.data; T < M.length; T++) {
                            var E = M[T];
                            b[S].push(f.decode(E))
                        }
                    }
                }
            }
            for (var L = 0, D = o; L < D.length; L++) {
                var u = (O = D[L]).name
                  , A = new i(u);
                this.schemas.push(A);
                for (var N = function(i) {
                    var n = i.name
                      , a = t.pb_classname(u, n)
                      , r = new e;
                    if (r.table = u,
                    r.sheet = n,
                    r.meta = i.meta,
                    r.fields = i.fields.map(function(t) {
                        return {
                            field_name: t.field_name,
                            array_length: t.array_length,
                            pb_type: t.pb_type,
                            comment: null
                        }
                    }),
                    "kv" === r.meta.category) {
                        var s = b[a];
                        s && (r.kvs = s.map(function(t) {
                            return t[r.meta.key]
                        }))
                    }
                    A.sheets.push(r)
                }, R = 0, B = O.sheets; R < B.length; R++) {
                    N(F = B[R])
                }
            }
            for (var k = 0, P = o; k < P.length; k++) {
                var O = P[k]
                  , u = O.name
                  , A = new n(u);
                this.datas.push(A);
                for (var U = 0, V = O.sheets; U < V.length; U++) {
                    var F = V[U]
                      , I = F.name
                      , S = t.pb_classname(u, I);
                    A[I] = b[S]
                }
            }
        }
        ,
        t.prototype.exportSchema = function() {
            return this.schemas
        }
        ,
        t.prototype.exportData = function() {
            return this.datas
        }
        ,
        t
    }();
    t.BinParser = a;
    var r = function() {
        function t(t, e) {
            var i = this;
            this.schema = {},
            this.data = {},
            t.forEach(function(t) {
                i.schema[t.name] = t
            }),
            e.forEach(function(t) {
                i.data[t.name] = t
            })
        }
        return t.prototype.toFormat = function() {
            var t = this
              , e = [];
            return Object.keys(this.schema).forEach(function(i) {
                var n = t.schema[i]
                  , a = t.data[i];
                a && n.sheets.forEach(function(t) {
                    var i = {};
                    i.table = t.table,
                    i.sheet = t.sheet,
                    i.meta = t.meta,
                    i.header = t.fields.map(function(t) {
                        return {
                            field_name: t.field_name,
                            array_length: t.array_length,
                            pb_type: t.pb_type
                        }
                    }),
                    i.rows = a[t.sheet],
                    e.push(i)
                })
            }),
            e
        }
        ,
        t
    }();
    t.TSDataFormat = r
}(bin || (bin = {}));
var capsui;
!function(t) {
    var e = function() {
        function t() {
            this._data = null,
            this._me = null,
            this.active = !1
        }
        return Object.defineProperty(t.prototype, "me", {
            get: function() {
                return this._me
            },
            enumerable: !0,
            configurable: !0
        }),
        Object.defineProperty(t.prototype, "owner", {
            set: function(t) {
                this._me = t
            },
            enumerable: !0,
            configurable: !0
        }),
        Object.defineProperty(t.prototype, "copydata", {
            set: function(t) {
                this._data = t
            },
            enumerable: !0,
            configurable: !0
        }),
        t.prototype.getNodeClone = function() {
            var t = Laya.View.createComp(this._data);
            return this.me.parent.addChild(t),
            t
        }
        ,
        t
    }();
    t.UICopy = e
}(capsui || (capsui = {}));
var capsui;
!function(t) {
    var e = function() {
        function t() {}
        return t._dfs_idmap = function(t, e, i) {
            if (e.compId && (i[e.compId] = t),
            e.child)
                for (var n = 0; n < e.child.length; n++) {
                    var a = e.child[n];
                    if (a.props && a.props.name) {
                        var r = t.getChildByName(a.props.name);
                        r && this._dfs_idmap(r, a, i)
                    }
                }
        }
        ,
        t.createFrameAnimation = function(t, e, i, n) {
            var a = e;
            if (!a.animations || 0 == a.animations.length)
                return null;
            var r = null;
            if ("" == n)
                r = a.animations[0];
            else
                for (c = 0; c < a.animations.length; c++)
                    if (a.animations[c].name == n) {
                        r = a.animations[c];
                        break
                    }
            if (null == r)
                return null;
            var s = {}
              , o = e;
            if ("" != i)
                for (var l = i.split("/"), h = 0; h < l.length; h++) {
                    if (!o.child)
                        return null;
                    for (var c = 0; c < o.child.length; c++) {
                        var u = o.child[c];
                        u.props && u.props.name && u.props.name == l[h] && (o = u)
                    }
                }
            this._dfs_idmap(t, o, s);
            var _ = new Laya.FrameAnimation;
            return _._setUp(s, r),
            _.stop(),
            _
        }
        ,
        t
    }();
    t.UIAnim = e
}(capsui || (capsui = {}));
var capsui;
!function(t) {
    var e = function() {
        function t(t, e) {
            var i = this;
            this.me = t,
            this.render_page = e,
            this.btn_left = this.me.getChildByName("btn_left");
            this.btn_left.clickHandler = Laya.Handler.create(this, function() {
                i.change_page(i.current_index - 1, !1)
            }, null, !1),
            this.btn_right = this.me.getChildByName("btn_right"),
            this.btn_right.clickHandler = Laya.Handler.create(this, function() {
                i.change_page(i.current_index + 1, !1)
            }, null, !1),
            this.label_current_page = this.me.getChildByName("curr_page"),
            this.btn_page = this.me.getChildByName("btn_page"),
            this.btn_page.clickHandler = Laya.Handler.create(this, function() {
                i.page_show_locking || i._show_page_choose()
            }, null, !1),
            this.container_pages = this.me.getChildByName("container_pages"),
            this.container_pages.getChildByName("close").clickHandler = Laya.Handler.create(this, function() {
                i.page_show_locking || i._close_page_choose()
            }, null, !1),
            this.scroll_pages = this.container_pages.getChildByName("bg").scriptMap["capsui.CScrollView"],
            this.scroll_pages.init_scrollview(Laya.Handler.create(this, this._render_page_choose_item, null, !1))
        }
        return t.prototype.reset = function() {
            this.me.visible = !1,
            this.container_pages.visible = !1,
            this.scroll_pages.reset(),
            this.btn_left.visible = !1,
            this.btn_right.visible = !1,
            this.btn_page.visible = !1,
            this.page_show_locking = !1,
            this.current_index = -1,
            this.label_current_page.text = ""
        }
        ,
        t.prototype.set_total_page_count = function(t) {
            this.total_count = t,
            this.me.visible = this.total_count > 0,
            this.btn_page.visible = this.total_count > 1,
            this.btn_left.visible = this.current_index > 0,
            this.btn_right.visible = this.current_index + 1 < this.total_count,
            this.change_page(this.current_index, !1)
        }
        ,
        t.prototype.change_page = function(t, e) {
            t >= this.total_count && (t = this.total_count - 1),
            t < 0 && (t = 0),
            (e || this.current_index != t) && (this.current_index = t,
            this.btn_left.visible = this.current_index > 0,
            this.btn_right.visible = this.current_index + 1 < this.total_count,
            this.label_current_page.text = (this.current_index + 1).toString(),
            this.render_page && this.render_page.runWith(t))
        }
        ,
        t.prototype._show_page_choose = function() {
            var t = this;
            if (this.total_count <= 1)
                this.page_show_locking = !1;
            else {
                this.container_pages.visible = !0,
                this.scroll_pages.reset(),
                this.scroll_pages.addItem(this.total_count);
                var e = this.container_pages.getChildByName("bg")
                  , i = e.getChildByName("content");
                this.total_count <= 3 ? (i.height = 54 * this.total_count,
                e.height = i.height,
                e.y = this.container_pages.height - e.height) : (i.height = this.container_pages.height,
                e.height = i.height,
                e.y = 0),
                e.alpha = 0,
                Laya.Tween.to(e, {
                    alpha: 1
                }, 150),
                Laya.timer.once(150, this, function() {
                    t.page_show_locking = !1
                })
            }
        }
        ,
        t.prototype._close_page_choose = function() {
            var t = this
              , e = this.container_pages.getChildByName("bg");
            Laya.Tween.to(e, {
                alpha: 0
            }, 150),
            this.page_show_locking = !0,
            Laya.timer.once(150, this, function() {
                t.page_show_locking = !1,
                t.container_pages.visible = !1
            })
        }
        ,
        t.prototype._render_page_choose_item = function(t) {
            var e = this
              , i = t.index
              , n = t.container;
            n.getChildByName("btn").clickHandler = Laya.Handler.create(this, function() {
                e.page_show_locking || (e.change_page(i, !1),
                e._close_page_choose())
            }, null, !1),
            n.getChildByName("page").text = (i + 1).toString()
        }
        ,
        t
    }();
    t.PageController = e
}(capsui || (capsui = {}));
var capsui;
!function(t) {
    var e = function() {
        function t() {
            this._data = null,
            this._me = null,
            this.items = [],
            this.lines = []
        }
        return Object.defineProperty(t.prototype, "locking", {
            get: function() {
                return this._locking
            },
            enumerable: !0,
            configurable: !0
        }),
        Object.defineProperty(t.prototype, "me", {
            get: function() {
                return this._me
            },
            enumerable: !0,
            configurable: !0
        }),
        Object.defineProperty(t.prototype, "owner", {
            set: function(t) {
                this._me = t,
                Laya.timer.frameOnce(3, this, this.onCreate)
            },
            enumerable: !0,
            configurable: !0
        }),
        Object.defineProperty(t.prototype, "choosed_index", {
            get: function() {
                return this._choosed_index
            },
            enumerable: !0,
            configurable: !0
        }),
        t.prototype.onCreate = function() {
            var t = this;
            this.out = this.me.getChildByName("out"),
            this.bg = this.me.getChildByName("bg"),
            this.line = this.me.getChildByName("line"),
            this.item_templete = this.me.getChildByName("templete"),
            this.content = this.me.getChildByName("content"),
            this.content.vScrollBarSkin = game.Tools.localUISrc("myres/vscroll.png"),
            this.content.vScrollBar.visible = !1,
            this.item_templete.visible = !1;
            for (var e = this.item_templete.scriptMap["capsui.UICopy"], i = 0; i < 10; i++) {
                var n = e.getNodeClone();
                this.content.addChild(n),
                this.items.push(n)
            }
            for (i = 0; i < 12; i++) {
                var a = this.line.scriptMap["capsui.UICopy"].getNodeClone();
                this.content.addChild(a),
                this.lines.push(a)
            }
            this.item_templete.visible = !0,
            this.item_templete.clickHandler = Laya.Handler.create(this, function() {
                t._locking || (t.out.visible ? t.up() : t.down())
            }, null, !1),
            this.out.clickHandler = Laya.Handler.create(this, function() {
                t._locking || t.up()
            }, null, !1)
        }
        ,
        t.prototype.init = function(t, e) {
            this._render = t,
            this._onChange = e
        }
        ,
        t.prototype.reset_show = function(t, e) {
            this.out.visible = !1,
            this.line.visible = !1,
            this.content.visible = !1,
            this.bg.height = this.item_templete.height,
            this._value_count = e,
            this._choosed_index = t,
            this._render.runWith({
                index: t,
                container: this.item_templete
            }),
            this._locking = !1
        }
        ,
        t.prototype.down = function() {
            var t = this;
            this._locking = !0,
            this.out.visible = !0;
            for (n = 0; n < this.items.length; n++)
                this.items[n].visible = !1;
            this.content.visible = !1,
            this.line.visible = !0,
            this.line.y = this.item_templete.height,
            this.content.y = this.item_templete.height + this.line.height;
            for (var e = function(e) {
                e < i._value_count ? (0 != e && (i.lines[e - 1].visible = !0,
                i.lines[e - 1].y = i.item_templete.height * e + i.line.height * (e - 1)),
                i._render.runWith({
                    index: e,
                    container: i.items[e]
                }),
                i.items[e].visible = !0,
                i.items[e].y = (i.item_templete.height + i.line.height) * e,
                i.items[e].clickHandler = Laya.Handler.create(i, function() {
                    t._locking || (t.up(),
                    t._choosed_index != e && (t._choosed_index = e,
                    t._render.runWith({
                        index: e,
                        container: t.item_templete
                    }),
                    t._onChange.runWith(t._choosed_index)))
                }, null, !1)) : i.items[e].visible = !1
            }, i = this, n = 0; n < this.items.length; n++)
                e(n);
            if (this.content.visible = !0,
            this.content.alpha = 0,
            this._value_count <= 3) {
                a = (this.item_templete.height + this.line.height) * (this._value_count + 1);
                this.content.height = (this.item_templete.height + this.line.height) * this._value_count,
                Laya.Tween.to(this.bg, {
                    height: a
                }, 150, Laya.Ease.strongOut),
                Laya.Tween.to(this.content, {
                    alpha: 1
                }, 150)
            } else {
                var a = 4.5 * (this.item_templete.height + this.line.height);
                this.content.height = 3.4 * (this.item_templete.height + this.line.height),
                Laya.Tween.to(this.bg, {
                    height: a
                }, 150, Laya.Ease.strongOut),
                Laya.Tween.to(this.content, {
                    alpha: 1
                }, 150)
            }
            this.line.alpha = 0,
            Laya.Tween.to(this.line, {
                alpha: 1
            }, 150),
            Laya.timer.once(150, this, function() {
                t._locking = !1
            })
        }
        ,
        t.prototype.up = function() {
            var t = this;
            this._locking = !0;
            var e = this.item_templete.height;
            Laya.Tween.to(this.bg, {
                height: e
            }, 150, Laya.Ease.strongOut),
            Laya.Tween.to(this.content, {
                alpha: 0
            }, 150),
            Laya.Tween.to(this.line, {
                alpha: 0
            }, 150),
            Laya.timer.once(150, this, function() {
                t.out.visible = !1,
                t.line.visible = !1,
                t.content.visible = !1,
                t._locking = !1
            })
        }
        ,
        t
    }();
    t.CDropdown = e
}(capsui || (capsui = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), basic;
!function(t) {
    var e = function(t) {
        function e() {
            return t.call(this) || this
        }
        return __extends(e, t),
        e.prototype.Clone = function() {
            for (var t = new e, i = 0; i < this.length; i++)
                t.push(this[i]);
            return t
        }
        ,
        e.prototype.RemoveAt = function(t) {
            if (!(t < 0 || t >= this.length)) {
                var e = this[t];
                return this[t] = this[this.length - 1],
                this[this.length - 1] = e,
                this.pop()
            }
        }
        ,
        e.prototype.RemoveX = function(t) {
            for (var e = 0; e < this.length; e++)
                if (this[e] === t) {
                    this.RemoveAt(e);
                    break
                }
            return this
        }
        ,
        e
    }(Array);
    t.Seq = e
}(basic || (basic = {}));
var basic;
!function(t) {
    var e = function() {
        return function() {
            this.key = null,
            this.val = null
        }
    }();
    t.Pair = e
}(basic || (basic = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), anim;
!function(t) {
    var e = function(t) {
        function e() {
            var e = t.call(this) || this;
            return e.mat = null,
            e.tick = 2e3,
            e.lasttime = 0,
            e
        }
        return __extends(e, t),
        e.prototype._load = function(t) {
            this.mat = t.meshRender.material,
            this.lasttime = 0,
            Laya.timer.frameLoop(1, this, this.update)
        }
        ,
        e.prototype.update = function() {
            if (this.destroyed)
                Laya.timer.clearAll(this);
            else if (this.enable) {
                var t = Laya.timer.currTimer - this.lasttime;
                t >= this.tick && (t = 0,
                this.lasttime = Laya.timer.currTimer);
                var e = 0;
                e = t < this.tick / 2 ? 2 * t / this.tick : 1 - (t - this.tick / 2) / (this.tick / 2);
                var i = this.mat.albedoColor.clone();
                i.w = 1 - e,
                this.mat.albedoColor = i
            } else
                this.lasttime = 0
        }
        ,
        e
    }(Laya.Script);
    t.Bling = e
}(anim || (anim = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), anim;
!function(t) {
    var e = function(t) {
        function e() {
            var e = t.call(this) || this;
            return e.mat = null,
            e
        }
        return __extends(e, t),
        e.prototype._load = function(t) {
            this.mat = t.meshRender.material,
            Laya.timer.frameLoop(1, this, this.update)
        }
        ,
        e.prototype.update = function() {
            if (this.destroyed)
                Laya.timer.clearAll(this);
            else if (this.enable) {
                if (e.lastupdateframe < Laya.timer.currFrame)
                    if (e.lastupdateframe < Laya.timer.currFrame - 10)
                        e.lastupdateframe = Laya.timer.currFrame,
                        e.lastupdatetime = Laya.timer.currTimer;
                    else {
                        e.lastupdateframe = Laya.timer.currFrame;
                        var t = (Laya.timer.currTimer - e.lastupdatetime) / 1e3;
                        e.tilingOffset.w >= -.35 ? e.v += 2.2 * t : e.tilingOffset.w >= -.65 ? (e.v -= 1.6 * t) < .1 && (e.v = .1) : e.v = .3,
                        e.tilingOffset.w -= e.v * t,
                        e.tilingOffset.w < -1 && (e.tilingOffset.w = -.1,
                        e.v = 0),
                        e.lastupdatetime = Laya.timer.currTimer
                    }
                this.mat.tilingOffset = e.tilingOffset.clone()
            }
        }
        ,
        e.tilingOffset = new Laya.Vector4(.8,.2,0,0),
        e.lastupdateframe = 0,
        e.lastupdatetime = 0,
        e.v = 0,
        e
    }(Laya.Script);
    t.RunUV = e
}(anim || (anim = {}));
var capsui;
!function(t) {
    var e = function() {
        function t() {
            this._me = null,
            this._root_view = null
        }
        return Object.defineProperty(t.prototype, "me", {
            get: function() {
                return this._me
            },
            enumerable: !0,
            configurable: !0
        }),
        Object.defineProperty(t.prototype, "root_view", {
            get: function() {
                return this._root_view
            },
            enumerable: !0,
            configurable: !0
        }),
        Object.defineProperty(t.prototype, "owner", {
            set: function(t) {
                var e = this;
                this._me = t,
                this._me.frameOnce(2, this, function() {
                    for (var t = e._me; t && !(t instanceof Laya.View); )
                        t = t.parent;
                    e._root_view = t,
                    e._root_view && (e._root_view.on("onenable", e, e._onEnable),
                    e._root_view.on("ondisable", e, e._onDisable)),
                    e.onCreate()
                })
            },
            enumerable: !0,
            configurable: !0
        }),
        t.prototype._onEnable = function() {
            !this.me || this.me.destroyed ? this.onDestroy() : this.onEnable()
        }
        ,
        t.prototype._onDisable = function() {
            !this.me || this.me.destroyed ? this.onDestroy() : this.onDisable()
        }
        ,
        t.prototype.onCreate = function() {}
        ,
        t.prototype.onEnable = function() {}
        ,
        t.prototype.onDisable = function() {}
        ,
        t.prototype.onDestroy = function() {
            this._root_view && (this._root_view.off("onenable", this, this._onEnable),
            this._root_view.off("ondisable", this, this._onDisable))
        }
        ,
        t
    }();
    t.UIComponent = e
}(capsui || (capsui = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), capsui;
!function(t) {
    var e = function(t) {
        function e() {
            var e = t.call(this) || this;
            return e.mousedowned = !1,
            e.origin_scale_x = 1,
            e.origin_scale_y = 1,
            e.starttime = 0,
            e.origin_x = 0,
            e
        }
        return __extends(e, t),
        e.prototype.onCreate = function() {
            this.origin_scale_x = this.me.scaleX,
            this.origin_scale_y = this.me.scaleY,
            this.me.on("mousedown", this, this.OnMouseDown),
            this.me.on("mouseup", this, this.OnMouseUp),
            this.me.on("mouseout", this, this.OnMouseUp),
            this.me.filters = [new Laya.ColorFilter([1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0])]
        }
        ,
        e.prototype.onEnable = function() {
            this.me.scaleX = this.me.scaleY = 1,
            this.origin_scale_x = this.me.scaleX,
            this.origin_scale_y = this.me.scaleY
        }
        ,
        e.prototype.onDisable = function() {
            this.mousedowned = !1,
            Laya.Tween.clearAll(this.me),
            this.me.destroyed || (this.me.scaleX = this.origin_scale_x,
            this.me.scaleY = this.origin_scale_y)
        }
        ,
        e.prototype.OnMouseDown = function() {
            this.mousedowned || (this.mousedowned = !0,
            this.origin_x = this.me.scaleX,
            this.starttime = Laya.timer.currTimer,
            Laya.timer.clear(this, this.DoAnim),
            Laya.timer.frameLoop(1, this, this.DoAnim))
        }
        ,
        e.prototype.OnMouseUp = function() {
            this.mousedowned && (this.mousedowned = !1,
            this.origin_x = this.me.scaleX,
            this.starttime = Laya.timer.currTimer,
            Laya.timer.clear(this, this.DoAnim),
            Laya.timer.frameLoop(1, this, this.DoAnim))
        }
        ,
        e.prototype.DoAnim = function() {
            if (this.me && !this.me.destroyed) {
                var t = Laya.timer.currTimer - this.starttime
                  , e = this.mousedowned ? 1.1 : 1;
                if (t >= 50)
                    this.me.scaleX = this.me.scaleY = e,
                    Laya.timer.clear(this, this.DoAnim);
                else {
                    var i = t / 50;
                    this.me.scaleX = this.me.scaleY = this.origin_x * (1 - i) + e * i
                }
            }
        }
        ,
        e
    }(t.UIComponent);
    t.CButton = e
}(capsui || (capsui = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), capsui;
!function(t) {
    var e = function(t) {
        function e() {
            var e = t.call(this) || this;
            return e.starttime = 0,
            e
        }
        return __extends(e, t),
        e.prototype.onCreate = function() {
            this.img_round = this.me.getChildByName("flower").getChildByName("round"),
            this.img_shine = this.me.getChildByName("flower").getChildByName("shine")
        }
        ,
        e.prototype.onEnable = function() {
            this.starttime = Laya.timer.currTimer,
            this.refreshShow(),
            Laya.timer.frameLoop(1, this, this.refreshShow)
        }
        ,
        e.prototype.onDisable = function() {
            Laya.timer.clearAll(this)
        }
        ,
        e.prototype.refreshShow = function() {
            var t = Laya.timer.currTimer - this.starttime;
            t > 2e3 && (t = 0,
            this.starttime = Laya.timer.currTimer);
            var e = t / 2e3;
            if (this.img_round.rotation = 360 * e,
            e < .5) {
                i = 2 * e;
                this.img_shine.alpha = i * i
            } else {
                var i = 2 - 2 * e;
                this.img_shine.alpha = i * i
            }
        }
        ,
        e
    }(t.UIComponent);
    t.CLoading = e
}(capsui || (capsui = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), capsui;
!function(t) {
    var e = function(t) {
        function e() {
            var e = null !== t && t.apply(this, arguments) || this;
            return e._drag_scroll = !1,
            e
        }
        return __extends(e, t),
        e.prototype.onCreate = function() {
            this.scrollpoint = this.me.getChildByName("scrollpoint")
        }
        ,
        e.prototype.init = function(t, e) {
            var i = this;
            this.ispoint = t,
            this.handler_change = e,
            e && (this.me.on("mousedown", this, function() {
                i._drag_scroll = !0;
                var t = i.me.mouseY / i.me.height;
                e.runWith(t)
            }),
            this.me.on("mousemove", this, function() {
                if (i._drag_scroll) {
                    var t = i.me.mouseY / i.me.height;
                    e.runWith(t)
                }
            }),
            this.me.on("mouseup", this, function() {
                i._drag_scroll = !1
            }),
            this.me.on("mouseout", this, function() {
                i._drag_scroll = !1
            }))
        }
        ,
        e.prototype.setVal = function(t, e) {
            t = t < 0 ? 0 : t > 1 ? 1 : t,
            (e = e < 0 ? 0 : e) >= 1 ? this.me.visible && (this.me.visible = !1) : (this.me.visible || (this.me.visible = !0),
            this.ispoint ? this.scrollpoint.y = this.me.height * t : (this.scrollpoint.height = this.me.height * e,
            this.scrollpoint.height < 20 && (this.scrollpoint.height = 20),
            this.scrollpoint.y = (this.me.height - this.scrollpoint.height) * t))
        }
        ,
        e.prototype.reset = function() {
            this._drag_scroll = !1
        }
        ,
        e
    }(t.UIComponent);
    t.CScrollBar = e
}(capsui || (capsui = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), capsui;
!function(t) {
    var e = function(t) {
        function e() {
            var e = t.call(this) || this;
            return e._scrollbar = null,
            e._scrollpoint = null,
            e._drag_scroll = !1,
            e._container_items = null,
            e._content = null,
            e._templete = null,
            e._items = [],
            e._item_heights = [],
            e._total_height = 0,
            e._rate = 0,
            e._repeat_x = 1,
            e._span_x = 0,
            e._value_count = 0,
            e._render_func = null,
            e
        }
        return __extends(e, t),
        Object.defineProperty(e.prototype, "rate", {
            get: function() {
                return this._rate
            },
            set: function(t) {
                this._total_height <= this._content.height ? this._content.vScrollBar.value = 0 : this._content.vScrollBar.value = (this._total_height - this._content.height) * t / 1
            },
            enumerable: !0,
            configurable: !0
        }),
        Object.defineProperty(e.prototype, "value_count", {
            get: function() {
                return this._value_count
            },
            enumerable: !0,
            configurable: !0
        }),
        Object.defineProperty(e.prototype, "need_scroll", {
            get: function() {
                return this._total_height > this._content.height
            },
            enumerable: !0,
            configurable: !0
        }),
        Object.defineProperty(e.prototype, "total_height", {
            get: function() {
                return this._total_height
            },
            enumerable: !0,
            configurable: !0
        }),
        Object.defineProperty(e.prototype, "view_height", {
            get: function() {
                return this._content.height
            },
            enumerable: !0,
            configurable: !0
        }),
        Object.defineProperty(e.prototype, "near_bottom", {
            get: function() {
                return this.total_height <= this.view_height || (1 - this.rate) * this.value_count < .5
            },
            enumerable: !0,
            configurable: !0
        }),
        e.prototype.addItem = function(t, e) {
            void 0 === e && (e = -1);
            var i = this._value_count;
            e <= 0 && (e = this._templete.height);
            for (n = 0; n < t; n++)
                this._item_heights.push(e);
            if (this._value_count += t,
            this._repeat_x <= 1 ? this._total_height += e * t : this._total_height = e * Math.ceil(this._value_count / this._repeat_x),
            i > 0)
                for (var n = 0; n < this._items.length; n++)
                    if (this._items[n].value_index == i - 1) {
                        var a = this._items[n];
                        this._render_func && this._render_func.runWith({
                            index: a.value_index,
                            container: a.container,
                            cache_data: a.cache_data
                        })
                    }
            this._onChange()
        }
        ,
        e.prototype.addItems = function(t) {
            for (var e = this._value_count, i = 0, n = 0; n < t.length; n++)
                this._item_heights.push(t[n]),
                i += t[n];
            if (this._value_count += t.length,
            this._repeat_x <= 1 && (this._total_height += i),
            e > 0)
                for (n = 0; n < this._items.length; n++)
                    if (this._items[n].value_index == e - 1) {
                        var a = this._items[n];
                        this._render_func && this._render_func.runWith({
                            index: a.value_index,
                            container: a.container,
                            cache_data: a.cache_data
                        })
                    }
            this._onChange()
        }
        ,
        e.prototype.delItem = function(t) {
            for (var e = 0; e < this._items.length; e++)
                this._items[e].value_index >= t && (this._items[e].value_index == this.value_count - 1 || this._render_func.runWith({
                    index: this._items[e].value_index,
                    container: this._items[e].container,
                    cache_data: this._items[e].cache_data
                }));
            this.popItem()
        }
        ,
        e.prototype.popItem = function() {
            if (0 != this._value_count) {
                var t = this._item_heights[this._item_heights.length - 1];
                this._total_height,
                this._rate;
                this._total_height -= t,
                this._value_count--,
                this._item_heights.pop(),
                this._onChange()
            }
        }
        ,
        e.prototype.onCreate = function() {
            var t = this
              , e = this.me.getChildByName("scrollbar");
            e && (this._scrollbar = e,
            this._scrollpoint = e.getChildByName("scrollpoint")),
            this._content = this.me.getChildByName("content"),
            this._content.vScrollBarSkin = game.Tools.localUISrc("myres/vscroll.png"),
            this._container_items = new Laya.Sprite,
            this._content.addChild(this._container_items),
            this._container_items.x = this._container_items.y = 0,
            this._container_items.height = 1e7,
            Laya.timer.frameOnce(2, this, function() {
                t._content.vScrollBar.visible = !1,
                t._content.vScrollBar.on("change", t, t._onChange)
            }),
            this._templete = this._content.getChildByName("templete"),
            this._templete.visible = !1,
            this._scrollbar && (this._scrollbar.on("mousedown", this, function() {
                t._drag_scroll = !0,
                t.rate = t._scrollbar.mouseY / t._scrollbar.height
            }),
            this._scrollbar.on("mousemove", this, function() {
                t._drag_scroll && (t.rate = t._scrollbar.mouseY / t._scrollbar.height)
            }),
            this._scrollbar.on("mouseup", this, function() {
                t._drag_scroll = !1
            }))
        }
        ,
        e.prototype.init_scrollview = function(t, e, i, n) {
            if (void 0 === e && (e = -1),
            void 0 === i && (i = 1),
            void 0 === n && (n = 0),
            this._repeat_x = i,
            this._span_x = n,
            this._render_func = t,
            this._items.length > 0) {
                for (r = 0; r < this._items.length; r++)
                    this._container_items.removeChild(this._items[r].container),
                    this._items[r].container.destroy();
                this._items = []
            }
            e <= 0 && (e = this._templete.height);
            var a = Math.ceil(this._content.height / e) + 2;
            a *= this._repeat_x;
            for (var r = 0; r < a; r++)
                this._items.push({
                    container: this._templete.scriptMap["capsui.UICopy"].getNodeClone(),
                    value_index: -1,
                    cache_data: {}
                }),
                this._content.removeChild(this._items[r].container),
                this._container_items.addChild(this._items[r].container)
        }
        ,
        e.prototype.reset = function() {
            this._content.vScrollBar.stopScroll(),
            this._drag_scroll = !1,
            this._total_height = 0,
            this._value_count = 0,
            this._item_heights = [],
            this.rate = 0,
            this._onRateChange(0)
        }
        ,
        e.prototype.change_render_handler = function(t) {
            this.reset(),
            this._render_func = t
        }
        ,
        e.prototype._onChange = function() {
            var t = this._content.vScrollBar
              , e = 1 * t.value;
            if (this._total_height <= this._content.height)
                e > 0 ? t.value = 0 : this._onRateChange(0);
            else if (e > this._total_height - this._content.height)
                t.value = (this._total_height - this._content.height) / 1;
            else {
                var i = e / (this._total_height - this._content.height);
                this._onRateChange(i)
            }
        }
        ,
        e.prototype.scrollDelta = function(t) {
            this.need_scroll && (this._content.vScrollBar.value += t)
        }
        ,
        e.prototype._onRateChange = function(t) {
            var e = 0;
            this._total_height <= this._content.height ? (this._rate = 0,
            this._scrollpoint && (this._scrollpoint.y = 0),
            this._scrollbar && (this._scrollbar.visible = !1)) : (this._rate = t,
            this._rate < 0 ? this._rate = 0 : this._rate > 1 && (this._rate = 1),
            this._scrollbar && (this._scrollbar.visible = !0),
            this._scrollpoint && this._scrollbar && (this._scrollpoint.y = this._scrollbar.height * this._rate),
            e = (this._total_height - this._content.height) * this._rate);
            for (var i = 0, n = 0, a = 0; a < this._item_heights.length; a += this._repeat_x) {
                if (n + this._item_heights[a] >= e) {
                    i = a;
                    break
                }
                n += this._item_heights[a]
            }
            for (var r = i % this._items.length, a = 0; a < this._items.length; a += this._repeat_x) {
                var s = i + a;
                if (s >= this._value_count || n - e > this._content.height)
                    for (o = 0; o < this._repeat_x; o++) {
                        (l = this._items[(r + a + o) % this._items.length]).container.visible = !1,
                        l.value_index = -1
                    }
                else {
                    for (var o = 0; o < this._repeat_x; o++) {
                        var l = this._items[(r + a + o) % this._items.length]
                          , h = s + o;
                        h >= this.value_count ? (l.container.visible = !1,
                        l.value_index = -1) : l.value_index != h && (l.container.visible = !0,
                        l.value_index = h,
                        l.container.y = n,
                        l.container.x = (this._templete.width + this._span_x) * o,
                        this._container_items.removeChild(l.container),
                        this._container_items.addChild(l.container),
                        this._render_func && this._render_func.runWith({
                            index: h,
                            container: l.container,
                            cache_data: l.cache_data
                        }))
                    }
                    n += this._item_heights[s]
                }
            }
            this.me.event("ratechange")
        }
        ,
        e.prototype.wantToRefreshItem = function(t) {
            for (var e = 0; e < this._items.length; e++)
                this._items[e].value_index == t && this._render_func.runWith({
                    index: t,
                    container: this._items[e].container,
                    cache_data: this._items[e].cache_data
                })
        }
        ,
        e.prototype.wantToRefreshAll = function() {
            for (var t = 0; t < this._items.length; t++)
                this._items[t].value_index >= 0 && this._render_func.runWith({
                    index: this._items[t].value_index,
                    container: this._items[t].container,
                    cache_data: this._items[t].cache_data
                })
        }
        ,
        e
    }(t.UIComponent);
    t.CScrollView = e
}(capsui || (capsui = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), capsui;
!function(t) {
    var e = function(t) {
        function e() {
            var e = t.call(this) || this;
            return e.origin_x = 1,
            e.origin_width = 1,
            e.extend_right = !0,
            e
        }
        return __extends(e, t),
        e.prototype.onCreate = function() {
            this.origin_x = this.me.x,
            this.origin_width = this.me.width,
            this.me.on("change", this, this.refresh_position),
            this.refresh_position()
        }
        ,
        e.prototype.onEnable = function() {}
        ,
        e.prototype.onDisable = function() {}
        ,
        e.prototype.refresh_position = function() {
            var t = this.me.textField.textWidth;
            t > this.origin_width ? this.me.x = this.origin_x + (t - this.origin_width) / 2 * this.me.scaleX * (this.extend_right ? 1 : -1) : this.me.x = this.origin_x
        }
        ,
        e
    }(t.UIComponent);
    t.LabelLocalizationPosition = e
}(capsui || (capsui = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), capsui;
!function(t) {
    var e = function(t) {
        function e() {
            var e = t.call(this) || this;
            return e.origin_scale = 1,
            e.origin_width = 1,
            e
        }
        return __extends(e, t),
        e.prototype.onCreate = function() {
            this.origin_scale = this.me.scaleX,
            this.origin_width = this.me.width,
            this.me.on("change", this, this.refresh_size),
            this.refresh_size()
        }
        ,
        e.prototype.onEnable = function() {}
        ,
        e.prototype.onDisable = function() {}
        ,
        e.prototype.change_width = function(t) {
            this.origin_width = t,
            this.refresh_size()
        }
        ,
        e.prototype.refresh_size = function() {
            var t = this.me.textField.textWidth;
            if (t > this.origin_width) {
                var e = t / this.origin_width;
                this.me.width = this.origin_width * e,
                this.me.scaleX = this.me.scaleY = this.origin_scale / e
            } else
                this.me.width = this.origin_width,
                this.me.scaleX = this.me.scaleY = this.origin_scale
        }
        ,
        e
    }(t.UIComponent);
    t.LabelLocalizationSize = e
}(capsui || (capsui = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), capsui;
!function(t) {
    var e = function(t) {
        function e() {
            var e = t.call(this) || this;
            return e._total_count = 0,
            e._func_load = null,
            e._loading = null,
            e._duringLoading = !1,
            e._load_id = 0,
            e
        }
        return __extends(e, t),
        Object.defineProperty(e.prototype, "total_count", {
            get: function() {
                return this._total_count
            },
            set: function(t) {
                this._total_count = t,
                this._pendingLoad()
            },
            enumerable: !0,
            configurable: !0
        }),
        e.prototype.reset = function() {
            this._load_id = 0,
            this._total_count = 0,
            this._duringLoading = !1,
            this._loading.visible = !1,
            t.prototype.reset.call(this)
        }
        ,
        e.prototype.onCreate = function() {
            this._loading = this.me.getChildByName("loading"),
            this._loading.visible = !1,
            t.prototype.onCreate.call(this)
        }
        ,
        e.prototype.init_nolimitlist = function(t, e) {
            this._func_load = t,
            this.init_scrollview(e)
        }
        ,
        e.prototype._onRateChange = function(e) {
            t.prototype._onRateChange.call(this, e),
            this._pendingLoad()
        }
        ,
        e.prototype._pendingLoad = function() {
            var t = this;
            if (!this._duringLoading && this._total_count > this.value_count && (1 - this.rate) * this.value_count <= 3 && this._func_load) {
                this._duringLoading = !0,
                this._load_id++;
                var e = this._load_id;
                this._func_load.runWith(this.value_count),
                Laya.timer.once(700, this, function() {
                    t._duringLoading && e == t._load_id && (t._loading.visible = !0)
                })
            }
        }
        ,
        e.prototype.loadOver = function(t, e) {
            this._duringLoading && (this._duringLoading = !1,
            this._loading && (this._loading.visible = !1),
            t ? this.addItem(e) : this._total_count = this.value_count)
        }
        ,
        e.prototype.popItem = function() {
            this._total_count--,
            t.prototype.popItem.call(this)
        }
        ,
        e
    }(t.CScrollView);
    t.NoLimitList = e
}(capsui || (capsui = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), game;
!function(t) {
    var e = function(e) {
        function i() {
            var t = e.call(this) || this;
            return t.inited = !1,
            i.Inst = t,
            t
        }
        return __extends(i, e),
        i.on_getSkuDetails = function(t) {
            if (this.goods_info = {},
            t) {
                for (var e = 0; e < t.length; e++) {
                    var i = t[e]
                      , n = i.productId;
                    this.goods_info[n] = i
                }
                Laya.PlatformClass.createClass("layaair.majsoul.mjmgr").call("getGPOwnedItems")
            }
        }
        ,
        i.on_gp_get_owneditems = function(t) {
            if (this.orders = [],
            t) {
                for (a = 0; a < t.length; a++) {
                    var e = t[a];
                    this.orders.push({
                        sku: e.sku,
                        data: e.data,
                        sign: e.sign
                    })
                }
                for (var i = function(t) {
                    var e = n.orders[t];
                    app.NetAgent.sendReq2Lobby("Lobby", "solveGooglePlayOrder", {
                        inapp_purchase_data: JSON.stringify(e.data),
                        inapp_data_signature: e.sign
                    }, function(t, i) {
                        if (t)
                            ;
                        else if (i.error) {
                            var n = i.error.code;
                            if (1901 == n || 1902 == n) {
                                (a = Laya.PlatformClass.createClass("layaair.majsoul.mjmgr")).call("consumeGPItem", e.data.purchaseToken)
                            }
                        } else {
                            var a = Laya.PlatformClass.createClass("layaair.majsoul.mjmgr");
                            a.call("consumeGPItem", e.data.purchaseToken)
                        }
                    })
                }, n = this, a = 0; a < this.orders.length; a++)
                    i(a)
            }
        }
        ,
        i.on_gp_buy_result = function(t, e) {
            var i = t.productId;
            this.orders.push({
                sku: i,
                data: t,
                sign: e
            }),
            app.NetAgent.sendReq2Lobby("Lobby", "solveGooglePlayOrder", {
                inapp_purchase_data: JSON.stringify(t),
                inapp_data_signature: e
            }, function(e, i) {
                if (e || i.error)
                    uiscript.UIMgr.Inst.showNetReqError("solveGooglePlayOrder", e, i);
                else {
                    Laya.PlatformClass.createClass("layaair.majsoul.mjmgr").call("consumeGPItem", t.purchaseToken)
                }
            })
        }
        ,
        i.on_consume_success = function(t) {
            for (var e = 0; e < this.orders.length; e++)
                if (this.orders[e].data.purchaseToken == t) {
                    this.orders[e] = this.orders[this.orders.length - 1],
                    this.orders.pop();
                    break
                }
        }
        ,
        i.on_failed_info = function(t) {
            uiscript.UIMgr.Inst && uiscript.UIMgr.Inst.ShowErrorInfo(t)
        }
        ,
        i.on_gp_pay_cancel = function() {
            this.current_order_id && "" != this.current_order_id && (app.NetAgent.sendReq2Lobby("Lobby", "cancelGooglePlayOrder", {
                order_id: this.current_order_id
            }, function(t, e) {
                (t || e.error) && uiscript.UIMgr.Inst.showNetReqError("cancelGooglePlayOrder", t, e)
            }),
            this.current_order_id = "")
        }
        ,
        i.on_gp_buy_error = function(e, i) {
            if (1 == i)
                app.NetAgent.sendReq2Lobby("Lobby", "cancelGooglePlayOrder", {
                    order_id: e
                }, function(t, e) {
                    (t || e.error) && uiscript.UIMgr.Inst.showNetReqError("cancelGooglePlayOrder", t, e)
                });
            else {
                var n = "";
                switch (i) {
                case 2:
                    n = t.Tools.strOfLocalization(2222);
                    break;
                case 3:
                    n = t.Tools.strOfLocalization(2223);
                    break;
                case 4:
                    n = t.Tools.strOfLocalization(2224);
                    break;
                case 5:
                case 6:
                    n = t.Tools.strOfLocalization(2225);
                    break;
                case 7:
                    n = t.Tools.strOfLocalization(2226)
                }
                "" != n && uiscript.UIMgr.Inst.ShowErrorInfo(n)
            }
        }
        ,
        i.prototype.recover_pre_order = function(t) {
            for (var e = "", n = cfg.mall.product.getGroup(10), a = 0; a < n.length; a++)
                if (n[a].goods_id == t) {
                    e = n[a].product_id;
                    break
                }
            if ("" == e)
                return !1;
            for (var r = function(t) {
                if (i.orders[t].sku == e) {
                    var n = i.orders[t];
                    return app.NetAgent.sendReq2Lobby("Lobby", "solveGooglePlayOrder", {
                        inapp_purchase_data: JSON.stringify(n.data),
                        inapp_data_signature: n.sign
                    }, function(t, e) {
                        if (t || e.error)
                            if (e && 1902 == e.error.code) {
                                (i = Laya.PlatformClass.createClass("layaair.majsoul.mjmgr")).call("consumeGPItem", n.data.purchaseToken)
                            } else
                                uiscript.UIMgr.Inst.showNetReqError("solveGooglePlayOrder", t, e);
                        else {
                            var i = Laya.PlatformClass.createClass("layaair.majsoul.mjmgr");
                            i.call("consumeGPItem", n.data.purchaseToken)
                        }
                    }),
                    {
                        value: !0
                    }
                }
            }, a = 0; a < i.orders.length; a++) {
                var s = r(a);
                if ("object" == typeof s)
                    return s.value
            }
            return !1
        }
        ,
        i.prototype.getGoodsInfo = function(t) {
            for (var e = cfg.mall.product.getGroup(10), n = "", a = 0; a < e.length; a++)
                if (e[a].goods_id == t) {
                    n = e[a].product_id;
                    break
                }
            if ("" == n)
                return null;
            if (i.goods_info[n]) {
                var r = i.goods_info[n];
                return {
                    currency_code: r.price_currency_code,
                    price: r.price
                }
            }
            return null
        }
        ,
        i.prototype.onGameStart = function() {
            var t = cfg.mall.product.getGroup(10)
              , e = "";
            if (t) {
                for (var i = 0; i < t.length; i++)
                    0 != i && (e += ","),
                    e += t[i].product_id;
                Laya.PlatformClass.createClass("layaair.majsoul.mjmgr").call("gp_getSkuDetail", e)
            }
        }
        ,
        i.prototype.want2BuyItem = function(t, e) {
            for (var n = "", a = cfg.mall.product.getGroup(10), r = 0; r < a.length; r++)
                if (a[r].goods_id == t) {
                    n = a[r].product_id;
                    break
                }
            "" != n ? app.NetAgent.sendReq2Lobby("Lobby", "createBillingOrder", {
                goods_id: t,
                payment_platform: 10,
                client_type: 1,
                account_id: GameMgr.Inst.account_id
            }, function(t, a) {
                if (t || a.error)
                    uiscript.UIMgr.Inst.showNetReqError("createBillingOrder", t, a),
                    e.runWith(0);
                else {
                    var r = a.order_id;
                    i.current_order_id = r;
                    Laya.PlatformClass.createClass("layaair.majsoul.mjmgr").call("gp_buySku", n, r),
                    e.runWith(0)
                }
            }) : e.runWith(1)
        }
        ,
        i.goods_info = {},
        i.current_order_id = "",
        i.orders = [],
        i
    }(t.AppShop);
    t.GooglePlayShop = e
}(game || (game = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), game;
!function(t) {
    var e = function() {
        function t() {}
        return t.Create = function(t) {
            var e = null;
            switch (t.t) {
            case "s":
                (e = new i).init(t)
            }
            return e
        }
        ,
        t
    }();
    t.ChatInfoBase = e;
    var i = function(t) {
        function e() {
            return null !== t && t.apply(this, arguments) || this
        }
        return __extends(e, t),
        e.prototype.init = function(t) {
            this.val = t.v;
            var e = uiscript.UI_LobbyChat.Inst.render_text;
            e.text = this.val,
            this._height = e.textWidth,
            this._height = e.textHeight
        }
        ,
        Object.defineProperty(e.prototype, "height", {
            get: function() {
                return this._height
            },
            enumerable: !0,
            configurable: !0
        }),
        Object.defineProperty(e.prototype, "width", {
            get: function() {
                return this._width
            },
            enumerable: !0,
            configurable: !0
        }),
        e.prototype.render = function(t) {
            var e = t.getChildByName("word");
            e.text = this.val,
            e.visible = !0
        }
        ,
        e
    }(e);
    t.ChatInfo_Str = i;
    var n = function() {
        function t(t) {
            this.infos = [],
            this.lastTimeStamp = 0,
            this.account_id = t,
            this.infos = [],
            this.lastTimeStamp = 0
        }
        return t.prototype.addInfo = function(t, i, n) {
            var a = e.Create(JSON.parse(i));
            return null == a ? (app.Log.Error("未找到合适的聊天类型 data:" + i),
            !1) : (a.timeStamp = t,
            this.infos.push({
                info: a,
                isme: n
            }),
            this.lastTimeStamp = t,
            !0)
        }
        ,
        t
    }();
    t.PersonChat = n;
    var a = function() {
        function t() {
            this.infos = []
        }
        return t.prototype.addInfo = function(t) {
            return null != e.Create(t.content) && (this.infos.push(t),
            !0)
        }
        ,
        t
    }();
    t.ChannelChat = a;
    var r = function() {
        function t() {
            this.chat_world = null,
            this.friend_chat = []
        }
        return t.init = function() {
            this.Inst = new t,
            this.Inst._init()
        }
        ,
        t.prototype._init = function() {
            this.chat_world = new a,
            this.friend_chat = [],
            app.NetAgent.AddListener2Lobby("NotifyChatMessage", Laya.Handler.create(this, this._onReceiveChat, null, !1))
        }
        ,
        t.prototype._onReceiveChat = function(t) {
            if (1 == t.type)
                t.world_chat && this.chat_world.addInfo(t.world_chat);
            else if (t.private_chat) {
                var e = t.private_chat
                  , i = 0
                  , n = !1;
                e.sender_id == GameMgr.Inst.account_id ? (n = !0,
                i = e.target_id) : (n = !1,
                i = e.sender_id);
                this.findFriend(i).addInfo(e.timestamp, e.content, n)
            }
        }
        ,
        t.prototype.findFriend = function(t) {
            for (var e = null, i = 0; i < this.friend_chat.length; i++)
                if (this.friend_chat[i].account_id == t) {
                    e = this.friend_chat[i];
                    break
                }
            return null == e && (e = new n(t),
            this.friend_chat.push(e)),
            e
        }
        ,
        t
    }();
    t.ChatMgr = r
}(game || (game = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), game;
!function(t) {
    var e = function(e) {
        function i() {
            var t = e.call(this) || this;
            return t.scene_path = "scene/lobby.ls",
            t.bglst = ["scene/Assets/Resource/lobby/yard.jpg", "scene/Assets/Resource/lobby/indoor.jpg"],
            t.ui_effect_list = ["scene/effect_get_character.lh", "scene/effect_get_zhuangban.lh", "scene/effect_heartup.lh", "scene/effect_heartup_favor.lh", "scene/effect_heartlevelup.lh", "scene/effect_item_shine.lh", "scene/effect_item_shine_big.lh"],
            t.scene_container = null,
            t.scene = null,
            t.bg_front_plane = null,
            t.bg_front_mat = null,
            t.bg_back_plane = null,
            t.bg_back_mat = null,
            t._current_bg = "",
            t._change_start_time = 0,
            t._during_change_bg = !1,
            t._check_idcard = !1,
            t._load_listener = [],
            t._progress_listener = [],
            i.Inst = t,
            t
        }
        return __extends(i, e),
        i.prototype.init = function(e) {
            var i = this;
            this._load_state = t.E_LoadState.loading;
            var n = [];
            n.push("extendRes/charactor/default/full.png"),
            n.push("extendRes/charactor/default/half.png"),
            n.push("extendRes/charactor/default/smallhead.png"),
            n.push("extendRes/charactor/default/bighead.png"),
            n.push("extendRes/charactor/default/waitingroom.png"),
            n.push("extendRes/emo/default.png");
            for (var a = [302001, 302002, 302003, 302004], r = 0; r < a.length; r++) {
                var s = cfg.item_definition.item.get(a[r]);
                n.push(s.icon),
                s.icon_transparent && "" != s.icon_transparent && n.push(s.icon_transparent)
            }
            n.push("extendRes/items/default.jpg"),
            cfg.level_definition.level_definition.forEach(function(t, e) {
                n.push(t.primary_icon)
            }),
            this._loadaudio(),
            n.push("extendRes/items/gold0.png"),
            n.push("extendRes/items/gold1.png"),
            t.LoadMgr.loadResImage(n, Laya.Handler.create(this, function() {
                t.LoadMgr.loadRes(t.E_LoadType.common, Laya.Handler.create(i, function() {
                    t.LoadMgr.loadRes(t.E_LoadType.lobby, Laya.Handler.create(i, function() {
                        return Laya.timer.frameOnce(1, i, function() {
                            t.EffectMgr.init(Laya.Handler.create(i, function() {
                                i.onProgressUpdate(1),
                                Laya.timer.frameOnce(5, i, function() {
                                    GameMgr.Inst.addScene(i.scene_container = new Laya.Sprite),
                                    i.scene_container.visible = !0,
                                    i._load_state = t.E_LoadState.loaded;
                                    for (var e = 0; e < i._load_listener.length; e++)
                                        i._load_listener[e] && i._load_listener[e].run();
                                    i._load_listener = [],
                                    i._progress_listener = []
                                })
                            }))
                        })
                    }), Laya.Handler.create(i, function(t) {
                        return i.onProgressUpdate(.7 + .3 * t)
                    }, null, !1))
                }), Laya.Handler.create(i, function(t) {
                    return i.onProgressUpdate(.5 + .2 * t)
                }, null, !1))
            }), Laya.Handler.create(this, function(t) {
                return i.onProgressUpdate(.5 * t)
            }, null, !1))
        }
        ,
        i.prototype._loadaudio = function() {
            cfg.audio.audio.forEach(function(t) {
                "lobby" == t.type && Laya.loader.load(t.path + view.AudioMgr.suffix)
            }),
            Laya.loader.load("audio/music/lobby.mp3"),
            Laya.loader.load("audio/music/game.mp3")
        }
        ,
        i.prototype.buildScene = function(t, e) {
            var i = this;
            if (this.scene)
                return e.runWith(1),
                void t.run();
            e.runWith(0),
            Laya.loader.create(this.scene_path, Laya.Handler.create(this, function() {
                e.runWith(.3);
                for (var n = [], a = 0; a < i.bglst.length; a++)
                    n.push(i.bglst[a]);
                Laya.loader.create(n, Laya.Handler.create(i, function() {
                    i.scene = Laya.loader.getRes(i.scene_path),
                    i.scene_container.addChild(i.scene),
                    i.bg_front_plane = i.scene.getChildByName("root").getChildByName("bg_front"),
                    i.bg_front_mat = i.bg_front_plane.meshRender.sharedMaterial,
                    i.bg_back_plane = i.scene.getChildByName("root").getChildByName("bg_back"),
                    i.bg_back_mat = i.bg_back_plane.meshRender.sharedMaterial,
                    i.bg_front_plane.active = !1,
                    e.runWith(.6);
                    for (var a = function(t) {
                        Laya.timer.frameOnce(5 * t, i, function() {
                            i.bg_back_mat.albedoTexture = Laya.loader.getRes(n[t].url),
                            e.runWith(.6 + .2 * (t + 1) / n.length)
                        })
                    }, r = 0; r < n.length; r++)
                        a(r);
                    Laya.timer.frameOnce(5 * n.length, i, function() {
                        i.scene.visible = !0,
                        e.runWith(.8),
                        i.preheart_effect(t, Laya.Handler.create(i, function(t) {
                            e.runWith(.8 + .2 * t)
                        }, null, !1))
                    })
                }), Laya.Handler.create(i, function(t) {
                    return e.runWith(.3 + .3 * t)
                }, null, !1))
            }), Laya.Handler.create(this, function(t) {
                return e.runWith(.3 * t)
            }, null, !1))
        }
        ,
        i.prototype.preheart_effect = function(e, i) {
            var n = this;
            app.Log.log("scene_lobby preheart_effect"),
            t.EffectMgr.preheat_3d_effect(this.ui_effect_list, t.FrontEffect.Inst.root2, !0, Laya.Handler.create(this, function() {
                Laya.timer.frameOnce(5, n, function() {
                    i.runWith(1),
                    e.run()
                })
            }), i)
        }
        ,
        i.prototype.onEnable = function() {
            this._during_change_bg = !1,
            uiscript.UIMgr.Inst.onSceneLobby_Enable(),
            this.scene && (this.scene.visible = !0),
            view.AudioMgr.PlayMusic("music/lobby.mp3"),
            this.pending_enter_event(),
            uiscript.UI_Invite.Inst.enable = !0,
            Laya.timer.frameLoop(1, this, this._update, null, !0)
        }
        ,
        i.prototype.pending_enter_event = function() {
            var e = this
              , i = "yard";
            if (GameMgr.Inst.account_data.nickname && "" != GameMgr.Inst.account_data.nickname)
                if (GameMgr.Inst.ingame)
                    i = "indoor",
                    t.MJNetMgr.Inst.OpenConnect(GameMgr.Inst.mj_game_token, GameMgr.Inst.mj_game_uuid, GameMgr.Inst.mj_server_location, !0, null);
                else if (uiscript.UI_WaitingRoom.Inst.inRoom)
                    i = "indoor",
                    uiscript.UIMgr.Inst.ShowWaitingRoom();
                else if (-1 != GameMgr.Inst.beinvited_roomid) {
                    var n = GameMgr.Inst.beinvited_roomid;
                    GameMgr.Inst.beinvited_roomid = -1,
                    app.NetAgent.sendReq2Lobby("Lobby", "joinRoom", {
                        room_id: n
                    }, function(t, e) {
                        t || e.error ? (uiscript.UIMgr.Inst.showNetReqError("joinRoom", t, e),
                        uiscript.UIMgr.Inst.showLobby()) : (uiscript.UI_WaitingRoom.Inst.updateData(e.room),
                        uiscript.UIMgr.Inst.ShowWaitingRoom())
                    })
                } else if ("" != GameMgr.Inst.outsee_paipuid) {
                    var a = GameMgr.Inst.outsee_paipuid;
                    GameMgr.Inst.outsee_paipuid = "";
                    var r = a.split("_")
                      , s = 0
                      , o = 0;
                    if (r.length > 1 && (s = "a" == r[1].charAt(0) ? t.Tools.decode_account_id(parseInt(r[1].substr(1))) : parseInt(r[1])),
                    r.length > 2) {
                        var l = parseInt(r[2]);
                        l && (o = l)
                    }
                    GameMgr.Inst.checkPaiPu(r[0], s, o)
                } else if (GameMgr.Inst.custom_match_id > 0)
                    i = "indoor",
                    uiscript.UI_Match_Room.Inst.enable || uiscript.UI_Match_Room.Inst.show(GameMgr.Inst.custom_match_id);
                else {
                    var h = !0;
                    if ((uiscript.UI_Ob.Inst.enable || uiscript.UI_PaiPu.Inst.enable || uiscript.UI_Match_Room.Inst.enable) && (h = !1,
                    i = "indoor"),
                    h) {
                        uiscript.UI_Lobby.Inst.enable = !0;
                        var c = !1;
                        if (!this._check_idcard) {
                            this._check_idcard = !0;
                            "chs" != GameMgr.client_language || uiscript.UI_ShiMingRenZheng.renzhenged || GameMgr.Inst.player_in_haiwai || !GameMgr.inRelease || (c = !0,
                            Laya.LocalStorage.setItem("shiming_time_" + t.Tools.encode_account_id(GameMgr.Inst.account_id), Date.now().toString()))
                        }
                        if (c)
                            uiscript.UI_ShiMingRenZheng.Inst.show();
                        else if (uiscript.UI_User_Xieyi.Inst) {
                            GameMgr.Inst.account_setting[t.EAccountSetKey.user_xieyi.toString()] ? (this.pending_pop2(),
                            uiscript.UI_User_Xieyi.Inst.destroy(),
                            uiscript.UI_User_Xieyi.Inst = null) : uiscript.UI_User_Xieyi.Inst.show(Laya.Handler.create(this, function() {
                                app.NetAgent.sendReq2Lobby("Lobby", "updateAccountSettings", {
                                    setting: {
                                        key: t.EAccountSetKey.user_xieyi,
                                        value: 1
                                    }
                                }, function(t, e) {}),
                                GameMgr.Inst.account_setting[t.EAccountSetKey.user_xieyi.toString()] = 1,
                                e.pending_pop2(),
                                uiscript.UI_User_Xieyi.Inst.destroy(),
                                uiscript.UI_User_Xieyi.Inst = null
                            }))
                        } else
                            this.pending_pop2()
                    }
                }
            else
                uiscript.UI_Nickname.show();
            this.change_bg(i, !0)
        }
        ,
        i.prototype.pending_pop2 = function() {
            uiscript.UI_Info.lobbyPopout() || uiscript.UI_Activity.need_popout && uiscript.UI_Activity.Inst.show()
        }
        ,
        i.prototype.onDisable = function() {
            uiscript.UIMgr.Inst.onSceneLobby_Disable(),
            this.scene.visible = !1,
            t.LoadMgr.disposeSceneRes("lobby"),
            this._current_bg = "",
            this.bg_back_mat = null,
            this.bg_back_plane = null,
            this.bg_front_mat = null,
            this.bg_front_plane = null,
            this.scene.destroy(!0),
            this.scene = null,
            t.EffectMgr.dispose_3d_effect(this.ui_effect_list),
            t.EffectMgr.force_dispose_3d_res(this.scene_path),
            this._during_change_bg = !1,
            Laya.timer.clearAll(this)
        }
        ,
        i.prototype.addLoadListenter = function(e, i) {
            this._load_state == t.E_LoadState.loaded ? Laya.timer.once(500, this, function() {
                i && i.runWith(1),
                e && e.run()
            }) : (i && this._progress_listener.push(i),
            e && this._load_listener.push(e))
        }
        ,
        i.prototype.change_bg = function(t, e) {
            if (t != this._current_bg || this._during_change_bg && e) {
                var i = "scene/Assets/Resource/lobby/" + t + ".jpg";
                "" == this._current_bg && (e = !0),
                e ? (this.bg_front_plane.active = !1,
                this._during_change_bg = !1) : (this.bg_front_plane.active = !0,
                this.bg_front_mat.albedoTexture = this.bg_back_mat.albedoTexture,
                this.bg_front_mat.albedoColor = new Laya.Vector4(1,1,1,1),
                this._during_change_bg = !0,
                this._change_start_time = Laya.timer.currTimer),
                this.bg_back_mat.albedoTexture = Laya.loader.getRes(i),
                this._current_bg = t
            }
        }
        ,
        i.prototype._update = function() {
            if (this._during_change_bg) {
                var t = Laya.timer.currTimer - this._change_start_time;
                if (t >= 200)
                    this._during_change_bg = !1,
                    this.bg_front_plane.active = !1;
                else {
                    var e = 1 - t / 200;
                    this.bg_front_mat.albedoColor = new Laya.Vector4(1,1,1,e)
                }
            }
        }
        ,
        i.prototype.onProgressUpdate = function(t) {
            for (var e = 0; e < this._progress_listener.length; e++)
                this._progress_listener[e].runWith(t)
        }
        ,
        i.Inst = null,
        i
    }(t.SceneBase);
    t.Scene_Lobby = e
}(game || (game = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), game;
!function(t) {
    var e = function(e) {
        function i() {
            var t = e.call(this) || this;
            return t.desktop = null,
            t.camera_main = null,
            t.scene_path2 = "scene/mjhandpai.ls",
            t.ui_effect_list = ["scene/effect_getstar.lh", "scene/effect_losestar.lh", "scene/effect_queshi_bang.lh", "scene/effect_juanzhou.lh", "scene/effect_yiman.lh", "scene/effect_yiman2.lh"],
            t.scene_hand = null,
            t.root2 = null,
            t.camera_hand = null,
            t._common_texture2d_loaded = !1,
            t._desktop_model_path = "",
            t._mjp_path = "",
            t._effect_list = [],
            t._mjp_textures = [],
            t._model_list = [],
            i.Inst = t,
            "en" == GameMgr.client_language ? t.ui_effect_list.push("scene/effect_winlose_en.lh") : t.ui_effect_list.push("scene/effect_winlose.lh"),
            t
        }
        return __extends(i, e),
        i.prototype.init = function(t) {}
        ,
        i.prototype.onEnable = function() {
            uiscript.UIMgr.Inst.onSceneMJ_Enable()
        }
        ,
        i.prototype.onDisable = function() {
            uiscript.UIMgr.Inst.onSceneMJ_Disable(),
            view.DesktopMgr.Inst.Reset(),
            view.DesktopMgr.Inst.active = !1,
            this.desktop.visible = !1,
            t.MJNetMgr.Inst.Close(),
            t.LoadMgr.disposeSceneRes("mjdesktop")
        }
        ,
        i.prototype.openMJRoom = function(t, e, i) {
            var n = this;
            this.load_common_texture2d(Laya.Handler.create(this, function() {
                n.load_mainscene(Laya.Handler.create(n, function() {
                    n.active_common_texture2d(Laya.Handler.create(n, function() {
                        app.Log.log("active_common_texture2d over"),
                        n._load_my_desktop_view(Laya.Handler.create(n, function() {
                            app.Log.log("_load_my_desktop_view over"),
                            n._load_my_mjp_view(Laya.Handler.create(n, function() {
                                app.Log.log("_load_my_mjp_view over"),
                                n._load_player_views(t, Laya.Handler.create(n, function() {
                                    app.Log.log("_load_player_effects over"),
                                    view.DesktopMgr.Inst.active = !0,
                                    n.desktop.visible = !0,
                                    view.DesktopMgr.Inst.Reset(),
                                    i.runWith(1),
                                    e.run()
                                }), Laya.Handler.create(n, function(t) {
                                    return i.runWith(.75 + .25 * t)
                                }, null, !1))
                            }), Laya.Handler.create(n, function(t) {
                                return i.runWith(.65 + .1 * t)
                            }, null, !1))
                        }), Laya.Handler.create(n, function(t) {
                            return i.runWith(.6 + .05 * t)
                        }, null, !1))
                    }), Laya.Handler.create(n, function(t) {
                        return i.runWith(.55 + .05 * t)
                    }, null, !1))
                }), Laya.Handler.create(n, function(t) {
                    return i.runWith(.1 + .45 * t)
                }, null, !1))
            }), Laya.Handler.create(this, function(t) {
                return i.runWith(.1 * t)
            }, null, !1))
        }
        ,
        i.prototype.load_mainscene = function(e, i) {
            var n = this;
            uiscript.UIMgr.Inst.openMjDesktopUI(Laya.Handler.create(this, function() {
                n.desktop ? (i.runWith(1),
                e.run()) : (cfg.audio.audio.forEach(function(t) {
                    "mj" == t.type && Laya.loader.load(t.path + view.AudioMgr.suffix)
                }),
                t.LoadMgr.loadRes(t.E_LoadType.scene_mj, Laya.Handler.create(n, function() {
                    return Laya.timer.frameOnce(1, n, function() {
                        var t = "scene/mjdesktop.ls";
                        "en" == GameMgr.client_language && (t = "scene/mjdesktop_en.ls"),
                        n.desktop = Laya.loader.getRes(t),
                        n.desktop.ambientColor = new Laya.Vector3(.4,.4,.4);
                        var a = n.desktop.getChildByName("main_camera");
                        GameMgr.Inst.addScene(n.desktop);
                        var r = n.desktop.addChild(new Laya.DirectionLight);
                        r.transform.translate(new Laya.Vector3(0,1,1.7)),
                        r.color = new Laya.Vector3(.5,.5,.5),
                        r.direction = new Laya.Vector3(0,-.933,-.36);
                        var s = Laya.loader.getRes(n.scene_path2);
                        GameMgr.Inst.addScene(s),
                        n.scene_hand = s,
                        n.root2 = s.getChildByName("root"),
                        n.camera_hand = s.getChildByName("camera"),
                        n.camera_hand.useOcclusionCulling = !1;
                        n.desktop.getChildByName("room").addComponent(view.DesktopMgr).mainCamera = a,
                        a.useOcclusionCulling = !1,
                        i.runWith(1),
                        e.run()
                    })
                }), Laya.Handler.create(n, function(t) {
                    return i.runWith(.2 + .8 * t)
                }, null, !1)))
            }, null, !1), Laya.Handler.create(this, function(t) {
                return i.runWith(.2 * t)
            }, null, !1))
        }
        ,
        i.prototype.load_common_texture2d = function(e, i) {
            var n = this;
            if (this._common_texture2d_loaded)
                i && i.runWith(1),
                e && e.run();
            else {
                for (var a = [], r = 0; r < t.EffectMgr.d3res_map.mj_common_texture2d.length; r++)
                    a.push(t.EffectMgr.d3res_map.mj_common_texture2d[r]);
                Laya.loader.create(a, Laya.Handler.create(this, function() {
                    n._common_texture2d_loaded = !0,
                    e && e.run()
                }), i, laya.d3.resource.Texture2D_caps)
            }
        }
        ,
        i.prototype.active_common_texture2d = function(e, i) {
            i.runWith(0);
            for (var n = [], a = 0; a < t.EffectMgr.d3res_map.mj_common_texture2d.length; a++)
                n.push(t.EffectMgr.d3res_map.mj_common_texture2d[a]);
            var r = 0
              , s = function() {
                if (r >= n.length)
                    return i.runWith(1),
                    void e.run();
                i.runWith(r / n.length);
                var t = Laya.loader.getRes(n[r]);
                t && t.recreateResource(),
                r++,
                s()
            };
            s()
        }
        ,
        i.prototype.clearTexture_commont_texture2d = function() {
            for (var e = t.EffectMgr.d3res_map.mj_common_texture2d, i = 0; i < e.length; i++) {
                var n = Laya.loader.getRes(e[i]);
                n && n.clearTexture()
            }
        }
        ,
        i.prototype._load_my_mjp_view = function(e, i) {
            var n = [];
            n.push("scene/Assets/Resource/tablecloth/" + t.GameUtility.get_common_view_res_name(t.ECommonView.desktop) + "/Table_Dif.jpg");
            var a = t.GameUtility.get_common_view_res_name(t.ECommonView.mjp)
              , r = "scene/Assets/Resource/mjpai/";
            "en" == GameMgr.client_language && (r += "en/"),
            r += a + "/";
            for (var s = 0; s < 10; s++)
                n.push(r + s + "m.png"),
                n.push(r + s + "p.png"),
                n.push(r + s + "s.png"),
                s >= 1 && s < 8 && n.push(r + s + "z.png");
            n.push(r + "hand.png"),
            this._mjp_textures = n,
            Laya.loader.create(n, e, i)
        }
        ,
        i.prototype._load_my_desktop_view = function(e, i) {
            var n = this
              , a = t.GameUtility.get_common_view_res_name(t.ECommonView.desktop);
            this._desktop_model_path = "scene/" + a + ".lh",
            Laya.loader.create(this._desktop_model_path, Laya.Handler.create(this, function() {
                n._desktop_model = Laya.loader.getRes(n._desktop_model_path),
                n.desktop.getChildByName("room").getChildByName("container_desktop").addChild(n._desktop_model),
                n._desktop_model.transform.localPosition = new Laya.Vector3(0,0,0),
                n._desktop_model.transform.localScale = new Laya.Vector3(1,1,1),
                n._desktop_model.transform.localRotationEuler = new Laya.Vector3(0,0,0),
                n._desktop_model.active = !0,
                n._desktop_model.isStatic = !0,
                i.runWith(1),
                e.run()
            }), i)
        }
        ,
        i.prototype._load_player_views = function(e, i, n) {
            var a = this
              , r = {};
            r["scene/effect_chipeng.lh"] = 1;
            for (var s = {}, o = {}, l = {}, h = 0; h < e.length; h++) {
                var c = e[h];
                if (c && c.character) {
                    var u = c.character
                      , _ = "scene/effect_hupai_default.lh"
                      , d = "scene/hand_human.lh"
                      , f = ""
                      , p = "scene/liqi_default.lh"
                      , m = "";
                    if (u.views)
                        for (var g = 0; g < u.views.length; g++) {
                            var y = u.views[g].slot
                              , v = u.views[g].item_id;
                            if (y == t.EPlayerView.liqi_bgm) {
                                var b = cfg.item_definition.item.get(v);
                                b && (m = b.sargs[0])
                            } else {
                                var x = cfg.item_definition.view.get(v);
                                x && (y == t.EPlayerView.hupai_effect ? _ = "scene/" + x.res_name + ".lh" : y == t.EPlayerView.liqi_effect ? f = "scene/" + x.res_name + ".lh" : y == t.EPlayerView.liqibang ? p = "scene/" + x.res_name + ".lh" : y == t.EPlayerView.hand_model && (d = "scene/" + x.res_name + ".lh"))
                            }
                        }
                    r[_] = 1,
                    "scene/effect_hupai_yanhua.lh" == _ && (r["scene/effect_hupai_yanhua_bang.lh"] = 1),
                    "" != f && (r[f] = 1),
                    s[p] = 1,
                    s[d] = 1,
                    "" != m && (l[m] = 1);
                    var w = u.skin
                      , C = cfg.item_definition.skin.get(w);
                    o[C.path + "/full.png"] = 1,
                    o[C.path + "/half.png"] = 1
                }
            }
            this._effect_list = [];
            for (var I in r)
                this._effect_list.push(I);
            this._model_list = [];
            for (var I in s)
                this._model_list.push(I);
            var S = [];
            for (var I in o)
                S.push(I);
            n.runWith(0),
            t.LoadMgr.loadResImage(S, Laya.Handler.create(this, function() {
                Laya.loader.create(a._model_list, Laya.Handler.create(a, function() {
                    t.EffectMgr.preheat_3d_effect(a._effect_list, view.DesktopMgr.Inst.trans_container_effect, !1, Laya.Handler.create(a, function() {
                        t.EffectMgr.preheat_3d_effect(a.ui_effect_list, t.FrontEffect.Inst.root2, !0, Laya.Handler.create(a, function() {
                            Laya.timer.frameOnce(5, a, function() {
                                i.run();
                                for (var t in l)
                                    Laya.loader.load("audio/" + t)
                            })
                        }), Laya.Handler.create(a, function(t) {
                            return n.runWith(.65 + .35 * t)
                        }, null, !1))
                    }), Laya.Handler.create(a, function(t) {
                        return n.runWith(.4 + .25 * t)
                    }, null, !1))
                }), Laya.Handler.create(a, function(t) {
                    return n.runWith(.3 + .1 * t)
                }, null, !1))
            }), Laya.Handler.create(this, function(t) {
                return n.runWith(.3 * t)
            }, null, !1))
        }
        ,
        i.prototype._on_quit = function() {
            if (uiscript.UI_DesktopInfo.Inst && uiscript.UI_DesktopInfo.Inst.onCloseRoom(),
            uiscript.UI_Win.Inst && (uiscript.UI_Win.Inst.enable = !1),
            uiscript.UI_ScoreChange.Inst && (uiscript.UI_ScoreChange.Inst.enable = !1),
            view.DesktopMgr.Inst && view.DesktopMgr.Inst.active) {
                if (this._desktop_model && (this._desktop_model.destroy(!0),
                this._desktop_model = null),
                t.EffectMgr.force_dispose_3d_res(this._desktop_model_path),
                this._desktop_model_path) {
                    (n = Laya.loader.getRes(this._desktop_model_path)) && n.destroy(!0),
                    this._desktop_model_path = ""
                }
                for (i = 0; i < this._model_list.length; i++) {
                    var e = this._model_list[i].url;
                    t.EffectMgr.force_dispose_3d_res(e);
                    (n = Laya.loader.getRes(e)) && n.destroy(!0)
                }
                this.clearTexture_commont_texture2d(),
                t.EffectMgr.dispose_3d_effect(this._effect_list),
                t.EffectMgr.dispose_3d_effect(this.ui_effect_list);
                for (var i = 0; i < this._mjp_textures.length; i++) {
                    var n = Laya.loader.getRes(this._mjp_textures[i].url);
                    n && n.dispose()
                }
            }
        }
        ,
        i.prototype.GameEnd = function() {
            app.Log.log("Scene_MJ GameEnd"),
            this._on_quit(),
            t.MJNetMgr.Inst.Close(),
            GameMgr.Inst.ingame = !1,
            GameMgr.Inst.EnterLobby()
        }
        ,
        i.prototype.ForceOut = function() {
            app.Log.log("Scene_MJ ForceOut"),
            this._on_quit(),
            t.MJNetMgr.Inst.Close(),
            GameMgr.Inst.EnterLobby()
        }
        ,
        i.Inst = null,
        i
    }(t.SceneBase);
    t.Scene_MJ = e
}(game || (game = {}));
var view;
!function(t) {
    var e = function() {
        function t() {}
        return t.play = function(t) {}
        ,
        t.fastplay = function(t, e) {}
        ,
        t.record = function(t, e) {
            return void 0 === e && (e = 0),
            0
        }
        ,
        t.fastrecord = function(t, e) {
            void 0 === e && (e = -1)
        }
        ,
        t
    }();
    t.ActionBase = e
}(view || (view = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), view;
!function(t) {
    var e = function(e) {
        function i() {
            return null !== e && e.apply(this, arguments) || this
        }
        return __extends(i, e),
        i.play = function(e) {
            app.Log.log("ActionAnGangAddGang play data:" + JSON.stringify(e));
            var i = e.seat
              , n = t.DesktopMgr.Inst.seat2LocalPosition(i);
            if (e.doras && t.DesktopMgr.Inst.WhenDoras(e.doras, !1),
            e.type == mjcore.E_Ming.gang_ming)
                t.DesktopMgr.Inst.players[n].PlaySound("act_kan"),
                Laya.timer.once(500, this, function() {
                    t.DesktopMgr.Inst.players[n].AddGang(mjcore.MJPai.Create(e.tiles)),
                    t.DesktopMgr.Inst.waiting_lingshang_deal_tile = !0
                });
            else {
                var a = new mjcore.MJMing;
                a.type = mjcore.E_Ming.gang_an,
                a.from = [i, i, i, i],
                a.pais = this.getAngangTile(e.tiles),
                Laya.timer.once(500, this, function() {
                    t.DesktopMgr.Inst.players[n].AddMing(a),
                    t.DesktopMgr.Inst.waiting_lingshang_deal_tile = !0
                }),
                t.DesktopMgr.Inst.players[n].PlaySound("act_kan")
            }
            e.operation && Laya.timer.once(600, this, function() {
                t.ActionOperation.play(e.operation)
            }),
            void 0 != e.zhenting && uiscript.UI_TingPai.Inst.setZhengting(e.zhenting),
            i == t.DesktopMgr.Inst.seat && uiscript.UI_TingPai.Inst.setData1(e),
            uiscript.UI_DesktopInfo.Inst.changeHeadEmo(i, "emoji_5", 2e3)
        }
        ,
        i.fastplay = function(e, i) {
            app.Log.log("ActionAnGangAddGang fastplay data:" + JSON.stringify(e) + " usetime:" + i);
            var n = e.seat
              , a = t.DesktopMgr.Inst.seat2LocalPosition(n);
            if (e.doras && t.DesktopMgr.Inst.WhenDoras(e.doras, !0),
            e.type == mjcore.E_Ming.gang_ming)
                t.DesktopMgr.Inst.players[a].AddGang(mjcore.MJPai.Create(e.tiles), !1);
            else {
                var r = new mjcore.MJMing;
                r.type = mjcore.E_Ming.gang_an,
                r.from = [n, n, n, n],
                r.pais = this.getAngangTile(e.tiles),
                t.DesktopMgr.Inst.players[a].AddMing(r, !1)
            }
            e.operation && -1 != i && Laya.timer.once(500, this, function() {
                t.ActionOperation.play(e.operation, i)
            }),
            void 0 != e.zhenting && uiscript.UI_TingPai.Inst.setZhengting(e.zhenting),
            n == t.DesktopMgr.Inst.seat && uiscript.UI_TingPai.Inst.setData1(e),
            t.DesktopMgr.Inst.waiting_lingshang_deal_tile = !0
        }
        ,
        i.record = function(e, i) {
            void 0 === i && (i = 0),
            app.Log.log("ActionAnGangAddGang record data:" + JSON.stringify(e)),
            e.doras && t.DesktopMgr.Inst.WhenDoras(e.doras, !0);
            var n = e.seat
              , a = t.DesktopMgr.Inst.seat2LocalPosition(n);
            if (e.type == mjcore.E_Ming.gang_ming)
                t.DesktopMgr.Inst.players[a].PlaySound("act_kan"),
                Laya.timer.once(500, this, function() {
                    t.DesktopMgr.Inst.players[a].AddGang(mjcore.MJPai.Create(e.tiles)),
                    t.DesktopMgr.Inst.waiting_lingshang_deal_tile = !0
                });
            else {
                var r = new mjcore.MJMing;
                r.type = mjcore.E_Ming.gang_an,
                r.from = [n, n, n, n],
                r.pais = this.getAngangTile(e.tiles),
                Laya.timer.once(500, this, function() {
                    t.DesktopMgr.Inst.players[a].AddMing(r),
                    t.DesktopMgr.Inst.waiting_lingshang_deal_tile = !0
                }),
                t.DesktopMgr.Inst.players[a].PlaySound("act_kan")
            }
            if (uiscript.UI_DesktopInfo.Inst.changeHeadEmo(n, "emoji_5", 2e3),
            t.DesktopMgr.Inst.mode == t.EMJMode.live_broadcast && e.operations)
                for (var s = 0; s < e.operations.length; s++)
                    t.ActionOperation.ob(e.operations[s], i, 450);
            return 1700
        }
        ,
        i.fastrecord = function(e, i) {
            void 0 === i && (i = -1),
            app.Log.log("ActionAnGangAddGang fastrecord data:" + JSON.stringify(e)),
            e.doras && t.DesktopMgr.Inst.WhenDoras(e.doras, !0);
            var n = e.seat
              , a = t.DesktopMgr.Inst.seat2LocalPosition(n);
            if (e.type == mjcore.E_Ming.gang_ming)
                t.DesktopMgr.Inst.players[a].AddGang(mjcore.MJPai.Create(e.tiles), !1);
            else {
                var r = new mjcore.MJMing;
                r.type = mjcore.E_Ming.gang_an,
                r.from = [n, n, n, n],
                r.pais = this.getAngangTile(e.tiles),
                t.DesktopMgr.Inst.players[a].AddMing(r, !1)
            }
            if (t.DesktopMgr.Inst.mode == t.EMJMode.live_broadcast && i >= 0 && e.operations)
                for (var s = 0; s < e.operations.length; s++)
                    t.ActionOperation.ob(e.operations[s], i, 450);
            t.DesktopMgr.Inst.waiting_lingshang_deal_tile = !0
        }
        ,
        i.getAngangTile = function(e) {
            var i = [];
            if ("0" != e.charAt(0) && "5" != e.charAt(0) || "z" == e.charAt(1))
                for (s = 0; s < 4; s++)
                    i.push(mjcore.MJPai.Create(e));
            else {
                var n = 1;
                if (t.DesktopMgr.Inst.game_config) {
                    var a = t.DesktopMgr.Inst.game_config.mode;
                    if (a && a.extendinfo) {
                        var r = JSON.parse(a.extendinfo);
                        if (r && null != r.dora_count)
                            switch (r.dora_count) {
                            case 0:
                                n = 0;
                                break;
                            case 2:
                            case 3:
                                n = 1;
                                break;
                            case 4:
                                n = "p" == e.charAt(1) ? 2 : 1
                            }
                    }
                    if (a && a.detail_rule && a.detail_rule && null != a.detail_rule.dora_count)
                        switch (a.detail_rule.dora_count) {
                        case 0:
                            n = 0;
                            break;
                        case 2:
                        case 3:
                            n = 1;
                            break;
                        case 4:
                            n = "p" == e.charAt(1) ? 2 : 1
                        }
                }
                for (var s = 0; s < 4; s++) {
                    var o = mjcore.MJPai.Create(e);
                    o.dora = 0 != s && s <= n,
                    i.push(o)
                }
            }
            return t.DesktopMgr.Inst.waiting_lingshang_deal_tile = !0,
            i
        }
        ,
        i
    }(t.ActionBase);
    t.ActionAnGangAddGang = e
}(view || (view = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), view;
!function(t) {
    var e = function(e) {
        function i() {
            return null !== e && e.apply(this, arguments) || this
        }
        return __extends(i, e),
        i.play = function(e) {
            app.Log.log("ActionBabei play data:" + JSON.stringify(e)),
            e.doras && t.DesktopMgr.Inst.WhenDoras(e.doras, !1);
            var i = e.seat
              , n = mjcore.MJPai.Create("4z");
            t.DesktopMgr.Inst.players[t.DesktopMgr.Inst.seat2LocalPosition(i)].AddBabei(n, e.moqie, !0),
            t.DesktopMgr.Inst.players[t.DesktopMgr.Inst.seat2LocalPosition(i)].PlaySound("act_babei"),
            i == t.DesktopMgr.Inst.seat ? t.DesktopMgr.Inst.mainrole.onBabei(n, !1) : t.DesktopMgr.Inst.players[t.DesktopMgr.Inst.seat2LocalPosition(i)].onBabei(e.moqie, !1),
            e.operation && Laya.timer.once(500, this, function() {
                t.ActionOperation.play(e.operation)
            }),
            void 0 != e.zhenting && void 0 == e.operation && (uiscript.UI_DesktopInfo.Inst.setZhenting(e.zhenting),
            uiscript.UI_TingPai.Inst.setZhengting(e.zhenting)),
            i == t.DesktopMgr.Inst.seat && uiscript.UI_TingPai.Inst.setData1(e),
            t.DesktopMgr.Inst.waiting_lingshang_deal_tile = !0
        }
        ,
        i.fastplay = function(e, i) {
            app.Log.log("ActionBabei fastplay data:" + JSON.stringify(e) + " usetime:" + i),
            e.doras && t.DesktopMgr.Inst.WhenDoras(e.doras, !0);
            var n = e.seat
              , a = mjcore.MJPai.Create("4z");
            t.DesktopMgr.Inst.players[t.DesktopMgr.Inst.seat2LocalPosition(n)].AddBabei(a, e.moqie, !1),
            n == t.DesktopMgr.Inst.seat ? t.DesktopMgr.Inst.mainrole.onBabei(a, !0) : t.DesktopMgr.Inst.players[t.DesktopMgr.Inst.seat2LocalPosition(n)].onBabei(e.moqie, !0),
            e.operation && -1 != i && Laya.timer.once(500, this, function() {
                t.ActionOperation.play(e.operation, i)
            }),
            void 0 != e.zhenting && void 0 == e.operation && (uiscript.UI_DesktopInfo.Inst.setZhenting(e.zhenting),
            uiscript.UI_TingPai.Inst.setZhengting(e.zhenting)),
            n == t.DesktopMgr.Inst.seat && uiscript.UI_TingPai.Inst.setData1(e),
            t.DesktopMgr.Inst.waiting_lingshang_deal_tile = !0
        }
        ,
        i.record = function(e, i) {
            void 0 === i && (i = 0),
            app.Log.log("ActionBabei record data:" + JSON.stringify(e)),
            e.doras && t.DesktopMgr.Inst.WhenDoras(e.doras, !0);
            var n = e.seat
              , a = mjcore.MJPai.Create("4z");
            if (t.DesktopMgr.Inst.players[t.DesktopMgr.Inst.seat2LocalPosition(n)].AddBabei(a, e.moqie, !0),
            t.DesktopMgr.Inst.players[t.DesktopMgr.Inst.seat2LocalPosition(n)].PlaySound("act_babei"),
            n == t.DesktopMgr.Inst.seat ? t.DesktopMgr.Inst.mainrole.onBabei(a, !1) : t.DesktopMgr.Inst.players[t.DesktopMgr.Inst.seat2LocalPosition(n)].recordBabei(a, e.moqie, !1),
            e.tingpais && t.DesktopMgr.Inst.setTingpai(e.seat, e.tingpais),
            t.DesktopMgr.Inst.mode == t.EMJMode.live_broadcast && e.operations)
                for (var r = 0; r < e.operations.length; r++)
                    t.ActionOperation.ob(e.operations[r], i, 450);
            return t.DesktopMgr.Inst.waiting_lingshang_deal_tile = !0,
            1e3
        }
        ,
        i.fastrecord = function(e, i) {
            void 0 === i && (i = -1),
            app.Log.log("ActionBabei fastrecord data:" + JSON.stringify(e)),
            e.doras && t.DesktopMgr.Inst.WhenDoras(e.doras, !0);
            var n = e.seat
              , a = mjcore.MJPai.Create("4z");
            if (t.DesktopMgr.Inst.players[t.DesktopMgr.Inst.seat2LocalPosition(n)].AddBabei(a, e.moqie, !1),
            n == t.DesktopMgr.Inst.seat ? t.DesktopMgr.Inst.mainrole.onBabei(a, !0) : t.DesktopMgr.Inst.players[t.DesktopMgr.Inst.seat2LocalPosition(n)].recordBabei(a, e.moqie, !0),
            e.tingpais && t.DesktopMgr.Inst.setTingpai(e.seat, e.tingpais),
            t.DesktopMgr.Inst.mode == t.EMJMode.live_broadcast && i >= 0 && e.operations)
                for (var r = 0; r < e.operations.length; r++)
                    t.ActionOperation.ob(e.operations[r], i, 450);
            t.DesktopMgr.Inst.waiting_lingshang_deal_tile = !0
        }
        ,
        i
    }(t.ActionBase);
    t.ActionBabei = e
}(view || (view = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), view;
!function(t) {
    var e = function(e) {
        function i() {
            return null !== e && e.apply(this, arguments) || this
        }
        return __extends(i, e),
        i.play = function(e) {
            app.Log.log("ActionChiPengGang play data:" + JSON.stringify(e));
            var i = e.seat
              , n = new mjcore.MJMing;
            n.type = e.type,
            n.from = e.froms,
            n.pais = [];
            for (var a = 0; a < e.tiles.length; a++)
                n.pais.push(mjcore.MJPai.Create(e.tiles[a]));
            Laya.timer.once(600, this, function() {
                try {
                    t.DesktopMgr.Inst.players[t.DesktopMgr.Inst.seat2LocalPosition(t.DesktopMgr.Inst.lastpai_seat)].QiPaiNoPass(),
                    t.DesktopMgr.Inst.players[t.DesktopMgr.Inst.seat2LocalPosition(i)].AddMing(n),
                    n.type == mjcore.E_Ming.gang_ming && (t.DesktopMgr.Inst.waiting_lingshang_deal_tile = !0)
                } catch (t) {
                    var e = {};
                    e.error = t.message,
                    e.stack = t.stack,
                    e.method = "addming600",
                    e.name = "ActionChiPengGang",
                    GameMgr.Inst.onFatalError(e)
                }
            }),
            i != t.DesktopMgr.Inst.seat || n.type != mjcore.E_Ming.gang_an && n.type != mjcore.E_Ming.gang_ming || (t.DesktopMgr.Inst.last_gang = Laya.timer.currTimer);
            var r = ""
              , s = "";
            switch (n.type) {
            case mjcore.E_Ming.kezi:
                r = "emoji_4",
                s = "emoji_3";
                break;
            case mjcore.E_Ming.shunzi:
                r = "emoji_2",
                s = "emoji_1";
                break;
            case mjcore.E_Ming.gang_ming:
                r = "emoji_6",
                s = "emoji_5"
            }
            uiscript.UI_DesktopInfo.Inst.changeHeadEmo(t.DesktopMgr.Inst.index_player, r, 2e3),
            t.DesktopMgr.Inst.index_player = i,
            uiscript.UI_DesktopInfo.Inst.changeHeadEmo(t.DesktopMgr.Inst.index_player, s, 2e3),
            t.DesktopMgr.Inst.RefreshPlayerIndicator(),
            e.liqi && t.ActionLiqi.play(e.liqi),
            e.operation && Laya.timer.once(600, this, function() {
                t.ActionOperation.play(e.operation)
            }),
            void 0 != e.zhenting && void 0 == e.operation && (uiscript.UI_DesktopInfo.Inst.setZhenting(e.zhenting),
            uiscript.UI_TingPai.Inst.setZhengting(e.zhenting));
            var o = "";
            switch (n.type) {
            case mjcore.E_Ming.shunzi:
                o = "act_chi";
                break;
            case mjcore.E_Ming.gang_ming:
            case mjcore.E_Ming.gang_an:
                o = "act_kan";
                break;
            case mjcore.E_Ming.kezi:
                o = "act_pon"
            }
            t.DesktopMgr.Inst.players[t.DesktopMgr.Inst.seat2LocalPosition(i)].PlaySound(o),
            i == t.DesktopMgr.Inst.seat && uiscript.UI_TingPai.Inst.setData0(e)
        }
        ,
        i.fastplay = function(e, i) {
            app.Log.log("ActionChiPengGang fastplay data:" + JSON.stringify(e) + " usetime:" + i);
            var n = e.seat
              , a = new mjcore.MJMing;
            a.type = e.type,
            a.from = e.froms,
            a.pais = [];
            for (var r = 0; r < e.tiles.length; r++)
                a.pais.push(mjcore.MJPai.Create(e.tiles[r]));
            t.DesktopMgr.Inst.players[t.DesktopMgr.Inst.seat2LocalPosition(t.DesktopMgr.Inst.lastpai_seat)].QiPaiNoPass(),
            t.DesktopMgr.Inst.players[t.DesktopMgr.Inst.seat2LocalPosition(n)].AddMing(a, !1),
            a.type == mjcore.E_Ming.gang_ming && (t.DesktopMgr.Inst.waiting_lingshang_deal_tile = !0),
            n != t.DesktopMgr.Inst.seat || a.type != mjcore.E_Ming.gang_an && a.type != mjcore.E_Ming.gang_ming || (t.DesktopMgr.Inst.last_gang = Laya.timer.currTimer),
            t.DesktopMgr.Inst.index_player = n,
            t.DesktopMgr.Inst.RefreshPlayerIndicator(),
            e.liqi && t.ActionLiqi.fastplay(e.liqi, 0),
            e.operation && -1 != i && Laya.timer.once(600, this, function() {
                t.ActionOperation.play(e.operation, i)
            }),
            void 0 != e.zhenting && void 0 == e.operation && (uiscript.UI_DesktopInfo.Inst.setZhenting(e.zhenting),
            uiscript.UI_TingPai.Inst.setZhengting(e.zhenting)),
            n == t.DesktopMgr.Inst.seat && uiscript.UI_TingPai.Inst.setData0(e)
        }
        ,
        i.record = function(e, i) {
            void 0 === i && (i = 0),
            app.Log.log("ActionChiPengGang record data:" + JSON.stringify(e));
            var n = e.seat
              , a = new mjcore.MJMing;
            a.type = e.type,
            a.from = e.froms,
            a.pais = [];
            for (var r = 0; r < e.tiles.length; r++)
                a.pais.push(mjcore.MJPai.Create(e.tiles[r]));
            Laya.timer.once(600, this, function() {
                t.DesktopMgr.Inst.players[t.DesktopMgr.Inst.seat2LocalPosition(t.DesktopMgr.Inst.lastpai_seat)].QiPaiNoPass(),
                t.DesktopMgr.Inst.players[t.DesktopMgr.Inst.seat2LocalPosition(n)].AddMing(a),
                a.type == mjcore.E_Ming.gang_ming && (t.DesktopMgr.Inst.waiting_lingshang_deal_tile = !0)
            }),
            n != t.DesktopMgr.Inst.seat || a.type != mjcore.E_Ming.gang_an && a.type != mjcore.E_Ming.gang_ming || (t.DesktopMgr.Inst.last_gang = Laya.timer.currTimer);
            var s = ""
              , o = "";
            switch (a.type) {
            case mjcore.E_Ming.kezi:
                s = "emoji_4",
                o = "emoji_3";
                break;
            case mjcore.E_Ming.shunzi:
                s = "emoji_2",
                o = "emoji_1";
                break;
            case mjcore.E_Ming.gang_ming:
                s = "emoji_6",
                o = "emoji_5"
            }
            uiscript.UI_DesktopInfo.Inst.changeHeadEmo(t.DesktopMgr.Inst.index_player, s, 2e3),
            t.DesktopMgr.Inst.index_player = n,
            uiscript.UI_DesktopInfo.Inst.changeHeadEmo(t.DesktopMgr.Inst.index_player, o, 2e3),
            t.DesktopMgr.Inst.RefreshPlayerIndicator(),
            e.liqi && t.ActionLiqi.record(e.liqi);
            var l = "";
            switch (a.type) {
            case mjcore.E_Ming.shunzi:
                l = "act_chi";
                break;
            case mjcore.E_Ming.gang_ming:
            case mjcore.E_Ming.gang_an:
                l = "act_kan";
                break;
            case mjcore.E_Ming.kezi:
                l = "act_pon"
            }
            return t.DesktopMgr.Inst.players[t.DesktopMgr.Inst.seat2LocalPosition(n)].PlaySound(l),
            t.DesktopMgr.Inst.mode == t.EMJMode.live_broadcast && e.operation && t.ActionOperation.ob(e.operation, i, 500),
            1700
        }
        ,
        i.fastrecord = function(e, i) {
            void 0 === i && (i = -1),
            app.Log.log("ActionChiPengGang fastrecord data:" + JSON.stringify(e));
            var n = e.seat
              , a = new mjcore.MJMing;
            a.type = e.type,
            a.from = e.froms,
            a.pais = [];
            for (var r = 0; r < e.tiles.length; r++)
                a.pais.push(mjcore.MJPai.Create(e.tiles[r]));
            t.DesktopMgr.Inst.players[t.DesktopMgr.Inst.seat2LocalPosition(t.DesktopMgr.Inst.lastpai_seat)].QiPaiNoPass(),
            t.DesktopMgr.Inst.players[t.DesktopMgr.Inst.seat2LocalPosition(n)].AddMing(a, !1),
            a.type == mjcore.E_Ming.gang_ming && (t.DesktopMgr.Inst.waiting_lingshang_deal_tile = !0),
            t.DesktopMgr.Inst.index_player = n,
            t.DesktopMgr.Inst.RefreshPlayerIndicator(),
            e.liqi && t.ActionLiqi.fastrecord(e.liqi),
            t.DesktopMgr.Inst.mode == t.EMJMode.live_broadcast && i >= 0 && e.operation && t.ActionOperation.ob(e.operation, i, 500)
        }
        ,
        i
    }(t.ActionBase);
    t.ActionChiPengGang = e
}(view || (view = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), view;
!function(t) {
    var e = function(e) {
        function i() {
            return null !== e && e.apply(this, arguments) || this
        }
        return __extends(i, e),
        i.play = function(e) {
            app.Log.log("ActionDealTile play data:" + JSON.stringify(e));
            var i = e.seat
              , n = e.tile;
            if (t.DesktopMgr.Inst.left_tile_count = e.left_tile_count,
            i == t.DesktopMgr.Inst.seat) {
                var a = Laya.timer.currTimer - t.DesktopMgr.Inst.last_gang
                  , r = 0;
                a < 650 && (r = 650 - a),
                Laya.timer.once(r, this, function() {
                    t.DesktopMgr.Inst.mainrole.TakePai(mjcore.MJPai.Create(n)),
                    t.DesktopMgr.Inst.ActionRunComplete()
                })
            } else
                t.DesktopMgr.Inst.players[t.DesktopMgr.Inst.seat2LocalPosition(i)].TakePai(mjcore.MJPai.Create("5z")),
                t.DesktopMgr.Inst.ActionRunComplete();
            t.DesktopMgr.Inst.index_player = i,
            t.DesktopMgr.Inst.RefreshPaiLeft(),
            t.DesktopMgr.Inst.RefreshPlayerIndicator(),
            e.liqi && t.ActionLiqi.play(e.liqi),
            e.operation && t.ActionOperation.play(e.operation),
            e.doras && e.doras.length > 0 && t.DesktopMgr.Inst.WhenDoras(e.doras, !1),
            void 0 != e.zhenting && void 0 == e.operation && (uiscript.UI_DesktopInfo.Inst.setZhenting(e.zhenting),
            uiscript.UI_TingPai.Inst.setZhengting(e.zhenting)),
            i == t.DesktopMgr.Inst.seat && uiscript.UI_TingPai.Inst.setData0(e),
            t.DesktopMgr.Inst.waiting_lingshang_deal_tile = !1
        }
        ,
        i.fastplay = function(e, i) {
            app.Log.log("ActionDealTile fastplay data:" + JSON.stringify(e) + " usetime:" + i);
            var n = e.seat
              , a = e.tile;
            t.DesktopMgr.Inst.left_tile_count = e.left_tile_count,
            n == t.DesktopMgr.Inst.seat ? t.DesktopMgr.Inst.mainrole.TakePai(mjcore.MJPai.Create(a), !1) : t.DesktopMgr.Inst.players[t.DesktopMgr.Inst.seat2LocalPosition(n)].TakePai(mjcore.MJPai.Create("5z")),
            t.DesktopMgr.Inst.index_player = n,
            t.DesktopMgr.Inst.RefreshPaiLeft(),
            t.DesktopMgr.Inst.RefreshPlayerIndicator(),
            e.liqi && t.ActionLiqi.fastplay(e.liqi, 0),
            e.operation && -1 != i && t.ActionOperation.play(e.operation, i),
            e.doras && e.doras.length > 0 && t.DesktopMgr.Inst.WhenDoras(e.doras, !0),
            void 0 != e.zhenting && void 0 == e.operation && (uiscript.UI_DesktopInfo.Inst.setZhenting(e.zhenting),
            uiscript.UI_TingPai.Inst.setZhengting(e.zhenting)),
            n == t.DesktopMgr.Inst.seat && uiscript.UI_TingPai.Inst.setData0(e),
            t.DesktopMgr.Inst.waiting_lingshang_deal_tile = !1
        }
        ,
        i.record = function(e, i) {
            void 0 === i && (i = 0),
            app.Log.log("ActionDealTile record data:" + JSON.stringify(e));
            var n = e.seat
              , a = e.tile;
            return t.DesktopMgr.Inst.left_tile_count = e.left_tile_count,
            n == t.DesktopMgr.Inst.seat ? t.DesktopMgr.Inst.mainrole.TakePai(mjcore.MJPai.Create(a)) : t.DesktopMgr.Inst.players[t.DesktopMgr.Inst.seat2LocalPosition(n)].recordTakePai(mjcore.MJPai.Create(a)),
            t.DesktopMgr.Inst.index_player = n,
            t.DesktopMgr.Inst.RefreshPaiLeft(),
            t.DesktopMgr.Inst.RefreshPlayerIndicator(),
            e.liqi && t.ActionLiqi.record(e.liqi),
            e.doras && e.doras.length > 0 && t.DesktopMgr.Inst.WhenDoras(e.doras, !0),
            t.DesktopMgr.Inst.mode == t.EMJMode.live_broadcast && e.operation && t.ActionOperation.ob(e.operation, i),
            t.DesktopMgr.Inst.waiting_lingshang_deal_tile = !1,
            300
        }
        ,
        i.fastrecord = function(e, i) {
            void 0 === i && (i = -1),
            app.Log.log("ActionDealTile fastrecord data:" + JSON.stringify(e));
            var n = e.seat
              , a = e.tile;
            t.DesktopMgr.Inst.left_tile_count = e.left_tile_count,
            n == t.DesktopMgr.Inst.seat ? t.DesktopMgr.Inst.mainrole.TakePai(mjcore.MJPai.Create(a), !1) : t.DesktopMgr.Inst.players[t.DesktopMgr.Inst.seat2LocalPosition(n)].recordTakePai(mjcore.MJPai.Create(a)),
            t.DesktopMgr.Inst.index_player = n,
            t.DesktopMgr.Inst.RefreshPaiLeft(),
            t.DesktopMgr.Inst.RefreshPlayerIndicator(),
            e.liqi && t.ActionLiqi.fastrecord(e.liqi),
            e.doras && e.doras.length > 0 && t.DesktopMgr.Inst.WhenDoras(e.doras, !0),
            t.DesktopMgr.Inst.mode == t.EMJMode.live_broadcast && i >= 0 && e.operation && t.ActionOperation.ob(e.operation, i),
            t.DesktopMgr.Inst.waiting_lingshang_deal_tile = !1
        }
        ,
        i
    }(t.ActionBase);
    t.ActionDealTile = e
}(view || (view = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), view;
!function(t) {
    var e = function(e) {
        function i() {
            return null !== e && e.apply(this, arguments) || this
        }
        return __extends(i, e),
        i.play = function(e) {
            app.Log.log("ActionDiscardTile play data:" + JSON.stringify(e)),
            e.doras && t.DesktopMgr.Inst.WhenDoras(e.doras, !1);
            var i = e.seat
              , n = mjcore.MJPai.Create(e.tile)
              , a = !(null == e.is_liqi || void 0 == e.is_liqi || !e.is_liqi);
            if (t.DesktopMgr.Inst.players[t.DesktopMgr.Inst.seat2LocalPosition(i)].AddQiPai(n, a, e.moqie),
            a) {
                e.is_wliqi ? t.DesktopMgr.Inst.players[t.DesktopMgr.Inst.seat2LocalPosition(i)].PlaySound("act_drich") : t.DesktopMgr.Inst.players[t.DesktopMgr.Inst.seat2LocalPosition(i)].PlaySound("act_rich");
                var r = t.DesktopMgr.Inst.player_effects[i].liqi_bgm;
                r && "" != r && (t.AudioMgr.lizhiMuted ? t.AudioMgr.PlayLiqiBgm(r, 1e3, !0) : (t.AudioMgr.StopMusic(),
                Laya.timer.once(1e3, this, function() {
                    t.DesktopMgr.Inst.gameing && (t.AudioMgr.PlayMusic("music/game.mp3", 1e3, !0),
                    t.AudioMgr.PlayLiqiBgm(r, 1e3, !0))
                })))
            }
            i == t.DesktopMgr.Inst.seat ? t.DesktopMgr.Inst.mainrole.OnDiscardTile(n, !1) : t.DesktopMgr.Inst.players[t.DesktopMgr.Inst.seat2LocalPosition(i)].onDiscardTile(e.moqie, !1),
            e.operation && Laya.timer.once(500, this, function() {
                t.ActionOperation.play(e.operation)
            }),
            void 0 != e.zhenting && void 0 == e.operation && (uiscript.UI_DesktopInfo.Inst.setZhenting(e.zhenting),
            uiscript.UI_TingPai.Inst.setZhengting(e.zhenting)),
            i == t.DesktopMgr.Inst.seat && uiscript.UI_TingPai.Inst.setData1(e)
        }
        ,
        i.fastplay = function(e, i) {
            app.Log.log("ActionDiscardTile fastplay data:" + JSON.stringify(e) + " usetime:" + i),
            e.doras && t.DesktopMgr.Inst.WhenDoras(e.doras, !0);
            var n = e.seat
              , a = mjcore.MJPai.Create(e.tile)
              , r = !(null == e.is_liqi || void 0 == e.is_liqi || !e.is_liqi);
            t.DesktopMgr.Inst.players[t.DesktopMgr.Inst.seat2LocalPosition(n)].AddQiPai(a, r, e.moqie, !1),
            n == t.DesktopMgr.Inst.seat ? t.DesktopMgr.Inst.mainrole.OnDiscardTile(a, !0) : t.DesktopMgr.Inst.players[t.DesktopMgr.Inst.seat2LocalPosition(n)].onDiscardTile(e.moqie, !0),
            e.operation && -1 != i && Laya.timer.once(500, this, function() {
                t.ActionOperation.play(e.operation, i)
            }),
            void 0 != e.zhenting && void 0 == e.operation && (uiscript.UI_DesktopInfo.Inst.setZhenting(e.zhenting),
            uiscript.UI_TingPai.Inst.setZhengting(e.zhenting)),
            n == t.DesktopMgr.Inst.seat && uiscript.UI_TingPai.Inst.setData1(e)
        }
        ,
        i.record = function(e, i) {
            void 0 === i && (i = 0),
            app.Log.log("ActionDiscardTile record data:" + JSON.stringify(e)),
            e.doras && t.DesktopMgr.Inst.WhenDoras(e.doras, !0);
            var n = e.seat
              , a = mjcore.MJPai.Create(e.tile)
              , r = !(null == e.is_liqi || void 0 == e.is_liqi || !e.is_liqi);
            if (t.DesktopMgr.Inst.players[t.DesktopMgr.Inst.seat2LocalPosition(n)].AddQiPai(a, r, e.moqie),
            r && (e.is_wliqi ? t.DesktopMgr.Inst.players[t.DesktopMgr.Inst.seat2LocalPosition(n)].PlaySound("act_drich") : t.DesktopMgr.Inst.players[t.DesktopMgr.Inst.seat2LocalPosition(n)].PlaySound("act_rich"),
            uiscript.UI_DesktopInfo.Inst.changeHeadEmo(n, "emoji_9", 2e3)),
            n == t.DesktopMgr.Inst.seat ? t.DesktopMgr.Inst.mainrole.OnDiscardTile(a, !1) : t.DesktopMgr.Inst.players[t.DesktopMgr.Inst.seat2LocalPosition(n)].recordDiscardTile(a, e.moqie, !1),
            e.tingpais && t.DesktopMgr.Inst.setTingpai(e.seat, e.tingpais),
            t.DesktopMgr.Inst.mode == t.EMJMode.live_broadcast && e.operations)
                for (var s = 0; s < e.operations.length; s++)
                    t.ActionOperation.ob(e.operations[s], i, 450);
            return 500
        }
        ,
        i.fastrecord = function(e, i) {
            void 0 === i && (i = -1),
            app.Log.log("ActionDiscardTile fastrecord data:" + JSON.stringify(e)),
            e.doras && t.DesktopMgr.Inst.WhenDoras(e.doras, !0);
            var n = e.seat
              , a = mjcore.MJPai.Create(e.tile)
              , r = !(null == e.is_liqi || void 0 == e.is_liqi || !e.is_liqi);
            if (t.DesktopMgr.Inst.players[t.DesktopMgr.Inst.seat2LocalPosition(n)].AddQiPai(a, r, e.moqie, !1),
            n == t.DesktopMgr.Inst.seat ? t.DesktopMgr.Inst.mainrole.OnDiscardTile(a, !0) : t.DesktopMgr.Inst.players[t.DesktopMgr.Inst.seat2LocalPosition(n)].recordDiscardTile(a, e.moqie, !0),
            e.tingpais && t.DesktopMgr.Inst.setTingpai(e.seat, e.tingpais),
            t.DesktopMgr.Inst.mode == t.EMJMode.live_broadcast && i >= 0 && e.operations)
                for (var s = 0; s < e.operations.length; s++)
                    t.ActionOperation.ob(e.operations[s], i, 450)
        }
        ,
        i
    }(t.ActionBase);
    t.ActionDiscardTile = e
}(view || (view = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), view;
!function(t) {
    var e = function(e) {
        function i() {
            return null !== e && e.apply(this, arguments) || this
        }
        return __extends(i, e),
        i.play = function(e) {
            var i = this;
            app.Log.log("ActionHule play data:" + JSON.stringify(e)),
            e.doras && t.DesktopMgr.Inst.WhenDoras(e.doras, !1),
            t.DesktopMgr.Inst.gameing = !1,
            uiscript.UI_OtherPlayerInfo.Inst.close(),
            t.AudioMgr.StopMusic();
            var n = !1;
            Laya.timer.once(100, this, function() {
                var a = e.hules
                  , r = 0;
                if (a[0].zimo) {
                    for (var s = a[0].seat, o = [], l = 0; l < a[0].hand.length; l++)
                        o.push(mjcore.MJPai.Create(a[0].hand[l]));
                    o = o.sort(mjcore.MJPai.Distance),
                    uiscript.UI_Huleshow.Inst.showZimo([t.DesktopMgr.Inst.seat2LocalPosition(s)]),
                    r += 1400,
                    (a[0].title && "" != a[0].title || a[0].title_id) && (Laya.timer.once(r, i, function() {
                        uiscript.UI_HuCutIn.show(t.DesktopMgr.Inst.player_datas[s].avatar_id),
                        n = !0
                    }),
                    r += 2e3),
                    Laya.timer.once(r, i, function() {
                        s == t.DesktopMgr.Inst.seat && t.DesktopMgr.Inst.mainrole.HulePrepare(o, a[0].hu_tile, a[0].zimo),
                        t.DesktopMgr.Inst.players[t.DesktopMgr.Inst.seat2LocalPosition(s)].Hule(o, a[0].hu_tile, a[0].zimo, n)
                    }),
                    r += 2800,
                    s == t.DesktopMgr.Inst.seat && (uiscript.UI_TingPai.Inst.reset(),
                    uiscript.UI_TingPai.Inst.setZhengting(!1))
                } else {
                    Laya.timer.once(r, i, function() {
                        for (var e = [], i = 0; i < a.length; i++)
                            e.push(t.DesktopMgr.Inst.seat2LocalPosition(a[i].seat));
                        uiscript.UI_Huleshow.Inst.showRong(e)
                    }),
                    r += 1500;
                    for (var h = function(e) {
                        var s = a[e].seat;
                        (a[e].title && "" != a[e].title || a[e].title_id) && (Laya.timer.once(r, i, function() {
                            uiscript.UI_HuCutIn.show(t.DesktopMgr.Inst.player_datas[s].avatar_id),
                            n = !0
                        }),
                        r += 2e3)
                    }, l = 0; l < a.length; l++)
                        h(l);
                    for (l = 0; l < a.length; l++) {
                        if (a[l].seat == t.DesktopMgr.Inst.seat) {
                            for (var c = [], u = 0; u < a[l].hand.length; u++)
                                c.push(mjcore.MJPai.Create(a[l].hand[u]));
                            c = c.sort(mjcore.MJPai.Distance),
                            t.DesktopMgr.Inst.mainrole.HulePrepare(c, a[l].hu_tile, a[l].zimo)
                        }
                    }
                    Laya.timer.once(r, i, function() {
                        for (var e = "scene/effect_hupai_default.lh", i = -1, r = 0; r < a.length; r++) {
                            var s = a[r].seat;
                            if (-1 == i)
                                i = s;
                            else {
                                t.DesktopMgr.Inst.seat2LocalPosition(i) > t.DesktopMgr.Inst.seat2LocalPosition(s) && (i = s)
                            }
                        }
                        i >= 0 && (e = t.DesktopMgr.Inst.player_effects[i].effect_hupai),
                        t.DesktopMgr.Inst.ShowHuleEffect(t.DesktopMgr.Inst.lastqipai.model.transform.position, e);
                        for (r = 0; r < a.length; r++) {
                            for (var o = [], l = 0; l < a[r].hand.length; l++)
                                o.push(mjcore.MJPai.Create(a[r].hand[l]));
                            o = o.sort(mjcore.MJPai.Distance),
                            t.DesktopMgr.Inst.players[t.DesktopMgr.Inst.seat2LocalPosition(a[r].seat)].Hule(o, a[r].hu_tile, a[r].zimo, n),
                            a[r].seat == t.DesktopMgr.Inst.seat && (uiscript.UI_TingPai.Inst.reset(),
                            uiscript.UI_TingPai.Inst.setZhengting(!1))
                        }
                    }),
                    r += 2e3
                }
                for (l = 0; l < e.delta_scores.length; l++)
                    e.delta_scores[l] > 0 ? uiscript.UI_DesktopInfo.Inst.changeHeadEmo(l, "emoji_7", -1) : e.delta_scores[l] < 0 && uiscript.UI_DesktopInfo.Inst.changeHeadEmo(l, "emoji_8", -1);
                Laya.timer.once(r, i, function() {
                    uiscript.UIMgr.Inst.ShowWin(e, !1),
                    t.DesktopMgr.Inst.ActionRunComplete()
                })
            })
        }
        ,
        i.fastplay = function(e, i) {
            app.Log.log("ActionHule fastplay data:" + JSON.stringify(e)),
            t.AudioMgr.StopMusic(),
            e.doras && t.DesktopMgr.Inst.WhenDoras(e.doras, !1),
            t.DesktopMgr.Inst.gameing = !1,
            uiscript.UIMgr.Inst.ShowWin(e, !1)
        }
        ,
        i.record = function(t) {
            return this.play(t),
            1e5
        }
        ,
        i.fastrecord = function(t) {
            this.play(t)
        }
        ,
        i
    }(t.ActionBase);
    t.ActionHule = e
}(view || (view = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), view;
!function(t) {
    var e = function(e) {
        function i() {
            return null !== e && e.apply(this, arguments) || this
        }
        return __extends(i, e),
        i.play = function(e) {
            app.Log.log("ActionLiqi play data:" + JSON.stringify(e)),
            Laya.timer.once(300, this, function() {
                var i = e.seat
                  , n = e.score;
                t.DesktopMgr.Inst.players[t.DesktopMgr.Inst.seat2LocalPosition(i)].ShowLiqi(),
                t.DesktopMgr.Inst.players[t.DesktopMgr.Inst.seat2LocalPosition(i)].SetScore(n, t.DesktopMgr.Inst.mainrole.score),
                uiscript.UI_DesktopInfo.Inst.setLiqibang(e.liqibang)
            })
        }
        ,
        i.fastplay = function(e, i) {
            app.Log.log("ActionLiqi fastplay data:" + JSON.stringify(e));
            var n = e.seat
              , a = e.score;
            t.DesktopMgr.Inst.players[t.DesktopMgr.Inst.seat2LocalPosition(n)].ShowLiqi(!1),
            t.DesktopMgr.Inst.players[t.DesktopMgr.Inst.seat2LocalPosition(n)].SetScore(a, t.DesktopMgr.Inst.mainrole.score),
            uiscript.UI_DesktopInfo.Inst.setLiqibang(e.liqibang)
        }
        ,
        i.record = function(t) {
            return app.Log.log("ActionLiqi record data:" + JSON.stringify(t)),
            this.play(t),
            0
        }
        ,
        i.fastrecord = function(e) {
            app.Log.log("ActionLiqi fastrecord data:" + JSON.stringify(e));
            var i = e.seat
              , n = e.score;
            t.DesktopMgr.Inst.players[t.DesktopMgr.Inst.seat2LocalPosition(i)].ShowLiqi(!1),
            t.DesktopMgr.Inst.players[t.DesktopMgr.Inst.seat2LocalPosition(i)].SetScore(n, t.DesktopMgr.Inst.mainrole.score),
            uiscript.UI_DesktopInfo.Inst.setLiqibang(e.liqibang)
        }
        ,
        i
    }(t.ActionBase);
    t.ActionLiqi = e
}(view || (view = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), view;
!function(t) {
    var e = function(e) {
        function i() {
            return null !== e && e.apply(this, arguments) || this
        }
        return __extends(i, e),
        i.play = function(e) {
            var i = this;
            app.Log.log("ActionLiuJu play data:" + JSON.stringify(e)),
            t.DesktopMgr.Inst.gameing = !1,
            uiscript.UI_OtherPlayerInfo.Inst.close();
            var n = 0;
            if (e.liqi ? (n = 1e3,
            t.ActionLiqi.play(e.liqi)) : n = 500,
            e.type == mjcore.E_LiuJu.sanjiahule) {
                t.AudioMgr.StopMusic();
                var a = e.seat;
                Laya.timer.once(n, this, function() {
                    for (var e = [], i = 0; i < 4; i++)
                        t.DesktopMgr.Inst.localPosition2Seat(i) != a && e.push(i);
                    uiscript.UI_Huleshow.Inst.showRong(e)
                }),
                n += 1500,
                Laya.timer.once(n, this, function() {
                    for (var i = 0; i < e.allplayertiles.length; i++)
                        if (i != a) {
                            for (var n = e.allplayertiles[i].split("|"), r = [], s = 0; s < n.length; s++)
                                r.push(mjcore.MJPai.Create(n[s]));
                            r = r.sort(mjcore.MJPai.Distance),
                            t.DesktopMgr.Inst.players[t.DesktopMgr.Inst.seat2LocalPosition(i)].Huangpai(!0, r, !1)
                        }
                }),
                n += 1e3,
                Laya.timer.once(n, this, function() {
                    uiscript.UIMgr.Inst.ShowLiuJu(e),
                    t.DesktopMgr.Inst.ActionRunComplete()
                })
            } else
                Laya.timer.once(n, this, function() {
                    t.AudioMgr.StopMusic();
                    var n = 500;
                    if (e.type == mjcore.E_LiuJu.jiuzhongjiupai) {
                        for (var a = e.seat, r = e.tiles, s = [], o = 0; o < r.length; o++)
                            s.push(mjcore.MJPai.Create(r[o]));
                        s = s.sort(mjcore.MJPai.Distance),
                        t.DesktopMgr.Inst.players[t.DesktopMgr.Inst.seat2LocalPosition(a)].Huangpai(!0, s, !1)
                    }
                    if (e.type == mjcore.E_LiuJu.sijializhi && e.allplayertiles && e.allplayertiles.length > 0) {
                        for (var l = 0; l < e.allplayertiles.length; l++) {
                            for (var h = e.allplayertiles[l].split("|"), s = [], o = 0; o < h.length; o++)
                                s.push(mjcore.MJPai.Create(h[o]));
                            s = s.sort(mjcore.MJPai.Distance),
                            t.DesktopMgr.Inst.players[t.DesktopMgr.Inst.seat2LocalPosition(l)].Huangpai(!0, s, !1)
                        }
                        n = 1e3
                    }
                    Laya.timer.once(n, i, function() {
                        uiscript.UIMgr.Inst.ShowLiuJu(e),
                        t.DesktopMgr.Inst.ActionRunComplete()
                    })
                })
        }
        ,
        i.fastplay = function(e, i) {
            app.Log.log("ActionLiuJu fastplay data:" + JSON.stringify(e)),
            t.AudioMgr.StopMusic(),
            t.DesktopMgr.Inst.gameing = !1,
            uiscript.UI_OtherPlayerInfo.Inst.close();
            if (e.liqi && t.ActionLiqi.fastplay(e.liqi, 0),
            e.type == mjcore.E_LiuJu.jiuzhongjiupai) {
                for (var n = e.seat, a = e.tiles, r = [], s = 0; s < a.length; s++)
                    r.push(mjcore.MJPai.Create(a[s]));
                r = r.sort(mjcore.MJPai.Distance),
                t.DesktopMgr.Inst.players[t.DesktopMgr.Inst.seat2LocalPosition(n)].Huangpai(!0, r, !0)
            }
            if (e.type == mjcore.E_LiuJu.sanjiahule)
                for (var n = e.seat, o = 0; o < e.allplayertiles.length; o++)
                    if (o != n) {
                        for (var l = e.allplayertiles[o].split("|"), r = [], s = 0; s < l.length; s++)
                            r.push(mjcore.MJPai.Create(l[s]));
                        r = r.sort(mjcore.MJPai.Distance),
                        t.DesktopMgr.Inst.players[t.DesktopMgr.Inst.seat2LocalPosition(o)].Huangpai(!0, r, !1)
                    }
            uiscript.UIMgr.Inst.ShowLiuJu(e)
        }
        ,
        i.record = function(t) {
            return app.Log.log("ActionLiuJu record data:" + JSON.stringify(t)),
            this.play(t),
            4e3
        }
        ,
        i.fastrecord = function(t) {
            this.play(t)
        }
        ,
        i
    }(t.ActionBase);
    t.ActionLiuJu = e
}(view || (view = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), view;
!function(t) {
    var e = function(e) {
        function i() {
            return null !== e && e.apply(this, arguments) || this
        }
        return __extends(i, e),
        i.play = function(e) {
            var i = this;
            app.Log.log("ActionNewRound play data:" + JSON.stringify(e)),
            t.AudioMgr.PlayMusic("music/game.mp3"),
            t.DesktopMgr.Inst.index_change = e.chang,
            t.DesktopMgr.Inst.index_ju = e.ju,
            t.DesktopMgr.Inst.index_ben = e.ben,
            t.DesktopMgr.Inst.index_player = e.ju,
            t.DesktopMgr.Inst.gameing = !0,
            t.DesktopMgr.Inst.left_tile_count = 69,
            t.DesktopMgr.Inst.rule_mode == t.ERuleMode.Liqi4 ? t.DesktopMgr.Inst.left_tile_count = 69 : (t.DesktopMgr.Inst.rule_mode = t.ERuleMode.Liqi3) && (t.DesktopMgr.Inst.left_tile_count = 50),
            e.left_tile_count && (t.DesktopMgr.Inst.left_tile_count = e.left_tile_count),
            t.DesktopMgr.Inst.waiting_lingshang_deal_tile = !1,
            t.DesktopMgr.Inst.setAutoHule(!1),
            t.DesktopMgr.Inst.setAutoMoQie(!1),
            t.DesktopMgr.Inst.setAutoNoFulu(!1),
            uiscript.UI_DesktopInfo.Inst.resetFunc(),
            uiscript.UI_TingPai.Inst.reset(),
            t.DesktopMgr.Inst.SetChangJuShow(t.DesktopMgr.Inst.index_change, t.DesktopMgr.Inst.index_ju),
            uiscript.UI_DesktopInfo.Inst.setBen(t.DesktopMgr.Inst.index_ben),
            uiscript.UI_DesktopInfo.Inst.setZhenting(!1),
            uiscript.UI_DesktopInfo.Inst.reset_rounds(),
            uiscript.UI_DesktopInfo.Inst.setLiqibang(e.liqibang);
            for (var n = 0; n < 4; n++)
                t.DesktopMgr.Inst.players[n].Reset(),
                t.DesktopMgr.Inst.players[n].setSeat(t.DesktopMgr.Inst.localPosition2Seat(n));
            t.DesktopMgr.Inst.RefreshPlayerIndicator(),
            t.DesktopMgr.Inst.RefreshPaiLeft(),
            t.DesktopMgr.Inst.setScores(e.scores),
            t.DesktopMgr.Inst.md5 = e.md5,
            t.DesktopMgr.Inst.choosed_pai = null,
            t.DesktopMgr.Inst.dora = [];
            var a = !1;
            void 0 != e.al && null != e.al && (a = e.al),
            a && uiscript.UI_AL.Show(),
            Laya.timer.once(a ? 1300 : 0, this, function() {
                for (var n = [], a = 0; a < e.tiles.length; a++)
                    n.push(mjcore.MJPai.Create(e.tiles[a]));
                t.DesktopMgr.Inst.mainrole.NewGame(n, !1);
                for (a = 1; a < 4; a++) {
                    var r = t.DesktopMgr.Inst.localPosition2Seat(a);
                    -1 != r && t.DesktopMgr.Inst.players[a].NewGame(13 + (r == t.DesktopMgr.Inst.index_ju ? 1 : 0), !1)
                }
                Laya.timer.once(1200, i, function() {
                    e.dora && "" != e.dora && (t.DesktopMgr.Inst.dora.push(mjcore.MJPai.Create(e.dora)),
                    uiscript.UI_DesktopInfo.Inst.setDora(0, t.DesktopMgr.Inst.dora[0]));
                    for (var i = 0; i < 4; i++)
                        t.DesktopMgr.Inst.players[i].OnDoraRefresh();
                    if (t.DesktopMgr.Inst.index_ju == t.DesktopMgr.Inst.seat) {
                        n = {
                            tingpais: e.tingpais0
                        };
                        uiscript.UI_TingPai.Inst.setData0(n)
                    } else {
                        var n = {
                            tingpais: e.tingpais1
                        };
                        uiscript.UI_TingPai.Inst.setData1(n)
                    }
                    t.DesktopMgr.Inst.ActionRunComplete()
                }),
                void 0 != e.operation && Laya.timer.once(1e3, i, function() {
                    t.ActionOperation.play(e.operation)
                })
            }),
            t.DesktopMgr.Inst.fetchLinks()
        }
        ,
        i.fastplay = function(e, i) {
            app.Log.log("ActionNewRound fastplay data:" + JSON.stringify(e) + " usetime:" + i),
            t.DesktopMgr.Inst.index_change = e.chang,
            t.DesktopMgr.Inst.index_ju = e.ju,
            t.DesktopMgr.Inst.index_ben = e.ben,
            t.DesktopMgr.Inst.index_player = e.ju,
            t.DesktopMgr.Inst.gameing = !0,
            t.DesktopMgr.Inst.left_tile_count = 69,
            t.DesktopMgr.Inst.rule_mode == t.ERuleMode.Liqi4 ? t.DesktopMgr.Inst.left_tile_count = 69 : (t.DesktopMgr.Inst.rule_mode = t.ERuleMode.Liqi3) && (t.DesktopMgr.Inst.left_tile_count = 50),
            e.left_tile_count && (t.DesktopMgr.Inst.left_tile_count = e.left_tile_count),
            t.DesktopMgr.Inst.waiting_lingshang_deal_tile = !1,
            t.DesktopMgr.Inst.setAutoHule(!1),
            t.DesktopMgr.Inst.setAutoMoQie(!1),
            t.DesktopMgr.Inst.setAutoNoFulu(!1),
            uiscript.UI_DesktopInfo.Inst.resetFunc(),
            uiscript.UI_TingPai.Inst.reset(),
            t.DesktopMgr.Inst.SetChangJuShow(t.DesktopMgr.Inst.index_change, t.DesktopMgr.Inst.index_ju),
            uiscript.UI_DesktopInfo.Inst.setBen(t.DesktopMgr.Inst.index_ben),
            uiscript.UI_DesktopInfo.Inst.setZhenting(!1),
            uiscript.UI_DesktopInfo.Inst.reset_rounds(),
            uiscript.UI_DesktopInfo.Inst.setLiqibang(e.liqibang);
            for (a = 0; a < 4; a++)
                t.DesktopMgr.Inst.players[a].Reset(),
                t.DesktopMgr.Inst.players[a].setSeat(t.DesktopMgr.Inst.localPosition2Seat(a));
            t.DesktopMgr.Inst.RefreshPlayerIndicator(),
            t.DesktopMgr.Inst.RefreshPaiLeft(),
            t.DesktopMgr.Inst.setScores(e.scores),
            t.DesktopMgr.Inst.md5 = e.md5,
            t.DesktopMgr.Inst.choosed_pai = null,
            t.DesktopMgr.Inst.dora = [];
            for (var n = [], a = 0; a < e.tiles.length; a++)
                n.push(mjcore.MJPai.Create(e.tiles[a]));
            t.DesktopMgr.Inst.mainrole.NewGame(n, !0);
            for (a = 1; a < 4; a++) {
                var r = t.DesktopMgr.Inst.localPosition2Seat(a);
                -1 != r && t.DesktopMgr.Inst.players[a].NewGame(13 + (r == t.DesktopMgr.Inst.index_ju ? 1 : 0), !0)
            }
            e.dora && "" != e.dora && (t.DesktopMgr.Inst.dora.push(mjcore.MJPai.Create(e.dora)),
            uiscript.UI_DesktopInfo.Inst.setDora(0, t.DesktopMgr.Inst.dora[0]));
            for (a = 0; a < 4; a++)
                t.DesktopMgr.Inst.players[a].OnDoraRefresh();
            if (t.DesktopMgr.Inst.index_ju == t.DesktopMgr.Inst.seat) {
                s = {
                    tingpais: e.tingpais0
                };
                uiscript.UI_TingPai.Inst.setData0(s)
            } else {
                var s = {
                    tingpais: e.tingpais1
                };
                uiscript.UI_TingPai.Inst.setData1(s)
            }
            e.operation && -1 != i && Laya.timer.once(100, this, function() {
                t.ActionOperation.play(e.operation, i + 100)
            })
        }
        ,
        i.record = function(e, i) {
            void 0 === i && (i = 0),
            app.Log.log("ActionNewRound record data:" + JSON.stringify(e)),
            t.DesktopMgr.Inst.ClearOperationShow(),
            t.AudioMgr.PlayMusic("music/game.mp3"),
            t.DesktopMgr.Inst.index_change = e.chang,
            t.DesktopMgr.Inst.index_ju = e.ju,
            t.DesktopMgr.Inst.index_ben = e.ben,
            t.DesktopMgr.Inst.index_player = e.ju,
            t.DesktopMgr.Inst.gameing = !0,
            t.DesktopMgr.Inst.left_tile_count = 69,
            t.DesktopMgr.Inst.rule_mode == t.ERuleMode.Liqi4 ? t.DesktopMgr.Inst.left_tile_count = 69 : (t.DesktopMgr.Inst.rule_mode = t.ERuleMode.Liqi3) && (t.DesktopMgr.Inst.left_tile_count = 50),
            e.left_tile_count && (t.DesktopMgr.Inst.left_tile_count = e.left_tile_count),
            t.DesktopMgr.Inst.waiting_lingshang_deal_tile = !1,
            t.DesktopMgr.Inst.tingpais = [[], [], [], []],
            uiscript.UI_TingPai.Inst.reset(),
            uiscript.UI_Replay.Inst.reset(),
            t.DesktopMgr.Inst.SetChangJuShow(t.DesktopMgr.Inst.index_change, t.DesktopMgr.Inst.index_ju),
            uiscript.UI_DesktopInfo.Inst.setBen(t.DesktopMgr.Inst.index_ben),
            uiscript.UI_DesktopInfo.Inst.setZhenting(!1),
            uiscript.UI_DesktopInfo.Inst.setLiqibang(e.liqibang);
            for (s = 0; s < 4; s++)
                t.DesktopMgr.Inst.players[s].setSeat(t.DesktopMgr.Inst.localPosition2Seat(s));
            t.DesktopMgr.Inst.RefreshPlayerIndicator(),
            t.DesktopMgr.Inst.RefreshPaiLeft(),
            t.DesktopMgr.Inst.choosed_pai = null,
            t.DesktopMgr.Inst.dora = [],
            t.AudioMgr.PlayAudio(216);
            for (s = 0; s < 4; s++) {
                var n = []
                  , a = "tiles" + s.toString();
                if (e[a] && e[a].length > 0) {
                    for (var r = 0; r < e[a].length; r++)
                        n.push(mjcore.MJPai.Create(e[a][r]));
                    s == t.DesktopMgr.Inst.seat ? t.DesktopMgr.Inst.mainrole.RecordNewGame(n) : t.DesktopMgr.Inst.players[t.DesktopMgr.Inst.seat2LocalPosition(s)].RecordNewGame(n)
                }
            }
            t.DesktopMgr.Inst.setScores(e.scores),
            t.DesktopMgr.Inst.md5 = e.md5,
            uiscript.UI_DesktopInfo.Inst.reset_rounds(),
            e.dora && "" != e.dora && (t.DesktopMgr.Inst.dora.push(mjcore.MJPai.Create(e.dora)),
            uiscript.UI_DesktopInfo.Inst.setDora(0, t.DesktopMgr.Inst.dora[0]));
            for (s = 0; s < 4; s++)
                t.DesktopMgr.Inst.players[s].OnDoraRefresh();
            if (e.tingpai)
                for (var s = 0; s < e.tingpai.length; s++)
                    e.tingpai[s].seat != t.DesktopMgr.Inst.index_ju && t.DesktopMgr.Inst.setTingpai(e.tingpai[s].seat, e.tingpai[s].tingpais1);
            return t.DesktopMgr.Inst.mode == t.EMJMode.paipu && (e.paishan ? (uiscript.UI_Replay.Inst.page_paishan.setTiles(e.paishan),
            uiscript.UI_Replay.Inst.page_paishan.refresh()) : uiscript.UI_Replay.Inst.page_paishan.setNoInfo()),
            t.DesktopMgr.Inst.mode == t.EMJMode.live_broadcast && e.operation && t.ActionOperation.ob(e.operation, i, 1e3),
            300
        }
        ,
        i.fastrecord = function(e, i) {
            void 0 === i && (i = -1),
            app.Log.log("ActionNewRound fastrecord data:" + JSON.stringify(e)),
            t.AudioMgr.PlayMusic("music/game.mp3"),
            t.DesktopMgr.Inst.ClearOperationShow(),
            t.DesktopMgr.Inst.index_change = e.chang,
            t.DesktopMgr.Inst.index_ju = e.ju,
            t.DesktopMgr.Inst.index_ben = e.ben,
            t.DesktopMgr.Inst.index_player = e.ju,
            t.DesktopMgr.Inst.gameing = !0,
            t.DesktopMgr.Inst.left_tile_count = 69,
            t.DesktopMgr.Inst.rule_mode == t.ERuleMode.Liqi4 ? t.DesktopMgr.Inst.left_tile_count = 69 : (t.DesktopMgr.Inst.rule_mode = t.ERuleMode.Liqi3) && (t.DesktopMgr.Inst.left_tile_count = 50),
            e.left_tile_count && (t.DesktopMgr.Inst.left_tile_count = e.left_tile_count),
            t.DesktopMgr.Inst.waiting_lingshang_deal_tile = !1,
            t.DesktopMgr.Inst.tingpais = [[], [], [], []],
            uiscript.UI_TingPai.Inst.reset(),
            uiscript.UI_Replay.Inst.reset(),
            t.DesktopMgr.Inst.SetChangJuShow(t.DesktopMgr.Inst.index_change, t.DesktopMgr.Inst.index_ju),
            uiscript.UI_DesktopInfo.Inst.setBen(t.DesktopMgr.Inst.index_ben),
            uiscript.UI_DesktopInfo.Inst.setZhenting(!1),
            uiscript.UI_DesktopInfo.Inst.setLiqibang(e.liqibang);
            for (s = 0; s < 4; s++)
                t.DesktopMgr.Inst.players[s].setSeat(t.DesktopMgr.Inst.localPosition2Seat(s));
            t.DesktopMgr.Inst.RefreshPlayerIndicator(),
            t.DesktopMgr.Inst.RefreshPaiLeft(),
            t.DesktopMgr.Inst.choosed_pai = null,
            t.DesktopMgr.Inst.dora = [];
            for (s = 0; s < 4; s++) {
                var n = []
                  , a = "tiles" + s.toString();
                if (e[a] && e[a].length > 0) {
                    for (var r = 0; r < e[a].length; r++)
                        n.push(mjcore.MJPai.Create(e[a][r]));
                    s == t.DesktopMgr.Inst.seat ? t.DesktopMgr.Inst.mainrole.RecordNewGame(n) : t.DesktopMgr.Inst.players[t.DesktopMgr.Inst.seat2LocalPosition(s)].RecordNewGame(n)
                }
            }
            t.DesktopMgr.Inst.setScores(e.scores),
            t.DesktopMgr.Inst.md5 = e.md5,
            uiscript.UI_DesktopInfo.Inst.reset_rounds(),
            e.dora && "" != e.dora && (t.DesktopMgr.Inst.dora.push(mjcore.MJPai.Create(e.dora)),
            uiscript.UI_DesktopInfo.Inst.setDora(0, t.DesktopMgr.Inst.dora[0]));
            for (s = 0; s < 4; s++)
                t.DesktopMgr.Inst.players[s].OnDoraRefresh();
            if (e.tingpai)
                for (var s = 0; s < e.tingpai.length; s++)
                    e.tingpai[s].seat != t.DesktopMgr.Inst.index_ju && t.DesktopMgr.Inst.setTingpai(e.tingpai[s].seat, e.tingpai[s].tingpais1);
            t.DesktopMgr.Inst.mode == t.EMJMode.paipu && (e.paishan ? (uiscript.UI_Replay.Inst.page_paishan.setTiles(e.paishan),
            uiscript.UI_Replay.Inst.page_paishan.refresh()) : uiscript.UI_Replay.Inst.page_paishan.setNoInfo()),
            t.DesktopMgr.Inst.mode == t.EMJMode.live_broadcast && i >= 0 && e.operation && t.ActionOperation.ob(e.operation, i, 1e3)
        }
        ,
        i
    }(t.ActionBase);
    t.ActionNewRound = e
}(view || (view = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), view;
!function(t) {
    var e = function(e) {
        function i() {
            return null !== e && e.apply(this, arguments) || this
        }
        return __extends(i, e),
        i.play = function(e) {
            var i = this;
            app.Log.log("ActionNewRound play data:" + JSON.stringify(e));
            for (var n = 0, a = 1; a < 4; a++) {
                var r = t.DesktopMgr.Inst.players[a].discardcd - Laya.timer.currTimer;
                r > n && (n = r)
            }
            Laya.timer.once(n, this, function() {
                t.AudioMgr.StopMusic();
                var n = e.players;
                t.DesktopMgr.Inst.gameing = !1,
                uiscript.UI_OtherPlayerInfo.Inst.close(),
                uiscript.UI_TingPai.Inst.reset(),
                uiscript.UI_TingPai.Inst.setZhengting(!1);
                for (var a = 0; a < n.length; a++) {
                    for (var r = [], s = 0; s < n[a].hand.length; s++)
                        r.push(mjcore.MJPai.Create(n[a].hand[s]));
                    r = r.sort(mjcore.MJPai.Distance),
                    t.DesktopMgr.Inst.players[t.DesktopMgr.Inst.seat2LocalPosition(a)].Huangpai(n[a].tingpai, r, !1)
                }
                Laya.timer.once(1e3, i, function() {
                    uiscript.UI_Huleshow.Inst.showLiuJu(n)
                }),
                Laya.timer.once(6e3, i, function() {
                    if (e.liujumanguan)
                        uiscript.UIMgr.Inst.ShowWin(e.scores, !0);
                    else {
                        var i = [];
                        if (e.scores && e.scores.length > 0) {
                            for (a = 0; a < t.DesktopMgr.Inst.player_count; a++)
                                i.push({
                                    old_score: e.scores[0].old_scores[a],
                                    delta: 0
                                });
                            for (a = 0; a < e.scores.length; a++)
                                if (e.scores[a].hasOwnProperty("delta_scores"))
                                    for (var n = 0; n < t.DesktopMgr.Inst.player_count && n < e.scores[a].delta_scores.length; n++)
                                        i[n].delta += e.scores[a].delta_scores[n]
                        } else
                            for (var a = 0; a < t.DesktopMgr.Inst.player_count; a++)
                                i.push({
                                    old_score: t.DesktopMgr.Inst.players[t.DesktopMgr.Inst.seat2LocalPosition(a)].score,
                                    delta: 0
                                });
                        uiscript.UI_ScoreChange.Inst.show(i)
                    }
                    t.DesktopMgr.Inst.ActionRunComplete()
                })
            })
        }
        ,
        i.fastplay = function(e, i) {
            app.Log.log("ActionNewRound fastplay data:" + JSON.stringify(e));
            t.AudioMgr.StopMusic();
            var n = e.players;
            t.DesktopMgr.Inst.gameing = !1,
            uiscript.UI_OtherPlayerInfo.Inst.close();
            var a = [!1, !1, !1, !1];
            uiscript.UI_TingPai.Inst.reset(),
            uiscript.UI_TingPai.Inst.setZhengting(!1);
            for (l = 0; l < t.DesktopMgr.Inst.player_count; l++) {
                for (var r = [], s = 0; s < n[l].hand.length; s++)
                    r.push(mjcore.MJPai.Create(n[l].hand[s]));
                r = r.sort(mjcore.MJPai.Distance),
                t.DesktopMgr.Inst.players[t.DesktopMgr.Inst.seat2LocalPosition(l)].Huangpai(n[l].tingpai, r, !0),
                a[t.DesktopMgr.Inst.seat2LocalPosition(l)] = n[l].tingpai
            }
            if (e.liujumanguan)
                uiscript.UIMgr.Inst.ShowWin(e.scores, !0);
            else {
                var o = [];
                if (e.scores && e.scores.length > 0) {
                    for (l = 0; l < t.DesktopMgr.Inst.player_count; l++)
                        o.push({
                            old_score: e.scores[0].old_scores[l],
                            delta: 0
                        });
                    for (l = 0; l < e.scores.length; l++)
                        if (e.scores[l].hasOwnProperty("delta_scores"))
                            for (s = 0; s < t.DesktopMgr.Inst.player_count && s < e.scores[l].delta_scores.length; s++)
                                o[s].delta += e.scores[l].delta_scores[s]
                } else
                    for (var l = 0; l < t.DesktopMgr.Inst.player_count; l++)
                        o.push({
                            old_score: t.DesktopMgr.Inst.players[t.DesktopMgr.Inst.seat2LocalPosition(l)].score,
                            delta: 0
                        });
                uiscript.UI_ScoreChange.Inst.show(o)
            }
        }
        ,
        i.record = function(t) {
            return app.Log.log("ActionNewRound record data:" + JSON.stringify(t)),
            this.play(t),
            8e3
        }
        ,
        i.fastrecord = function(t) {
            this.play(t)
        }
        ,
        i
    }(t.ActionBase);
    t.ActionNoTile = e
}(view || (view = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), view;
!function(t) {
    var e = function(e) {
        function i() {
            return null !== e && e.apply(this, arguments) || this
        }
        return __extends(i, e),
        i.play = function(e, i) {
            void 0 === i && (i = 0),
            app.Log.log("ActionOperation play data:" + JSON.stringify(e) + " usetime:" + i);
            try {
                if (e) {
                    t.DesktopMgr.Inst.mainrole.can_discard = !1;
                    var n = e.operation_list;
                    if (null == n || 0 == n.length)
                        return;
                    t.DesktopMgr.Inst.oplist = n;
                    var a = e.time_fixed
                      , r = e.time_add;
                    (a -= i) < 0 && (r += a,
                    a = 0,
                    r < 0 && (r = 0)),
                    app.Log.log("ActionOperation time_fixed:" + a + " time_add:" + r),
                    a + r >= 2e3 && t.DesktopMgr.Inst._PendingAuto() && uiscript.UI_DesktopInfo.Inst.showCountDown(a, r)
                }
            } catch (t) {
                var s = {};
                s.error = t.message,
                s.stack = t.stack,
                s.method = "play",
                s.name = "ActionOperation",
                GameMgr.Inst.onFatalError(s)
            }
        }
        ,
        i.ob = function(e, i, n) {
            void 0 === i && (i = 0),
            void 0 === n && (n = 0),
            app.Log.log("ActionOperation ob data:" + JSON.stringify(e) + " usetime:" + i);
            e.seat == t.DesktopMgr.Inst.seat && Laya.timer.once(n, this, function() {
                var t = e.time_fixed
                  , n = e.time_add;
                if ((i -= 300) < 0 && (i = 0),
                (t -= i) < 0 && (n += t,
                t = 0,
                n < 0 && (n = 0)),
                t + n >= 2e3) {
                    for (var a = !1, r = !1, s = !1, o = e.operation_list, l = 0; l < o.length; l++) {
                        switch (o[l].type) {
                        case mjcore.E_PlayOperation.eat:
                        case mjcore.E_PlayOperation.peng:
                        case mjcore.E_PlayOperation.ming_gang:
                        case mjcore.E_PlayOperation.rong:
                            a = !0;
                            break;
                        case mjcore.E_PlayOperation.an_gang:
                        case mjcore.E_PlayOperation.add_gang:
                        case mjcore.E_PlayOperation.liqi:
                        case mjcore.E_PlayOperation.zimo:
                            r = !0;
                        case mjcore.E_PlayOperation.jiuzhongjiupai:
                            r = !0
                        }
                        o[l].type != mjcore.E_PlayOperation.dapai && o[l].type != mjcore.E_PlayOperation.liqi || (s = !0)
                    }
                    r && uiscript.UIMgr.Inst.ShowLiqiZimo(o),
                    a && uiscript.UIMgr.Inst.ShowChipenghu(o),
                    (a || r || s) && uiscript.UI_DesktopInfo.Inst.showCountDown(t, n)
                }
            })
        }
        ,
        i
    }(t.ActionBase);
    t.ActionOperation = e
}(view || (view = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), view;
!function(t) {
    t.PAIMODEL_HEIGHT = .043225 * .94,
    t.PAIMODEL_WIDTH = .032775 * .94,
    t.PAIMODEL_THICKNESS = .0235 * .95 * .94,
    t.PAI_COUNT = 136;
    var e;
    !function(t) {
        t[t.NULL = 0] = "NULL",
        t[t.AUTH = 1] = "AUTH",
        t[t.SYNCING = 2] = "SYNCING",
        t[t.READY = 3] = "READY"
    }(e = t.ELink_State || (t.ELink_State = {}));
    var i;
    !function(t) {
        t[t.Liqi4 = 0] = "Liqi4",
        t[t.Liqi3 = 1] = "Liqi3"
    }(i = t.ERuleMode || (t.ERuleMode = {}));
    var n;
    !function(t) {
        t[t.play = 0] = "play",
        t[t.paipu = 1] = "paipu",
        t[t.live_broadcast = 2] = "live_broadcast"
    }(n = t.EMJMode || (t.EMJMode = {}));
    var a = function(a) {
        function r() {
            var e = a.call(this) || this;
            return e.rule_mode = i.Liqi4,
            e.mode = n.play,
            e.active = !1,
            e.game_config = null,
            e.seat = 0,
            e.dora = [],
            e.players = null,
            e.mainrole = null,
            e.num_left_show = new Array,
            e.plane_chang = null,
            e.plane_ju = null,
            e.trans_container_effect = null,
            e.effect_pai_canchi = null,
            e.effect_dora3D = null,
            e.effect_doraPlane = null,
            e.effect_shadow = null,
            e.auto_hule = !1,
            e.auto_nofulu = !1,
            e.auto_moqie = !1,
            e.auto_liqi = !0,
            e.duringReconnect = !1,
            e.gameing = !1,
            e.lastpai_seat = 0,
            e.lastqipai = null,
            e.oplist = [],
            e.liqi_select = [],
            e.operation_showing = !1,
            e.myaccountid = 0,
            e.player_datas = [],
            e.player_effects = [],
            e.mjp_res_name = "",
            e.last_gang = 0,
            e.gameEndResult = null,
            e.levelchangeinfo = null,
            e.activity_reward = null,
            e.rewardinfo = null,
            e.choosed_pai = null,
            e.actionList = [],
            e.action_index = 0,
            e.current_step = 0,
            e.actionMap = null,
            e.tingpais = [],
            e.record_show_hand = !1,
            e.record_show_paopai = !1,
            e.ptchange = 0,
            e.waiting_lingshang_deal_tile = !1,
            e.md5 = "",
            e.paipu_config = 0,
            e.ai_level = 1,
            e.timestoped = !1,
            e.handles_after_timerun = [],
            e.doactioncd = 0,
            e.dochain_fast = !1,
            e.action_running = !1,
            e.hangupCount = 0,
            r.Inst = e,
            e.actionMap = {},
            e.actionMap.ActionMJStart = new Laya.Handler(e,function(t) {
                t.msg;
                return app.Log.log("ActionMJStart begin"),
                e.ClearOperationShow(),
                GameMgr.Inst.EnterMJ(),
                uiscript.UI_FightBegin.show(Laya.Handler.create(e, function() {
                    uiscript.UI_Loading.Inst.close(),
                    e.ActionRunComplete()
                })),
                2e3
            }
            ,null,!1),
            e.actionMap.ActionNewRound = new Laya.Handler(e,function(i) {
                app.Log.log("ActionNewRound begin");
                var n = i.msg
                  , a = i.fast;
                if (e.ClearOperationShow(),
                uiscript.UI_Loading.Inst.close(),
                GameMgr.Inst.EnterMJ(),
                a)
                    return uiscript.UI_FightBegin.hide(),
                    t.ActionNewRound.fastplay(n, -1),
                    0;
                var r = uiscript.UI_FightBegin.hide();
                return Laya.timer.once(r + 200, e, function() {
                    t.ActionNewRound.play(n)
                }),
                n.al && (r += 1300),
                r + 200 + 1200 + 400
            }
            ,null,!1),
            e.actionMap.ActionDiscardTile = new Laya.Handler(e,function(i) {
                e.ClearOperationShow();
                var n = i.msg;
                return i.fast ? (t.ActionDiscardTile.fastplay(n, -1),
                0) : (t.ActionDiscardTile.play(n),
                Laya.timer.once(500, e, e.ActionRunComplete),
                500)
            }
            ,null,!1),
            e.actionMap.ActionDealTile = new Laya.Handler(e,function(i) {
                e.ClearOperationShow();
                var n = i.msg;
                return i.fast ? (t.ActionDealTile.fastplay(n, -1),
                0) : (t.ActionDealTile.play(n),
                500)
            }
            ,null,!1),
            e.actionMap.ActionChiPengGang = new Laya.Handler(e,function(i) {
                e.ClearOperationShow();
                var n = i.msg;
                return i.fast ? (t.ActionChiPengGang.fastplay(n, -1),
                0) : (t.ActionChiPengGang.play(n),
                1100)
            }
            ,null,!1),
            e.actionMap.ActionAnGangAddGang = new Laya.Handler(e,function(i) {
                e.ClearOperationShow();
                var n = i.msg;
                return i.fast ? (t.ActionAnGangAddGang.fastplay(n, -1),
                0) : (t.ActionAnGangAddGang.play(n),
                1100)
            }
            ,null,!1),
            e.actionMap.ActionHule = new Laya.Handler(e,function(i) {
                e.ClearOperationShow();
                var n = i.msg;
                return t.ActionHule.play(n),
                5e3
            }
            ,null,!1),
            e.actionMap.ActionNoTile = new Laya.Handler(e,function(i) {
                e.ClearOperationShow();
                var n = i.msg;
                return t.ActionNoTile.play(n),
                5e3
            }
            ,null,!1),
            e.actionMap.ActionLiuJu = new Laya.Handler(e,function(i) {
                e.ClearOperationShow();
                var n = i.msg;
                return t.ActionLiuJu.play(n),
                5e3
            }
            ,null,!1),
            e.actionMap.ActionBaBei = new Laya.Handler(e,function(i) {
                e.ClearOperationShow();
                var n = i.msg;
                return i.fast ? (t.ActionBabei.fastplay(n, -1),
                0) : (t.ActionBabei.play(n),
                1e3)
            }
            ,null,!1),
            app.NetAgent.AddListener2MJ("NotifyGameEndResult", Laya.Handler.create(e, function(t) {
                e.gameEndResult = t.result
            })),
            app.NetAgent.AddListener2MJ("ActionPrototype", Laya.Handler.create(e, function(t) {
                if (app.Log.log("Receive Action: " + JSON.stringify(t)),
                e.duringReconnect)
                    e.actionList.push(t);
                else if (e.actionList.length > 0)
                    e.actionList.push(t);
                else {
                    e.actionList.push(t);
                    var i = e.doactioncd - Laya.timer.currTimer;
                    i < 0 && (i = 0),
                    e.StartChainAction(i)
                }
            })),
            app.NetAgent.AddListener2MJ("NotifyGameFinishReward", Laya.Handler.create(e, function(t) {
                app.Log.log("NotifyGameFinishReward: " + JSON.stringify(t)),
                e.levelchangeinfo = t.level_change,
                e.rewardinfo = t
            })),
            app.NetAgent.AddListener2MJ("NotifyActivityReward", Laya.Handler.create(e, function(t) {
                app.Log.log("NotifyActivityReward: " + JSON.stringify(t)),
                e.activity_reward = t
            })),
            app.NetAgent.AddListener2MJ("NotifyGameTerminate", Laya.Handler.create(e, function(t) {
                app.Log.log("NotifyGameTerminate:" + JSON.stringify(t)),
                "user-manual-terminate" != t.reason && uiscript.UI_SecondConfirm.Inst.show_only_confirm(game.Tools.strOfLocalization(2227), Laya.Handler.create(e, function() {
                    e.Reset(),
                    game.Scene_MJ.Inst.GameEnd()
                }))
            })),
            t.ModelAnimationController.init_data(),
            app.NetAgent.AddListener2MJ("NotifyGamePause", Laya.Handler.create(e, function(t) {
                app.Log.log("NotifyGamePause:" + JSON.stringify(t));
                var i = t.paused;
                e.setGameStop(i)
            })),
            e
        }
        return __extends(r, a),
        Object.defineProperty(r.prototype, "round_id", {
            get: function() {
                return this.index_change + "-" + this.index_ju + "-" + this.index_ben
            },
            enumerable: !0,
            configurable: !0
        }),
        Object.defineProperty(r.prototype, "main_role_character_info", {
            get: function() {
                return this.player_datas[this.seat].character
            },
            enumerable: !0,
            configurable: !0
        }),
        Object.defineProperty(r.prototype, "player_count", {
            get: function() {
                return this.rule_mode == i.Liqi3 ? 3 : 4
            },
            enumerable: !0,
            configurable: !0
        }),
        r.prototype.seat2LocalPosition = function(t) {
            if (this.rule_mode == i.Liqi3) {
                for (var e = this.seat, n = 0; n < 4; n++) {
                    if (t == e)
                        return n;
                    ++e >= 3 && (e = -1)
                }
                return 0
            }
            return (t - this.seat + 4) % 4
        }
        ,
        r.prototype.localPosition2Seat = function(t) {
            if (this.rule_mode == i.Liqi3) {
                for (var e = this.seat, n = 0; n < t; n++)
                    ++e >= 3 && (e = -1);
                return e
            }
            return (this.seat + t) % 4
        }
        ,
        r.prototype.getPlayerName = function(t) {
            return this.player_datas[t].nickname
        }
        ,
        Object.defineProperty(r.prototype, "showingPaopai", {
            get: function() {
                return this.mode != n.play
            },
            enumerable: !0,
            configurable: !0
        }),
        r.prototype.ActionRunComplete = function() {
            this.action_running = !1
        }
        ,
        r.prototype.StartChainAction = function(t) {
            this.doactioncd = Laya.timer.currTimer + t,
            Laya.timer.frameLoop(1, this, this.DoChainAction)
        }
        ,
        r.prototype.DoChainAction = function() {
            var t = this;
            if (this.action_index >= this.actionList.length)
                this.action_index = 0,
                this.actionList = [],
                this.dochain_fast = !1,
                Laya.timer.clear(this, this.DoChainAction),
                this.duringReconnect && (app.Log.log("finishSyncGame0"),
                app.NetAgent.sendReq2MJ("FastTest", "finishSyncGame", {}, function(t, e) {}),
                this.duringReconnect = !1);
            else {
                if (!this.dochain_fast) {
                    if (this.action_running)
                        return;
                    if (Laya.timer.currTimer <= this.doactioncd - Laya.timer.delta)
                        return;
                    Laya.timer.clear(this, this.DoChainAction)
                }
                this.action_index == this.actionList.length - 1 && this.duringReconnect && (this.duringReconnect = !1,
                app.Log.log("finishSyncGame1"),
                app.NetAgent.sendReq2MJ("FastTest", "finishSyncGame", {}, function(t, e) {})),
                this.dochain_fast ? this.action_index + 2 < this.actionList.length ? this.DoMJAction(this.actionList[this.action_index++], !0) : (this.dochain_fast = !1,
                this.DoMJAction(this.actionList[this.action_index++], !1)) : (this.dochain_fast = !1,
                this.action_index + 4 < this.actionList.length && (this.dochain_fast = !0),
                this.dochain_fast ? Laya.timer.once(800, this, function() {
                    for (var e = t.actionList.length - 1; e >= t.action_index; e--)
                        if ("ActionNewRound" == t.actionList[e].name) {
                            t.action_index = e;
                            break
                        }
                    t.DoMJAction(t.actionList[t.action_index++], !0)
                }) : this.DoMJAction(this.actionList[this.action_index++], !1))
            }
        }
        ,
        r.prototype.DoMJAction = function(t, e) {
            var i = this;
            if (this.active) {
                var n = net.ProtobufManager.lookupType("lq." + t.name);
                if (!n)
                    throw new Error("ERR_CANNOT_FIND_MESSAGE_TYPE, lq." + t.name);
                var a = t.step
                  , r = n.decode(t.data);
                if (app.Log.log("DoMJAction step:" + a + " [" + t.name + "]:  " + JSON.stringify(r) + " fast:" + e),
                a > 1 && a != this.current_step + 1)
                    return app.Log.log("step 不对 强制触发全数据重连 step:" + a + " current_step:" + this.current_step),
                    void this.trySyncGame();
                var s = 0;
                if (this.current_step = a,
                this.actionMap.hasOwnProperty(t.name))
                    try {
                        e || (this.action_running = !0),
                        s = this.actionMap[t.name].runWith({
                            msg: r,
                            fast: e
                        })
                    } catch (e) {
                        var o = {};
                        return o.error = e.message,
                        o.stack = e.stack,
                        o.method = "DoMJAction",
                        o.name = t.name,
                        o.data = t,
                        o.step = a,
                        void GameMgr.Inst.onFatalError(o)
                    }
                else
                    app.Log.Error("没有监听操作：" + t.name);
                e ? this.DoChainAction() : Laya.timer.frameOnce(1, this, function() {
                    i.StartChainAction(s)
                })
            }
        }
        ,
        r.prototype._load = function(e) {
            this.desktop3D = e,
            this.desktop3D.getChildByName("all").active = !1;
            var i = this.desktop3D.getChildByName("poss");
            this.players = new Array,
            this.mainrole = i.getChildByName("man_1").addComponent(t.ViewPlayer_Me),
            this.mainrole.Init(this, 0, game.Scene_MJ.Inst.root2.getChildByName("hands"), i.getChildByName("ming_1").getChildAt(0), i.getChildByName("hai_1").getChildAt(0), i.getChildByName("man_1"), i.getChildByName("babei_1").getChildAt(0)),
            this.mainrole.trans_hand3D = i.getChildByName("pai_1"),
            this.mainrole.trans_hand3D.getChildAt(0).active = !1,
            this.mainrole.trans_hand3D.active = !1,
            this.mainrole.trans_hand3DCover = i.getChildByName("pai_1_cover"),
            this.mainrole.trans_hand3DCover.getChildAt(0).active = !1,
            this.mainrole.trans_hand3DCover.active = !1,
            this.players.push(this.mainrole);
            for (var n = 2; n <= 4; n++) {
                var a = i.getChildByName("man_" + n).addComponent(t.ViewPlayer_Other);
                a.Init(this, n - 1, i.getChildByName("pai_" + n).getChildAt(0), i.getChildByName("ming_" + n).getChildAt(0), i.getChildByName("hai_" + n).getChildAt(0), i.getChildByName("man_" + n), i.getChildByName("babei_" + n).getChildAt(0)),
                this.players.push(a)
            }
            var r = this.desktop3D.getChildByName("other")
              , s = r.getChildByName("left");
            this.num_left_show.push(s.getChildByName("0")),
            this.num_left_show.push(s.getChildByName("1")),
            this.SetLeftPaiShow(0);
            var o = r.getChildByName("chang");
            this.plane_chang = o.getChildByName("chang"),
            this.plane_ju = o.getChildByName("ju"),
            this.SetChangJuShow(0, 0),
            this.trans_container_effect = this.desktop3D.getChildByName("effect"),
            this.effect_pai_canchi = this.trans_container_effect.getChildByName("effect_pai_canchi"),
            this.effect_dora3D = this.trans_container_effect.getChildByName("effect_dora"),
            this.effect_shadow = this.trans_container_effect.getChildByName("effect_shadow"),
            this.effect_pai_canchi.active = !0,
            this.effect_dora3D.active = !0,
            this.effect_shadow.active = !0,
            this.effect_doraPlane = game.Scene_MJ.Inst.root2.getChildByName("hands").getChildByName("effect_dora"),
            this.effect_doraPlane.active = !1
        }
        ,
        r.prototype.initRoom = function(e, a, s, o, l) {
            var h = this;
            uiscript.UI_WaitingRoom.Inst.resetData(),
            this.game_config = e,
            this.rule_mode = i.Liqi4,
            e.mode.mode && (e.mode.mode < 10 ? this.rule_mode = i.Liqi4 : this.rule_mode = i.Liqi3),
            this.mode = o,
            this.seat = -1,
            this.player_datas = a,
            this.gameEndResult = null,
            this.levelchangeinfo = null,
            this.activity_reward = null,
            this.rewardinfo = null,
            this.active = !0,
            this.ptchange = 0,
            this.paipu_config = 0,
            this.timestoped = !1,
            this.action_running = !1,
            this.hangupCount = 0,
            this.handles_after_timerun = [],
            uiscript.UI_GameStop.Inst.close(),
            this.mode == n.paipu ? this.record_show_hand = this.record_show_paopai = !0 : this.record_show_hand = this.record_show_paopai = !1,
            this.mode == n.play ? (uiscript.UI_Invite.Inst.enable = !1,
            4 == e.category && (GameMgr.Inst.custom_match_id = e.meta.customized_contest_uid)) : uiscript.UI_Invite.Inst.enable = !0,
            this.myaccountid = s;
            for (var c = {}, u = 0; u < a.length; u++)
                for (var _ = cfg.item_definition.skin.get(a[u].avatar_id), d = cfg.item_definition.character.get(_.character_id), f = cfg.voice.sound.getGroup(d.sound), p = 0; p < f.length; p++)
                    if (a[u].character && 2 == f[p].category && f[p].level_limit <= a[u].character.level) {
                        var m = f[p].path + t.AudioMgr.suffix;
                        c.hasOwnProperty(m) || (c[m] = 1)
                    }
            for (var g in c)
                Laya.loader.load(g, null, null, null, 3);
            for (u = 0; u < this.player_datas.length; u++)
                this.player_datas[u].account_id == s && (this.seat = u);
            if (-1 == this.seat) {
                if (this.mode == n.play)
                    return uiscript.UIMgr.Inst.ShowErrorInfo(game.Tools.strOfLocalization(2228)),
                    void app.Log.Error(JSON.stringify(a));
                this.seat = 0
            }
            if (uiscript.UI_Replay.Inst.enable = this.mode == n.paipu,
            r.bianjietishi = !0,
            o == n.play) {
                if (e.mode && e.mode.detail_rule) {
                    var y = e.mode.detail_rule;
                    null != y.bianjietishi && (r.bianjietishi = y.bianjietishi)
                }
                if (2 == e.category && e.meta) {
                    var v = cfg.desktop.matchmode.get(e.meta.mode_id);
                    v && 6 == v.room && (r.bianjietishi = !1)
                }
                uiscript.UI_MJTask_Progress.record()
            }
            this.mjp_res_name = game.GameUtility.get_common_view_res_name(game.ECommonView.mjp),
            this.player_effects = [];
            for (u = 0; u < this.player_datas.length; u++) {
                var b = this.player_datas[u].character;
                if (b) {
                    var x = b.views
                      , w = "scene/effect_hupai_default.lh"
                      , C = ""
                      , I = "scene/liqi_default.lh"
                      , S = "hand_human"
                      , T = "";
                    if (x)
                        for (p = 0; p < x.length; p++) {
                            var M = x[p].slot
                              , E = x[p].item_id;
                            if (M == game.EPlayerView.liqi_bgm) {
                                var L = cfg.item_definition.item.get(E);
                                L && (T = L.sargs[0])
                            } else {
                                var D = cfg.item_definition.view.get(E);
                                D && (M == game.EPlayerView.hupai_effect ? w = "scene/" + D.res_name + ".lh" : M == game.EPlayerView.liqi_effect ? C = "scene/" + D.res_name + ".lh" : M == game.EPlayerView.liqibang ? I = "scene/" + D.res_name + ".lh" : M == game.EPlayerView.hand_model && (S = D.res_name))
                            }
                        }
                    this.player_effects.push({
                        effect_hupai: w,
                        effect_liqi: C,
                        liqibang: I,
                        hand: S,
                        liqi_bgm: T
                    })
                } else
                    this.player_datas[u].character = {
                        charid: 200001,
                        level: 0,
                        exp: 0,
                        views: [],
                        skin: 400101,
                        is_upgraded: !1
                    },
                    this.player_effects.push({
                        effect_hupai: "scene/effect_hupai_default.lh",
                        effect_liqi: "",
                        liqibang: "scene/liqi_default.lh",
                        hand: "hand_human",
                        liqi_bgm: ""
                    })
            }
            uiscript.UI_DesktopInfo.Inst.initRoom(),
            uiscript.UI_DesktopInfo.Inst.refreshSeat(),
            uiscript.UI_Hangup_Warn.Inst.enable = !1,
            uiscript.UI_TingPai.Inst.enable = !0,
            this.index_change = 0,
            this.index_ju = 0,
            this.index_ben = 0,
            this.index_player = 0,
            this.gameing = !0,
            this.left_tile_count = 69,
            this.duringReconnect = !1,
            this.current_step = 0,
            this.action_index = 0,
            this.dochain_fast = !1,
            this.actionList = [],
            this.setAutoHule(!1),
            this.setAutoMoQie(!1),
            this.setAutoNoFulu(!1),
            uiscript.UI_DesktopInfo.Inst.resetFunc(),
            this.SetChangJuShow(this.index_change, this.index_ju),
            uiscript.UI_DesktopInfo.Inst.setBen(this.index_ben),
            uiscript.UI_DesktopInfo.Inst.setZhenting(!1);
            for (u = 0; u < 4; u++)
                this.players[u].onInitRoom(this.localPosition2Seat(u)),
                this.players[u].SetScore(0, 0),
                this.players[u].trans_ind.active = !1,
                this.players[u].RefreshDir();
            this.RefreshPaiLeft(),
            uiscript.UI_GameEnd.Inst.forceclose(),
            uiscript.UI_RankChange.Inst.close(),
            uiscript.UI_MJReward.Inst.close(),
            Laya.timer.frameOnce(6, this, function() {
                h.Reset(),
                app.Log.log("场景init结束：" + Laya.Stat.currentMemorySize / 1024 / 1024 + " MB"),
                l && l.run()
            })
        }
        ,
        r.prototype.changeMainbody = function(t) {
            if (this.mode != n.play) {
                this.seat = t,
                uiscript.UI_DesktopInfo.Inst.refreshSeat(!0);
                for (var e = 0; e < 4; e++)
                    this.players[e].onInitRoom(this.localPosition2Seat(e)),
                    this.players[e].trans_ind.active = !1,
                    this.players[e].RefreshDir();
                this.Reset(),
                this.mode == n.paipu && uiscript.UI_Replay.Inst.onChangeMainBody(),
                this.mode == n.live_broadcast && uiscript.UI_Live_Broadcast.Inst.onChangeMainbody()
            }
        }
        ,
        r.prototype.trySyncGame = function() {
            var t = this;
            this.Reset(),
            this.duringReconnect = !0,
            this.hangupCount = 0,
            app.NetAgent.sendReq2MJ("FastTest", "syncGame", {
                round_id: this.round_id,
                step: 0
            }, function(e, i) {
                e || i.error ? (uiscript.UIMgr.Inst.showNetReqError("syncGame", e, i),
                game.Scene_MJ.Inst.ForceOut()) : (app.Log.log("[syncGame2] " + JSON.stringify(i)),
                i.isEnd ? (uiscript.UIMgr.Inst.ShowErrorInfo(game.Tools.strOfLocalization(2229)),
                game.Scene_MJ.Inst.GameEnd()) : (t.fetchLinks(),
                t.Reset(),
                t.duringReconnect = !0,
                t.syncGameByStep(i.game_restore)))
            })
        }
        ,
        r.prototype.syncGameByStep = function(e) {
            var i = this
              , n = !1;
            if (this.timestoped = !1,
            this.handles_after_timerun = [],
            this.action_running = !1,
            uiscript.UI_GameStop.Inst.close(),
            this.hangupCount = 0,
            uiscript.UI_Hangup_Warn.Inst.enable = !1,
            e && 5 === e.game_state && (this.timestoped = !0),
            GameMgr.Inst.EnterMJ(),
            e && e.actions && e.actions.length > 0) {
                this.actionList = [];
                var a = -1;
                null != e.passed_waiting_time && void 0 != e.passed_waiting_time && (a = 1e3 * e.passed_waiting_time);
                for (var s = 0; s < e.actions.length; s++) {
                    var o = e.actions[s]
                      , l = s == e.actions.length - 1 ? a : -1
                      , h = net.ProtobufManager.lookupType("lq." + o.name);
                    if (!h)
                        throw new Error("ERR_CANNOT_FIND_MESSAGE_TYPE, lq." + o.name);
                    var c = h.decode(o.data);
                    this.current_step = o.step;
                    try {
                        switch (o.name) {
                        case "ActionNewRound":
                            t.ActionNewRound.fastplay(c, l);
                            break;
                        case "ActionDiscardTile":
                            t.ActionDiscardTile.fastplay(c, l);
                            break;
                        case "ActionDealTile":
                            t.ActionDealTile.fastplay(c, l);
                            break;
                        case "ActionChiPengGang":
                            t.ActionChiPengGang.fastplay(c, l);
                            break;
                        case "ActionAnGangAddGang":
                            t.ActionAnGangAddGang.fastplay(c, l);
                            break;
                        case "ActionHule":
                            t.ActionHule.fastplay(c, l),
                            n = !0;
                            break;
                        case "ActionLiuJu":
                            t.ActionLiuJu.fastplay(c, l),
                            n = !0;
                            break;
                        case "ActionNoTile":
                            t.ActionNoTile.fastplay(c, l),
                            n = !0;
                            break;
                        case "ActionBaBei":
                            t.ActionBabei.fastplay(c, l)
                        }
                    } catch (t) {
                        var u = {};
                        u.error = t.message,
                        u.stack = t.stack,
                        u.method = "syncGameByStep",
                        u.name = o.name,
                        u.data = o,
                        u.step = s,
                        GameMgr.Inst.onFatalError(u);
                        break
                    }
                }
                Laya.timer.once(1e3, this, function() {
                    i.duringReconnect = !1,
                    uiscript.UI_Loading.Inst.close(),
                    n || t.AudioMgr.PlayMusic("music/game.mp3"),
                    i.DoChainAction()
                })
            } else
                this.duringReconnect = !1,
                this.timestoped ? this.handles_after_timerun.push(Laya.Handler.create(this, function() {
                    app.NetAgent.sendReq2MJ("FastTest", "confirmNewRound", {}, function(t, e) {})
                })) : app.NetAgent.sendReq2MJ("FastTest", "confirmNewRound", {}, function(t, e) {});
            app.Log.log("finishSyncGame11"),
            app.NetAgent.sendReq2MJ("FastTest", "finishSyncGame", {}, function(t, e) {}),
            r.Inst.fetchLinks(),
            this.timestoped && uiscript.UI_GameStop.Inst.show()
        }
        ,
        r.prototype.setGameStop = function(t) {
            if (t != this.timestoped)
                if (this.timestoped = t,
                this.timestoped)
                    this.handles_after_timerun = [],
                    uiscript.UI_GameStop.Inst.show();
                else {
                    if (uiscript.UI_GameStop.Inst.close(),
                    this.handles_after_timerun)
                        for (var e = 0; e < this.handles_after_timerun.length; e++)
                            this.handles_after_timerun[e].run();
                    this.handles_after_timerun = [],
                    this.hangupCount = 0
                }
        }
        ,
        r.prototype.CreatePai3D = function(t) {
            var e = this.desktop3D.getChildByName("all").getChildByName("maque").clone()
              , i = this.desktop3D.getChildByName("all").getChildByName("maque_outline").clone()
              , n = e
              , a = new caps.BaseMaterial(caps.Cartoon.filename)
              , r = "scene/Assets/Resource/mjpai/";
            "en" == GameMgr.client_language && (r += "en/"),
            r += this.mjp_res_name + "/" + t.toString() + ".png",
            a.setTexture(caps.Cartoon.TEXTURE, Laya.loader.getRes(r)),
            a.setNumber(caps.Cartoon.SPLIT, .4),
            a.setColor(caps.Cartoon.COLOR_LIGHT, new Laya.Vector3(1,1,1)),
            a.setColor(caps.Cartoon.COLOR_UNLIGHT, new Laya.Vector3(.788,.788,.8235)),
            a.setColor(caps.Cartoon.COLOR, new Laya.Vector3(1,1,1)),
            n.meshRender.sharedMaterial = a;
            var s = i;
            e.addChild(s),
            s.transform.localPosition = new Laya.Vector3(0,0,0),
            s.transform.localScale = new Laya.Vector3(1,1,1),
            s.transform.localRotation = new Laya.Quaternion(0,0,0,0);
            var o = s
              , l = new caps.Material_Outline(caps.Outline.filename);
            return l.setColor(caps.Outline.OUTLINE_COLOR, new Laya.Vector3(.165,.192,.204)),
            l.setNumber(caps.Outline.OUTLINE_ALPHA, .6),
            l.setNumber(caps.Outline.OUTLINE, .0012),
            o.meshRender.sharedMaterial = l,
            e
        }
        ,
        r.prototype.RefreshPlayerIndicator = function() {
            for (var t = 0; t < 4; t++)
                this.players[t].trans_ind.active = t == this.seat2LocalPosition(this.index_player),
                this.players[t].RefreshScore(this.mainrole.score)
        }
        ,
        r.prototype.setAutoHule = function(t) {
            this.auto_hule = t,
            this._PendingAuto()
        }
        ,
        r.prototype.setAutoNoFulu = function(t) {
            this.auto_nofulu = t,
            this._PendingAuto()
        }
        ,
        r.prototype.setAutoMoQie = function(t) {
            this.auto_moqie = t,
            this._PendingAuto()
        }
        ,
        r.prototype.setAutoLiPai = function(t) {
            this.auto_liqi = t,
            t && this.gameing && this.mainrole && this.mainrole.LiPai()
        }
        ,
        r.prototype.setScoreDelta = function(t) {
            for (var e = 1; e < 4; e++)
                this.players[e].duringShowDetla = t,
                this.players[e].RefreshScore(this.mainrole.score)
        }
        ,
        r.prototype.SetChangJuShow = function(t, e) {
            var i = new Laya.Vector4(.2,1,t % 4 * .2,0);
            "en" == GameMgr.client_language && (i = new Laya.Vector4(1,.25,0,.25 * (t % 4 - 3))),
            this.plane_chang.meshRender.material.tilingOffset = i;
            var n = new Laya.Vector4(.25,1,.25 * e,0);
            this.plane_ju.meshRender.material.tilingOffset = n
        }
        ,
        r.prototype.SetLeftPaiShow = function(t) {
            t >= 100 ? t = 99 : t < 0 && (t = 0);
            for (var e = [t % 10, Math.floor(t / 10)], i = 0; i < e.length; i++) {
                var n = new Laya.Vector4(.1,1,.1 * e[i],0);
                this.num_left_show[i].meshRender.material.tilingOffset = n
            }
        }
        ,
        r.prototype.RefreshPaiLeft = function() {
            this.SetLeftPaiShow(this.left_tile_count)
        }
        ,
        r.prototype.Reset = function() {
            app.Log.log("DesktopMgr.Reset"),
            this.operation_showing = !1,
            this.oplist = [],
            Laya.timer.clearAll(t.ActionAnGangAddGang),
            Laya.timer.clearAll(t.ActionChiPengGang),
            Laya.timer.clearAll(t.ActionDealTile),
            Laya.timer.clearAll(t.ActionDiscardTile),
            Laya.timer.clearAll(t.ActionHule),
            Laya.timer.clearAll(t.ActionLiqi),
            Laya.timer.clearAll(t.ActionLiuJu),
            Laya.timer.clearAll(t.ActionNewRound),
            Laya.timer.clearAll(t.ActionNoTile),
            Laya.timer.clearAll(t.ActionOperation),
            Laya.timer.clearAll(this),
            uiscript.UI_DesktopInfo.Inst.reset_rounds(),
            uiscript.UI_Replay.Inst.reset(),
            this.effect_pai_canchi.active = !1;
            for (var e = 0; e < 4; e++)
                this.players[e].Reset();
            this.tingpais = [[], [], [], []],
            this.md5 = "",
            this.current_step = -1
        }
        ,
        r.prototype.setScores = function(e) {
            for (var i = 0; i < e.length; i++)
                this.players[t.DesktopMgr.Inst.seat2LocalPosition(i)].SetScore(e[i], e[this.seat])
        }
        ,
        r.prototype._PendingAuto = function() {
            if (null == this.oplist || 0 == this.oplist.length)
                return !1;
            app.Log.log("_PendingAuto");
            try {
                var t = !1
                  , e = !1
                  , i = !1
                  , n = !1
                  , a = !1
                  , r = this.operation_showing;
                this.operation_showing = !0;
                var s = null;
                this.liqi_select = [];
                for (_ = 0; _ < this.oplist.length; _++) {
                    switch (this.oplist[_].type) {
                    case mjcore.E_PlayOperation.eat:
                    case mjcore.E_PlayOperation.peng:
                    case mjcore.E_PlayOperation.ming_gang:
                    case mjcore.E_PlayOperation.rong:
                        t = !0;
                        break;
                    case mjcore.E_PlayOperation.an_gang:
                    case mjcore.E_PlayOperation.add_gang:
                    case mjcore.E_PlayOperation.liqi:
                    case mjcore.E_PlayOperation.zimo:
                    case mjcore.E_PlayOperation.babei:
                        e = !0;
                    case mjcore.E_PlayOperation.jiuzhongjiupai:
                        e = !0
                    }
                    if (this.oplist[_].type == mjcore.E_PlayOperation.dapai && (a = !0,
                    s = this.oplist[_].combination),
                    this.oplist[_].type == mjcore.E_PlayOperation.liqi) {
                        a = !0,
                        this.liqi_select = [];
                        for (var o = 0; o < this.oplist[_].combination.length; o++)
                            this.liqi_select.push(mjcore.MJPai.Create(this.oplist[_].combination[o]))
                    }
                    this.oplist[_].type == mjcore.E_PlayOperation.rong && (i = !0),
                    this.oplist[_].type == mjcore.E_PlayOperation.zimo && (n = !0)
                }
                var l = this.auto_hule
                  , h = this.auto_nofulu
                  , c = this.auto_moqie;
                if (this.hangupCount >= 5 && (h = !0,
                c = !0),
                l && (i || n))
                    return Laya.timer.once(800, this, function() {
                        i ? app.NetAgent.sendReq2MJ("FastTest", "inputChiPengGang", {
                            type: mjcore.E_PlayOperation.rong,
                            index: 0
                        }, function(t, e) {}) : n && app.NetAgent.sendReq2MJ("FastTest", "inputOperation", {
                            type: mjcore.E_PlayOperation.zimo,
                            index: 0
                        }, function(t, e) {})
                    }),
                    this.ClearOperationShow(),
                    !1;
                if (t) {
                    if (h && !i && !n)
                        return app.NetAgent.sendReq2MJ("FastTest", "inputChiPengGang", {
                            cancel_operation: !0
                        }, function(t, e) {}),
                        this.ClearOperationShow(),
                        !1;
                    r || uiscript.UIMgr.Inst.ShowChipenghu(this.oplist)
                } else if (e && (r || uiscript.UIMgr.Inst.ShowLiqiZimo(this.oplist)),
                a) {
                    if (c && !uiscript.UI_LiQiZiMo.Inst.enable && null != this.mainrole.last_tile)
                        return this.Action_QiPai(this.mainrole.last_tile.val, !0, !0),
                        !1;
                    if (!r && (this.mainrole.can_discard = !0,
                    s && s.length > 0)) {
                        for (var u = [], _ = 0; _ < s.length; _++)
                            u.push(mjcore.MJPai.Create(s[_]));
                        this.mainrole.ChiTiSelect(u)
                    }
                } else
                    this.mainrole.can_discard = !1
            } catch (t) {
                var d = {};
                d.error = t.message,
                d.stack = t.stack,
                d.method = "_PendingAuto",
                d.name = "DesktopMgr",
                GameMgr.Inst.onFatalError(d)
            }
            return !0
        }
        ,
        r.prototype.OperationTimeOut = function() {
            if (null != this.oplist && 0 != this.oplist.length) {
                var t = !1
                  , e = !1
                  , i = !1
                  , n = !1
                  , a = !1;
                this.operation_showing;
                this.operation_showing = !0;
                this.hangupCount++,
                this.hangupCount >= 5 && !uiscript.UI_Hangup_Warn.Inst.enable && uiscript.UI_Hangup_Warn.Inst.show();
                for (o = 0; o < this.oplist.length; o++) {
                    switch (this.oplist[o].type) {
                    case mjcore.E_PlayOperation.eat:
                    case mjcore.E_PlayOperation.peng:
                    case mjcore.E_PlayOperation.ming_gang:
                    case mjcore.E_PlayOperation.rong:
                        t = !0;
                        break;
                    case mjcore.E_PlayOperation.an_gang:
                    case mjcore.E_PlayOperation.add_gang:
                    case mjcore.E_PlayOperation.liqi:
                    case mjcore.E_PlayOperation.zimo:
                    case mjcore.E_PlayOperation.babei:
                        e = !0
                    }
                    this.oplist[o].type != mjcore.E_PlayOperation.dapai && this.oplist[o].type != mjcore.E_PlayOperation.liqi || (a = !0,
                    this.oplist[o].type == mjcore.E_PlayOperation.dapai && this.oplist[o].combination),
                    this.oplist[o].type == mjcore.E_PlayOperation.rong && (i = !0),
                    this.oplist[o].type == mjcore.E_PlayOperation.zimo && (n = !0)
                }
                if (t)
                    i ? app.NetAgent.sendReq2MJ("FastTest", "inputChiPengGang", {
                        type: mjcore.E_PlayOperation.rong,
                        index: 0,
                        timeuse: 1e6
                    }, function(t, e) {}) : app.NetAgent.sendReq2MJ("FastTest", "inputChiPengGang", {
                        cancel_operation: !0,
                        timeuse: 1e6
                    }, function(t, e) {}),
                    this.ClearOperationShow();
                else if (a)
                    if (this.mainrole.during_liqi) {
                        for (var r = null, s = !1, o = 0; o < this.mainrole.hand.length; o++)
                            this.mainrole.hand[o].valid && (r = this.mainrole.hand[o].val,
                            s = this.mainrole.hand[o] === this.mainrole.last_tile);
                        this.Action_LiQi(r, s)
                    } else {
                        var l = null
                          , s = !1;
                        if (null == l && this.mainrole.last_tile && this.mainrole.last_tile.valid && (l = this.mainrole.last_tile.val,
                        s = !0),
                        null == l)
                            for (o = this.mainrole.hand.length - 1; o >= 0; o--)
                                if (this.mainrole.hand[o].valid) {
                                    l = this.mainrole.hand[o].val,
                                    s = !1;
                                    break
                                }
                        this.Action_QiPai(l, s, !0)
                    }
                else
                    e && (n ? app.NetAgent.sendReq2MJ("FastTest", "inputOperation", {
                        type: mjcore.E_PlayOperation.zimo,
                        index: 0,
                        timeuse: 1e6
                    }, function(t, e) {}) : app.NetAgent.sendReq2MJ("FastTest", "inputOperation", {
                        cancel_operation: !0,
                        timeuse: 1e6
                    }, function(t, e) {}),
                    this.ClearOperationShow())
            }
        }
        ,
        r.prototype.WhenDoOperation = function() {
            this.hangupCount = 0,
            uiscript.UI_Hangup_Warn.Inst.enable && (uiscript.UI_Hangup_Warn.Inst.enable = !1),
            this.ClearOperationShow()
        }
        ,
        r.prototype.ClearOperationShow = function() {
            this.operation_showing = !1,
            this.oplist = [],
            uiscript.UIMgr.Inst.CloseLiuJu(),
            uiscript.UIMgr.Inst.CloseWin(),
            uiscript.UIMgr.Inst.CloseChipenghu(),
            uiscript.UIMgr.Inst.CloseLiqiZimo(),
            Laya.timer.clearAll(t.ActionOperation),
            uiscript.UI_ScoreChange.Inst.enable = !1,
            this.mainrole.can_discard = !1,
            uiscript.UI_DesktopInfo.Inst.closeCountDown()
        }
        ,
        r.prototype.WhenLiqiInfo = function(t) {
            var e = this;
            t && Laya.timer.once(300, this, function() {
                var i = t.seat
                  , n = t.score;
                e.players[e.seat2LocalPosition(i)].ShowLiqi(),
                e.players[e.seat2LocalPosition(i)].SetScore(n, e.mainrole.score),
                uiscript.UI_DesktopInfo.Inst.setLiqibang(t.liqibang)
            })
        }
        ,
        r.prototype.WhenDoras = function(e, i) {
            var n = this;
            if (!(null == e || void 0 == e || 0 == e.length || e.length <= this.dora.length) && e) {
                for (var a = 0; a < e.length; a++)
                    this.dora.length > a ? this.dora[a] = mjcore.MJPai.Create(e[a]) : this.dora.push(mjcore.MJPai.Create(e[a])),
                    uiscript.UI_DesktopInfo.Inst.setDora(a, this.dora[a]);
                Laya.timer.frameOnce(1, this, function() {
                    for (var t = 0; t < 4; t++)
                        n.players[t].OnDoraRefresh()
                }),
                i || t.AudioMgr.PlayAudio(215)
            }
        }
        ,
        r.prototype.Action_QiPai = function(t, e, i) {
            app.NetAgent.sendReq2MJ("FastTest", "inputOperation", {
                type: mjcore.E_PlayOperation.dapai,
                tile: t.toString(),
                moqie: e,
                timeuse: uiscript.UI_DesktopInfo.Inst._timecd.timeuse
            }, function(t, e) {
                t ? app.Log.Error("Action_QiPai 失败") : app.Log.info("Action_QiPai 成功")
            }),
            i ? this.ClearOperationShow() : this.WhenDoOperation()
        }
        ,
        r.prototype.Action_LiQi = function(t, e) {
            if (!this.liqi_select || 0 == this.liqi_select.length)
                return !1;
            for (var i = !1, n = 0; n < this.liqi_select.length; n++)
                if (0 == mjcore.MJPai.Distance(this.liqi_select[n], t)) {
                    i = !0;
                    break
                }
            return !!i && (app.NetAgent.sendReq2MJ("FastTest", "inputOperation", {
                type: mjcore.E_PlayOperation.liqi,
                tile: t.toString(),
                moqie: e,
                timeuse: uiscript.UI_DesktopInfo.Inst._timecd.timeuse
            }, function(t, e) {
                t ? app.Log.Error("Action_LiQi 失败") : app.Log.info("Action_LiQi 成功")
            }),
            this.WhenDoOperation(),
            !0)
        }
        ,
        r.prototype.SetLastQiPai = function(t, e) {
            this.lastqipai = e,
            this.lastpai_seat = t,
            this.effect_pai_canchi.active = !1
        }
        ,
        r.prototype.ShowHuleEffect = function(e, i) {
            var n = this;
            if (null != e) {
                e = e.clone();
                var a = game.EffectMgr.create_d3_effect(i);
                this.trans_container_effect.addChild(a),
                a.transform.position = e,
                a.active = !0;
                var r = 213;
                switch (i) {
                case "scene/effect_hupai_default.lh":
                    r = 213;
                    break;
                case "scene/effect_hupai_fire.lh":
                    r = 230;
                    break;
                case "scene/effect_hupai_feng.lh":
                    r = 231;
                    break;
                case "scene/effect_hupai_sakura.lh":
                    r = 232;
                    break;
                case "scene/effect_hupai_ice.lh":
                    r = 233;
                    break;
                case "scene/effect_hupai_juguang.lh":
                    r = 234;
                    break;
                case "scene/effect_hupai_heihuo.lh":
                    r = 237;
                    break;
                case "scene/effect_hupai_yanhua.lh":
                    r = 238
                }
                t.AudioMgr.PlayAudio(r),
                Laya.timer.once(2e3, this, function() {
                    a.destroy(!0)
                }),
                "scene/effect_hupai_yanhua.lh" == i && Laya.timer.once(600, this, function() {
                    var t = game.EffectMgr.create_d3_effect("scene/effect_hupai_yanhua_bang.lh");
                    n.desktop3D.addChild(t),
                    t.transform.position = new Laya.Vector3(0,0,0),
                    t.active = !0,
                    Laya.timer.once(2e3, n, function() {
                        t.destroy(!0)
                    })
                })
            }
        }
        ,
        r.prototype.ShowChiPengEffect = function() {
            this.lastqipai.model && this.lastqipai.model.transform && (this.lastqipai.model.parent.addChild(this.effect_pai_canchi),
            this.effect_pai_canchi.transform.localPosition = this.lastqipai.model.transform.localPosition.clone(),
            this.effect_pai_canchi.transform.localRotation = this.lastqipai.model.transform.localRotation.clone(),
            this.effect_pai_canchi.active = !0)
        }
        ,
        r.prototype.CloseChiPngEffect = function() {
            this.effect_pai_canchi.active = !1,
            this.trans_container_effect.addChild(this.effect_pai_canchi)
        }
        ,
        r.prototype.setChoosedPai = function(t) {
            var e = !1;
            if (e || !t || this.choosed_pai || (e = !0),
            e || t || !this.choosed_pai || (e = !0),
            !e && t && this.choosed_pai && 0 != mjcore.MJPai.Distance(this.choosed_pai, t) && (e = !0),
            e && (this.choosed_pai = t ? t.Clone() : null,
            r.bianjietishi)) {
                for (var i = 0; i < 4; i++)
                    this.players[i].OnChoosePai();
                uiscript.UI_TingPai.Inst.onChooseTile(t)
            }
        }
        ,
        r.prototype.setTingpai = function(e, i) {
            for (var n = !1, a = [], r = 0; r < i.length; r++)
                a.push(mjcore.MJPai.Create(i[r].tile));
            this.tingpais[e].length != a.length && (n = !0);
            for (r = 0; r < a.length && !n; r++)
                0 != mjcore.MJPai.Distance(a[r], this.tingpais[e][r]) && (n = !0);
            if (n) {
                this.tingpais[e] = a;
                for (r = 0; r < t.DesktopMgr.Inst.players.length; r++) {
                    if (!(this.localPosition2Seat(r) < 0)) {
                        for (o = 0; o < t.DesktopMgr.Inst.players[r].container_qipai.pais.length; o++) {
                            (l = t.DesktopMgr.Inst.players[r].container_qipai.pais[o]).ispaopai = this.isPaoPai(l.val),
                            l.OnChoosedPai()
                        }
                        for (o = 0; o < t.DesktopMgr.Inst.players[r].container_ming.pais.length; o++) {
                            (l = t.DesktopMgr.Inst.players[r].container_ming.pais[o]).ispaopai = this.isPaoPai(l.val),
                            l.OnChoosedPai()
                        }
                        for (o = 0; o < t.DesktopMgr.Inst.players[r].container_babei.pais.length; o++) {
                            (l = t.DesktopMgr.Inst.players[r].container_babei.pais[o]).ispaopai = this.isPaoPai(l.val),
                            l.OnChoosedPai()
                        }
                        if ((l = t.DesktopMgr.Inst.players[r].container_qipai.last_pai) && (l.ispaopai = this.isPaoPai(l.val),
                        l.OnChoosedPai()),
                        0 == r)
                            for (var s = t.DesktopMgr.Inst.players[r], o = 0; o < s.hand.length; o++) {
                                (l = s.hand[o]).ispaopai = this.isPaoPai(l.val),
                                l.RefreshPaoPai()
                            }
                        else
                            for (var s = t.DesktopMgr.Inst.players[r], o = 0; o < s.hand.length; o++) {
                                var l = s.hand[o].pai3D;
                                this.record_show_hand ? l.ispaopai = this.isPaoPai(l.val) : l.ispaopai = !1,
                                l.OnChoosedPai()
                            }
                    }
                }
            }
        }
        ,
        r.prototype.isPaoPai = function(t) {
            if (!this.record_show_paopai)
                return !1;
            for (var e = 0; e < this.tingpais.length; e++)
                for (var i = 0; i < this.tingpais[e].length; i++)
                    if (0 == mjcore.MJPai.Distance(this.tingpais[e][i], t))
                        return !0;
            return !1
        }
        ,
        r.prototype.getPaiLeft = function(t) {
            for (var e = 0, i = 0; i < 4; i++) {
                for (var n = this.players[i], a = 0; a < n.container_babei.pais.length; a++)
                    0 == mjcore.MJPai.Distance(n.container_babei.pais[a].val, t) && e++;
                for (a = 0; a < n.container_ming.pais.length; a++)
                    0 == mjcore.MJPai.Distance(n.container_ming.pais[a].val, t) && e++;
                for (a = 0; a < n.container_qipai.pais.length; a++)
                    0 == mjcore.MJPai.Distance(n.container_qipai.pais[a].val, t) && e++;
                n.container_qipai.last_pai && 0 == mjcore.MJPai.Distance(n.container_qipai.last_pai.val, t) && e++
            }
            for (i = 0; i < this.mainrole.hand.length; i++)
                0 == mjcore.MJPai.Distance(this.mainrole.hand[i].val, t) && e++;
            for (i = 0; i < this.dora.length; i++)
                this.dora[i] && 0 == mjcore.MJPai.Distance(this.dora[i], t) && e++;
            var r = 4 - e;
            return r < 0 ? 0 : r > 4 ? 4 : r
        }
        ,
        r.prototype.get_gang_count = function() {
            for (var t = 0, e = 0; e < this.players.length; e++) {
                if (this.localPosition2Seat(e) >= 0)
                    for (var i = this.players[e].container_ming.mings, n = 0; n < i.length; n++)
                        i[n].type != mjcore.E_Ming.gang_an && i[n].type != mjcore.E_Ming.gang_ming || t++
            }
            return t
        }
        ,
        r.prototype.get_babei_count = function() {
            for (var t = 0, e = 0; e < this.players.length; e++) {
                this.localPosition2Seat(e) >= 0 && (t += this.players[e].container_babei.pais.length)
            }
            return t
        }
        ,
        r.prototype.fetchLinks = function() {
            app.NetAgent.sendReq2MJ("FastTest", "fetchGamePlayerState", {}, function(t, e) {
                if (t || e.error)
                    uiscript.UIMgr.Inst.showNetReqError("fetchGamePlayerState", t, e);
                else {
                    app.Log.log(JSON.stringify(e)),
                    r.player_link_state = [];
                    for (var i = 0; i < e.state_list.length; i++)
                        r.player_link_state.push(e.state_list[i]);
                    uiscript.UI_DesktopInfo.Inst.refreshLinks()
                }
            })
        }
        ,
        r.prototype.onShowHandChange = function(t) {
            if (this.gameing) {
                this.record_show_hand = t;
                for (var e = 1; e < 4; e++)
                    this.players[e].onShowHandChange(t)
            }
        }
        ,
        r.prototype.onShowPaopaiChange = function(e) {
            if (this.gameing) {
                this.record_show_paopai = e,
                this.mainrole.onShowPaopaiChange();
                for (i = 1; i < 4; i++)
                    this.players[i].onShowPaopaiChange();
                for (var i = 0; i < t.DesktopMgr.Inst.players.length; i++) {
                    if (!(this.localPosition2Seat(i) < 0)) {
                        for (n = 0; n < t.DesktopMgr.Inst.players[i].container_qipai.pais.length; n++) {
                            (a = t.DesktopMgr.Inst.players[i].container_qipai.pais[n]).ispaopai = this.isPaoPai(a.val),
                            a.OnChoosedPai()
                        }
                        for (n = 0; n < t.DesktopMgr.Inst.players[i].container_ming.pais.length; n++) {
                            (a = t.DesktopMgr.Inst.players[i].container_ming.pais[n]).ispaopai = this.isPaoPai(a.val),
                            a.OnChoosedPai()
                        }
                        for (var n = 0; n < t.DesktopMgr.Inst.players[i].container_babei.pais.length; n++) {
                            (a = t.DesktopMgr.Inst.players[i].container_babei.pais[n]).ispaopai = this.isPaoPai(a.val),
                            a.OnChoosedPai()
                        }
                        var a = t.DesktopMgr.Inst.players[i].container_qipai.last_pai;
                        a && (a.ispaopai = this.isPaoPai(a.val),
                        a.OnChoosedPai())
                    }
                }
            }
        }
        ,
        r.Inst = null,
        r.player_link_state = [e.NULL, e.NULL, e.NULL, e.NULL],
        r.click_prefer = 0,
        r.double_click_pass = 0,
        r.en_mjp = !1,
        r.bianjietishi = !0,
        r
    }(Laya.Script);
    t.DesktopMgr = a
}(view || (view = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), view;
!function(t) {
    var e = new Laya.Vector4(1,1,1,1)
      , i = new Laya.Vector4(.6,.6,.6,1)
      , n = function(n) {
        function a() {
            var t = n.call(this) || this;
            return t.mySelf = null,
            t.acitve = !1,
            t.val = null,
            t.valid = !0,
            t._clickeffect = null,
            t.during_newgame = !1,
            t.newgame_start = 0,
            t.newgame_lifetime = 200,
            t.during_hule = !1,
            t.hule_start = 0,
            t.hule_lifetime = 100,
            t.isDora = !1,
            t.ispaopai = !1,
            t.index = -1,
            t.pos_x = 0,
            t.z = 0,
            t.bedraged = !1,
            t
        }
        return __extends(a, n),
        a.prototype._load = function(t) {
            this.mySelf = t,
            this.mySelf.active = !1,
            this.isDora = !1,
            Laya.timer.frameLoop(1, this, this.Update)
        }
        ,
        a.prototype.Reset = function() {
            this.val = null,
            this.valid = !0,
            this.index = -1,
            this._SetColor(e),
            this.mySelf.active = !1,
            this.during_newgame = !1,
            this.during_hule = !1,
            this.bedraged = !1,
            this.mySelf.transform.localPosition = new Laya.Vector3(0,0,0),
            null != this._clickeffect && (this._clickeffect.destroy(),
            this._clickeffect = null),
            this.acitve = !1,
            this.isDora = !1,
            this.mySelf.numChildren > 0 && (this.mySelf.getChildAt(0).active = !1)
        }
        ,
        a.prototype.SetVal = function(n, a) {
            this.val = n,
            this.valid = a,
            this._SetColor(a ? e : i);
            var r = n.dora ? .9 : .1 * (n.index - 1)
              , s = 0;
            switch (n.type) {
            case mjcore.E_MJPai.s:
                s = -.75;
                break;
            case mjcore.E_MJPai.m:
                s = -.5;
                break;
            case mjcore.E_MJPai.p:
                s = -.25;
                break;
            default:
                s = 0
            }
            var o = this.mySelf.meshRender.material
              , l = "scene/Assets/Resource/mjpai/";
            "en" == GameMgr.client_language && (l += "en/"),
            l += t.DesktopMgr.Inst.mjp_res_name + "/hand.png",
            o.albedoTexture = Laya.loader.getRes(l),
            o.tilingOffset = new Laya.Vector4(.1,.25,r,s),
            this.mySelf.active = !0,
            this.acitve = !0,
            this.RefreshDora()
        }
        ,
        a.prototype.LiqiSelect = function(t) {
            if (!this.mySelf.destroyed) {
                for (var n = !1, a = 0; a < t.length; a++)
                    if (0 == mjcore.MJPai.Distance(this.val, t[a])) {
                        n = !0;
                        break
                    }
                n ? (this._SetColor(e),
                this.valid = !0) : (this._SetColor(i),
                this.valid = !1)
            }
        }
        ,
        a.prototype.ChiTiSelect = function(t) {
            if (!this.mySelf.destroyed) {
                for (var n = !1, a = 0; a < t.length; a++)
                    if (0 == mjcore.MJPai.Distance(this.val, t[a])) {
                        n = !0;
                        break
                    }
                n ? (this._SetColor(i),
                this.valid = !1) : (this._SetColor(e),
                this.valid = !0)
            }
        }
        ,
        a.prototype.RefreshPaoPai = function() {
            this.ispaopai ? this._SetColor(new Laya.Vector4(1,.78,.78,1)) : this._SetColor(e)
        }
        ,
        a.prototype.SelectEnd = function() {
            this.mySelf.destroyed || (this._SetColor(e),
            this.valid = !0)
        }
        ,
        a.prototype._SetColor = function(t) {
            if (!this.mySelf.destroyed) {
                this.mySelf.meshRender.material.albedoColor = t
            }
        }
        ,
        a.prototype.SetIndex = function(t, e, i) {
            this.index = t,
            this.pos_x = 2.55 * t + (e ? .8 : 0),
            i || (this.mySelf.transform.localPosition = new Laya.Vector3(this.pos_x,this.mySelf.transform.localPosition.y,this.z))
        }
        ,
        a.prototype.AddClickEffect = function(t) {
            null != this._clickeffect && (this._clickeffect.destroy(),
            this._clickeffect = null),
            this.mySelf.addChild(t),
            this._clickeffect = t,
            t.transform.localPosition = new Laya.Vector3(0,0,2),
            t.active = !0,
            Laya.timer.once(300, this, this.RemoveClickEffect)
        }
        ,
        a.prototype.RemoveClickEffect = function() {
            null != this._clickeffect && (this._clickeffect.destroy(),
            this._clickeffect = null)
        }
        ,
        a.prototype.AnimNewTile = function() {
            var t = this.mySelf.meshRender.material
              , e = t.albedoColor.clone();
            e.w = 0,
            t.albedoColor = e,
            this.during_newgame = !0,
            this.newgame_start = Laya.timer.currTimer
        }
        ,
        a.prototype.Hule = function() {
            this.during_hule = !0,
            this.hule_start = Laya.timer.currTimer,
            this.acitve = !1,
            this.mySelf.numChildren > 0 && (this.mySelf.getChildAt(0).active = !1)
        }
        ,
        a.prototype.Update = function() {
            if (this.during_newgame) {
                var t = Laya.timer.currTimer - this.newgame_start
                  , e = this.mySelf.transform.localPosition.clone()
                  , i = (n = this.mySelf.meshRender.material).albedoColor.clone();
                if (t >= this.newgame_lifetime)
                    e.y = 0,
                    this.mySelf.transform.localPosition = e,
                    i.w = 1,
                    n.albedoColor = i,
                    this.during_newgame = !1;
                else {
                    a = t / this.newgame_lifetime;
                    e.y = .5 * (1 - a),
                    this.mySelf.transform.localPosition = e,
                    i.w = a,
                    n.albedoColor = i
                }
            }
            if (this.during_hule) {
                var t = Laya.timer.currTimer - this.hule_start
                  , n = this.mySelf.meshRender.material
                  , i = n.albedoColor.clone();
                if (t >= this.hule_lifetime)
                    i.w = 0,
                    n.albedoColor = i;
                else {
                    var a = t / this.hule_lifetime;
                    i.w = 1 - a,
                    n.albedoColor = i
                }
            }
            if (!this.bedraged) {
                var r = this.mySelf.transform.localPosition
                  , s = Math.abs(r.x - this.pos_x);
                if (s > 1e-5) {
                    var o = 2.55 * 25 * Laya.timer.delta / 1e3;
                    o >= s ? this.mySelf.transform.localPosition = new Laya.Vector3(this.pos_x,this.mySelf.transform.localPosition.y,this.z) : (this.pos_x < r.x && (o = -o),
                    this.mySelf.transform.localPosition = new Laya.Vector3(r.x + o,this.mySelf.transform.localPosition.y,this.z))
                }
            }
        }
        ,
        a.prototype.RefreshDora = function() {
            if (t.DesktopMgr.bianjietishi && !this.isDora) {
                if (this.val.dora && (this.isDora = !0),
                !this.isDora)
                    for (var e = 0; e < t.DesktopMgr.Inst.dora.length; e++)
                        if (mjcore.MJPai.DoraMet(this.val, t.DesktopMgr.Inst.dora[e])) {
                            this.isDora = !0;
                            break
                        }
                if (this.isDora)
                    if (0 == this.mySelf.numChildren) {
                        var i = t.DesktopMgr.Inst.effect_doraPlane.clone();
                        this.mySelf.addChild(i),
                        i.transform.localPosition = new Laya.Vector3(0,0,0),
                        i.transform.localScale = new Laya.Vector3(1,1,1),
                        i.transform.localRotationEuler = new Laya.Vector3(0,0,0),
                        i.active = !0;
                        i.getChildAt(0).addComponent(anim.RunUV)
                    } else
                        this.mySelf.getChildAt(0).active = !0
            }
        }
        ,
        a.Cmp = function(t, e) {
            var i = mjcore.MJPai.Distance(t.val, e.val);
            return 0 != i ? i : t.index - e.index
        }
        ,
        a
    }(Laya.Script);
    t.HandPaiPlane = n
}(view || (view = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), view;
!function(t) {
    var e = function(e) {
        function i() {
            var t = e.call(this) || this;
            return t.desktop = null,
            t.seat = 0,
            t.trans_hand = null,
            t.trans_paihai = null,
            t.trans_ming = null,
            t.trans_liqi = null,
            t.trans_ind = null,
            t.trans_dir = null,
            t.trans_man = null,
            t.trans_babei = null,
            t.container_score = null,
            t.trans_scores = null,
            t.hand3d = null,
            t._hand_models = [],
            t._anim_hands = [],
            t.container_qipai = null,
            t.container_ming = null,
            t.container_babei = null,
            t.score = 0,
            t.duringShowDetla = !1,
            t.anim_id = 0,
            t.trans_liqi_position = null,
            t.trans_liqi_scale = null,
            t.liqibang = null,
            t.hand_type = "hand_human",
            t
        }
        return __extends(i, e),
        i.prototype.Init = function(e, i, n, a, r, s, o) {
            this.desktop = e,
            this.seat = i,
            this.trans_hand = n,
            this.trans_paihai = r,
            this.trans_ming = a,
            this.trans_man = s,
            this.trans_babei = o;
            for (h = 0; h < this.trans_hand.parent.numChildren; h++)
                this.trans_hand.parent.getChildAt(h).active = !1;
            for (h = 0; h < this.trans_ming.parent.numChildren; h++)
                this.trans_ming.parent.getChildAt(h).active = !1;
            for (h = 0; h < this.trans_paihai.parent.numChildren; h++)
                this.trans_paihai.parent.getChildAt(h).active = !1;
            for (h = 0; h < this.trans_babei.parent.numChildren; h++)
                this.trans_babei.parent.getChildAt(h).active = !1;
            this.container_qipai = new t.Block_QiPai(r,this),
            this.container_ming = new t.Block_Ming(a,this),
            this.container_babei = new t.Block_Babei(o,this),
            this.trans_liqi = s.getChildByName("liqi"),
            this.trans_liqi.active = !1,
            this.trans_liqi_position = this.trans_liqi.transform.localPosition,
            this.trans_liqi_scale = this.trans_liqi.transform.localScale,
            this.trans_dir = s.getChildByName("dir"),
            this.trans_ind = s.getChildByName("ind");
            var l = s.getChildByName("score");
            this.container_score = l,
            this.trans_scores = new Array;
            for (var h = 0; h < 10; h++)
                this.trans_scores.push(l.getChildByName(h.toString()));
            this.hand3d = s.parent.getChildByName("hand_" + (i + 1).toString()),
            this.hand3d.active = !1,
            this.SetScore(25e3, 25e3),
            this.RefreshDir()
        }
        ,
        i.prototype.onInitRoom = function(e) {
            this.seat = e,
            -1 != this.seat ? (this.trans_man.active = !0,
            this.create_liqibang(),
            this.hand_type = t.DesktopMgr.Inst.player_effects[this.seat].hand,
            this.create_hand()) : this.trans_man.active = !1
        }
        ,
        i.prototype.create_liqibang = function() {
            this.liqibang && (this.liqibang.destroy(!0),
            this.liqibang = null),
            this.liqibang = Laya.loader.getRes(t.DesktopMgr.Inst.player_effects[this.seat].liqibang).clone(),
            this.trans_liqi.addChild(this.liqibang),
            this.liqibang.transform.localPosition = new Laya.Vector3(0,0,0),
            this.liqibang.transform.localScale = new Laya.Vector3(1,1,1),
            this.liqibang.transform.localRotationEuler = new Laya.Vector3(0,0,0),
            this.liqibang.active = !0;
            var e = function(t) {
                if ("shadow" != t.name) {
                    if (t instanceof Laya.MeshSprite3D) {
                        var i = t;
                        if (i.meshRender && i.meshRender.sharedMaterial) {
                            var n = new caps.BaseMaterial(caps.Cartoon.filename);
                            n.setTexture(caps.Cartoon.TEXTURE, i.meshRender.material.albedoTexture),
                            n.setNumber(caps.Cartoon.SPLIT, .4),
                            n.setColor(caps.Cartoon.COLOR_LIGHT, new Laya.Vector3(1,1,1)),
                            n.setColor(caps.Cartoon.COLOR_UNLIGHT, new Laya.Vector3(1,1,1)),
                            n.setColor(caps.Cartoon.COLOR, new Laya.Vector3(1,1,1)),
                            i.meshRender.sharedMaterial = n
                        }
                    }
                    for (var a = 0; a < t.numChildren; a++)
                        e(t.getChildAt(a))
                }
            };
            e(this.liqibang.getChildAt(0))
        }
        ,
        i.prototype.create_hand = function() {
            if (this._anim_hands = [],
            this._hand_models) {
                for (var e = 0; e < this._hand_models.length; e++)
                    this._hand_models[e].destroy(!0);
                this._hand_models = []
            }
            var i = t.DesktopMgr.Inst.player_effects[this.seat].hand
              , n = "scene/" + i + ".lh"
              , a = Laya.loader.getRes(n);
            a.getChildAt(0).getChildByName("node_liqibang").getChildByName("p") && a.getChildAt(0).getChildByName("node_liqibang").getChildByName("p").destroy(!0),
            a.getChildAt(0).getChildByName("node_tile").getChildByName("p") && a.getChildAt(0).getChildByName("node_tile").getChildByName("p").destroy(!0);
            var r = a.getChildAt(0).clone();
            this.hand3d.addChild(r),
            r.transform.localPosition = new Laya.Vector3(0,0,0),
            r.transform.localScale = new Laya.Vector3(1,1,1),
            r.transform.localRotation = new Laya.Quaternion(0,0,0,0),
            this._anim_hands = [r.getComponentByType(Laya.Animator)],
            this._hand_models = [r];
            var s = new Laya.Vector3(.9725,.9137,.937);
            "hand_cat_blue" == i && (s = new Laya.Vector3(216 / 255,210 / 255,206 / 255));
            var o = r.getChildByName("hand")
              , l = new caps.BaseMaterial(caps.Cartoon.filename);
            if (l.setTexture(caps.Cartoon.TEXTURE, o.skinnedMeshRender.sharedMaterials[0].albedoTexture),
            l.setColor(caps.Cartoon.COLOR_LIGHT, new Laya.Vector3(1,1,1)),
            l.setColor(caps.Cartoon.COLOR_UNLIGHT, s),
            l.setColor(caps.Cartoon.COLOR, new Laya.Vector3(1,1,1)),
            l.setNumber(caps.Cartoon.SPLIT, .4),
            2 == o.skinnedMeshRender.sharedMaterials.length) {
                var h = new caps.BaseMaterial(caps.Cartoon.filename);
                h.setTexture(caps.Cartoon.TEXTURE, o.skinnedMeshRender.sharedMaterials[1].albedoTexture),
                h.setColor(caps.Cartoon.COLOR_LIGHT, new Laya.Vector3(1,1,1)),
                h.setColor(caps.Cartoon.COLOR_UNLIGHT, s),
                h.setColor(caps.Cartoon.COLOR, new Laya.Vector3(1,1,1)),
                h.setNumber(caps.Cartoon.SPLIT, .4),
                o.skinnedMeshRender.sharedMaterials = [l, h]
            } else
                o.skinnedMeshRender.sharedMaterials = [l];
            var c = new Laya.Vector3(.6823,.447,.408)
              , u = .6;
            "hand_cat_blue" == i && (c = new Laya.Vector3(83 / 255,65 / 255,63 / 255),
            u = .9);
            var _ = r.clone();
            _.getChildByName("node_liqibang").destroy(!0),
            _.getChildByName("node_tile").destroy(!0),
            _.getChildByName("Dum_Shadow").destroy(!0),
            r.addChild(_),
            _.transform.localPosition = new Laya.Vector3(0,0,0),
            _.transform.localScale = new Laya.Vector3(1,1,1),
            _.transform.localRotation = new Laya.Quaternion(0,0,0,0);
            var d = _.getChildByName("hand")
              , f = new caps.Material_Outline(caps.Outline.filename);
            f.setColor(caps.Outline.OUTLINE_COLOR, c),
            f.setNumber(caps.Outline.OUTLINE_ALPHA, u),
            f.setNumber(caps.Outline.OUTLINE, .001);
            var p = new caps.Material_Outline(caps.Outline.filename);
            p.setColor(caps.Outline.OUTLINE_COLOR, c),
            p.setNumber(caps.Outline.OUTLINE_ALPHA, u),
            p.setNumber(caps.Outline.OUTLINE, .001),
            d.skinnedMeshRender.sharedMaterials = [f, p],
            this._anim_hands.push(_.getComponentByType(Laya.Animator)),
            this._hand_models.push(_),
            this.hand3d.active = !0,
            this.hand3d.transform.position = new Laya.Vector3(0,0,0)
        }
        ,
        i.prototype.playHandAnimtion = function(t) {
            var e = this;
            this.hand3d.active = !0;
            for (var i = 0; i < this._anim_hands.length; i++)
                this._anim_hands[i].play(t.name, t.speed);
            this.hand3d.transform.localScale = new Laya.Vector3(1e-4,1e-4,1),
            Laya.timer.frameOnce(1, this, function() {
                e.hand3d.transform.localScale = new Laya.Vector3(1,1,1)
            }),
            this.anim_id++;
            var n = this.anim_id;
            Laya.timer.once(t.lifetime, this, function() {
                n == e.anim_id && (e.hand3d.active = !1)
            })
        }
        ,
        i.prototype.setSeat = function(t) {
            this.seat = t
        }
        ,
        i.prototype.Reset = function() {
            this.duringShowDetla = !1,
            this.container_ming.Reset(),
            this.container_qipai.Reset(),
            this.container_babei.Reset(),
            this.trans_liqi.active = !1,
            this.hand3d && (this.hand3d.active = !1),
            Laya.timer.clearAll(this),
            this.anim_id = 0
        }
        ,
        i.prototype.AddQiPai = function(t, e, i, n) {
            void 0 === n && (n = !0),
            this.container_qipai.AddQiPai(t, e, i, n)
        }
        ,
        i.prototype.QiPaiPass = function() {
            this.container_qipai.QiPaiPass()
        }
        ,
        i.prototype.QiPaiNoPass = function() {
            this.container_qipai.QiPaiNoPass()
        }
        ,
        i.prototype.AddMing = function(t, e) {
            void 0 === e && (e = !0),
            this.container_ming.AddMing(t, e)
        }
        ,
        i.prototype.AddGang = function(t, e) {
            void 0 === e && (e = !0),
            this.container_ming.AddGang(t, e)
        }
        ,
        i.prototype.AddBabei = function(t, e, i) {
            void 0 === i && (i = !0),
            this.container_babei.AddBabei(t, e, i)
        }
        ,
        i.prototype.ShowLiqi = function(e) {
            var i = this;
            if (void 0 === e && (e = !0),
            this.trans_liqi.transform.localPosition = this.trans_liqi_position,
            this.trans_liqi.transform.localScale = this.trans_liqi_scale,
            this.trans_liqi.active = !0,
            e) {
                this.hand3d.transform.position = this.trans_liqi.transform.position.clone(),
                this.hand3d.getChildAt(0).getChildByName("node_liqibang").addChild(this.trans_liqi),
                this.trans_liqi.transform.localScale = new Laya.Vector3(.01,.01,.01),
                this.trans_liqi.transform.localPosition = new Laya.Vector3(0,0,0),
                this.trans_liqi.transform.localRotation = new Laya.Quaternion(0,0,-.7,-.7),
                this.hand3d.active = !0;
                var n = t.ModelAnimationController.get_anim_config("LiZhi", this.hand_type);
                this.playHandAnimtion(n),
                Laya.timer.once(n.keypoint[0], this, function() {
                    i.trans_man.addChild(i.trans_liqi),
                    i.trans_liqi.transform.localPosition = i.trans_liqi_position,
                    i.trans_liqi.transform.localScale = i.trans_liqi_scale,
                    i.trans_liqi.transform.localRotation = new Laya.Quaternion(0,0,0,1)
                })
            }
        }
        ,
        i.prototype.SetScore = function(t, e) {
            this.score = t,
            this.RefreshScore(e)
        }
        ,
        i.prototype.RefreshDir = function() {
            if (-1 != this.seat) {
                var e = new Laya.Vector4
                  , i = 0;
                i = t.DesktopMgr.Inst.rule_mode == t.ERuleMode.Liqi3 ? (this.seat - t.DesktopMgr.Inst.index_ju + 3) % 3 : (this.seat - t.DesktopMgr.Inst.index_ju + 4) % 4,
                e.z = .25 * i,
                e.w = 0,
                e.x = .25,
                e.y = 1,
                this.trans_dir.meshRender.material.tilingOffset = e
            }
        }
        ,
        i.prototype.RefreshScore = function(t) {
            if (-1 == this.seat)
                this.container_score.active = !1;
            else {
                this.container_score.active = !0;
                var e = ""
                  , i = 0;
                if (this.duringShowDetla) {
                    var n = this.score - t;
                    n > 0 ? (e = "+" + n.toString(),
                    i = -.33333) : (e = n.toString(),
                    i = -.66667)
                } else
                    e = this.score.toString(),
                    i = 0;
                for (s = 0; s < e.length && s < this.trans_scores.length; s++) {
                    var a = 0;
                    switch (e[e.length - s - 1]) {
                    case "-":
                        a = 0;
                        break;
                    case "+":
                        a = 1;
                        break;
                    case "0":
                        a = 2;
                        break;
                    case "1":
                        a = 3;
                        break;
                    case "2":
                        a = 4;
                        break;
                    case "3":
                        a = 5;
                        break;
                    case "4":
                        a = 6;
                        break;
                    case "5":
                        a = 7;
                        break;
                    case "6":
                        a = 8;
                        break;
                    case "7":
                        a = 9;
                        break;
                    case "8":
                        a = 10;
                        break;
                    case "9":
                        a = 11
                    }
                    a /= 12;
                    var r = new Laya.Vector4;
                    r.z = a,
                    r.w = i,
                    r.x = 1 / 12,
                    r.y = 1 / 3,
                    this.trans_scores[s].meshRender.material.tilingOffset = r,
                    this.trans_scores[s].active = !0
                }
                for (var s = e.length; s < this.trans_scores.length; s++)
                    this.trans_scores[s].active = !1;
                if (e.length <= 6) {
                    (o = this.container_score.transform.localPosition.clone()).x = .165 * (e.length - 1) / 2 - .5325,
                    this.container_score.transform.localPosition = o,
                    this.container_score.transform.localScale = new Laya.Vector3(1,1,1)
                } else {
                    var o = this.container_score.transform.localPosition.clone();
                    o.x = -.12,
                    this.container_score.transform.localPosition = o;
                    var l = .56 + (10 - e.length) / 4 * (1 - .56)
                      , h = .9 + (10 - e.length) / 4 * (1 - .9);
                    this.container_score.transform.localScale = new Laya.Vector3(l,h,1)
                }
            }
        }
        ,
        i.prototype.Hule = function(t, e, i, n) {}
        ,
        i.prototype.Huangpai = function(t, e, i) {}
        ,
        i.prototype.OnDoraRefresh = function() {
            this.container_qipai.OnDoraRefresh(),
            this.container_ming.OnDoraRefresh(),
            this.container_babei.OnDoraRefresh()
        }
        ,
        i.prototype.OnChoosePai = function() {
            this.container_qipai.OnChoosedPai(),
            this.container_ming.OnChoosedPai(),
            this.container_babei.OnChoosedPai()
        }
        ,
        i.prototype.PlaySound = function(e) {
            var i = "";
            switch (e) {
            case "act_chi":
                i = "chi";
                break;
            case "act_drich":
            case "act_rich":
                i = "lizhi";
                break;
            case "act_kan":
                i = "gang";
                break;
            case "act_pon":
                i = "peng";
                break;
            case "act_babei":
                i = "babei"
            }
            "" != i && uiscript.UI_DesktopInfo.Inst.shout(t.DesktopMgr.Inst.seat2LocalPosition(this.seat), i, this.desktop.player_datas[this.seat]),
            t.AudioMgr.PlayCharactorSound(this.desktop.player_datas[this.seat].character, e)
        }
        ,
        i
    }(Laya.Script);
    t.ViewPlayer = e
}(view || (view = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), view;
!function(t) {
    var e = function(e) {
        function i() {
            var t = e.call(this) || this;
            return t._choose_pai = null,
            t._mouse_in_pai = null,
            t._mouse_in_start_time = -1,
            t.handpool = [],
            t.hand = [],
            t.during_liqi = !1,
            t.effect_click = null,
            t.trans_hand3D = null,
            t.trans_hand3DCover = null,
            t._hand3d = [],
            t.can_discard = !1,
            t.last_tile = null,
            t._prediscard_index = -1,
            t.mouse_downx = 0,
            t.mouse_downy = 0,
            t.mouse_downed = !1,
            t.during_drag = !1,
            t.click_on_choosed = !1,
            t.zd = 0,
            t.xianggonged = !1,
            t.screen_left = -7.2,
            t.screen_right = 44.4,
            t.screen_top = 16.6,
            t.screen_bottom = -1.4,
            t.handrange_top = 2.5,
            t.handorigin_x = 0,
            t.handwidth = 2.55,
            i.Inst = t,
            t
        }
        return __extends(i, e),
        i.prototype.Init = function(i, n, a, r, s, o, l) {
            e.prototype.Init.call(this, i, n, a, r, s, o, l);
            var h = a.getChildByName("pai");
            this.effect_click = a.getChildByName("effect_dianji"),
            a.active = !0,
            h.active = !1;
            for (var c = 0; c < 16; c++) {
                var u = h.clone();
                this.trans_hand.addChild(u),
                u.transform.localPosition = new Laya.Vector3(0,0,0),
                u.transform.localRotation = new Laya.Quaternion(0,0,0,1),
                u.transform.localScale = new Laya.Vector3(1,1,1),
                u.active = !1;
                var _ = u.addComponent(t.HandPaiPlane);
                this.handpool.push(_)
            }
            this.ray = new Laya.Ray(new Laya.Vector3,new Laya.Vector3),
            this.phasorSprite3D = new Laya.PhasorSpriter3D,
            this.rayCastHit = new Laya.RaycastHit,
            Laya.stage.on(Laya.Event.MOUSE_DOWN, this, this.onMouseDown),
            Laya.stage.on(Laya.Event.MOUSE_UP, this, this.onMouseUp),
            Laya.stage.on(Laya.Event.MOUSE_MOVE, this, this.onMouseMove),
            Laya.stage.on(Laya.Event.MOUSE_OUT, this, this.onMouseOut)
        }
        ,
        i.prototype._AddHandPai = function(e) {
            var i = this.handpool.pop();
            return i.Reset(),
            i.SetVal(e, !0),
            i.z = this.zd,
            this.zd -= .02,
            t.DesktopMgr.Inst.mode != t.EMJMode.play && (i.ispaopai = t.DesktopMgr.Inst.isPaoPai(i.val),
            i.RefreshPaoPai()),
            this.hand.push(i),
            i
        }
        ,
        i.prototype._OnRemovePai = function(t) {
            t === this._choose_pai && (this._choose_pai = null,
            this.resetMouseState())
        }
        ,
        i.prototype._RemovePai = function(t) {
            for (var e = 0; e < this.hand.length; e++)
                if (this.hand[e] === t) {
                    for (var i = this.hand[e], n = e; n < this.hand.length - 1; n++)
                        this.hand[n] = this.hand[n + 1],
                        this.hand[n].SetIndex(n, !1, !0);
                    this.hand.pop(),
                    this._OnRemovePai(i),
                    i.Reset(),
                    this.handpool.push(i);
                    break
                }
        }
        ,
        i.prototype._RemoveHandPai = function(t) {
            for (var e = this.hand.length - 1; e >= 0; e--)
                if (mjcore.MJPai.isSame(t, this.hand[e].val)) {
                    for (var i = this.hand[e], n = e; n < this.hand.length - 1; n++)
                        this.hand[n] = this.hand[n + 1],
                        this.hand[n].SetIndex(n, !1, !0);
                    this.hand.pop(),
                    this._OnRemovePai(i),
                    i.Reset(),
                    this.handpool.push(i);
                    break
                }
        }
        ,
        i.prototype.Reset = function() {
            e.prototype.Reset.call(this);
            for (t = 0; t < this.hand.length; t++)
                this.hand[t].Reset(),
                this.handpool.push(this.hand[t]);
            this.hand = [];
            for (var t = 0; t < this._hand3d.length; t++)
                this._hand3d[t].Destory();
            this._hand3d = [],
            this.zd = 0,
            this.during_liqi = !1,
            this.trans_hand3D.active = !1,
            this.trans_hand3DCover.active = !1,
            this.last_tile = null,
            this.can_discard = !1,
            this._choose_pai = null,
            this._mouse_in_pai = null,
            this.xianggonged = !1,
            this.resetMouseState(),
            Laya.timer.clearAll(this)
        }
        ,
        i.prototype.NewGame = function(e, i) {
            var n = this;
            if (this.Reset(),
            this.RefreshDir(),
            i) {
                for (r = 0; r < e.length; r++) {
                    this._AddHandPai(e[r]).SetIndex(r, 14 == r, !1)
                }
                this.pendingXiangGong(14 == this.hand.length, "NewGame fast")
            } else {
                for (var a = [], r = 0; r < e.length; r++) {
                    var s = Math.floor(Math.random() * r);
                    a.push(a[s]),
                    a[s] = e[r]
                }
                for (var o = 0, r = 0; r < 4; r++)
                    Laya.timer.once(300 * r, this, function() {
                        for (var e = 0; e < 4 && o != a.length; e++) {
                            o++;
                            var i = n._AddHandPai(a[o - 1]);
                            i.SetIndex(o - 1, !1, !1),
                            i.AnimNewTile()
                        }
                        t.AudioMgr.PlayAudio(216)
                    });
                Laya.timer.once(1200, this, function() {
                    n.LiPai(),
                    n.last_tile = n.hand[n.hand.length - 1],
                    14 == n.hand.length && n.hand[n.hand.length - 1].SetIndex(n.hand.length - 1, !0, !1),
                    n.pendingXiangGong(14 == n.hand.length, "NewGame No fast")
                })
            }
            Laya.timer.frameLoop(1, this, this.update)
        }
        ,
        i.prototype.RecordNewGame = function(t) {
            this.Reset(),
            this.RefreshDir();
            for (var e = 0; e < t.length; e++) {
                this._AddHandPai(t[e]).SetIndex(e, 14 == e, !1)
            }
            this.pendingXiangGong(14 == this.hand.length, "RecordNewGame"),
            Laya.timer.frameLoop(1, this, this.update)
        }
        ,
        i.prototype.TakePai = function(t, e) {
            void 0 === e && (e = !0),
            app.Log.log("ViewPlayer_Me TakePai " + t.toString() + " doanim:" + e);
            try {
                var i = this._AddHandPai(t);
                i.SetIndex(this.hand.length - 1, !0, !1),
                e && i.AnimNewTile(),
                this.last_tile = i,
                this.pendingXiangGong(!0, "TakePai")
            } catch (t) {
                var n = {};
                n.error = t.message,
                n.stack = t.stack,
                n.method = "TakePai",
                n.name = "ViewPlayer_Me",
                GameMgr.Inst.onFatalError(n)
            }
            app.Log.log("ViewPlayer_Me TakePai end")
        }
        ,
        i.prototype.onBabei = function(t, e) {
            this.OnDiscardTile(t, e)
        }
        ,
        i.prototype.OnDiscardTile = function(t, e) {
            app.Log.log("ViewPlayer_Me OnDiscardTile " + t.toString() + " fast:" + e);
            try {
                if (this._prediscard_index >= 0 && this._prediscard_index < this.hand.length) {
                    this.hand[this._prediscard_index].val;
                    mjcore.MJPai.isSame(this.hand[this._prediscard_index].val, t) ? this._RemovePai(this.hand[this._prediscard_index]) : (this.hand[this._prediscard_index].mySelf.active = !0,
                    this._RemoveHandPai(t))
                } else
                    this._RemoveHandPai(t);
                this.LiPai(e),
                this.last_tile = null,
                this._prediscard_index = -1,
                this.pendingXiangGong(!1, "OnDiscardTile")
            } catch (t) {
                var i = {};
                i.error = t.message,
                i.stack = t.stack,
                i.method = "OnDiscardTile",
                i.name = "ViewPlayer_Me OnDiscardTile",
                GameMgr.Inst.onFatalError(i)
            }
        }
        ,
        i.prototype.AddGang = function(t, i) {
            void 0 === i && (i = !0),
            app.Log.log("ViewPlayer_Me AddGang " + t.toString() + " doanim:" + i);
            try {
                e.prototype.AddGang.call(this, t, i),
                this._RemoveHandPai(t),
                this.LiPai(),
                this.last_tile = null,
                this.pendingXiangGong(!1, "AddGang")
            } catch (t) {
                var n = {};
                n.error = t.message,
                n.stack = t.stack,
                n.method = "AddGang",
                n.class = "ViewPlayer_Me",
                GameMgr.Inst.onFatalError(n)
            }
        }
        ,
        i.prototype.LiPai = function(e) {
            void 0 === e && (e = !1);
            for (i = 0; i < this.hand.length; i++)
                this.hand[i].SelectEnd();
            if (t.DesktopMgr.Inst.auto_liqi || t.DesktopMgr.Inst.mode != t.EMJMode.play) {
                this.hand.sort(t.HandPaiPlane.Cmp);
                for (var i = 0; i < this.hand.length; i++)
                    this.hand[i].SetIndex(i, !1, !e),
                    t.DesktopMgr.Inst.mode != t.EMJMode.play && this.hand[i].RefreshPaoPai()
            }
        }
        ,
        i.prototype.AddMing = function(t, e) {
            void 0 === e && (e = !0),
            app.Log.log("ViewPlayer_Me AddMing " + t.toString() + " doanim:" + e);
            try {
                for (var i = 0; i < t.pais.length; i++)
                    t.from[i] == this.seat && this._RemoveHandPai(t.pais[i]);
                this.container_ming.AddMing(t, e),
                this.LiPai(),
                this.last_tile = null,
                this.pendingXiangGong(t.type == mjcore.E_Ming.kezi || t.type == mjcore.E_Ming.shunzi, "AddMing")
            } catch (t) {
                var n = {};
                n.error = t.message,
                n.stack = t.stack,
                n.method = "AddMing",
                n.class = "ViewPlayer_Me",
                GameMgr.Inst.onFatalError(n)
            }
        }
        ,
        i.prototype.ChiTiSelect = function(t) {
            for (var e = 0; e < this.hand.length; e++)
                this.hand[e].ChiTiSelect(t)
        }
        ,
        i.prototype.LiQiSelect = function(t, e) {
            this.during_liqi = e;
            for (var i = 0; i < this.hand.length; i++)
                e ? this.hand[i].LiqiSelect(t) : this.hand[i].SelectEnd()
        }
        ,
        i.prototype.HulePrepare = function(e, i, n) {
            app.Log.log("ViewPlayer_Me HulePrepare " + i.toString() + " zimo:" + n);
            try {
                uiscript.UI_DesktopInfo.Inst.setZhenting(!1);
                for (r = 0; r < this.hand.length; r++)
                    this.hand[r].Hule();
                for (var a = [], r = 0; r < e.length; r++) {
                    var s = new t.HandPai3D(this.trans_hand3D);
                    s.SetVal(e[r]),
                    s.SetIndex(r, !1),
                    s.Stand(),
                    a.push(s)
                }
                this._hand3d = a,
                this.trans_hand3D.active = !0
            } catch (t) {
                var o = {};
                o.error = t.message,
                o.stack = t.stack,
                o.method = "HulePrepare",
                o.class = "ViewPlayer_Me",
                GameMgr.Inst.onFatalError(o)
            }
        }
        ,
        i.prototype.Hule = function(e, i, n, a) {
            var r = this;
            if (app.Log.log("ViewPlayer_Me Hule " + i.toString() + " zimo:" + n),
            n) {
                var s = new t.HandPai3D(this.trans_hand3D);
                s.SetVal(i),
                s.SetIndex(this._hand3d.length, !0),
                this._hand3d.push(s),
                s.FullDown(),
                s.shadow.active = !1,
                s.model.transform.localPosition.z += .15 * t.PAIMODEL_HEIGHT;
                var o = s.pai3D.model.transform.position.clone();
                this.hand3d.transform.position = o.clone(),
                this.hand3d.getChildAt(0).getChildByName("node_tile").addChild(s.pai3D.model),
                s.pai3D.model.transform.localPosition = new Laya.Vector3(0,0,0),
                s.pai3D.model.transform.localRotationEuler = new Laya.Vector3(0,0,0);
                var l = t.ModelAnimationController.get_anim_config("Zimo", this.hand_type);
                this.playHandAnimtion(l),
                Laya.timer.once(l.keypoint[0], this, function() {
                    t.AudioMgr.PlayAudio(227)
                }),
                Laya.timer.once(l.keypoint[1], this, function() {
                    s.contianer_pai.addChild(s.pai3D.model),
                    s.pai3D.model.transform.localRotationEuler = new Laya.Vector3(0,180,0),
                    s.FullDown(),
                    Laya.timer.once(100, r, function() {
                        return t.DesktopMgr.Inst.ShowHuleEffect(s.pai3D.model.transform.position, t.DesktopMgr.Inst.player_effects[r.seat].effect_hupai)
                    })
                })
            }
            var h = this._hand3d.length - (n ? 1 : 0)
              , c = n ? 1100 : 200;
            Laya.timer.once(c, this, function() {
                if (0 != r._hand3d.length) {
                    t.AudioMgr.PlayAudio(223);
                    for (var e = 0; e < h; e++)
                        r._hand3d[e].DoAnim_FullDown()
                }
            }),
            this.trans_hand3D.active = !0
        }
        ,
        i.prototype.Huangpai = function(e, i, n) {
            var a = this;
            app.Log.log("ViewPlayer_Me Huangpai  tingpai:" + e + " fast:" + n),
            uiscript.UI_DesktopInfo.Inst.setZhenting(!1);
            for (o = 0; o < this.hand.length; o++)
                this.hand[o].Hule();
            for (var r = [], s = e ? this.trans_hand3D : this.trans_hand3DCover, o = 0; o < this.hand.length; o++) {
                var l = new t.HandPai3D(s);
                l.SetVal(this.hand[o].val),
                l.SetIndex(o, !1),
                l.Stand(),
                r.push(l)
            }
            var h = r.length;
            if (n)
                for (o = 0; o < h; o++)
                    e ? this._hand3d[o].FullDown() : this._hand3d[o].Cover();
            else
                Laya.timer.once(500, this, function() {
                    for (var i = 0; i < h; i++)
                        e ? a._hand3d[i].DoAnim_FullDown() : a._hand3d[i].DoAnim_Cover();
                    t.AudioMgr.PlayAudio(223)
                });
            this._hand3d = r,
            s.active = !0
        }
        ,
        i.prototype.OnDoraRefresh = function() {
            if (-1 != this.seat) {
                e.prototype.OnDoraRefresh.call(this);
                for (var t = 0; t < this.hand.length; t++)
                    this.hand[t].RefreshDora()
            }
        }
        ,
        i.prototype.DoDiscardTile = function() {
            if (app.Log.log("ViewPlayer_Me DoDiscardTile"),
            this.during_liqi) {
                if (!this.desktop.Action_LiQi(this._choose_pai.val, this._choose_pai === this.last_tile))
                    return;
                this.during_liqi = !1
            } else
                this.desktop.Action_QiPai(this._choose_pai.val, this._choose_pai === this.last_tile, !1);
            this._prediscard_index = this._choose_pai.index,
            this._choose_pai.mySelf.active = !1,
            this._choose_pai = null,
            this.can_discard = !1
        }
        ,
        i.prototype.onShowPaopaiChange = function() {
            if (t.DesktopMgr.Inst.gameing)
                for (var e = 0; e < this.hand.length; e++)
                    this.hand[e].ispaopai = t.DesktopMgr.Inst.isPaoPai(this.hand[e].val),
                    this.hand[e].RefreshPaoPai()
        }
        ,
        i.prototype.pendingXiangGong = function(t, e) {
            if (!this.xianggonged)
                try {
                    var i = 13 - 3 * this.container_ming.mings.length;
                    t && i++;
                    for (var n = !1, a = 0; a < this.hand.length; a++)
                        if (this.hand[a].index != a) {
                            n = !0;
                            break
                        }
                    for (var r = "", a = 0; a < this.hand.length; a++)
                        0 != a && (r += ", "),
                        r += "[" + a + "|" + this.hand[a].index + "]" + this.hand[a].val.toString();
                    if (app.Log.log("hands: " + r),
                    this.hand.length != i || n || this.hand.length + this.handpool.length != 16) {
                        this.xianggonged = !0;
                        var s = {};
                        s.from = e,
                        s.need_discard = t,
                        s.ming_count = this.container_ming.mings.length,
                        s.tile_count = i,
                        s.hand_length = this.hand.length,
                        s.index_error = n,
                        s.hands = r,
                        s.handpool_count = this.handpool.length,
                        GameMgr.Inst.onXiangGongError(s)
                    }
                } catch (t) {}
        }
        ,
        i.prototype.onDoubleClick = function() {
            this.can_discard && (this.during_liqi || this.last_tile && (t.DesktopMgr.Inst.timestoped || (this.desktop.Action_QiPai(this.last_tile.val, !0, !1),
            this._prediscard_index = this.hand.length - 1,
            this.last_tile.mySelf.active = !1,
            this._choose_pai = null,
            this.can_discard = !1)))
        }
        ,
        i.prototype.setChoosePai = function(e, i) {
            if (this._choose_pai !== e) {
                if (this._choose_pai && this._choose_pai != e) {
                    var n = this._choose_pai.mySelf.transform.localPosition.clone();
                    n.y = 0,
                    this._choose_pai.mySelf.transform.localPosition = n,
                    this._choose_pai = null
                }
                this._choose_pai = e;
                var a = this._choose_pai.mySelf.transform.localPosition.clone();
                a.y = .8,
                this._choose_pai.mySelf.transform.localPosition = a,
                i && e.AddClickEffect(this.effect_click.clone()),
                t.DesktopMgr.Inst.setChoosedPai(this._choose_pai.val),
                t.AudioMgr.PlayAudio(204)
            }
        }
        ,
        i.prototype.resetMouseState = function() {
            if (this._mouse_in_pai = null,
            this.during_drag = !1,
            this.mouse_downed = !1,
            this.click_on_choosed = !1,
            this._choose_pai) {
                var e = this._choose_pai.mySelf.transform.localPosition.clone();
                e.y = 0,
                this._choose_pai.mySelf.transform.localPosition = e,
                this._choose_pai = null
            }
            t.DesktopMgr.Inst.setChoosedPai(null)
        }
        ,
        i.prototype.onMouseDown = function() {
            if (t.DesktopMgr.Inst.gameing && !(t.DesktopMgr.Inst.mode == t.EMJMode.play && t.DesktopMgr.Inst.timestoped || uiscript.UI_Hangup_Warn.Inst.enable)) {
                var e = this.getMouseInfo();
                e.pai ? (this._choose_pai === e.pai ? this.click_on_choosed = !0 : (this.setChoosePai(e.pai, !0),
                this.click_on_choosed = !1),
                this.mouse_downx = Laya.MouseManager.instance.mouseX,
                this.mouse_downy = Laya.MouseManager.instance.mouseY,
                this.mouse_downed = !0) : this.resetMouseState()
            }
        }
        ,
        i.prototype.onMouseMove = function() {
            if (t.DesktopMgr.Inst.mode == t.EMJMode.play && (t.DesktopMgr.Inst.mode != t.EMJMode.play || !t.DesktopMgr.Inst.timestoped) && !uiscript.UI_Hangup_Warn.Inst.enable && this._choose_pai && this.mouse_downed) {
                var e = Laya.MouseManager.instance.mouseX
                  , i = Laya.MouseManager.instance.mouseY;
                (e - this.mouse_downx) * (e - this.mouse_downx) + (i - this.mouse_downy) * (i - this.mouse_downy) > 400 && (this.during_drag = !0)
            }
        }
        ,
        i.prototype.onMouseUp = function() {
            if (t.DesktopMgr.Inst.gameing && !(t.DesktopMgr.Inst.mode == t.EMJMode.play && t.DesktopMgr.Inst.timestoped || uiscript.UI_Hangup_Warn.Inst.enable)) {
                var e = this.getMouseInfo();
                this.mouse_downed = !1,
                this.during_drag ? (this.during_drag = !1,
                null == this._choose_pai ? this.resetMouseState() : this.can_discard && !e.inHandRange && this._choose_pai.valid ? (this.DoDiscardTile(),
                this.resetMouseState()) : this.resetMouseState()) : this.click_on_choosed && this.can_discard && this._choose_pai.valid && (this.DoDiscardTile(),
                this.resetMouseState())
            }
        }
        ,
        i.prototype.onMouseOut = function() {
            this.mouse_downed = !1,
            this.click_on_choosed = !1,
            this.during_drag && (this.during_drag = !1,
            this.resetMouseState())
        }
        ,
        i.prototype.getMouseInfo = function() {
            var e = Laya.MouseManager.instance.mouseX
              , i = Laya.MouseManager.instance.mouseY
              , n = 0
              , a = 0;
            Laya.Browser.width / 1920 < Laya.Browser.height / 1080 ? a = (Laya.Browser.height - Laya.Browser.width / 1920 * 1080) / 2 : n = (Laya.Browser.width - Laya.Browser.height / 1080 * 1920) / 2;
            var r = e / (Laya.Browser.width - 2 * n) * (this.screen_right - this.screen_left) + this.screen_left
              , s = i / (Laya.Browser.height - 2 * a) * (this.screen_bottom - this.screen_top) + this.screen_top
              , o = Math.floor((r - this.handorigin_x) / this.handwidth);
            o < 0 && (o = 0),
            o >= this.hand.length && (o = this.hand.length - 1);
            var l = null;
            return game.Scene_MJ.Inst.camera_hand.viewportPointToRay(new Laya.Vector2(e,i), this.ray),
            Laya.Physics.rayCast(this.ray, this.rayCastHit, 300),
            this.rayCastHit.sprite3D && (l = this.rayCastHit.sprite3D.getComponentByType(t.HandPaiPlane)),
            {
                inHandRange: s < this.handrange_top,
                index: o,
                x: r,
                y: s,
                pai: l
            }
        }
        ,
        i.prototype.update = function() {
            var e = this.getMouseInfo();
            if (this.during_drag)
                if (!t.DesktopMgr.Inst.gameing || t.DesktopMgr.Inst.timestoped)
                    this.resetMouseState();
                else if (null == this._choose_pai)
                    this.resetMouseState();
                else {
                    if (!t.DesktopMgr.Inst.auto_liqi && e.inHandRange && e.index != this._choose_pai.index) {
                        if (e.index < this._choose_pai.index) {
                            for (i = e.index; i < this._choose_pai.index; i++)
                                this.hand[i].SetIndex(i + 1, !1, !0);
                            for (i = this._choose_pai.index; i > e.index; i--)
                                this.hand[i] = this.hand[i - 1],
                                this.hand[i].SetIndex(i, !1, !0)
                        } else
                            for (var i = this._choose_pai.index; i < e.index; i++)
                                this.hand[i] = this.hand[i + 1],
                                this.hand[i].SetIndex(i, !1, !0);
                        this.hand[e.index] = this._choose_pai,
                        this._choose_pai.SetIndex(e.index, !1, !0)
                    }
                    this._choose_pai.mySelf.parent.setChildIndex(this._choose_pai.mySelf, this._choose_pai.mySelf.parent.numChildren - 1),
                    this._choose_pai.mySelf.transform.localPosition = new Laya.Vector3(e.x,e.y,.5)
                }
            else if (!this.mouse_downed) {
                if (t.DesktopMgr.Inst.mode == t.EMJMode.play && t.DesktopMgr.Inst.timestoped)
                    return;
                if (uiscript.UI_Hangup_Warn.Inst.enable)
                    return;
                if (Laya.Browser.onPC && !GameMgr.inConch && 0 == t.DesktopMgr.click_prefer && t.DesktopMgr.Inst.gameing)
                    if (null == e.pai)
                        this.resetMouseState();
                    else if (this._mouse_in_pai && this._mouse_in_pai === e.pai) {
                        Laya.timer.currTimer - this._mouse_in_start_time > 10 && (this.setChoosePai(this._mouse_in_pai, !1),
                        this._mouse_in_pai = null)
                    } else
                        this._mouse_in_pai = e.pai,
                        this._mouse_in_start_time = Laya.timer.currTimer
            }
        }
        ,
        i.Inst = null,
        i
    }(t.ViewPlayer);
    t.ViewPlayer_Me = e
}(view || (view = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), view;
!function(t) {
    var e = function(e) {
        function i() {
            var t = e.call(this) || this;
            return t.handnum = 0,
            t.hand = null,
            t.discardcd = 0,
            t.debug_new_round_frame = -1,
            t.debug_reset_frame = -1,
            t
        }
        return __extends(i, e),
        i.prototype.Reset = function() {
            if (e.prototype.Reset.call(this),
            null != this.hand) {
                for (var t = 0; t < this.hand.length; t++)
                    this.hand[t].Destory();
                this.hand = null
            }
            Laya.timer.clearAll(this),
            this.discardcd = 0,
            this.debug_reset_frame = Laya.timer.currFrame
        }
        ,
        i.prototype.ForceSet = function(t) {
            this.Reset(),
            this.RefreshDir(),
            this.hand = [],
            this.SetNum(t)
        }
        ,
        i.prototype.NewGame = function(e, i) {
            var n = this;
            if (this.Reset(),
            this.RefreshDir(),
            this.handnum = e,
            this.hand = [],
            i)
                for (s = 0; s < e; s++) {
                    var a = new t.HandPai3D(this.trans_hand.parent);
                    a.SetVal(mjcore.MJPai.Create("5z")),
                    a.SetIndex(s, 14 == s),
                    a.Stand(),
                    this.hand.push(a)
                }
            else {
                for (var r = 0, s = 0; s < 4; s++)
                    Laya.timer.once(300 * s, this, function() {
                        for (var i = 0; i < 4 && r != e; i++) {
                            r++;
                            var a = new t.HandPai3D(n.trans_hand.parent);
                            a.SetVal(mjcore.MJPai.Create("5z")),
                            a.SetIndex(r - 1, !1),
                            n.hand.push(a),
                            a.DoAnim_Stand()
                        }
                    });
                14 == e && Laya.timer.once(900, this, function() {
                    n.hand[13].SetIndex(13, !0)
                })
            }
        }
        ,
        i.prototype.RecordNewGame = function(e) {
            this.Reset(),
            this.RefreshDir(),
            this.handnum = e.length,
            this.hand = [];
            for (var i = 0; i < e.length; i++) {
                var n = new t.HandPai3D(this.trans_hand.parent);
                n.SetVal(e[i]),
                n.SetIndex(i, 14 == i),
                t.DesktopMgr.Inst.record_show_hand ? n.FullDown() : n.Stand(),
                this.hand.push(n)
            }
            this.debug_new_round_frame = Laya.timer.currFrame
        }
        ,
        i.prototype.LiPai = function() {
            this.hand[this.hand.length - 1].SetIndex(this.hand.length - 1, !1),
            this.hand[this.hand.length - 1].Stand()
        }
        ,
        i.prototype.onBabei = function(t, e) {
            this.onDiscardTile(t, e)
        }
        ,
        i.prototype.onDiscardTile = function(t, e) {
            var i = this;
            if (!(this.seat < 0))
                if (app.Log.log("ViewPlayer_Other onDiscardTile  moqie:" + t + " fast:" + e),
                e)
                    this.hand[this.hand.length - 1].Destory(),
                    this.hand.pop();
                else if (t)
                    this.hand[this.hand.length - 1].Destory(),
                    this.hand.pop();
                else {
                    var n = Math.floor(Math.random() * (this.hand.length - 1));
                    this.hand[n].Destory(),
                    this.discardcd = 1200 + Laya.timer.currTimer,
                    Laya.timer.once(1e3, this, function() {
                        i.hand[n] = i.hand[i.hand.length - 1],
                        i.hand.pop(),
                        i.hand[n].SetIndex(n, !1),
                        i.hand[n].Stand()
                    })
                }
        }
        ,
        i.prototype._RemoveHandPai = function(t, e) {
            if (void 0 === e && (e = !0),
            e) {
                for (i = 0; i < this.hand.length; i++)
                    if (mjcore.MJPai.isSame(t, this.hand[i].val)) {
                        n = this.hand[i];
                        this.hand[i] = this.hand[this.hand.length - 1],
                        this.hand[this.hand.length - 1] = n,
                        this.hand.pop(),
                        n.Destory();
                        break
                    }
            } else
                for (var i = this.hand.length - 1; i >= 0; i--)
                    if (mjcore.MJPai.isSame(t, this.hand[i].val)) {
                        var n = this.hand[i];
                        this.hand[i] = this.hand[this.hand.length - 1],
                        this.hand[this.hand.length - 1] = n,
                        this.hand.pop(),
                        n.Destory();
                        break
                    }
        }
        ,
        i.prototype._LiPai = function() {
            this.hand.sort(function(t, e) {
                return mjcore.MJPai.Distance(t.val, e.val)
            });
            for (var t = 0; t < this.hand.length; t++)
                this.hand[t].SetIndex(t, !1)
        }
        ,
        i.prototype.recordBabei = function(t, e, i) {
            this.recordDiscardTile(t, e, i)
        }
        ,
        i.prototype.recordDiscardTile = function(t, e, i) {
            var n = this;
            this.seat < 0 || (this._RemoveHandPai(t, !e),
            i ? this._LiPai() : Laya.timer.once(1e3, this, function() {
                n._LiPai()
            }))
        }
        ,
        i.prototype.SetNum = function(e) {
            if (!(this.seat < 0)) {
                for (app.Log.log("ViewPlayer_Other SetNum  _num:" + e + " _oldnum:" + this.hand.length); this.hand.length < e; ) {
                    var i = new t.HandPai3D(this.trans_hand.parent);
                    i.SetVal(mjcore.MJPai.Create("5z")),
                    i.SetIndex(this.hand.length, !1),
                    i.Stand(),
                    this.hand.push(i)
                }
                for (; this.hand.length > e; )
                    this.hand[this.hand.length - 1].Destory(),
                    this.hand.pop();
                app.Log.log("ViewPlayer_Other SetNum _chandlength:" + this.hand.length),
                this.LiPai()
            }
        }
        ,
        i.prototype.AddMing = function(i, n) {
            if (void 0 === n && (n = !0),
            !(this.seat < 0)) {
                app.Log.log("ViewPlayer_Other AddMing  ming:" + i.toString() + " doanim:" + n);
                try {
                    if (t.DesktopMgr.Inst.mode == t.EMJMode.play) {
                        for (var a = 0, r = 0; r < i.pais.length; r++)
                            i.from[r] == this.seat && a++;
                        this.SetNum(this.hand.length - a)
                    } else {
                        for (r = 0; r < i.pais.length; r++)
                            i.from[r] == this.seat && this._RemoveHandPai(i.pais[r]);
                        this._LiPai()
                    }
                    e.prototype.AddMing.call(this, i, n)
                } catch (t) {
                    var s = {};
                    s.error = t.message,
                    s.stack = t.stack,
                    s.method = "AddMing",
                    s.class = "ViewPlayer_Other",
                    GameMgr.Inst.onFatalError(s)
                }
            }
        }
        ,
        i.prototype.AddGang = function(i, n) {
            if (void 0 === n && (n = !0),
            !(this.seat < 0)) {
                app.Log.log("ViewPlayer_Other AddGang " + i.toString() + " doanim:" + n);
                try {
                    e.prototype.AddGang.call(this, i, n),
                    t.DesktopMgr.Inst.mode == t.EMJMode.play ? this.SetNum(this.hand.length - 1) : (this._RemoveHandPai(i),
                    this._LiPai())
                } catch (t) {
                    var a = {};
                    a.error = t.message,
                    a.stack = t.stack,
                    a.method = "TakePai",
                    a.class = "ViewPlayer_Other",
                    GameMgr.Inst.onFatalError(a)
                }
            }
        }
        ,
        i.prototype.OnDoraRefresh = function() {
            if (!(this.seat < 0) && (e.prototype.OnDoraRefresh.call(this),
            t.DesktopMgr.Inst.mode != t.EMJMode.play))
                for (var i = 0; i < this.hand.length; i++)
                    this.hand[i].pai3D.RefreshDora()
        }
        ,
        i.prototype.TakePai = function(e) {
            if (!(this.seat < 0)) {
                app.Log.log("ViewPlayer_Other TakePai " + e.toString());
                try {
                    var i = new t.HandPai3D(this.trans_hand.parent);
                    i.SetVal(e),
                    i.SetIndex(this.hand.length, !0),
                    i.Stand(),
                    this.hand.push(i)
                } catch (t) {
                    var n = {};
                    n.error = t.message,
                    n.stack = t.stack,
                    n.method = "TakePai",
                    n.class = "ViewPlayer_Other",
                    n.last_new_round_frame = this.debug_new_round_frame,
                    n.last_reset_frame = this.debug_reset_frame,
                    n.hand_is_null = null == this.hand,
                    GameMgr.Inst.onFatalError(n)
                }
            }
        }
        ,
        i.prototype.recordTakePai = function(e) {
            if (!(this.seat < 0)) {
                var i = new t.HandPai3D(this.trans_hand.parent);
                i.SetVal(e),
                i.SetIndex(this.hand.length, !0),
                t.DesktopMgr.Inst.record_show_hand ? (i.FullDown(),
                i.pai3D.ispaopai = t.DesktopMgr.Inst.isPaoPai(i.pai3D.val)) : i.Stand(),
                i.pai3D.OnChoosedPai(),
                this.hand.push(i)
            }
        }
        ,
        i.prototype.Hule = function(e, i, n, a) {
            var r = this;
            if (!(this.seat < 0))
                if (app.Log.log("ViewPlayer_Other Hule " + i.toString() + " zimo:" + n),
                t.DesktopMgr.Inst.mode == t.EMJMode.play) {
                    if (this.SetNum(e.length + (n ? 1 : 0)),
                    n) {
                        var s = this.hand[this.hand.length - 1];
                        s.SetVal(i),
                        s.SetIndex(this.hand.length - 1, !0),
                        s.FullDown(),
                        s.model.transform.localPosition.z += .2 * t.PAIMODEL_HEIGHT,
                        s.shadow.active = !1;
                        u = s.pai3D.model.transform.position.clone();
                        this.hand3d.transform.position = u.clone(),
                        this.hand3d.getChildAt(0).getChildByName("node_tile").addChild(s.pai3D.model),
                        s.pai3D.model.transform.localPosition = new Laya.Vector3(0,0,0),
                        s.pai3D.model.transform.localRotationEuler = new Laya.Vector3(0,0,0);
                        var o = t.ModelAnimationController.get_anim_config("Zimo", this.hand_type);
                        this.playHandAnimtion(o),
                        Laya.timer.once(o.keypoint[0], this, function() {
                            t.AudioMgr.PlayAudio(227)
                        }),
                        Laya.timer.once(o.keypoint[1], this, function() {
                            s.contianer_pai.addChild(s.pai3D.model),
                            s.pai3D.model.transform.localRotationEuler = new Laya.Vector3(0,180,0),
                            s.FullDown(),
                            Laya.timer.once(100, r, function() {
                                return t.DesktopMgr.Inst.ShowHuleEffect(s.pai3D.model.transform.position, t.DesktopMgr.Inst.player_effects[r.seat].effect_hupai)
                            })
                        })
                    }
                    var l = e.length
                      , h = n ? 1100 : 200;
                    Laya.timer.once(h, this, function() {
                        t.AudioMgr.PlayAudio(223);
                        for (var i = 0; i < l; i++)
                            r.hand[i].SetVal(e[i]),
                            r.hand[i].DoAnim_FullDown()
                    })
                } else {
                    if (n) {
                        var c = this.hand[this.hand.length - 1];
                        c.SetVal(i),
                        c.SetIndex(this.hand.length - 1, !0),
                        c.FullDown(),
                        c.model.transform.localPosition.z += .2 * t.PAIMODEL_HEIGHT,
                        c.shadow.active = !1;
                        var u = c.pai3D.model.transform.position.clone();
                        this.hand3d.transform.position = u.clone(),
                        this.hand3d.getChildAt(0).getChildByName("node_tile").addChild(c.pai3D.model),
                        c.pai3D.model.transform.localPosition = new Laya.Vector3(0,0,0),
                        c.pai3D.model.transform.localRotationEuler = new Laya.Vector3(0,0,0);
                        var _ = t.ModelAnimationController.get_anim_config("Zimo", this.hand_type);
                        this.playHandAnimtion(_),
                        Laya.timer.once(_.keypoint[0], this, function() {
                            t.AudioMgr.PlayAudio(227)
                        }),
                        Laya.timer.once(_.keypoint[1], this, function() {
                            c.contianer_pai.addChild(c.pai3D.model),
                            c.pai3D.model.transform.localRotationEuler = new Laya.Vector3(0,180,0),
                            c.FullDown(),
                            Laya.timer.once(100, r, function() {
                                return t.DesktopMgr.Inst.ShowHuleEffect(c.pai3D.model.transform.position, t.DesktopMgr.Inst.player_effects[r.seat].effect_hupai)
                            })
                        })
                    }
                    if (t.DesktopMgr.Inst.record_show_hand)
                        ;
                    else {
                        var d = e.length
                          , h = n ? 1100 : 200;
                        Laya.timer.once(h, this, function() {
                            t.AudioMgr.PlayAudio(223);
                            for (var e = 0; e < d; e++)
                                r.hand[e].DoAnim_FullDown()
                        })
                    }
                }
        }
        ,
        i.prototype.Huangpai = function(e, i, n) {
            var a = this;
            if (!(this.seat < 0))
                if (app.Log.log("ViewPlayer_Other Huangpai  tingpai:" + e + " fast:" + n),
                t.DesktopMgr.Inst.mode == t.EMJMode.play)
                    if (n)
                        if (e) {
                            this.SetNum(i.length);
                            for (r = 0; r < i.length; r++)
                                this.hand[r].SetVal(i[r]),
                                this.hand[r].FullDown()
                        } else
                            for (var r = 0; r < this.hand.length; r++)
                                this.hand[r].Cover();
                    else
                        Laya.timer.once(300, this, function() {
                            if (t.AudioMgr.PlayAudio(223),
                            e) {
                                a.SetNum(i.length);
                                for (n = 0; n < i.length; n++)
                                    a.hand[n].SetVal(i[n]),
                                    a.hand[n].DoAnim_FullDown()
                            } else
                                for (var n = 0; n < a.hand.length; n++)
                                    a.hand[n].DoAnim_Cover()
                        });
                else
                    t.DesktopMgr.Inst.record_show_hand || Laya.timer.once(300, this, function() {
                        if (t.AudioMgr.PlayAudio(223),
                        e)
                            for (n = 0; n < i.length; n++)
                                a.hand[n].DoAnim_FullDown();
                        else
                            for (var n = 0; n < a.hand.length; n++)
                                a.hand[n].DoAnim_Cover()
                    })
        }
        ,
        i.prototype.onShowHandChange = function(e) {
            if (!(this.seat < 0) && t.DesktopMgr.Inst.gameing)
                for (var i = 0; i < this.hand.length; i++)
                    e ? (this.hand[i].FullDown(),
                    this.hand[i].pai3D.ispaopai = t.DesktopMgr.Inst.isPaoPai(this.hand[i].pai3D.val)) : (this.hand[i].Stand(),
                    this.hand[i].pai3D.ispaopai = !1),
                    this.hand[i].pai3D.OnChoosedPai()
        }
        ,
        i.prototype.onShowPaopaiChange = function() {
            if (!(this.seat < 0) && t.DesktopMgr.Inst.gameing && t.DesktopMgr.Inst.record_show_hand)
                for (var e = 0; e < this.hand.length; e++)
                    this.hand[e].pai3D.ispaopai = t.DesktopMgr.Inst.isPaoPai(this.hand[e].pai3D.val),
                    this.hand[e].pai3D.OnChoosedPai()
        }
        ,
        i.prototype.OnChoosePai = function() {
            if (!(this.seat < 0) && (e.prototype.OnChoosePai.call(this),
            (t.DesktopMgr.Inst.mode == t.EMJMode.paipu || t.DesktopMgr.Inst.mode == t.EMJMode.live_broadcast) && t.DesktopMgr.Inst.record_show_hand))
                for (var i = 0; i < this.hand.length; i++)
                    this.hand[i].pai3D.OnChoosedPai()
        }
        ,
        i
    }(t.ViewPlayer);
    t.ViewPlayer_Other = e
}(view || (view = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), caps;
!function(t) {
    var e = function(t) {
        function e(e) {
            var i = t.call(this) || this;
            return "" != e && i.setShaderName(e),
            i
        }
        return __extends(e, t),
        e.prototype.setInt = function(t, e) {
            this._setInt(t, e)
        }
        ,
        e.prototype.getInt = function(t) {
            return this._getInt(t)
        }
        ,
        e.prototype.setNumber = function(t, e) {
            this._setNumber(t, e)
        }
        ,
        e.prototype.getNumber = function(t) {
            return this._getNumber(t)
        }
        ,
        e.prototype.setBool = function(t, e) {
            this._setBool(t, e)
        }
        ,
        e.prototype.getBool = function(t) {
            return this._getBool(t)
        }
        ,
        e.prototype.setVector2 = function(t, e) {
            this._setVector2(t, e)
        }
        ,
        e.prototype.getVector2 = function(t) {
            return this._getVector2(t)
        }
        ,
        e.prototype.setColor = function(t, e) {
            this._setColor(t, e)
        }
        ,
        e.prototype.getColor = function(t) {
            return this._getColor(t)
        }
        ,
        e.prototype.setTexture = function(t, e) {
            this._setTexture(t, e)
        }
        ,
        e.prototype.getTexture = function(t) {
            return this._getTexture(t)
        }
        ,
        e
    }(Laya.BaseMaterial);
    t.BaseMaterial = e
}(caps || (caps = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), caps;
!function(t) {
    var e = function(t) {
        function e(e) {
            var i = t.call(this, e) || this;
            return i.cull = 2,
            i.blend = 1,
            i.srcBlend = 770,
            i.dstBlend = 771,
            i.alphaTest = !0,
            i.depthWrite = !0,
            i.renderQueue = 2,
            i
        }
        return __extends(e, t),
        e
    }(t.BaseMaterial);
    t.Material_Clip = e
}(caps || (caps = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), caps;
!function(t) {
    var e = function(e) {
        function i(i) {
            var n = e.call(this, i) || this;
            return n.cull = t.BaseMaterial.CULL_FRONT,
            n.blend = 1,
            n.srcBlend = 770,
            n.dstBlend = 771,
            n.alphaTest = !0,
            n.depthWrite = !0,
            n.renderQueue = 2,
            n
        }
        return __extends(i, e),
        i
    }(t.BaseMaterial);
    t.Material_Outline = e
}(caps || (caps = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), View = laya.ui.View, Dialog = laya.ui.Dialog, EffectAnimation = laya.display.EffectAnimation, ui;
!function(t) {
    !function(e) {
        var i = function(e) {
            function i() {
                var i = e.call(this) || this;
                return i.effectData = t.anim.alpha_inUI.uiView,
                i
            }
            return __extends(i, e),
            i.uiView = {
                type: "View",
                props: {},
                child: [{
                    type: "Image",
                    props: {
                        y: -4,
                        x: 4,
                        skin: "myres/0p.png",
                        anchorY: .5,
                        anchorX: .5
                    },
                    compId: 2
                }],
                animations: [{
                    nodes: [{
                        target: 2,
                        keyframes: {
                            y: [{
                                value: -1,
                                tweenMethod: "linearNone",
                                tween: !0,
                                target: 2,
                                key: "y",
                                index: 0
                            }, {
                                value: 167,
                                tweenMethod: "linearNone",
                                tween: !0,
                                target: 2,
                                key: "y",
                                index: 14
                            }, {
                                value: 0,
                                tweenMethod: "backIn",
                                tween: !0,
                                target: 2,
                                key: "y",
                                index: 20
                            }],
                            x: [{
                                value: -1,
                                tweenMethod: "backIn",
                                tween: !0,
                                target: 2,
                                key: "x",
                                index: 0
                            }, {
                                value: -360,
                                tweenMethod: "linearNone",
                                tween: !0,
                                target: 2,
                                key: "x",
                                index: 14
                            }, {
                                value: 0,
                                tweenMethod: "backIn",
                                tween: !0,
                                target: 2,
                                key: "x",
                                index: 20
                            }],
                            scaleY: [{
                                value: 1,
                                tweenMethod: "linearNone",
                                tween: !0,
                                target: 2,
                                key: "scaleY",
                                index: 0
                            }, {
                                value: .58,
                                tweenMethod: "linearNone",
                                tween: !0,
                                target: 2,
                                key: "scaleY",
                                index: 7
                            }, {
                                value: 2,
                                tweenMethod: "linearNone",
                                tween: !0,
                                target: 2,
                                key: "scaleY",
                                index: 20
                            }],
                            scaleX: [{
                                value: 1,
                                tweenMethod: "linearNone",
                                tween: !0,
                                target: 2,
                                key: "scaleX",
                                index: 0
                            }, {
                                value: .5,
                                tweenMethod: "linearNone",
                                tween: !0,
                                target: 2,
                                key: "scaleX",
                                index: 7
                            }, {
                                value: 2,
                                tweenMethod: "linearNone",
                                tween: !0,
                                target: 2,
                                key: "scaleX",
                                index: 20
                            }, {
                                value: 1,
                                tweenMethod: "linearNone",
                                tween: !0,
                                target: 2,
                                key: "scaleX",
                                index: 31
                            }],
                            rotation: [{
                                value: 0,
                                tweenMethod: "linearNone",
                                tween: !0,
                                target: 2,
                                key: "rotation",
                                index: 0
                            }, {
                                value: 0,
                                tweenMethod: "linearNone",
                                tween: !0,
                                target: 2,
                                key: "rotation",
                                index: 14
                            }],
                            alpha: [{
                                value: 1,
                                tweenMethod: "linearNone",
                                tween: !0,
                                target: 2,
                                key: "alpha",
                                index: 0
                            }, {
                                value: 1,
                                tweenMethod: "backIn",
                                tween: !0,
                                target: 2,
                                key: "alpha",
                                index: 20
                            }]
                        }
                    }],
                    name: "in",
                    id: 1,
                    frameRate: 60,
                    action: 0
                }, {
                    nodes: [{
                        target: 2,
                        keyframes: {
                            y: [{
                                value: 0,
                                tweenMethod: "linearNone",
                                tween: !0,
                                target: 2,
                                key: "y",
                                index: 0
                            }],
                            x: [{
                                value: 0,
                                tweenMethod: "backIn",
                                tween: !0,
                                target: 2,
                                key: "x",
                                index: 0
                            }, {
                                value: 100,
                                tweenMethod: "linearNone",
                                tween: !0,
                                target: 2,
                                key: "x",
                                index: 10
                            }]
                        }
                    }],
                    name: "out",
                    id: 2,
                    frameRate: 24,
                    action: 0
                }]
            },
            i
        }(EffectAnimation);
        e.alpha_inUI = i
    }(t.anim || (t.anim = {}))
}(ui || (ui = {})),
function(t) {
    !function(t) {
        var e = function(t) {
            function e() {
                return t.call(this) || this
            }
            return __extends(e, t),
            e.prototype.createChildren = function() {
                t.prototype.createChildren.call(this),
                this.loadUI("anim/animtest")
            }
            ,
            e
        }(View);
        t.animtestUI = e
    }(t.anim || (t.anim = {}))
}(ui || (ui = {})),
function(t) {
    !function(t) {
        var e = function(t) {
            function e() {
                return t.call(this) || this
            }
            return __extends(e, t),
            e.prototype.createChildren = function() {
                View.regComponent("capsui.CButton", capsui.CButton),
                t.prototype.createChildren.call(this),
                this.loadUI("both_ui/character_star_up")
            }
            ,
            e
        }(View);
        t.character_star_upUI = e
    }(t.both_ui || (t.both_ui = {}))
}(ui || (ui = {})),
function(t) {
    !function(t) {
        var e = function(t) {
            function e() {
                return t.call(this) || this
            }
            return __extends(e, t),
            e.prototype.createChildren = function() {
                View.regComponent("capsui.CButton", capsui.CButton),
                View.regComponent("capsui.LabelLocalizationSize", capsui.LabelLocalizationSize),
                View.regComponent("capsui.UICopy", capsui.UICopy),
                t.prototype.createChildren.call(this),
                this.loadUI("both_ui/config")
            }
            ,
            e
        }(View);
        t.configUI = e
    }(t.both_ui || (t.both_ui = {}))
}(ui || (ui = {})),
function(t) {
    !function(t) {
        var e = function(t) {
            function e() {
                return t.call(this) || this
            }
            return __extends(e, t),
            e.prototype.createChildren = function() {
                View.regComponent("capsui.CButton", capsui.CButton),
                View.regComponent("capsui.CLoading", capsui.CLoading),
                t.prototype.createChildren.call(this),
                this.loadUI("both_ui/course")
            }
            ,
            e
        }(View);
        t.courseUI = e
    }(t.both_ui || (t.both_ui = {}))
}(ui || (ui = {})),
function(t) {
    !function(t) {
        var e = function(t) {
            function e() {
                return t.call(this) || this
            }
            return __extends(e, t),
            e.prototype.createChildren = function() {
                View.regComponent("capsui.UICopy", capsui.UICopy),
                t.prototype.createChildren.call(this),
                this.loadUI("both_ui/fly_tips")
            }
            ,
            e
        }(View);
        t.fly_tipsUI = e
    }(t.both_ui || (t.both_ui = {}))
}(ui || (ui = {})),
function(t) {
    !function(t) {
        var e = function(t) {
            function e() {
                return t.call(this) || this
            }
            return __extends(e, t),
            e.prototype.createChildren = function() {
                t.prototype.createChildren.call(this),
                this.loadUI("both_ui/getcharacter")
            }
            ,
            e
        }(View);
        t.getcharacterUI = e
    }(t.both_ui || (t.both_ui = {}))
}(ui || (ui = {})),
function(t) {
    !function(t) {
        var e = function(t) {
            function e() {
                return t.call(this) || this
            }
            return __extends(e, t),
            e.prototype.createChildren = function() {
                t.prototype.createChildren.call(this),
                this.loadUI("both_ui/getreward")
            }
            ,
            e
        }(View);
        t.getrewardUI = e
    }(t.both_ui || (t.both_ui = {}))
}(ui || (ui = {})),
function(t) {
    !function(t) {
        var e = function(t) {
            function e() {
                return t.call(this) || this
            }
            return __extends(e, t),
            e.prototype.createChildren = function() {
                t.prototype.createChildren.call(this),
                this.loadUI("both_ui/gettitle")
            }
            ,
            e
        }(View);
        t.gettitleUI = e
    }(t.both_ui || (t.both_ui = {}))
}(ui || (ui = {})),
function(t) {
    !function(t) {
        var e = function(t) {
            function e() {
                return t.call(this) || this
            }
            return __extends(e, t),
            e.prototype.createChildren = function() {
                View.regComponent("capsui.CButton", capsui.CButton),
                t.prototype.createChildren.call(this),
                this.loadUI("both_ui/gitfcode")
            }
            ,
            e
        }(View);
        t.gitfcodeUI = e
    }(t.both_ui || (t.both_ui = {}))
}(ui || (ui = {})),
function(t) {
    !function(t) {
        var e = function(t) {
            function e() {
                return t.call(this) || this
            }
            return __extends(e, t),
            e.prototype.createChildren = function() {
                View.regComponent("capsui.CButton", capsui.CButton),
                t.prototype.createChildren.call(this),
                this.loadUI("both_ui/infolite")
            }
            ,
            e
        }(View);
        t.infoliteUI = e
    }(t.both_ui || (t.both_ui = {}))
}(ui || (ui = {})),
function(t) {
    !function(t) {
        var e = function(t) {
            function e() {
                return t.call(this) || this
            }
            return __extends(e, t),
            e.prototype.createChildren = function() {
                View.regComponent("capsui.LabelLocalizationSize", capsui.LabelLocalizationSize),
                View.regComponent("capsui.CButton", capsui.CButton),
                View.regComponent("capsui.UICopy", capsui.UICopy),
                t.prototype.createChildren.call(this),
                this.loadUI("both_ui/invite")
            }
            ,
            e
        }(View);
        t.inviteUI = e
    }(t.both_ui || (t.both_ui = {}))
}(ui || (ui = {})),
function(t) {
    !function(t) {
        var e = function(t) {
            function e() {
                return t.call(this) || this
            }
            return __extends(e, t),
            e.prototype.createChildren = function() {
                View.regComponent("capsui.CButton", capsui.CButton),
                t.prototype.createChildren.call(this),
                this.loadUI("both_ui/itemdetail")
            }
            ,
            e
        }(View);
        t.itemdetailUI = e
    }(t.both_ui || (t.both_ui = {}))
}(ui || (ui = {})),
function(t) {
    !function(t) {
        var e = function(t) {
            function e() {
                return t.call(this) || this
            }
            return __extends(e, t),
            e.prototype.createChildren = function() {
                t.prototype.createChildren.call(this),
                this.loadUI("both_ui/light_tips")
            }
            ,
            e
        }(View);
        t.light_tipsUI = e
    }(t.both_ui || (t.both_ui = {}))
}(ui || (ui = {})),
function(t) {
    !function(t) {
        var e = function(t) {
            function e() {
                return t.call(this) || this
            }
            return __extends(e, t),
            e.prototype.createChildren = function() {
                View.regComponent("capsui.CButton", capsui.CButton),
                View.regComponent("capsui.CScrollBar", capsui.CScrollBar),
                View.regComponent("capsui.LabelLocalizationSize", capsui.LabelLocalizationSize),
                View.regComponent("capsui.UICopy", capsui.UICopy),
                View.regComponent("capsui.CScrollView", capsui.CScrollView),
                t.prototype.createChildren.call(this),
                this.loadUI("both_ui/otherplayerinfo")
            }
            ,
            e
        }(View);
        t.otherplayerinfoUI = e
    }(t.both_ui || (t.both_ui = {}))
}(ui || (ui = {})),
function(t) {
    !function(t) {
        var e = function(t) {
            function e() {
                return t.call(this) || this
            }
            return __extends(e, t),
            e.prototype.createChildren = function() {
                View.regComponent("capsui.CButton", capsui.CButton),
                View.regComponent("capsui.CScrollBar", capsui.CScrollBar),
                View.regComponent("capsui.LabelLocalizationSize", capsui.LabelLocalizationSize),
                View.regComponent("capsui.UICopy", capsui.UICopy),
                View.regComponent("capsui.CScrollView", capsui.CScrollView),
                t.prototype.createChildren.call(this),
                this.loadUI("both_ui/otherplayerinfo_en")
            }
            ,
            e
        }(View);
        t.otherplayerinfo_enUI = e
    }(t.both_ui || (t.both_ui = {}))
}(ui || (ui = {})),
function(t) {
    !function(t) {
        var e = function(t) {
            function e() {
                return t.call(this) || this
            }
            return __extends(e, t),
            e.prototype.createChildren = function() {
                View.regComponent("capsui.CButton", capsui.CButton),
                t.prototype.createChildren.call(this),
                this.loadUI("both_ui/popwindow")
            }
            ,
            e
        }(View);
        t.popwindowUI = e
    }(t.both_ui || (t.both_ui = {}))
}(ui || (ui = {})),
function(t) {
    !function(t) {
        var e = function(t) {
            function e() {
                return t.call(this) || this
            }
            return __extends(e, t),
            e.prototype.createChildren = function() {
                View.regComponent("capsui.LabelLocalizationSize", capsui.LabelLocalizationSize),
                View.regComponent("capsui.UICopy", capsui.UICopy),
                View.regComponent("capsui.CScrollView", capsui.CScrollView),
                View.regComponent("capsui.CButton", capsui.CButton),
                View.regComponent("capsui.CLoading", capsui.CLoading),
                t.prototype.createChildren.call(this),
                this.loadUI("both_ui/rules")
            }
            ,
            e
        }(View);
        t.rulesUI = e
    }(t.both_ui || (t.both_ui = {}))
}(ui || (ui = {})),
function(t) {
    !function(t) {
        var e = function(t) {
            function e() {
                return t.call(this) || this
            }
            return __extends(e, t),
            e.prototype.createChildren = function() {
                View.regComponent("capsui.LabelLocalizationSize", capsui.LabelLocalizationSize),
                View.regComponent("capsui.UICopy", capsui.UICopy),
                View.regComponent("capsui.CScrollView", capsui.CScrollView),
                View.regComponent("capsui.CButton", capsui.CButton),
                View.regComponent("capsui.CLoading", capsui.CLoading),
                t.prototype.createChildren.call(this),
                this.loadUI("both_ui/rules_en")
            }
            ,
            e
        }(View);
        t.rules_enUI = e
    }(t.both_ui || (t.both_ui = {}))
}(ui || (ui = {})),
function(t) {
    !function(t) {
        var e = function(t) {
            function e() {
                return t.call(this) || this
            }
            return __extends(e, t),
            e.prototype.createChildren = function() {
                View.regComponent("capsui.CButton", capsui.CButton),
                t.prototype.createChildren.call(this),
                this.loadUI("both_ui/secondconfirm")
            }
            ,
            e
        }(View);
        t.secondconfirmUI = e
    }(t.both_ui || (t.both_ui = {}))
}(ui || (ui = {})),
function(t) {
    !function(t) {
        var e = function(t) {
            function e() {
                return t.call(this) || this
            }
            return __extends(e, t),
            e.prototype.createChildren = function() {
                View.regComponent("capsui.CButton", capsui.CButton),
                t.prototype.createChildren.call(this),
                this.loadUI("common/anotherlogin")
            }
            ,
            e
        }(View);
        t.anotherloginUI = e
    }(t.common || (t.common = {}))
}(ui || (ui = {})),
function(t) {
    !function(t) {
        var e = function(t) {
            function e() {
                return t.call(this) || this
            }
            return __extends(e, t),
            e.prototype.createChildren = function() {
                View.regComponent("capsui.CButton", capsui.CButton),
                t.prototype.createChildren.call(this),
                this.loadUI("common/closeapp")
            }
            ,
            e
        }(View);
        t.closeappUI = e
    }(t.common || (t.common = {}))
}(ui || (ui = {})),
function(t) {
    !function(t) {
        var e = function(t) {
            function e() {
                return t.call(this) || this
            }
            return __extends(e, t),
            e.prototype.createChildren = function() {
                t.prototype.createChildren.call(this),
                this.loadUI("common/common")
            }
            ,
            e
        }(View);
        t.commonUI = e
    }(t.common || (t.common = {}))
}(ui || (ui = {})),
function(t) {
    !function(t) {
        var e = function(t) {
            function e() {
                return t.call(this) || this
            }
            return __extends(e, t),
            e.prototype.createChildren = function() {
                t.prototype.createChildren.call(this),
                this.loadUI("common/disconnect")
            }
            ,
            e
        }(View);
        t.disconnectUI = e
    }(t.common || (t.common = {}))
}(ui || (ui = {})),
function(t) {
    !function(t) {
        var e = function(t) {
            function e() {
                return t.call(this) || this
            }
            return __extends(e, t),
            e.prototype.createChildren = function() {
                View.regComponent("capsui.CButton", capsui.CButton),
                View.regComponent("Script", laya.display.Sprite),
                t.prototype.createChildren.call(this),
                this.loadUI("common/errorinfo")
            }
            ,
            e
        }(View);
        t.errorinfoUI = e
    }(t.common || (t.common = {}))
}(ui || (ui = {})),
function(t) {
    !function(t) {
        var e = function(t) {
            function e() {
                return t.call(this) || this
            }
            return __extends(e, t),
            e.prototype.createChildren = function() {
                View.regComponent("capsui.CButton", capsui.CButton),
                t.prototype.createChildren.call(this),
                this.loadUI("common/hangup_logout")
            }
            ,
            e
        }(View);
        t.hangup_logoutUI = e
    }(t.common || (t.common = {}))
}(ui || (ui = {})),
function(t) {
    !function(t) {
        var e = function(t) {
            function e() {
                return t.call(this) || this
            }
            return __extends(e, t),
            e.prototype.createChildren = function() {
                t.prototype.createChildren.call(this),
                this.loadUI("common/loading")
            }
            ,
            e
        }(View);
        t.loadingUI = e
    }(t.common || (t.common = {}))
}(ui || (ui = {})),
function(t) {
    !function(t) {
        var e = function(t) {
            function e() {
                return t.call(this) || this
            }
            return __extends(e, t),
            e.prototype.createChildren = function() {
                t.prototype.createChildren.call(this),
                this.loadUI("common/preventaddiction")
            }
            ,
            e
        }(View);
        t.preventaddictionUI = e
    }(t.common || (t.common = {}))
}(ui || (ui = {})),
function(t) {
    !function(t) {
        var e = function(t) {
            function e() {
                return t.call(this) || this
            }
            return __extends(e, t),
            e.prototype.createChildren = function() {
                View.regComponent("capsui.CButton", capsui.CButton),
                t.prototype.createChildren.call(this),
                this.loadUI("common/reconnect")
            }
            ,
            e
        }(View);
        t.reconnectUI = e
    }(t.common || (t.common = {}))
}(ui || (ui = {})),
function(t) {
    !function(t) {
        var e = function(t) {
            function e() {
                return t.call(this) || this
            }
            return __extends(e, t),
            e.prototype.createChildren = function() {
                t.prototype.createChildren.call(this),
                this.loadUI("common/rollnotice")
            }
            ,
            e
        }(View);
        t.rollnoticeUI = e
    }(t.common || (t.common = {}))
}(ui || (ui = {})),
function(t) {
    !function(t) {
        var e = function(t) {
            function e() {
                return t.call(this) || this
            }
            return __extends(e, t),
            e.prototype.createChildren = function() {
                View.regComponent("capsui.CButton", capsui.CButton),
                t.prototype.createChildren.call(this),
                this.loadUI("common/shimingrenzheng")
            }
            ,
            e
        }(View);
        t.shimingrenzhengUI = e
    }(t.common || (t.common = {}))
}(ui || (ui = {})),
function(t) {
    !function(t) {
        var e = function(t) {
            function e() {
                return t.call(this) || this
            }
            return __extends(e, t),
            e.prototype.createChildren = function() {
                View.regComponent("capsui.CButton", capsui.CButton),
                t.prototype.createChildren.call(this),
                this.loadUI("common/user_xieyi")
            }
            ,
            e
        }(View);
        t.user_xieyiUI = e
    }(t.common || (t.common = {}))
}(ui || (ui = {})),
function(t) {
    !function(t) {
        var e = function(t) {
            function e() {
                return t.call(this) || this
            }
            return __extends(e, t),
            e.prototype.createChildren = function() {
                View.regComponent("capsui.CButton", capsui.CButton),
                View.regComponent("capsui.CScrollBar", capsui.CScrollBar),
                t.prototype.createChildren.call(this),
                this.loadUI("common/user_xieyi_enjp")
            }
            ,
            e
        }(View);
        t.user_xieyi_enjpUI = e
    }(t.common || (t.common = {}))
}(ui || (ui = {})),
function(t) {
    !function(t) {
        var e = function(t) {
            function e() {
                return t.call(this) || this
            }
            return __extends(e, t),
            e.prototype.createChildren = function() {
                View.regComponent("capsui.UICopy", capsui.UICopy),
                View.regComponent("capsui.CScrollView", capsui.CScrollView),
                t.prototype.createChildren.call(this),
                this.loadUI("entrance/chooseserver")
            }
            ,
            e
        }(View);
        t.chooseserverUI = e
    }(t.entrance || (t.entrance = {}))
}(ui || (ui = {})),
function(t) {
    !function(t) {
        var e = function(t) {
            function e() {
                return t.call(this) || this
            }
            return __extends(e, t),
            e.prototype.createChildren = function() {
                View.regComponent("capsui.UICopy", capsui.UICopy),
                View.regComponent("capsui.CScrollView", capsui.CScrollView),
                t.prototype.createChildren.call(this),
                this.loadUI("entrance/choose_language")
            }
            ,
            e
        }(View);
        t.choose_languageUI = e
    }(t.entrance || (t.entrance = {}))
}(ui || (ui = {})),
function(t) {
    !function(t) {
        var e = function(t) {
            function e() {
                return t.call(this) || this
            }
            return __extends(e, t),
            e.prototype.createChildren = function() {
                View.regComponent("capsui.CButton", capsui.CButton),
                View.regComponent("capsui.LabelLocalizationSize", capsui.LabelLocalizationSize),
                t.prototype.createChildren.call(this),
                this.loadUI("entrance/entrance")
            }
            ,
            e
        }(View);
        t.entranceUI = e
    }(t.entrance || (t.entrance = {}))
}(ui || (ui = {})),
function(t) {
    !function(t) {
        var e = function(t) {
            function e() {
                return t.call(this) || this
            }
            return __extends(e, t),
            e.prototype.createChildren = function() {
                t.prototype.createChildren.call(this),
                this.loadUI("entrance/ios_webview_update")
            }
            ,
            e
        }(View);
        t.ios_webview_updateUI = e
    }(t.entrance || (t.entrance = {}))
}(ui || (ui = {})),
function(t) {
    !function(t) {
        var e = function(t) {
            function e() {
                return t.call(this) || this
            }
            return __extends(e, t),
            e.prototype.createChildren = function() {
                t.prototype.createChildren.call(this),
                this.loadUI("entrance/remind")
            }
            ,
            e
        }(View);
        t.remindUI = e
    }(t.entrance || (t.entrance = {}))
}(ui || (ui = {})),
function(t) {
    !function(t) {
        var e = function(t) {
            function e() {
                return t.call(this) || this
            }
            return __extends(e, t),
            e.prototype.createChildren = function() {
                t.prototype.createChildren.call(this),
                this.loadUI("entrance/remind_new")
            }
            ,
            e
        }(View);
        t.remind_newUI = e
    }(t.entrance || (t.entrance = {}))
}(ui || (ui = {})),
function(t) {
    !function(t) {
        var e = function(t) {
            function e() {
                return t.call(this) || this
            }
            return __extends(e, t),
            e.prototype.createChildren = function() {
                View.regComponent("capsui.CButton", capsui.CButton),
                View.regComponent("capsui.UICopy", capsui.UICopy),
                View.regComponent("capsui.CScrollView", capsui.CScrollView),
                View.regComponent("capsui.LabelLocalizationSize", capsui.LabelLocalizationSize),
                t.prototype.createChildren.call(this),
                this.loadUI("lobby/activity")
            }
            ,
            e
        }(View);
        t.activityUI = e
    }(t.lobby || (t.lobby = {}))
}(ui || (ui = {})),
function(t) {
    !function(t) {
        !function(t) {
            var e = function(t) {
                function e() {
                    return t.call(this) || this
                }
                return __extends(e, t),
                e.prototype.createChildren = function() {
                    View.regComponent("capsui.CButton", capsui.CButton),
                    t.prototype.createChildren.call(this),
                    this.loadUI("lobby/activitys/activitybase")
                }
                ,
                e
            }(View);
            t.activitybaseUI = e
        }(t.activitys || (t.activitys = {}))
    }(t.lobby || (t.lobby = {}))
}(ui || (ui = {})),
function(t) {
    !function(t) {
        !function(t) {
            var e = function(t) {
                function e() {
                    return t.call(this) || this
                }
                return __extends(e, t),
                e.prototype.createChildren = function() {
                    View.regComponent("capsui.CButton", capsui.CButton),
                    View.regComponent("capsui.UICopy", capsui.UICopy),
                    t.prototype.createChildren.call(this),
                    this.loadUI("lobby/activitys/activity_exchange")
                }
                ,
                e
            }(View);
            t.activity_exchangeUI = e
        }(t.activitys || (t.activitys = {}))
    }(t.lobby || (t.lobby = {}))
}(ui || (ui = {})),
function(t) {
    !function(t) {
        !function(t) {
            var e = function(t) {
                function e() {
                    return t.call(this) || this
                }
                return __extends(e, t),
                e.prototype.createChildren = function() {
                    View.regComponent("capsui.CButton", capsui.CButton),
                    t.prototype.createChildren.call(this),
                    this.loadUI("lobby/activitys/activity_jiuji")
                }
                ,
                e
            }(View);
            t.activity_jiujiUI = e
        }(t.activitys || (t.activitys = {}))
    }(t.lobby || (t.lobby = {}))
}(ui || (ui = {})),
function(t) {
    !function(t) {
        !function(t) {
            var e = function(t) {
                function e() {
                    return t.call(this) || this
                }
                return __extends(e, t),
                e.prototype.createChildren = function() {
                    View.regComponent("capsui.CButton", capsui.CButton),
                    View.regComponent("capsui.UICopy", capsui.UICopy),
                    t.prototype.createChildren.call(this),
                    this.loadUI("lobby/activitys/activity_task")
                }
                ,
                e
            }(View);
            t.activity_taskUI = e
        }(t.activitys || (t.activitys = {}))
    }(t.lobby || (t.lobby = {}))
}(ui || (ui = {})),
function(t) {
    !function(t) {
        !function(t) {
            var e = function(t) {
                function e() {
                    return t.call(this) || this
                }
                return __extends(e, t),
                e.prototype.createChildren = function() {
                    View.regComponent("capsui.CScrollBar", capsui.CScrollBar),
                    t.prototype.createChildren.call(this),
                    this.loadUI("lobby/activitys/activity_task_newyear")
                }
                ,
                e
            }(View);
            t.activity_task_newyearUI = e
        }(t.activitys || (t.activitys = {}))
    }(t.lobby || (t.lobby = {}))
}(ui || (ui = {})),
function(t) {
    !function(t) {
        !function(t) {
            var e = function(t) {
                function e() {
                    return t.call(this) || this
                }
                return __extends(e, t),
                e.prototype.createChildren = function() {
                    View.regComponent("capsui.CButton", capsui.CButton),
                    t.prototype.createChildren.call(this),
                    this.loadUI("lobby/activitys/activity_xuanshang")
                }
                ,
                e
            }(View);
            t.activity_xuanshangUI = e
        }(t.activitys || (t.activitys = {}))
    }(t.lobby || (t.lobby = {}))
}(ui || (ui = {})),
function(t) {
    !function(t) {
        !function(t) {
            var e = function(t) {
                function e() {
                    return t.call(this) || this
                }
                return __extends(e, t),
                e.prototype.createChildren = function() {
                    t.prototype.createChildren.call(this),
                    this.loadUI("lobby/activitys/sign")
                }
                ,
                e
            }(View);
            t.signUI = e
        }(t.activitys || (t.activitys = {}))
    }(t.lobby || (t.lobby = {}))
}(ui || (ui = {})),
function(t) {
    !function(t) {
        var e = function(t) {
            function e() {
                return t.call(this) || this
            }
            return __extends(e, t),
            e.prototype.createChildren = function() {
                View.regComponent("capsui.CButton", capsui.CButton),
                t.prototype.createChildren.call(this),
                this.loadUI("lobby/add_room")
            }
            ,
            e
        }(View);
        t.add_roomUI = e
    }(t.lobby || (t.lobby = {}))
}(ui || (ui = {})),
function(t) {
    !function(t) {
        var e = function(t) {
            function e() {
                return t.call(this) || this
            }
            return __extends(e, t),
            e.prototype.createChildren = function() {
                View.regComponent("capsui.CButton", capsui.CButton),
                t.prototype.createChildren.call(this),
                this.loadUI("lobby/ageconfirm")
            }
            ,
            e
        }(View);
        t.ageconfirmUI = e
    }(t.lobby || (t.lobby = {}))
}(ui || (ui = {})),
function(t) {
    !function(t) {
        var e = function(t) {
            function e() {
                return t.call(this) || this
            }
            return __extends(e, t),
            e.prototype.createChildren = function() {
                View.regComponent("capsui.CButton", capsui.CButton),
                View.regComponent("capsui.UICopy", capsui.UICopy),
                View.regComponent("capsui.CScrollView", capsui.CScrollView),
                t.prototype.createChildren.call(this),
                this.loadUI("lobby/agepending")
            }
            ,
            e
        }(View);
        t.agependingUI = e
    }(t.lobby || (t.lobby = {}))
}(ui || (ui = {})),
function(t) {
    !function(t) {
        var e = function(t) {
            function e() {
                return t.call(this) || this
            }
            return __extends(e, t),
            e.prototype.createChildren = function() {
                View.regComponent("capsui.CButton", capsui.CButton),
                t.prototype.createChildren.call(this),
                this.loadUI("lobby/agesuccess")
            }
            ,
            e
        }(View);
        t.agesuccessUI = e
    }(t.lobby || (t.lobby = {}))
}(ui || (ui = {})),
function(t) {
    !function(t) {
        var e = function(t) {
            function e() {
                return t.call(this) || this
            }
            return __extends(e, t),
            e.prototype.createChildren = function() {
                View.regComponent("capsui.CButton", capsui.CButton),
                t.prototype.createChildren.call(this),
                this.loadUI("lobby/agexiane")
            }
            ,
            e
        }(View);
        t.agexianeUI = e
    }(t.lobby || (t.lobby = {}))
}(ui || (ui = {})),
function(t) {
    !function(t) {
        var e = function(t) {
            function e() {
                return t.call(this) || this
            }
            return __extends(e, t),
            e.prototype.createChildren = function() {
                View.regComponent("capsui.UICopy", capsui.UICopy),
                View.regComponent("capsui.CButton", capsui.CButton),
                View.regComponent("capsui.CScrollView", capsui.CScrollView),
                t.prototype.createChildren.call(this),
                this.loadUI("lobby/bag")
            }
            ,
            e
        }(View);
        t.bagUI = e
    }(t.lobby || (t.lobby = {}))
}(ui || (ui = {})),
function(t) {
    !function(t) {
        var e = function(t) {
            function e() {
                return t.call(this) || this
            }
            return __extends(e, t),
            e.prototype.createChildren = function() {
                View.regComponent("capsui.CButton", capsui.CButton),
                t.prototype.createChildren.call(this),
                this.loadUI("lobby/chang_nickname")
            }
            ,
            e
        }(View);
        t.chang_nicknameUI = e
    }(t.lobby || (t.lobby = {}))
}(ui || (ui = {})),
function(t) {
    !function(t) {
        var e = function(t) {
            function e() {
                return t.call(this) || this
            }
            return __extends(e, t),
            e.prototype.createChildren = function() {
                View.regComponent("capsui.CButton", capsui.CButton),
                t.prototype.createChildren.call(this),
                this.loadUI("lobby/checkhuiyu")
            }
            ,
            e
        }(View);
        t.checkhuiyuUI = e
    }(t.lobby || (t.lobby = {}))
}(ui || (ui = {})),
function(t) {
    !function(t) {
        var e = function(t) {
            function e() {
                return t.call(this) || this
            }
            return __extends(e, t),
            e.prototype.createChildren = function() {
                View.regComponent("capsui.CButton", capsui.CButton),
                View.regComponent("capsui.LabelLocalizationSize", capsui.LabelLocalizationSize),
                t.prototype.createChildren.call(this),
                this.loadUI("lobby/create_room")
            }
            ,
            e
        }(View);
        t.create_roomUI = e
    }(t.lobby || (t.lobby = {}))
}(ui || (ui = {})),
function(t) {
    !function(t) {
        var e = function(t) {
            function e() {
                return t.call(this) || this
            }
            return __extends(e, t),
            e.prototype.createChildren = function() {
                View.regComponent("capsui.CButton", capsui.CButton),
                View.regComponent("capsui.LabelLocalizationSize", capsui.LabelLocalizationSize),
                View.regComponent("capsui.UICopy", capsui.UICopy),
                View.regComponent("capsui.CLoading", capsui.CLoading),
                View.regComponent("capsui.NoLimitList", capsui.NoLimitList),
                t.prototype.createChildren.call(this),
                this.loadUI("lobby/friend")
            }
            ,
            e
        }(View);
        t.friendUI = e
    }(t.lobby || (t.lobby = {}))
}(ui || (ui = {})),
function(t) {
    !function(t) {
        var e = function(t) {
            function e() {
                return t.call(this) || this
            }
            return __extends(e, t),
            e.prototype.createChildren = function() {
                View.regComponent("capsui.CButton", capsui.CButton),
                View.regComponent("Text", laya.display.Text),
                View.regComponent("capsui.UICopy", capsui.UICopy),
                t.prototype.createChildren.call(this),
                this.loadUI("lobby/info")
            }
            ,
            e
        }(View);
        t.infoUI = e
    }(t.lobby || (t.lobby = {}))
}(ui || (ui = {})),
function(t) {
    !function(t) {
        var e = function(t) {
            function e() {
                return t.call(this) || this
            }
            return __extends(e, t),
            e.prototype.createChildren = function() {
                View.regComponent("capsui.LabelLocalizationSize", capsui.LabelLocalizationSize),
                View.regComponent("capsui.UICopy", capsui.UICopy),
                t.prototype.createChildren.call(this),
                this.loadUI("lobby/introduce")
            }
            ,
            e
        }(View);
        t.introduceUI = e
    }(t.lobby || (t.lobby = {}))
}(ui || (ui = {})),
function(t) {
    !function(t) {
        var e = function(t) {
            function e() {
                return t.call(this) || this
            }
            return __extends(e, t),
            e.prototype.createChildren = function() {
                View.regComponent("capsui.CButton", capsui.CButton),
                View.regComponent("capsui.LabelLocalizationSize", capsui.LabelLocalizationSize),
                t.prototype.createChildren.call(this),
                this.loadUI("lobby/lobby")
            }
            ,
            e
        }(View);
        t.lobbyUI = e
    }(t.lobby || (t.lobby = {}))
}(ui || (ui = {})),
function(t) {
    !function(t) {
        var e = function(t) {
            function e() {
                return t.call(this) || this
            }
            return __extends(e, t),
            e.prototype.createChildren = function() {
                View.regComponent("Text", laya.display.Text),
                View.regComponent("capsui.CButton", capsui.CButton),
                View.regComponent("capsui.UICopy", capsui.UICopy),
                View.regComponent("capsui.CScrollView", capsui.CScrollView),
                t.prototype.createChildren.call(this),
                this.loadUI("lobby/lobbychat")
            }
            ,
            e
        }(View);
        t.lobbychatUI = e
    }(t.lobby || (t.lobby = {}))
}(ui || (ui = {})),
function(t) {
    !function(t) {
        var e = function(t) {
            function e() {
                return t.call(this) || this
            }
            return __extends(e, t),
            e.prototype.createChildren = function() {
                View.regComponent("capsui.LabelLocalizationPosition", capsui.LabelLocalizationPosition),
                View.regComponent("capsui.CButton", capsui.CButton),
                View.regComponent("capsui.UICopy", capsui.UICopy),
                View.regComponent("capsui.LabelLocalizationSize", capsui.LabelLocalizationSize),
                View.regComponent("capsui.CLoading", capsui.CLoading),
                View.regComponent("capsui.NoLimitList", capsui.NoLimitList),
                t.prototype.createChildren.call(this),
                this.loadUI("lobby/match_lobby")
            }
            ,
            e
        }(View);
        t.match_lobbyUI = e
    }(t.lobby || (t.lobby = {}))
}(ui || (ui = {})),
function(t) {
    !function(t) {
        var e = function(t) {
            function e() {
                return t.call(this) || this
            }
            return __extends(e, t),
            e.prototype.createChildren = function() {
                View.regComponent("capsui.CButton", capsui.CButton),
                View.regComponent("capsui.UICopy", capsui.UICopy),
                View.regComponent("capsui.CScrollView", capsui.CScrollView),
                View.regComponent("capsui.CLoading", capsui.CLoading),
                View.regComponent("capsui.NoLimitList", capsui.NoLimitList),
                t.prototype.createChildren.call(this),
                this.loadUI("lobby/match_room")
            }
            ,
            e
        }(View);
        t.match_roomUI = e
    }(t.lobby || (t.lobby = {}))
}(ui || (ui = {})),
function(t) {
    !function(t) {
        var e = function(t) {
            function e() {
                return t.call(this) || this
            }
            return __extends(e, t),
            e.prototype.createChildren = function() {
                View.regComponent("capsui.CButton", capsui.CButton),
                View.regComponent("capsui.UICopy", capsui.UICopy),
                t.prototype.createChildren.call(this),
                this.loadUI("lobby/match_shilian")
            }
            ,
            e
        }(View);
        t.match_shilianUI = e
    }(t.lobby || (t.lobby = {}))
}(ui || (ui = {})),
function(t) {
    !function(t) {
        var e = function(t) {
            function e() {
                return t.call(this) || this
            }
            return __extends(e, t),
            e.prototype.createChildren = function() {
                t.prototype.createChildren.call(this),
                this.loadUI("lobby/match_ticket")
            }
            ,
            e
        }(View);
        t.match_ticketUI = e
    }(t.lobby || (t.lobby = {}))
}(ui || (ui = {})),
function(t) {
    !function(t) {
        var e = function(t) {
            function e() {
                return t.call(this) || this
            }
            return __extends(e, t),
            e.prototype.createChildren = function() {
                View.regComponent("capsui.CButton", capsui.CButton),
                View.regComponent("capsui.LabelLocalizationSize", capsui.LabelLocalizationSize),
                t.prototype.createChildren.call(this),
                this.loadUI("lobby/nickname")
            }
            ,
            e
        }(View);
        t.nicknameUI = e
    }(t.lobby || (t.lobby = {}))
}(ui || (ui = {})),
function(t) {
    !function(t) {
        var e = function(t) {
            function e() {
                return t.call(this) || this
            }
            return __extends(e, t),
            e.prototype.createChildren = function() {
                View.regComponent("capsui.CButton", capsui.CButton),
                t.prototype.createChildren.call(this),
                this.loadUI("lobby/number_input")
            }
            ,
            e
        }(View);
        t.number_inputUI = e
    }(t.lobby || (t.lobby = {}))
}(ui || (ui = {})),
function(t) {
    !function(t) {
        var e = function(t) {
            function e() {
                return t.call(this) || this
            }
            return __extends(e, t),
            e.prototype.createChildren = function() {
                View.regComponent("capsui.UICopy", capsui.UICopy),
                View.regComponent("capsui.CScrollView", capsui.CScrollView),
                View.regComponent("capsui.CDropdown", capsui.CDropdown),
                View.regComponent("capsui.LabelLocalizationSize", capsui.LabelLocalizationSize),
                View.regComponent("capsui.CButton", capsui.CButton),
                t.prototype.createChildren.call(this),
                this.loadUI("lobby/ob")
            }
            ,
            e
        }(View);
        t.obUI = e
    }(t.lobby || (t.lobby = {}))
}(ui || (ui = {})),
function(t) {
    !function(t) {
        var e = function(t) {
            function e() {
                return t.call(this) || this
            }
            return __extends(e, t),
            e.prototype.createChildren = function() {
                View.regComponent("capsui.CButton", capsui.CButton),
                View.regComponent("capsui.CScrollView", capsui.CScrollView),
                View.regComponent("capsui.CLoading", capsui.CLoading),
                View.regComponent("capsui.LabelLocalizationSize", capsui.LabelLocalizationSize),
                View.regComponent("capsui.UICopy", capsui.UICopy),
                t.prototype.createChildren.call(this),
                this.loadUI("lobby/paipu")
            }
            ,
            e
        }(View);
        t.paipuUI = e
    }(t.lobby || (t.lobby = {}))
}(ui || (ui = {})),
function(t) {
    !function(t) {
        var e = function(t) {
            function e() {
                return t.call(this) || this
            }
            return __extends(e, t),
            e.prototype.createChildren = function() {
                View.regComponent("capsui.CButton", capsui.CButton),
                t.prototype.createChildren.call(this),
                this.loadUI("lobby/pipei")
            }
            ,
            e
        }(View);
        t.pipeiUI = e
    }(t.lobby || (t.lobby = {}))
}(ui || (ui = {})),
function(t) {
    !function(t) {
        var e = function(t) {
            function e() {
                return t.call(this) || this
            }
            return __extends(e, t),
            e.prototype.createChildren = function() {
                t.prototype.createChildren.call(this),
                this.loadUI("lobby/pipeichenggong")
            }
            ,
            e
        }(View);
        t.pipeichenggongUI = e
    }(t.lobby || (t.lobby = {}))
}(ui || (ui = {})),
function(t) {
    !function(t) {
        var e = function(t) {
            function e() {
                return t.call(this) || this
            }
            return __extends(e, t),
            e.prototype.createChildren = function() {
                View.regComponent("capsui.LabelLocalizationSize", capsui.LabelLocalizationSize),
                View.regComponent("capsui.CButton", capsui.CButton),
                View.regComponent("capsui.UICopy", capsui.UICopy),
                t.prototype.createChildren.call(this),
                this.loadUI("lobby/pipeiyuyue")
            }
            ,
            e
        }(View);
        t.pipeiyuyueUI = e
    }(t.lobby || (t.lobby = {}))
}(ui || (ui = {})),
function(t) {
    !function(t) {
        var e = function(t) {
            function e() {
                return t.call(this) || this
            }
            return __extends(e, t),
            e.prototype.createChildren = function() {
                View.regComponent("capsui.CButton", capsui.CButton),
                View.regComponent("capsui.UICopy", capsui.UICopy),
                View.regComponent("capsui.CScrollView", capsui.CScrollView),
                View.regComponent("capsui.CScrollBar", capsui.CScrollBar),
                View.regComponent("capsui.LabelLocalizationSize", capsui.LabelLocalizationSize),
                t.prototype.createChildren.call(this),
                this.loadUI("lobby/playerinfo")
            }
            ,
            e
        }(View);
        t.playerinfoUI = e
    }(t.lobby || (t.lobby = {}))
}(ui || (ui = {})),
function(t) {
    !function(t) {
        var e = function(t) {
            function e() {
                return t.call(this) || this
            }
            return __extends(e, t),
            e.prototype.createChildren = function() {
                View.regComponent("capsui.LabelLocalizationSize", capsui.LabelLocalizationSize),
                View.regComponent("capsui.CButton", capsui.CButton),
                View.regComponent("capsui.UICopy", capsui.UICopy),
                View.regComponent("capsui.CScrollView", capsui.CScrollView),
                View.regComponent("capsui.CScrollBar", capsui.CScrollBar),
                t.prototype.createChildren.call(this),
                this.loadUI("lobby/playerinfo_en")
            }
            ,
            e
        }(View);
        t.playerinfo_enUI = e
    }(t.lobby || (t.lobby = {}))
}(ui || (ui = {})),
function(t) {
    !function(t) {
        var e = function(t) {
            function e() {
                return t.call(this) || this
            }
            return __extends(e, t),
            e.prototype.createChildren = function() {
                View.regComponent("capsui.UICopy", capsui.UICopy),
                View.regComponent("capsui.NoLimitList", capsui.NoLimitList),
                View.regComponent("capsui.CLoading", capsui.CLoading),
                View.regComponent("capsui.CButton", capsui.CButton),
                t.prototype.createChildren.call(this),
                this.loadUI("lobby/rank")
            }
            ,
            e
        }(View);
        t.rankUI = e
    }(t.lobby || (t.lobby = {}))
}(ui || (ui = {})),
function(t) {
    !function(t) {
        var e = function(t) {
            function e() {
                return t.call(this) || this
            }
            return __extends(e, t),
            e.prototype.createChildren = function() {
                View.regComponent("capsui.CButton", capsui.CButton),
                View.regComponent("capsui.LabelLocalizationSize", capsui.LabelLocalizationSize),
                View.regComponent("capsui.UICopy", capsui.UICopy),
                View.regComponent("capsui.CScrollView", capsui.CScrollView),
                View.regComponent("capsui.CLoading", capsui.CLoading),
                t.prototype.createChildren.call(this),
                this.loadUI("lobby/recharge")
            }
            ,
            e
        }(View);
        t.rechargeUI = e
    }(t.lobby || (t.lobby = {}))
}(ui || (ui = {})),
function(t) {
    !function(t) {
        var e = function(t) {
            function e() {
                return t.call(this) || this
            }
            return __extends(e, t),
            e.prototype.createChildren = function() {
                View.regComponent("capsui.LabelLocalizationSize", capsui.LabelLocalizationSize),
                View.regComponent("capsui.CButton", capsui.CButton),
                View.regComponent("capsui.UICopy", capsui.UICopy),
                View.regComponent("capsui.CScrollView", capsui.CScrollView),
                t.prototype.createChildren.call(this),
                this.loadUI("lobby/shop")
            }
            ,
            e
        }(View);
        t.shopUI = e
    }(t.lobby || (t.lobby = {}))
}(ui || (ui = {})),
function(t) {
    !function(t) {
        var e = function(t) {
            function e() {
                return t.call(this) || this
            }
            return __extends(e, t),
            e.prototype.createChildren = function() {
                View.regComponent("capsui.CButton", capsui.CButton),
                View.regComponent("capsui.UICopy", capsui.UICopy),
                t.prototype.createChildren.call(this),
                this.loadUI("lobby/sign")
            }
            ,
            e
        }(View);
        t.signUI = e
    }(t.lobby || (t.lobby = {}))
}(ui || (ui = {})),
function(t) {
    !function(t) {
        var e = function(t) {
            function e() {
                return t.call(this) || this
            }
            return __extends(e, t),
            e.prototype.createChildren = function() {
                View.regComponent("capsui.LabelLocalizationPosition", capsui.LabelLocalizationPosition),
                View.regComponent("capsui.CButton", capsui.CButton),
                t.prototype.createChildren.call(this),
                this.loadUI("lobby/sushe")
            }
            ,
            e
        }(View);
        t.susheUI = e
    }(t.lobby || (t.lobby = {}))
}(ui || (ui = {})),
function(t) {
    !function(t) {
        var e = function(t) {
            function e() {
                return t.call(this) || this
            }
            return __extends(e, t),
            e.prototype.createChildren = function() {
                View.regComponent("capsui.CButton", capsui.CButton),
                View.regComponent("capsui.UICopy", capsui.UICopy),
                View.regComponent("capsui.CScrollView", capsui.CScrollView),
                t.prototype.createChildren.call(this),
                this.loadUI("lobby/sushe_select")
            }
            ,
            e
        }(View);
        t.sushe_selectUI = e
    }(t.lobby || (t.lobby = {}))
}(ui || (ui = {})),
function(t) {
    !function(t) {
        var e = function(t) {
            function e() {
                return t.call(this) || this
            }
            return __extends(e, t),
            e.prototype.createChildren = function() {
                View.regComponent("capsui.CButton", capsui.CButton),
                View.regComponent("capsui.UICopy", capsui.UICopy),
                View.regComponent("capsui.LabelLocalizationSize", capsui.LabelLocalizationSize),
                View.regComponent("capsui.CScrollView", capsui.CScrollView),
                t.prototype.createChildren.call(this),
                this.loadUI("lobby/sushe_select_en")
            }
            ,
            e
        }(View);
        t.sushe_select_enUI = e
    }(t.lobby || (t.lobby = {}))
}(ui || (ui = {})),
function(t) {
    !function(t) {
        var e = function(t) {
            function e() {
                return t.call(this) || this
            }
            return __extends(e, t),
            e.prototype.createChildren = function() {
                View.regComponent("capsui.CLoading", capsui.CLoading),
                t.prototype.createChildren.call(this),
                this.loadUI("lobby/tanfang0")
            }
            ,
            e
        }(View);
        t.tanfang0UI = e
    }(t.lobby || (t.lobby = {}))
}(ui || (ui = {})),
function(t) {
    !function(t) {
        var e = function(t) {
            function e() {
                return t.call(this) || this
            }
            return __extends(e, t),
            e.prototype.createChildren = function() {
                View.regComponent("capsui.LabelLocalizationPosition", capsui.LabelLocalizationPosition),
                View.regComponent("capsui.CButton", capsui.CButton),
                t.prototype.createChildren.call(this),
                this.loadUI("lobby/tangfang1")
            }
            ,
            e
        }(View);
        t.tangfang1UI = e
    }(t.lobby || (t.lobby = {}))
}(ui || (ui = {})),
function(t) {
    !function(t) {
        var e = function(t) {
            function e() {
                return t.call(this) || this
            }
            return __extends(e, t),
            e.prototype.createChildren = function() {
                View.regComponent("capsui.UICopy", capsui.UICopy),
                View.regComponent("capsui.CScrollView", capsui.CScrollView),
                View.regComponent("capsui.CButton", capsui.CButton),
                t.prototype.createChildren.call(this),
                this.loadUI("lobby/titlebook")
            }
            ,
            e
        }(View);
        t.titlebookUI = e
    }(t.lobby || (t.lobby = {}))
}(ui || (ui = {})),
function(t) {
    !function(t) {
        var e = function(t) {
            function e() {
                return t.call(this) || this
            }
            return __extends(e, t),
            e.prototype.createChildren = function() {
                View.regComponent("capsui.CButton", capsui.CButton),
                View.regComponent("capsui.LabelLocalizationSize", capsui.LabelLocalizationSize),
                View.regComponent("capsui.UICopy", capsui.UICopy),
                View.regComponent("capsui.CScrollView", capsui.CScrollView),
                View.regComponent("capsui.CScrollBar", capsui.CScrollBar),
                View.regComponent("capsui.LabelLocalizationPosition", capsui.LabelLocalizationPosition),
                t.prototype.createChildren.call(this),
                this.loadUI("lobby/treasure")
            }
            ,
            e
        }(View);
        t.treasureUI = e
    }(t.lobby || (t.lobby = {}))
}(ui || (ui = {})),
function(t) {
    !function(t) {
        var e = function(t) {
            function e() {
                return t.call(this) || this
            }
            return __extends(e, t),
            e.prototype.createChildren = function() {
                View.regComponent("capsui.CButton", capsui.CButton),
                View.regComponent("capsui.UICopy", capsui.UICopy),
                View.regComponent("capsui.LabelLocalizationSize", capsui.LabelLocalizationSize),
                View.regComponent("capsui.CScrollView", capsui.CScrollView),
                t.prototype.createChildren.call(this),
                this.loadUI("lobby/visit")
            }
            ,
            e
        }(View);
        t.visitUI = e
    }(t.lobby || (t.lobby = {}))
}(ui || (ui = {})),
function(t) {
    !function(t) {
        var e = function(t) {
            function e() {
                return t.call(this) || this
            }
            return __extends(e, t),
            e.prototype.createChildren = function() {
                View.regComponent("capsui.CButton", capsui.CButton),
                View.regComponent("capsui.LabelLocalizationPosition", capsui.LabelLocalizationPosition),
                View.regComponent("capsui.LabelLocalizationSize", capsui.LabelLocalizationSize),
                View.regComponent("capsui.UICopy", capsui.UICopy),
                View.regComponent("capsui.CScrollView", capsui.CScrollView),
                t.prototype.createChildren.call(this),
                this.loadUI("lobby/waitingroom")
            }
            ,
            e
        }(View);
        t.waitingroomUI = e
    }(t.lobby || (t.lobby = {}))
}(ui || (ui = {})),
function(t) {
    !function(t) {
        var e = function(t) {
            function e() {
                return t.call(this) || this
            }
            return __extends(e, t),
            e.prototype.createChildren = function() {
                View.regComponent("capsui.CButton", capsui.CButton),
                t.prototype.createChildren.call(this),
                this.loadUI("lobby/waitob")
            }
            ,
            e
        }(View);
        t.waitobUI = e
    }(t.lobby || (t.lobby = {}))
}(ui || (ui = {})),
function(t) {
    !function(t) {
        var e = function(t) {
            function e() {
                return t.call(this) || this
            }
            return __extends(e, t),
            e.prototype.createChildren = function() {
                View.regComponent("capsui.CButton", capsui.CButton),
                View.regComponent("capsui.CLoading", capsui.CLoading),
                t.prototype.createChildren.call(this),
                this.loadUI("lobby/xinshouyindao")
            }
            ,
            e
        }(View);
        t.xinshouyindaoUI = e
    }(t.lobby || (t.lobby = {}))
}(ui || (ui = {})),
function(t) {
    !function(t) {
        var e = function(t) {
            function e() {
                return t.call(this) || this
            }
            return __extends(e, t),
            e.prototype.createChildren = function() {
                t.prototype.createChildren.call(this),
                this.loadUI("mj/activity_task")
            }
            ,
            e
        }(View);
        t.activity_taskUI = e
    }(t.mj || (t.mj = {}))
}(ui || (ui = {})),
function(t) {
    !function(t) {
        var e = function(t) {
            function e() {
                return t.call(this) || this
            }
            return __extends(e, t),
            e.prototype.createChildren = function() {
                t.prototype.createChildren.call(this),
                this.loadUI("mj/al")
            }
            ,
            e
        }(View);
        t.alUI = e
    }(t.mj || (t.mj = {}))
}(ui || (ui = {})),
function(t) {
    !function(t) {
        var e = function(t) {
            function e() {
                return t.call(this) || this
            }
            return __extends(e, t),
            e.prototype.createChildren = function() {
                View.regComponent("capsui.CButton", capsui.CButton),
                t.prototype.createChildren.call(this),
                this.loadUI("mj/chipenghu")
            }
            ,
            e
        }(View);
        t.chipenghuUI = e
    }(t.mj || (t.mj = {}))
}(ui || (ui = {})),
function(t) {
    !function(t) {
        var e = function(t) {
            function e() {
                return t.call(this) || this
            }
            return __extends(e, t),
            e.prototype.createChildren = function() {
                View.regComponent("capsui.LabelLocalizationSize", capsui.LabelLocalizationSize),
                View.regComponent("capsui.CButton", capsui.CButton),
                View.regComponent("capsui.CScrollBar", capsui.CScrollBar),
                View.regComponent("capsui.UICopy", capsui.UICopy),
                View.regComponent("capsui.CScrollView", capsui.CScrollView),
                t.prototype.createChildren.call(this),
                this.loadUI("mj/desktopInfo")
            }
            ,
            e
        }(View);
        t.desktopInfoUI = e
    }(t.mj || (t.mj = {}))
}(ui || (ui = {})),
function(t) {
    !function(t) {
        var e = function(t) {
            function e() {
                return t.call(this) || this
            }
            return __extends(e, t),
            e.prototype.createChildren = function() {
                t.prototype.createChildren.call(this),
                this.loadUI("mj/fightbegin")
            }
            ,
            e
        }(View);
        t.fightbeginUI = e
    }(t.mj || (t.mj = {}))
}(ui || (ui = {})),
function(t) {
    !function(t) {
        var e = function(t) {
            function e() {
                return t.call(this) || this
            }
            return __extends(e, t),
            e.prototype.createChildren = function() {
                View.regComponent("capsui.CButton", capsui.CButton),
                t.prototype.createChildren.call(this),
                this.loadUI("mj/gameend")
            }
            ,
            e
        }(View);
        t.gameendUI = e
    }(t.mj || (t.mj = {}))
}(ui || (ui = {})),
function(t) {
    !function(t) {
        var e = function(t) {
            function e() {
                return t.call(this) || this
            }
            return __extends(e, t),
            e.prototype.createChildren = function() {
                t.prototype.createChildren.call(this),
                this.loadUI("mj/gamestop")
            }
            ,
            e
        }(View);
        t.gamestopUI = e
    }(t.mj || (t.mj = {}))
}(ui || (ui = {})),
function(t) {
    !function(t) {
        var e = function(t) {
            function e() {
                return t.call(this) || this
            }
            return __extends(e, t),
            e.prototype.createChildren = function() {
                View.regComponent("capsui.CButton", capsui.CButton),
                t.prototype.createChildren.call(this),
                this.loadUI("mj/hangup_warn")
            }
            ,
            e
        }(View);
        t.hangup_warnUI = e
    }(t.mj || (t.mj = {}))
}(ui || (ui = {})),
function(t) {
    !function(t) {
        var e = function(t) {
            function e() {
                return t.call(this) || this
            }
            return __extends(e, t),
            e.prototype.createChildren = function() {
                t.prototype.createChildren.call(this),
                this.loadUI("mj/huleshow")
            }
            ,
            e
        }(View);
        t.huleshowUI = e
    }(t.mj || (t.mj = {}))
}(ui || (ui = {})),
function(t) {
    !function(t) {
        var e = function(t) {
            function e() {
                return t.call(this) || this
            }
            return __extends(e, t),
            e.prototype.createChildren = function() {
                t.prototype.createChildren.call(this),
                this.loadUI("mj/hu_cutin")
            }
            ,
            e
        }(View);
        t.hu_cutinUI = e
    }(t.mj || (t.mj = {}))
}(ui || (ui = {})),
function(t) {
    !function(t) {
        var e = function(t) {
            function e() {
                return t.call(this) || this
            }
            return __extends(e, t),
            e.prototype.createChildren = function() {
                View.regComponent("capsui.CButton", capsui.CButton),
                t.prototype.createChildren.call(this),
                this.loadUI("mj/info_md5")
            }
            ,
            e
        }(View);
        t.info_md5UI = e
    }(t.mj || (t.mj = {}))
}(ui || (ui = {})),
function(t) {
    !function(t) {
        var e = function(t) {
            function e() {
                return t.call(this) || this
            }
            return __extends(e, t),
            e.prototype.createChildren = function() {
                t.prototype.createChildren.call(this),
                this.loadUI("mj/liuju")
            }
            ,
            e
        }(View);
        t.liujuUI = e
    }(t.mj || (t.mj = {}))
}(ui || (ui = {})),
function(t) {
    !function(t) {
        var e = function(t) {
            function e() {
                return t.call(this) || this
            }
            return __extends(e, t),
            e.prototype.createChildren = function() {
                View.regComponent("capsui.LabelLocalizationSize", capsui.LabelLocalizationSize),
                View.regComponent("capsui.CButton", capsui.CButton),
                t.prototype.createChildren.call(this),
                this.loadUI("mj/live_broadcast")
            }
            ,
            e
        }(View);
        t.live_broadcastUI = e
    }(t.mj || (t.mj = {}))
}(ui || (ui = {})),
function(t) {
    !function(t) {
        var e = function(t) {
            function e() {
                return t.call(this) || this
            }
            return __extends(e, t),
            e.prototype.createChildren = function() {
                View.regComponent("Text", laya.display.Text),
                t.prototype.createChildren.call(this),
                this.loadUI("mj/rankchange")
            }
            ,
            e
        }(View);
        t.rankchangeUI = e
    }(t.mj || (t.mj = {}))
}(ui || (ui = {})),
function(t) {
    !function(t) {
        var e = function(t) {
            function e() {
                return t.call(this) || this
            }
            return __extends(e, t),
            e.prototype.createChildren = function() {
                View.regComponent("capsui.CButton", capsui.CButton),
                View.regComponent("capsui.LabelLocalizationSize", capsui.LabelLocalizationSize),
                View.regComponent("capsui.UICopy", capsui.UICopy),
                View.regComponent("capsui.CScrollView", capsui.CScrollView),
                t.prototype.createChildren.call(this),
                this.loadUI("mj/replay")
            }
            ,
            e
        }(View);
        t.replayUI = e
    }(t.mj || (t.mj = {}))
}(ui || (ui = {})),
function(t) {
    !function(t) {
        var e = function(t) {
            function e() {
                return t.call(this) || this
            }
            return __extends(e, t),
            e.prototype.createChildren = function() {
                t.prototype.createChildren.call(this),
                this.loadUI("mj/replay_whell")
            }
            ,
            e
        }(View);
        t.replay_whellUI = e
    }(t.mj || (t.mj = {}))
}(ui || (ui = {})),
function(t) {
    !function(t) {
        var e = function(t) {
            function e() {
                return t.call(this) || this
            }
            return __extends(e, t),
            e.prototype.createChildren = function() {
                t.prototype.createChildren.call(this),
                this.loadUI("mj/rewardprogress")
            }
            ,
            e
        }(View);
        t.rewardprogressUI = e
    }(t.mj || (t.mj = {}))
}(ui || (ui = {})),
function(t) {
    !function(t) {
        var e = function(t) {
            function e() {
                return t.call(this) || this
            }
            return __extends(e, t),
            e.prototype.createChildren = function() {
                View.regComponent("capsui.CButton", capsui.CButton),
                View.regComponent("capsui.LabelLocalizationSize", capsui.LabelLocalizationSize),
                t.prototype.createChildren.call(this),
                this.loadUI("mj/scorechange")
            }
            ,
            e
        }(View);
        t.scorechangeUI = e
    }(t.mj || (t.mj = {}))
}(ui || (ui = {})),
function(t) {
    !function(t) {
        var e = function(t) {
            function e() {
                return t.call(this) || this
            }
            return __extends(e, t),
            e.prototype.createChildren = function() {
                t.prototype.createChildren.call(this),
                this.loadUI("mj/task_progress")
            }
            ,
            e
        }(View);
        t.task_progressUI = e
    }(t.mj || (t.mj = {}))
}(ui || (ui = {})),
function(t) {
    !function(t) {
        var e = function(t) {
            function e() {
                return t.call(this) || this
            }
            return __extends(e, t),
            e.prototype.createChildren = function() {
                t.prototype.createChildren.call(this),
                this.loadUI("mj/tingpai")
            }
            ,
            e
        }(View);
        t.tingpaiUI = e
    }(t.mj || (t.mj = {}))
}(ui || (ui = {})),
function(t) {
    !function(t) {
        var e = function(t) {
            function e() {
                return t.call(this) || this
            }
            return __extends(e, t),
            e.prototype.createChildren = function() {
                View.regComponent("capsui.CButton", capsui.CButton),
                View.regComponent("capsui.LabelLocalizationSize", capsui.LabelLocalizationSize),
                t.prototype.createChildren.call(this),
                this.loadUI("mj/win")
            }
            ,
            e
        }(View);
        t.winUI = e
    }(t.mj || (t.mj = {}))
}(ui || (ui = {}));
var uiscript;
!function(t) {
    var e = function() {
        function e(t) {
            this._me = null,
            this._enable = !1,
            this._valid = !1,
            this._enable = this._valid = !1,
            t ? (this._me = t,
            this._me.visible = !1,
            this._me.frameOnce(4, this, this._onload)) : console.error("加载UI失败")
        }
        return Object.defineProperty(e.prototype, "me", {
            get: function() {
                return this._me
            },
            enumerable: !0,
            configurable: !0
        }),
        Object.defineProperty(e.prototype, "enable", {
            get: function() {
                return this._valid && this._enable
            },
            set: function(t) {
                this._valid && this._enable != t && (this._enable = t,
                this._me.visible = t,
                t ? this._onEnable() : this._onDisable())
            },
            enumerable: !0,
            configurable: !0
        }),
        e.prototype._onload = function() {
            this._valid = !0,
            this.onCreate(),
            this.me.frameLoop(1, this, this._update)
        }
        ,
        e.prototype._update = function() {
            this.enable && this.update()
        }
        ,
        e.prototype._onEnable = function() {
            this._valid && (this.me.event("onenable"),
            this.onEnable())
        }
        ,
        e.prototype._onDisable = function() {
            this._valid && (this.me.event("ondisable"),
            this.onDisable())
        }
        ,
        e.prototype.destroy = function() {
            this._valid && (Laya.timer.clearAll(this),
            this.enable = !1,
            this.onDestroy(),
            this._valid = !1,
            this._me.destroy(!0),
            t.UIMgr.Inst.onUIDestory(this))
        }
        ,
        e.prototype.onCreate = function() {}
        ,
        e.prototype.onEnable = function() {}
        ,
        e.prototype.update = function() {}
        ,
        e.prototype.onDisable = function() {}
        ,
        e.prototype.onDestroy = function() {}
        ,
        e.anim_pop_out = function(t, e) {
            t.alpha = 0;
            var i = t.scaleX
              , n = t.scaleY;
            t.scaleX = .6 * i,
            t.scaleY = .6 * n,
            Laya.Tween.to(t, {
                alpha: 1,
                scaleX: i,
                scaleY: n
            }, 150, Laya.Ease.backOut, Laya.Handler.create(t, function() {
                t.scaleX = i,
                t.scaleY = n,
                t.alpha = 1,
                e && e.run()
            }))
        }
        ,
        e.anim_pop_hide = function(t, e) {
            t.alpha = 1;
            var i = t.scaleX
              , n = t.scaleY;
            Laya.Tween.to(t, {
                alpha: 0,
                scaleX: .6 * i,
                scaleY: .6 * n
            }, 150, Laya.Ease.backOut, Laya.Handler.create(t, function() {
                t.scaleX = i,
                t.scaleY = n,
                t.alpha = 0,
                e && e.run()
            }))
        }
        ,
        e.anim_alpha_in = function(t, e, i, n, a, r) {
            void 0 === n && (n = 0),
            void 0 === a && (a = null),
            void 0 === r && (r = null);
            var s = {};
            for (var o in e)
                s[o] = t[o],
                t[o] += e[o];
            t.alpha = 0,
            s.alpha = 1,
            Laya.Tween.to(t, s, i, r, a, n)
        }
        ,
        e.anim_alpha_out = function(t, e, i, n, a, r) {
            void 0 === n && (n = 0),
            void 0 === a && (a = null),
            void 0 === r && (r = null);
            var s = {};
            for (var o in e)
                s[o] = t[o],
                e[o] += t[o];
            e.alpha = 0,
            Laya.Tween.to(t, e, i, r, Laya.Handler.create(t, function() {
                for (var i in e)
                    t[i] = s[i];
                t.alpha = 0,
                a && a.run()
            }), n)
        }
        ,
        e
    }();
    t.UIBase = e
}(uiscript || (uiscript = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), uiscript;
!function(t) {
    var e = function(t) {
        function e(e, i) {
            var n = t.call(this, i) || this;
            return n.__activity_name = e,
            n
        }
        return __extends(e, t),
        Object.defineProperty(e.prototype, "activity_name", {
            get: function() {
                return this.__activity_name
            },
            enumerable: !0,
            configurable: !0
        }),
        e.prototype.isopen = function() {
            return !1
        }
        ,
        e.prototype.haveRedPoint = function() {
            return !1
        }
        ,
        e.prototype.need_popout = function() {
            return !1
        }
        ,
        e.prototype.show = function() {}
        ,
        e.prototype.hide = function() {}
        ,
        e
    }(t.UIBase);
    t.UI_ActivityBase = e
}(uiscript || (uiscript = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), uiscript;
!function(t) {
    var e = function() {
        function e(e, i) {
            var n = this;
            this.me = e,
            this.father = i,
            this.me.visible = !1,
            this.container_info = e.getChildByName("info"),
            this.item_icon = this.container_info.getChildByName("item"),
            this.item_name = this.container_info.getChildByName("item_name"),
            this.item_count = this.container_info.getChildByName("item_count"),
            this.btn_exchange = this.container_info.getChildByName("btn_exchange");
            var a = this.container_info.getChildByName("count");
            this.currency_icon = a.getChildByName("icon"),
            this.currency_count = a.getChildByName("need_count"),
            this.left_count = a.getChildByName("left_count"),
            this.btn_icon = this.container_info.getChildByName("btn_icon"),
            this.btn_icon.clickHandler = Laya.Handler.create(this, function() {
                var e = cfg.activity.exchange.get(n.id);
                e && t.UI_ItemDetail.Inst.show(e.reward_id)
            }, null, !1),
            this.label_getted = this.container_info.getChildByName("getted")
        }
        return e.prototype.refresh = function() {
            var e = this
              , i = this.id
              , n = cfg.activity.exchange.get(i);
            this.container_info.visible = !0,
            this.item_count.text = "x" + n.reward_count;
            var a = cfg.item_definition.currency.get(n.reward_id);
            a && (game.LoadMgr.setImgSkin(this.item_icon, a.icon),
            this.item_name.text = a["name_" + GameMgr.client_language]);
            var r = cfg.item_definition.item.get(n.reward_id);
            r && (game.LoadMgr.setImgSkin(this.item_icon, r.icon),
            this.item_name.text = r["name_" + GameMgr.client_language]);
            var s = cfg.item_definition.item.get(n.consume_id);
            s && game.LoadMgr.setImgSkin(this.currency_icon, s.icon_transparent),
            this.currency_count.text = n.consume_count.toString(),
            this.item_count.x = this.item_name.textField.textWidth + this.item_name.x + 50;
            var o = this.count
              , l = n.exchange_limit;
            o = o >= l ? 0 : l - o,
            this.left_count.text = o + "/" + l,
            this.label_getted.visible = !1,
            this.btn_exchange.visible = !1,
            0 != o ? (this.left_count.color = "#37b625",
            t.UI_Bag.get_item_count(n.consume_id) < n.consume_count ? this.btn_exchange.filters = [new Laya.ColorFilter(t.GRAY_FILTER)] : this.btn_exchange.filters = [],
            this.btn_exchange.visible = !0,
            this.btn_exchange.clickHandler = Laya.Handler.create(this, function() {
                t.UI_Bag.get_item_count(n.consume_id) < n.consume_count ? t.UIMgr.Inst.ShowErrorInfo(game.Tools.strOfLocalization(2230, [s["name_" + GameMgr.client_language]])) : (game.Tools.setGrayDisable(e.btn_exchange, !0),
                app.NetAgent.sendReq2Lobby("Lobby", "exchangeActivityItem", {
                    exchange_id: i
                }, function(n, a) {
                    if (i == e.id)
                        if (game.Tools.setGrayDisable(e.btn_exchange, !1),
                        n || a.error)
                            t.UIMgr.Inst.showNetReqError("exchangeActivityItem", n, a);
                        else {
                            if (e.count++,
                            e.father.refreshCurrencyCount(),
                            Laya.timer.once(500, e, function() {
                                e.father.refreshCurrencyCount()
                            }),
                            t.UI_Activity.onExchanged(i),
                            r && r.category == t.EItemCategory.fudai) {
                                if (a.execute_reward) {
                                    for (var s = [], o = 0; o < a.execute_reward.length; o++)
                                        s.push(a.execute_reward[o].reward);
                                    game.Tools.showRewards({
                                        rewards: s
                                    }, null)
                                }
                            } else
                                t.UI_LightTips.Inst.show(game.Tools.strOfLocalization(2231, [e.item_name.text + " " + e.item_count.text]));
                            e.father.refreshAll()
                        }
                }))
            }, null, !1)) : (this.left_count.color = "#e3283c",
            this.btn_exchange.clickHandler = null,
            this.label_getted.visible = !0,
            game.Tools.setGrayDisable(this.btn_exchange, !0))
        }
        ,
        e.prototype.show = function(t) {
            this.id = t.exchange_id,
            this.count = t.count,
            this.refresh(),
            this.me.visible = !0
        }
        ,
        e
    }()
      , i = function(t) {
        function i(e, i) {
            return t.call(this, e, i) || this
        }
        return __extends(i, t),
        i.prototype.onCreate = function() {
            var t = this;
            this.root = this.me.getChildByName("root"),
            this.content = this.root.getChildByName("content"),
            this.head = this.content.getChildByName("head"),
            this.task_templete = this.content.getChildByName("task_templete"),
            this.task_templete.visible = !1,
            this.cells = [];
            for (var i = 0; i < 20; i++)
                this.cells.push(new e(this.task_templete.scriptMap["capsui.UICopy"].getNodeClone(),this));
            this.scrollbar = this.root.getChildByName("scrollbar"),
            this.scrollpoint = this.scrollbar.getChildByName("scrollpoint"),
            this.content.vScrollBarSkin = "",
            this.content.vScrollBar.on("change", this, function() {
                t.refresh_scrollbar()
            })
        }
        ,
        i.prototype.refreshCurrencyCount = function() {}
        ,
        i.prototype.refreshView = function(t) {
            for (var e = this.head.height + 15, i = 0; i < this.cells.length; i++)
                i < t.length ? (this.cells[i].show(t[i]),
                this.cells[i].me.y = e,
                e += this.cells[i].me.height) : this.cells[i].me.visible = !1;
            this.total_h = e,
            this.content.refresh(),
            this.refresh_scrollbar(),
            this.refreshCurrencyCount()
        }
        ,
        i.prototype.refreshAll = function() {
            for (var t = 0; t < this.cells.length; t++)
                this.cells[t].me.visible && this.cells[t].refresh()
        }
        ,
        i.prototype.refresh_scrollbar = function() {
            if (this.total_h > this.content.height) {
                var t = this.content.vScrollBar.value / this.content.vScrollBar.max;
                this.scrollpoint.height = this.scrollbar.height * this.content.height / this.total_h,
                this.scrollpoint.y = t * this.scrollbar.height * (1 - this.content.height / this.total_h),
                this.scrollbar.visible = !0
            } else
                this.scrollbar.visible = !1
        }
        ,
        i
    }(t.UI_ActivityBase);
    t.UI_Activity_Exchange = i
}(uiscript || (uiscript = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), uiscript;
!function(t) {
    var e = function(e) {
        function i() {
            var t = e.call(this, game.Tools.strOfLocalization(2232), new ui.lobby.activitys.activity_jiujiUI) || this;
            return t.btn_cd = 0,
            t
        }
        return __extends(i, e),
        i.Init = function() {
            var e = this;
            app.NetAgent.sendReq2Lobby("Lobby", "fetchReviveCoinInfo", {}, function(i, n) {
                i || n.error ? t.UIMgr.Inst.showNetReqError("fetchReviveCoinInfo", i, n) : e.has_gained = n.has_gained
            }),
            app.NetAgent.AddListener2Lobby("NotifyReviveCoinUpdate", Laya.Handler.create(this, function(t) {
                e.has_gained = t.has_gained,
                e.Inst && e.Inst.enable && e.Inst.refresh()
            }, null, !1))
        }
        ,
        i.prototype.isopen = function() {
            return !0
        }
        ,
        i.prototype.onCreate = function() {
            var e = this;
            this.root = this.me.getChildByName("root"),
            this.title = this.root.getChildByName("title"),
            this.desc = this.root.getChildByName("desc");
            var n = this.root.getChildByName("task");
            this.task = {
                container: n,
                bg: n.getChildByName("bg"),
                container_info: n.getChildByName("info"),
                item_icon: n.getChildByName("info").getChildByName("item"),
                item_count: n.getChildByName("info").getChildByName("item_count"),
                item_name: n.getChildByName("info").getChildByName("item_name"),
                btn_get: n.getChildByName("info").getChildByName("btn_get"),
                getno: n.getChildByName("info").getChildByName("noget"),
                alreadyget: n.getChildByName("info").getChildByName("alreadyget")
            },
            this.task.btn_get.clickHandler = Laya.Handler.create(this, function() {
                e.btn_cd > Laya.timer.currTimer || (e.btn_cd = Laya.timer.currTimer + 1e3,
                app.NetAgent.sendReq2Lobby("Lobby", "gainReviveCoin", {}, function(n, a) {
                    e.btn_cd = 0,
                    n || a.error ? t.UIMgr.Inst.showNetReqError("gainReviveCoin", n, a) : (e.task.btn_get.visible = !1,
                    e.task.alreadyget.visible = !0,
                    i.has_gained = !0)
                }))
            }, null, !1)
        }
        ,
        i.prototype.show = function() {
            this.me.visible = !0,
            this.btn_cd = 0,
            this.refresh()
        }
        ,
        i.prototype.hide = function() {
            this.me.visible = !1
        }
        ,
        i.prototype.findData = function() {
            var t = 0;
            return cfg.events.soscoin.forEach(function(e) {
                e.level_limit == GameMgr.Inst.account_data.level.id && (t = e.id)
            }),
            t
        }
        ,
        i.prototype.refresh = function() {
            var t = cfg.events.soscoin.get(this.findData());
            if (t)
                if (this.desc.text = t["desc_" + GameMgr.client_language],
                t.gold_num < 1)
                    this.task.bg.skin = game.Tools.localUISrc("myres/lobby/bg_rules_no.png"),
                    this.task.container_info.visible = !1;
                else {
                    this.task.bg.skin = game.Tools.localUISrc("myres/lobby/bg_rules.png"),
                    this.task.container_info.visible = !0,
                    this.task.getno.visible = !1,
                    this.task.btn_get.visible = !1,
                    this.task.alreadyget.visible = !1,
                    this.task.item_count.text = t.gold_num.toString(),
                    i.has_gained ? this.task.alreadyget.visible = !0 : GameMgr.Inst.account_data.gold < t.gold_limit ? this.task.btn_get.visible = !0 : this.task.getno.visible = !0;
                    var e = cfg.item_definition.currency.get(100002);
                    this.task.item_icon.skin = game.LoadMgr.getResImageSkin(e.icon),
                    this.task.item_name.text = e["name_" + GameMgr.client_language]
                }
            else
                this.desc.text = game.Tools.strOfLocalization(2233),
                this.task.container_info.visible = !1,
                this.task.bg.skin = game.Tools.localUISrc("myres/lobby/bg_rules_no.png")
        }
        ,
        i.Inst = null,
        i.has_gained = !1,
        i
    }(t.UI_ActivityBase);
    t.UI_Activity_Jiuji = e
}(uiscript || (uiscript = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), uiscript;
!function(t) {
    var e = function(e) {
        function i() {
            var t = e.call(this, cfg.activity.activity.get(1004).name, new ui.lobby.activitys.activity_task_newyearUI) || this;
            return t.activity_id = 1004,
            t.toth = 0,
            t
        }
        return __extends(i, e),
        i.prototype.isopen = function() {
            return t.UI_Activity.activities[1004]
        }
        ,
        i.prototype.need_popout = function() {
            var t = cfg.activity.activity.get(1004);
            return !(!t || !t.need_popout)
        }
        ,
        i.prototype.onCreate = function() {
            var t = this;
            this.root = this.me.getChildByName("root"),
            this.content = this.root.getChildByName("content"),
            this.scrollbar = this.root.getChildByName("scrollbar").scriptMap["capsui.CScrollBar"],
            this.content.vScrollBarSkin = "",
            this.scrollbar.init(!1, null),
            this.toth = this.content.getChildByName("fu").y + this.content.getChildByName("fu").height,
            this.content.vScrollBar.on("change", this, function() {
                t.scrollbar.setVal(t.content.vScrollBar.value / t.content.vScrollBar.max, t.content.height / t.toth)
            })
        }
        ,
        i.prototype.show = function() {
            this.enable = !0,
            this.content.refresh(),
            this.content.vScrollBar.value = 0,
            this.content.vScrollBar.stopScroll(),
            this.scrollbar.reset(),
            this.scrollbar.setVal(0, this.content.height / this.toth),
            game.LoadMgr.setImgSkin(this.root.getChildByName("content").getChildByName("head"), "myres2/treasurehead/newyear_task.jpg"),
            game.LoadMgr.setImgSkin(this.content.getChildByName("denglong").getChildByName("info").getChildByName("item"), game.GameUtility.get_item_view(309003).icon),
            game.LoadMgr.setImgSkin(this.content.getChildByName("baozhu").getChildByName("info").getChildByName("item"), game.GameUtility.get_item_view(309004).icon),
            game.LoadMgr.setImgSkin(this.content.getChildByName("fu").getChildByName("info").getChildByName("item"), game.GameUtility.get_item_view(309005).icon)
        }
        ,
        i.prototype.hide = function() {
            this.enable = !1
        }
        ,
        i
    }(t.UI_ActivityBase);
    t.UI_Activity_NewYear = e
}(uiscript || (uiscript = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), uiscript;
!function(t) {
    var e = function() {
        function e(t) {
            this.id = 0,
            this.me = t,
            this.me.visible = !1,
            this.container_info = t.getChildByName("info"),
            this.task_name = this.container_info.getChildByName("taskname"),
            this.item_icon = this.container_info.getChildByName("item"),
            this.item_name = this.container_info.getChildByName("item_name"),
            this.item_count = this.container_info.getChildByName("item_count"),
            this.progress_bar = this.container_info.getChildByName("bar").getChildByName("val"),
            this.progress_label = this.container_info.getChildByName("progress"),
            this.btn_get = this.container_info.getChildByName("btn_get"),
            this.flag_getted = this.container_info.getChildByName("alreadyget")
        }
        return e.prototype.show = function(e) {
            var i = this;
            this.me.visible = !0;
            var n = e.id;
            this.id = n;
            var a = cfg.activity.task.get(e.id)
              , r = cfg.events.base_task.get(a.base_task_id);
            this.container_info.visible = !0,
            this.btn_get.visible = !1,
            this.flag_getted.visible = !1,
            e.rewarded ? this.flag_getted.visible = !0 : (this.btn_get.visible = !0,
            e.achieved ? (game.Tools.setGrayDisable(this.btn_get, !1),
            this.btn_get.clickHandler = Laya.Handler.create(this, function() {
                game.Tools.setGrayDisable(i.btn_get, !0),
                app.NetAgent.sendReq2Lobby("Lobby", "completeActivityTask", {
                    task_id: n
                }, function(e, a) {
                    if (game.Tools.setGrayDisable(i.btn_get, !1),
                    e || a.error)
                        t.UIMgr.Inst.showNetReqError("completeActivityTask", e, a);
                    else {
                        if (i.id == n) {
                            i.btn_get.visible = !1,
                            i.flag_getted.visible = !0;
                            var r = game.Tools.strOfLocalization(2234, [i.item_name.text + " " + i.item_count.text]);
                            t.UI_LightTips.Inst.show(r)
                        }
                        t.UI_Activity.onTaskRewarded(n)
                    }
                })
            }, null, !1)) : (game.Tools.setGrayDisable(this.btn_get, !0),
            this.btn_get.clickHandler = null)),
            this.task_name.text = r.desc,
            this.item_count.text = "x" + a.reward_count;
            var s = cfg.item_definition.currency.get(a.reward_id);
            s && (game.LoadMgr.setImgSkin(this.item_icon, s.icon),
            this.item_name.text = s["name_" + GameMgr.client_language]);
            var o = cfg.item_definition.item.get(a.reward_id);
            o && (game.LoadMgr.setImgSkin(this.item_icon, o.icon),
            this.item_name.text = o["name_" + GameMgr.client_language]),
            this.item_count.x = this.item_name.textField.textWidth + this.item_name.x + 50;
            var l = e.counter;
            l || (l = 0),
            l > r.target && (l = r.target),
            this.progress_bar.scaleX = l / r.target,
            this.progress_label.text = l.toString() + "/" + r.target.toString()
        }
        ,
        e
    }()
      , i = function(t) {
        function i(e) {
            return t.call(this, e, new ui.lobby.activitys.activity_taskUI) || this
        }
        return __extends(i, t),
        i.prototype.setHead = function(t, e, i) {
            this.head_url = t,
            this.head_width = e,
            this.head_height = i,
            this.head_width != this.content.width && (this.head_height *= this.content.width / this.head_width,
            this.head_width = this.content.width),
            this.head.width = this.head_width,
            this.head_height = this.head_height
        }
        ,
        i.prototype.onCreate = function() {
            var t = this;
            this.root = this.me.getChildByName("root"),
            this.content = this.root.getChildByName("content"),
            this.head = this.content.getChildByName("head"),
            this.task_templete = this.content.getChildByName("task_templete"),
            this.task_templete.visible = !1,
            this.task_cells = [];
            for (var i = 0; i < 10; i++)
                this.task_cells.push(new e(this.task_templete.scriptMap["capsui.UICopy"].getNodeClone()));
            this.scrollbar = this.root.getChildByName("scrollbar"),
            this.scrollpoint = this.scrollbar.getChildByName("scrollpoint"),
            this.content.vScrollBarSkin = "",
            this.content.vScrollBar.on("change", this, function() {
                t.refresh_scrollbar()
            })
        }
        ,
        i.prototype.refreshView = function(t) {
            game.LoadMgr.setImgSkin(this.head, this.head_url);
            for (var e = this.head_height + 15, i = 0; i < this.task_cells.length; i++)
                i < t.length ? (this.task_cells[i].show(t[i]),
                this.task_cells[i].me.y = e,
                e += this.task_cells[i].me.height) : this.task_cells[i].me.visible = !1;
            this.total_h = e,
            this.content.refresh(),
            this.refresh_scrollbar()
        }
        ,
        i.prototype.refresh_scrollbar = function() {
            if (this.total_h > this.content.height) {
                var t = this.content.vScrollBar.value / this.content.vScrollBar.max;
                this.scrollpoint.height = this.scrollbar.height * this.content.height / this.total_h,
                this.scrollpoint.y = t * this.scrollbar.height * (1 - this.content.height / this.total_h),
                this.scrollbar.visible = !0
            } else
                this.scrollbar.visible = !1
        }
        ,
        i
    }(t.UI_ActivityBase);
    t.UI_Activity_Task = i
}(uiscript || (uiscript = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), uiscript;
!function(t) {
    var e = function(e) {
        function i() {
            var t = e.call(this, game.Tools.strOfLocalization(2235), new ui.lobby.activitys.activity_xuanshangUI) || this;
            return t.tasks = [],
            t.btn_cd = 0,
            t
        }
        return __extends(i, e),
        i.Init = function() {
            var e = this;
            app.NetAgent.sendReq2Lobby("Lobby", "fetchDailyTask", {}, function(i, n) {
                i || n.error ? t.UIMgr.Inst.showNetReqError("fetchDailyTask", i, n) : (e.has_refresh_count = n.has_refresh_count,
                e.datas = n.progresses)
            }),
            app.NetAgent.AddListener2Lobby("NotifyDailyTaskUpdate", Laya.Handler.create(this, function(t) {
                e.has_refresh_count = !0,
                e.datas = t.progresses,
                e.Inst && e.Inst.enable && e.Inst.refresh()
            }, null, !1))
        }
        ,
        i.dataUpdate = function(t) {
            for (var e = 0; e < t.progresses.length; e++)
                for (var i = t.progresses[e], n = 0; n < this.datas.length; n++)
                    if (!this.datas[n].achieved && this.datas[n].id == i.id) {
                        null != i.achieved && void 0 != i.achieved && (this.datas[n].achieved = i.achieved),
                        null != i.counter && void 0 != i.counter && (this.datas[n].counter = i.counter);
                        break
                    }
        }
        ,
        i.prototype.isopen = function() {
            return !0
        }
        ,
        i.prototype.onCreate = function() {
            this.root = this.me.getChildByName("root");
            for (var t = 0; t < 3; t++) {
                var e = this.root.getChildByName("task" + t);
                this.timerefresh = this.root.getChildByName("nochange"),
                this.tasks.push({
                    container: e,
                    bg: e.getChildByName("bg"),
                    container_info: e.getChildByName("info"),
                    item_icon: e.getChildByName("info").getChildByName("item"),
                    item_name: e.getChildByName("info").getChildByName("item_name"),
                    item_count: e.getChildByName("info").getChildByName("item_count"),
                    desc: e.getChildByName("info").getChildByName("requirement"),
                    progress_bar: e.getChildByName("info").getChildByName("bar").getChildByName("val"),
                    progress_label: e.getChildByName("info").getChildByName("progress"),
                    btn_change: e.getChildByName("info").getChildByName("btn_change")
                })
            }
        }
        ,
        i.prototype.show = function() {
            this.enable = !0,
            this.btn_cd = 0,
            this.refresh()
        }
        ,
        i.prototype.getLocalTime = function() {
            var t, e, i, n = new Date;
            n.getTime(),
            n.getTimezoneOffset();
            return n.getUTCHours() + 8 < 4 ? (t = 5 - (n.getUTCHours() + 8),
            i = game.Tools.strOfLocalization(2674, [t.toString()]) + game.Tools.strOfLocalization(2747)) : n.getUTCHours() + 8 >= 5 && (t = 24 - (n.getUTCHours() + 8) + 5,
            i = game.Tools.strOfLocalization(2674, [t.toString()]) + game.Tools.strOfLocalization(2747)),
            n.getUTCHours() + 8 == 4 && (e = 60 - n.getMinutes(),
            i = game.Tools.strOfLocalization(2674, [e.toString()]) + game.Tools.strOfLocalization(2748)),
            i
        }
        ,
        i.prototype.hide = function() {
            this.enable = !1
        }
        ,
        i.prototype.refresh = function() {
            var e = this;
            this.timerefresh.text = this.getLocalTime();
            for (var n = function(n) {
                var r = a.tasks[n];
                if (n < i.datas.length) {
                    var s = i.datas[n]
                      , o = cfg.events.dailyevent.get(s.id);
                    if (s.achieved || !o)
                        r.container_info.visible = !1,
                        r.bg.skin = game.Tools.localUISrc("myres/lobby/bg_rules_no.png");
                    else {
                        r.container_info.visible = !0,
                        r.bg.skin = game.Tools.localUISrc("myres/lobby/bg_rules.png"),
                        r.btn_change.visible = i.has_refresh_count,
                        r.desc.text = o["desc_" + GameMgr.client_language],
                        r.item_count.text = "×" + o.reward_num.toString(),
                        r.item_count.parent.getChildAt(6).visible = !1;
                        var l = cfg.item_definition.currency.get(o.reward_type);
                        l && (r.item_icon.skin = game.LoadMgr.getResImageSkin(l.icon),
                        r.item_name.text = l["name_" + GameMgr.client_language]);
                        var h = cfg.item_definition.item.get(o.reward_type);
                        h && (r.item_icon.skin = game.LoadMgr.getResImageSkin(h.icon),
                        r.item_name.text = h["name_" + GameMgr.client_language]),
                        r.progress_bar.scaleX = s.counter / o.target,
                        r.progress_label.text = s.counter.toString() + "/" + o.target.toString(),
                        r.btn_change.clickHandler = Laya.Handler.create(a, function() {
                            if (!(e.btn_cd > Laya.timer.currTimer)) {
                                e.btn_cd = 1e3 + Laya.timer.currTimer;
                                for (var a = 0; a < e.tasks.length; a++)
                                    e.tasks[a].btn_change.visible = !1;
                                app.NetAgent.sendReq2Lobby("Lobby", "refreshDailyTask", {
                                    task_id: s.id
                                }, function(a, r) {
                                    if (e.btn_cd = 0,
                                    a || r.error)
                                        t.UIMgr.Inst.showNetReqError("refreshDailyTask", a, r);
                                    else {
                                        i.has_refresh_count = !1,
                                        i.datas[n] = r.progress;
                                        for (var s = [], o = 0; o < i.datas.length; o++)
                                            i.datas[o].achieved || s.push(i.datas[o]);
                                        i.datas = s,
                                        e.refresh()
                                    }
                                })
                            }
                        }, null, !1)
                    }
                } else
                    r.container_info.visible = !1,
                    r.bg.skin = game.Tools.localUISrc("myres/lobby/bg_rules_no.png")
            }, a = this, r = 0; r < this.tasks.length; r++)
                n(r)
        }
        ,
        i.has_refresh_count = !1,
        i.datas = [],
        i
    }(t.UI_ActivityBase);
    t.UI_Activity_Xuanshang = e
}(uiscript || (uiscript = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), uiscript;
!function(t) {
    var e = function(e) {
        function i() {
            return e.call(this, cfg.activity.activity.get(1002).name, new ui.lobby.activitys.activity_exchangeUI) || this
        }
        return __extends(i, e),
        i.prototype.isopen = function() {
            return t.UI_Activity.activities[1002]
        }
        ,
        i.prototype.onCreate = function() {
            e.prototype.onCreate.call(this),
            this.label_count_bell = this.head.getChildByName("count0"),
            this.label_count_socks = this.head.getChildByName("count1")
        }
        ,
        i.prototype.refreshCurrencyCount = function() {
            this.label_count_bell.text = t.UI_Bag.get_item_count(309001).toString(),
            this.label_count_socks.text = t.UI_Bag.get_item_count(309002).toString()
        }
        ,
        i.prototype.show = function() {
            this.enable = !0,
            game.LoadMgr.setImgSkin(this.head, "myres2/treasurehead/christmas_reward.jpg"),
            this.refreshView(t.UI_Activity.getExchangeList(1002))
        }
        ,
        i.prototype.hide = function() {
            this.enable = !1
        }
        ,
        i
    }(t.UI_Activity_Exchange);
    t.UI_Christmas_Exchange = e
}(uiscript || (uiscript = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), uiscript;
!function(t) {
    var e = function(e) {
        function i() {
            return e.call(this, cfg.activity.activity.get(1001).name) || this
        }
        return __extends(i, e),
        i.prototype.onCreate = function() {
            e.prototype.onCreate.call(this),
            this.setHead("myres2/treasurehead/christmas_task.jpg", 974, 326)
        }
        ,
        i.prototype.isopen = function() {
            return t.UI_Activity.activities[1001]
        }
        ,
        i.prototype.haveRedPoint = function() {
            var e = t.UI_Activity.getTaskList(1001);
            if (e)
                for (var i = 0; i < e.length; i++)
                    if (!e[i].rewarded && e[i].achieved)
                        return !0;
            return !1
        }
        ,
        i.prototype.need_popout = function() {
            var t = cfg.activity.activity.get(1001);
            return !(!t || !t.need_popout)
        }
        ,
        i.prototype.show = function() {
            this.enable = !0,
            this.refreshView(t.UI_Activity.getTaskList(1001))
        }
        ,
        i.prototype.hide = function() {
            this.enable = !1
        }
        ,
        i
    }(t.UI_Activity_Task);
    t.UI_Christmas_Task = e
}(uiscript || (uiscript = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), uiscript;
!function(t) {
    var e = function(e) {
        function i() {
            return e.call(this, cfg.activity.activity.get(1005).name, new ui.lobby.activitys.activity_exchangeUI) || this
        }
        return __extends(i, e),
        i.prototype.isopen = function() {
            return t.UI_Activity.activities[1005]
        }
        ,
        i.prototype.onCreate = function() {
            e.prototype.onCreate.call(this),
            this.label_count_0 = this.head.getChildByName("count0"),
            this.label_count_1 = this.head.getChildByName("count1"),
            this.label_count_2 = this.head.getChildByName("count2")
        }
        ,
        i.prototype.refreshCurrencyCount = function() {
            this.label_count_0.text = t.UI_Bag.get_item_count(309003).toString(),
            this.label_count_1.text = t.UI_Bag.get_item_count(309004).toString(),
            this.label_count_2.text = t.UI_Bag.get_item_count(309005).toString()
        }
        ,
        i.prototype.show = function() {
            this.enable = !0,
            game.LoadMgr.setImgSkin(this.head, "myres2/treasurehead/newyear_reward.jpg"),
            this.refreshView(t.UI_Activity.getExchangeList(1005))
        }
        ,
        i.prototype.hide = function() {
            this.enable = !1
        }
        ,
        i
    }(t.UI_Activity_Exchange);
    t.UI_NewYear_Exchange = e
}(uiscript || (uiscript = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), uiscript;
!function(t) {
    var e = function() {
        function e(e) {
            this.tasks = [],
            this.left_scrollview = null,
            this.panel_right = null,
            this.select_index = 0,
            this.notask = null,
            this.opening_tasks = [],
            this.me = e,
            this.me.visible = !1,
            this.notask = this.me.getChildByName("notask"),
            this.left_scrollview = this.me.getChildByName("left").scriptMap["capsui.CScrollView"],
            this.left_scrollview.init_scrollview(Laya.Handler.create(this, this.renderLeft, null, !1)),
            this.panel_right = this.me.getChildByName("right"),
            cfg.activity && cfg.activity.activity && (cfg.activity.activity.get(1004) && this.addTask(new t.UI_Activity_NewYear),
            cfg.activity.activity.get(1005) && this.addTask(new t.UI_NewYear_Exchange)),
            this.addTask(new t.UI_Activity_Xuanshang),
            this.addTask(new t.UI_Activity_Jiuji)
        }
        return e.prototype.haveRedPoint = function() {
            for (var t = 0; t < this.tasks.length; t++)
                if (this.tasks[t].isopen() && this.tasks[t].haveRedPoint())
                    return !0;
            return !1
        }
        ,
        e.prototype.need_popout = function() {
            var t = 0
              , e = Laya.LocalStorage.getItem("activity_popout");
            e && "" != e && (t = parseInt(e));
            var i = Date.now();
            if (i < t + 864e5)
                return !1;
            for (var n = 0; n < this.tasks.length; n++)
                if (this.tasks[n].isopen() && this.tasks[n].need_popout())
                    return Laya.LocalStorage.setItem("activity_popout", i.toString()),
                    !0;
            return !1
        }
        ,
        e.prototype.addTask = function(t) {
            this.panel_right.addChild(t.me),
            this.tasks.push(t)
        }
        ,
        e.prototype.show = function() {
            this.me.visible = !0,
            this.left_scrollview.reset(),
            this.select_index = 0,
            this.opening_tasks = [];
            for (var t = 0; t < this.tasks.length; t++)
                this.tasks[t].isopen() && this.opening_tasks.push(t);
            this.opening_tasks.length > 0 ? (this.left_scrollview.me.visible = !0,
            this.panel_right.visible = !0,
            this.notask.visible = !1,
            this.left_scrollview.addItem(this.opening_tasks.length),
            this.tasks[this.opening_tasks[this.select_index]].show()) : (this.left_scrollview.me.visible = !1,
            this.panel_right.visible = !1,
            this.notask.visible = !0)
        }
        ,
        e.prototype.hide = function() {
            this.me.visible = !1,
            this.select_index >= 0 && this.select_index < this.opening_tasks.length && (this.tasks[this.opening_tasks[this.select_index]].hide(),
            this.left_scrollview.wantToRefreshItem(this.select_index)),
            this.select_index = -1,
            this.left_scrollview.reset()
        }
        ,
        e.prototype.renderLeft = function(t) {
            var e = this
              , i = t.index
              , n = t.container
              , a = n.getChildByName("bg");
            a.skin = game.Tools.localUISrc(this.select_index == i ? "myres/lobby/act_choosed.png" : "myres/lobby/act_unchoosen.png"),
            n.clickHandler = Laya.Handler.create(this, function() {
                if (e.select_index != i) {
                    var t = e.select_index;
                    e.select_index = i,
                    t >= 0 && t < e.opening_tasks.length && (e.tasks[e.opening_tasks[t]].hide(),
                    e.left_scrollview.wantToRefreshItem(t)),
                    a.skin = game.Tools.localUISrc("myres/lobby/act_choosed.png"),
                    e.select_index = i,
                    e.tasks[e.opening_tasks[e.select_index]].show()
                }
            }, null, !1),
            n.getChildByName("title").text = this.tasks[this.opening_tasks[i]].activity_name,
            n.getChildByName("redpoint").visible = this.tasks[this.opening_tasks[i]].haveRedPoint()
        }
        ,
        e.prototype.refreshAllLeft = function() {
            this.left_scrollview.wantToRefreshAll()
        }
        ,
        e
    }()
      , i = function(i) {
        function n() {
            var t = i.call(this, new ui.lobby.activityUI) || this;
            return t.root = null,
            t.tabs = [],
            t.redpoint = null,
            t.page_huodong = null,
            t.select_tab = -1,
            t.locking = !1,
            n.Inst = t,
            t
        }
        return __extends(n, i),
        Object.defineProperty(n, "haveRedPoint", {
            get: function() {
                return !(!this.Inst || !this.Inst.page_huodong.haveRedPoint())
            },
            enumerable: !0,
            configurable: !0
        }),
        Object.defineProperty(n, "need_popout", {
            get: function() {
                return !(!this.Inst || !this.Inst.page_huodong.need_popout())
            },
            enumerable: !0,
            configurable: !0
        }),
        n.init = function() {
            var e = this;
            this.activities = {},
            this.activity_tasks = {},
            this.activity_exchange = {},
            app.NetAgent.sendReq2Lobby("Lobby", "fetchActivityList", {}, function(i, n) {
                if (i || n.error)
                    t.UIMgr.Inst.showNetReqError("fetchActivityList", i, n);
                else if (n.activities)
                    for (var a = 0; a < n.activities.length; a++)
                        e.activities[n.activities[a].activity_id] = 1
            }),
            app.NetAgent.sendReq2Lobby("Lobby", "fetchAccountActivityData", {}, function(i, n) {
                if (i || n.error)
                    t.UIMgr.Inst.showNetReqError("fetchAccountActivityData", i, n);
                else {
                    if (n.exchange_records)
                        for (r = 0; r < n.exchange_records.length; r++) {
                            var a = n.exchange_records[r];
                            e.activity_exchange[a.exchange_id] = a
                        }
                    if (n.task_progress_list)
                        for (var r = 0; r < n.task_progress_list.length; r++) {
                            var s = n.task_progress_list[r];
                            e.activity_tasks[s.id] = s
                        }
                }
            }),
            app.NetAgent.AddListener2Lobby("NotifyActivityTaskUpdate", new Laya.Handler(this,function(t) {
                if (e.activity_tasks = {},
                t.progresses)
                    for (var i = 0; i < t.progresses.length; i++) {
                        var n = t.progresses[i];
                        e.activity_tasks[n.id] = n
                    }
            }
            )),
            app.NetAgent.AddListener2Lobby("NotifyActivityChange", new Laya.Handler(this,function(t) {
                if (t.end_activities)
                    for (n = 0; n < t.end_activities.length; n++) {
                        var i = t.end_activities[n];
                        e.activities[i] && delete e.activities[i]
                    }
                if (t.new_activities)
                    for (var n = 0; n < t.new_activities.length; n++) {
                        var a = t.new_activities[n];
                        e.activities[a.activity_id] = 1
                    }
            }
            ))
        }
        ,
        n.accountUpdate = function(t) {
            if (t.activity_task && t.activity_task.progresses)
                for (var e = 0; e < t.activity_task.progresses.length; e++) {
                    var i = t.activity_task.progresses[e];
                    this.activity_tasks[i.id] = i
                }
        }
        ,
        n.activity_is_running = function(t) {
            return !!this.activities[t]
        }
        ,
        n.getTaskList = function(t) {
            var e = [];
            for (var i in this.activity_tasks) {
                var n = parseInt(i)
                  , a = cfg.activity.task.get(n);
                a && a.activity_id === t && e.push(this.activity_tasks[i])
            }
            return e
        }
        ,
        n.getExchangeList = function(t) {
            var e = this
              , i = [];
            return cfg.activity.exchange.forEach(function(n) {
                n.activity_id === t && (e.activity_exchange[n.id] ? i.push(e.activity_exchange[n.id]) : i.push({
                    exchange_id: n.id,
                    count: 0
                }))
            }),
            i
        }
        ,
        n.onExchanged = function(t) {
            this.activity_exchange[t] || (this.activity_exchange[t] = {
                exchange_id: t,
                count: 0
            }),
            this.activity_exchange[t].count++
        }
        ,
        n.onTaskRewarded = function(e) {
            this.activity_tasks[e] && (this.activity_tasks[e].rewarded = !0),
            this.Inst && this.Inst.page_huodong.refreshAllLeft(),
            t.UI_Lobby.Inst.refreshInfo()
        }
        ,
        n.onTreasureRateUp = function(t) {
            var e = function(e) {
                var i = parseInt(e)
                  , n = cfg.activity.activity.get(i);
                if (n && "chest_up" === n.type) {
                    var a = cfg.activity.chest_up.getGroup(i);
                    if (a) {
                        var r = "";
                        if (a.forEach(function(e) {
                            e.chest_id == t && (r = e.img)
                        }),
                        "" != r)
                            return {
                                value: r
                            }
                    }
                }
            };
            for (var i in this.activities) {
                var n = e(i);
                if ("object" == typeof n)
                    return n.value
            }
            return ""
        }
        ,
        n.prototype.onCreate = function() {
            var i = this;
            this.root = this.me.getChildByName("root");
            for (var n = 0; n < 2; n++)
                this.tabs.push(this.root.getChildByName("tabs").getChildByName("tab" + n.toString())),
                this.tabs[n].clickHandler = Laya.Handler.create(this, this._switchTab, [n, !1], !1);
            this.redpoint = this.tabs[1].getChildByName("redpoint"),
            this.redpoint.visible = !1,
            new t.UI_Mail(this.root.getChildByName("page_mail")),
            this.page_huodong = new e(this.root.getChildByName("page_huodong")),
            this.root.getChildByName("btn_close").clickHandler = Laya.Handler.create(this, function() {
                i.close()
            }, null, !1)
        }
        ,
        n.prototype.show = function() {
            var e = this;
            this.enable = !0,
            this.locking = !0,
            this._switchTab(0, !0),
            this.refresh_redpoint(),
            t.UIBase.anim_pop_out(this.root, Laya.Handler.create(this, function() {
                e.locking = !1
            }))
        }
        ,
        n.prototype.close = function() {
            var e = this;
            this.locking = !0,
            t.UIBase.anim_pop_hide(this.root, Laya.Handler.create(this, function() {
                e.locking = !1,
                e.enable = !1
            }))
        }
        ,
        n.prototype.onDisable = function() {
            this.page_huodong.hide(),
            t.UI_Mail.Inst.hide()
        }
        ,
        n.prototype._switchTab = function(e, i) {
            (i || this.select_tab != e) && (this.select_tab = e,
            this.tabs[0].getChildByName("img").skin = game.Tools.localUISrc(0 == e ? "myres/lobby/act_bright.png" : "myres/lobby/act_dark.png"),
            this.tabs[1].getChildByName("img").skin = game.Tools.localUISrc(1 == e ? "myres/lobby/mail_bright.png" : "myres/lobby/mail_dark.png"),
            1 == this.select_tab ? (this.page_huodong.hide(),
            t.UI_Mail.Inst.show()) : (this.page_huodong.show(),
            t.UI_Mail.Inst.hide()))
        }
        ,
        n.prototype.refresh_redpoint = function() {
            this.redpoint.visible = t.UI_Mail.haveRedPoint,
            this.page_huodong.refreshAllLeft()
        }
        ,
        n.Inst = null,
        n.activities = {},
        n.activity_tasks = {},
        n.activity_exchange = {},
        n
    }(t.UIBase);
    t.UI_Activity = i
}(uiscript || (uiscript = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), uiscript;
!function(t) {
    var e = function(e) {
        function i() {
            var t = e.call(this, new ui.lobby.add_roomUI) || this;
            return t.txtinput = null,
            t.locking = !1,
            t.root = null,
            i.Inst = t,
            t
        }
        return __extends(i, e),
        i.Show = function() {
            this.Inst._show()
        }
        ,
        i.Close = function() {
            null != this.Inst && this.Inst._hide()
        }
        ,
        i.prototype.onCreate = function() {
            var t = this;
            this.root = this.me.getChildByName("root"),
            this.root.getChildByName("btn_cancel").clickHandler = Laya.Handler.create(this, function() {
                t.locking || t._hide()
            }, null, !1),
            this.root.getChildByName("btn_create").clickHandler = Laya.Handler.create(this, this._btnAddRoom, null, !1),
            this.txtinput = this.root.getChildByName("input").getChildByName("txtinput");
            for (var e = this.root.getChildByName("numpad"), i = function(i) {
                var a = e.getChildByName("n" + i)
                  , r = a.getChildByName("s");
                r.alpha = 0;
                var s = !1;
                a.on("mousedown", n, function() {
                    r.alpha = 0,
                    s = !0,
                    Laya.Tween.to(r, {
                        alpha: 1
                    }, 50, null, null, 0, !0, !0)
                }),
                a.on("mouseup", n, function() {
                    Laya.Tween.to(r, {
                        alpha: 0
                    }, 50, null, null, 0, !0, !0),
                    s && t.txtinput.text.length < t.txtinput.maxChars && (t.txtinput.text = t.txtinput.text + i.toString()),
                    s = !1
                }),
                a.on("mouseout", n, function() {
                    Laya.Tween.to(r, {
                        alpha: 0
                    }, 50, null, null, 0, !0, !0),
                    s = !1
                })
            }, n = this, a = 0; a < 10; a++)
                i(a);
            var r = (o = e.getChildByName("clear")).getChildByName("s");
            r.alpha = 0;
            var s = !1;
            o.on("mousedown", this, function() {
                r.alpha = 0,
                s = !0,
                Laya.Tween.to(r, {
                    alpha: 1
                }, 50, null, null, 0, !0, !0)
            }),
            o.on("mouseup", this, function() {
                Laya.Tween.to(r, {
                    alpha: 0
                }, 50, null, null, 0, !0, !0),
                s && (t.txtinput.text = ""),
                s = !1
            }),
            o.on("mouseout", this, function() {
                Laya.Tween.to(r, {
                    alpha: 0
                }, 50, null, null, 0, !0, !0),
                s = !1
            });
            var o = e.getChildByName("del")
              , l = o.getChildByName("s");
            l.alpha = 0;
            var h = !1;
            o.on("mousedown", this, function() {
                l.alpha = 0,
                h = !0,
                Laya.Tween.to(l, {
                    alpha: 1
                }, 50, null, null, 0, !0, !0)
            }),
            o.on("mouseup", this, function() {
                if (Laya.Tween.to(l, {
                    alpha: 0
                }, 50, null, null, 0, !0, !0),
                h) {
                    var e = t.txtinput.text;
                    e.length > 0 && (e = e.substr(0, e.length - 1)),
                    t.txtinput.text = e
                }
                h = !1
            }),
            o.on("mouseout", this, function() {
                Laya.Tween.to(l, {
                    alpha: 0
                }, 50, null, null, 0, !0, !0),
                h = !1
            })
        }
        ,
        i.prototype._show = function() {
            var e = this;
            this.enable = !0,
            this.txtinput.text = "",
            this.locking || (this.locking = !0,
            t.UIBase.anim_pop_out(this.root, Laya.Handler.create(this, function() {
                e.locking = !1
            })))
        }
        ,
        i.prototype._hide = function() {
            var e = this;
            this.locking = !0,
            t.UIBase.anim_pop_hide(this.root, Laya.Handler.create(this, function() {
                e.locking = !1,
                e.enable = !1
            }))
        }
        ,
        i.prototype._btnAddRoom = function() {
            var e = this;
            this.locking || (this._hide(),
            app.NetAgent.sendReq2Lobby("Lobby", "joinRoom", {
                room_id: parseInt(this.txtinput.text)
            }, function(i, n) {
                i || n.error ? t.UIMgr.Inst.showNetReqError("joinRoom", i, n) : (e.enable = !1,
                t.UI_Lobby.Inst.enable = !1,
                t.UI_WaitingRoom.Inst.updateData(n.room),
                t.UIMgr.Inst.ShowWaitingRoom())
            }))
        }
        ,
        i.Inst = null,
        i
    }(t.UIBase);
    t.UI_Add_Room = e
}(uiscript || (uiscript = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), uiscript;
!function(t) {
    var e = function(e) {
        function i() {
            var t = e.call(this, new ui.lobby.ageconfirmUI) || this;
            return t.birth_day = 0,
            i.Inst = t,
            t
        }
        return __extends(i, e),
        i.prototype.onCreate = function() {
            var e = this;
            this.root = this.me.getChildByName("agepending").getChildByName("root"),
            this.btn_confirm = this.root.getChildByName("btn_confirm"),
            this.btn_close = this.root.getChildByName("btn_close"),
            this.nianling = this.root.getChildByName("sheding"),
            this.shangxian = this.root.getChildByName("shangxian"),
            this.btn_confirm.clickHandler = Laya.Handler.create(this, function() {
                e.locking || (e.close(),
                app.NetAgent.sendReq2Lobby("Lobby", "modifyBirthday", {
                    birthday: e.birth_day
                }, function(i, n) {
                    i || n.error ? t.UIMgr.Inst.showNetReqError("modifyBirthday", i, n) : (GameMgr.Inst.account_data.birthday = e.birth_day,
                    t.UI_Agesuccess.Inst.show())
                }))
            }, null, !1),
            this.btn_close.clickHandler = Laya.Handler.create(this, function() {
                e.locking || e.close()
            }, null, !1)
        }
        ,
        i.prototype.show = function(e, i, n) {
            var a = this;
            this.enable = !0,
            this.locking = !0;
            var r = "生年月日を" + e + "年" + i + "月に設定しますか？";
            this.nianling.text = r;
            var s = new Date;
            s.setFullYear(parseInt(e), parseInt(i) - 1, 1),
            s.setHours(0, 0, 0, 0),
            this.birth_day = Math.floor(s.getTime() / 1e3),
            n < 0 ? (this.shangxian.visible = !1,
            this.root.getChildByName("xiaofei1").visible = !1,
            this.root.getChildByName("xiaofei0").visible = !1) : (this.shangxian.text = n.toString(),
            this.shangxian.visible = !0,
            this.root.getChildByName("xiaofei1").visible = !0,
            this.root.getChildByName("xiaofei0").visible = !0),
            t.UIBase.anim_pop_out(this.root, Laya.Handler.create(this, function() {
                a.locking = !1
            }))
        }
        ,
        i.prototype.close = function() {
            var e = this;
            this.locking = !0,
            t.UIBase.anim_pop_hide(this.root, Laya.Handler.create(this, function() {
                e.locking = !1,
                e.enable = !1
            }))
        }
        ,
        i
    }(t.UIBase);
    t.UI_Ageconfirm = e
}(uiscript || (uiscript = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), uiscript;
!function(t) {
    var e = function() {
        function t(t, e, i, n, a) {
            var r = this;
            this.isopen = !1,
            this.locking = !1,
            this.showed = !1,
            this.when_close = null,
            this.when_choose = null,
            this.datas = [],
            this.start_rate = 0,
            this.me = t,
            t.visible = !1,
            this.isopen = !1,
            this.locking = !1,
            this.when_close = e,
            this.when_choose = i,
            this.datas = n,
            this.start_rate = a,
            this.scrollview = this.me.scriptMap["capsui.CScrollView"],
            this.scrollview.init_scrollview(new Laya.Handler(this,this.refresh_item)),
            this.bg = this.me.getChildByName("bg"),
            this.content = this.me.getChildByName("content"),
            t.getChildByName("btn_open").clickHandler = new Laya.Handler(this,function() {
                r.locking || (r.isopen ? r.close() : r.show())
            }
            )
        }
        return t.prototype.reset = function() {
            this.isopen = !1,
            this.locking = !1,
            this.me.visible = !0,
            this.bg.visible = !1,
            this.content.visible = !1
        }
        ,
        t.prototype.show = function() {
            var t = this;
            this.locking = !0,
            this.isopen = !0,
            this.bg.visible = !0,
            this.bg.height = 10,
            Laya.Tween.to(this.bg, {
                height: 285
            }, 150, Laya.Ease.linearNone),
            this.content.visible = !0,
            this.content.alpha = 0,
            Laya.Tween.to(this.content, {
                alpha: 1
            }, 150, Laya.Ease.linearNone),
            Laya.timer.once(150, this, function() {
                t.locking = !1
            }),
            this.showed || (this.scrollview.reset(),
            this.scrollview.addItem(this.datas.length),
            this.showed = !0,
            this.scrollview.rate = this.start_rate)
        }
        ,
        t.prototype.refresh_item = function(t) {
            var e = this
              , i = t.index
              , n = t.container;
            n.getChildByName("btn").clickHandler = Laya.Handler.create(this, function() {
                e.locking || (e.close(),
                e.when_choose && e.when_choose.runWith(e.datas[i]))
            }, null, !1),
            n.getChildByName("btn").getChildByName("txt").text = this.datas[i]
        }
        ,
        t.prototype.close = function() {
            var t = this;
            this.locking = !0,
            Laya.Tween.to(this.content, {
                alpha: 0
            }, 150, Laya.Ease.linearNone),
            Laya.Tween.to(this.bg, {
                height: 10
            }, 150, Laya.Ease.linearNone),
            Laya.timer.once(150, this, function() {
                t.locking = !1,
                t.bg.visible = !1,
                t.content.visible = !1,
                t.isopen = !1,
                t.when_close && t.when_close.run()
            })
        }
        ,
        t
    }()
      , i = function() {
        function t(t, i, n) {
            var a = this;
            this.locking = !1,
            this.me = t,
            t.visible = !1,
            this.me.getChildByName("btn_close").clickHandler = new Laya.Handler(this,function() {
                a.dropdown_mouth.locking || a.dropdown_year.locking || (a.dropdown_mouth.isopen && a.dropdown_mouth.close(),
                a.dropdown_year.isopen && a.dropdown_year.close())
            }
            );
            this.dropdown_mouth = new e(this.me.getChildByName("container_month"),new Laya.Handler(this,function() {
                a._OnStateChange(),
                i.runWith("")
            }
            ),new Laya.Handler(this,function(t) {
                return i.runWith(t)
            }
            ),["01", "02", "03", "04", "05", "06", "07", "08", "09", "10", "11", "12"],0);
            for (var r = new Date(Date.now()), s = [], o = 0; o < 120; o++)
                s.push((r.getFullYear() - 120 + o).toString());
            this.dropdown_year = new e(this.me.getChildByName("container_year"),new Laya.Handler(this,function() {
                a._OnStateChange(),
                n.runWith("")
            }
            ),new Laya.Handler(this,function(t) {
                return n.runWith(t)
            }
            ),s,1)
        }
        return t.prototype.show = function(t) {
            this.dropdown_mouth.reset(),
            this.dropdown_year.reset(),
            this.me.visible = !0,
            t ? this.dropdown_mouth.show() : this.dropdown_year.show()
        }
        ,
        t.prototype._OnStateChange = function() {
            this.dropdown_year.isopen || this.dropdown_mouth.isopen || (this.me.visible = !1)
        }
        ,
        t
    }()
      , n = function(e) {
        function n() {
            var t = e.call(this, new ui.lobby.agependingUI) || this;
            return t.color_hint = "#5A82C8",
            t.color_wrong = "#FF3030",
            n.Inst = t,
            t
        }
        return __extends(n, e),
        n.prototype.onCreate = function() {
            var t = this;
            this.root = this.me.getChildByName("agepending").getChildByName("root"),
            this.btn_confirm = this.root.getChildByName("btn_confirm"),
            this.btn_close = this.root.getChildByName("btn_close");
            var e = this.me.getChildByName("agepending").getChildByName("root");
            this.btn_month = e.getChildByName("month"),
            this.btn_month.clickHandler = new Laya.Handler(this,function() {
                t.locking || t.date_dropdown.show(!0)
            }
            ),
            this.txt_month = this.btn_month.getChildByName("txt"),
            this.btn_year = e.getChildByName("year"),
            this.btn_year.clickHandler = new Laya.Handler(this,function() {
                t.locking || t.date_dropdown.show(!1)
            }
            ),
            this.txt_year = this.btn_year.getChildByName("txt"),
            this.notice_month = e.getChildByName("notice_month"),
            this.notice_year = e.getChildByName("notice_year"),
            this.date_dropdown = new i(this.me.getChildByName("agepending").getChildByName("container_dropdown"),new Laya.Handler(this,function(e) {
                "" != e && (t.txt_month.text = e),
                t.pending_month()
            }
            ),new Laya.Handler(this,function(e) {
                "" != e && (t.txt_year.text = e),
                t.pending_year()
            }
            )),
            this.btn_confirm.clickHandler = Laya.Handler.create(this, function() {
                t.locking || t.onClickConfirm()
            }, null, !1),
            this.btn_close.clickHandler = Laya.Handler.create(this, function() {
                t.locking || t.close()
            }, null, !1)
        }
        ,
        n.prototype.onClickConfirm = function() {
            var e = !0
              , i = "0"
              , n = "0";
            if (this.pending_month() || (e = !1),
            this.pending_year() || (e = !1),
            i = this.txt_year.text,
            n = this.txt_month.text,
            e) {
                var a = parseInt(i)
                  , r = parseInt(n)
                  , s = new Date
                  , o = 12 * s.getFullYear() + s.getMonth() - 12 * a - r
                  , l = Math.floor(o / 12)
                  , h = 0;
                h = l < 16 ? 5e3 : l < 20 ? 2e4 : -1,
                t.UI_Ageconfirm.Inst.show(i, n, h),
                this.close()
            }
        }
        ,
        n.prototype.pending_month = function() {
            return this.txt_month.text != game.Tools.strOfLocalization(2729) ? (this.notice_month.text = "",
            !0) : (this.notice_month.text = game.Tools.strOfLocalization(2733),
            this.notice_month.color = this.color_wrong,
            !1)
        }
        ,
        n.prototype.pending_year = function() {
            return this.txt_year.text != game.Tools.strOfLocalization(2730) ? (this.notice_year.text = "",
            !0) : (this.notice_year.text = game.Tools.strOfLocalization(2734),
            this.notice_year.color = this.color_wrong,
            !1)
        }
        ,
        n.prototype.show = function() {
            var e = this;
            this.enable = !0,
            this.locking = !0,
            this.confirmflag = 0,
            this.date_dropdown.me.visible = !1,
            this.notice_month.text = game.Tools.strOfLocalization(2731),
            this.notice_month.color = this.color_hint,
            this.notice_year.text = game.Tools.strOfLocalization(2732),
            this.notice_year.color = this.color_hint,
            t.UIBase.anim_pop_out(this.root, Laya.Handler.create(this, function() {
                e.locking = !1
            }))
        }
        ,
        n.prototype.close = function() {
            var e = this;
            this.locking = !0,
            t.UIBase.anim_pop_hide(this.root, Laya.Handler.create(this, function() {
                e.locking = !1,
                e.enable = !1
            }))
        }
        ,
        n
    }(t.UIBase);
    t.UI_Agepending = n
}(uiscript || (uiscript = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), uiscript;
!function(t) {
    var e = function(e) {
        function i() {
            var t = e.call(this, new ui.lobby.agesuccessUI) || this;
            return i.Inst = t,
            t
        }
        return __extends(i, e),
        i.prototype.onCreate = function() {
            var t = this;
            this.root = this.me.getChildByName("agepending").getChildByName("root"),
            this.btn_confirm = this.root.getChildByName("btn_confirm"),
            this.btn_close = this.root.getChildByName("btn_close"),
            this.btn_confirm.clickHandler = Laya.Handler.create(this, function() {
                t.locking || t.close()
            }, null, !1),
            this.btn_close.clickHandler = Laya.Handler.create(this, function() {
                t.locking || t.close()
            }, null, !1)
        }
        ,
        i.prototype.show = function() {
            var e = this;
            this.enable = !0,
            this.locking = !0,
            t.UIBase.anim_pop_out(this.root, Laya.Handler.create(this, function() {
                e.locking = !1
            }))
        }
        ,
        i.prototype.close = function() {
            var e = this;
            this.locking = !0,
            t.UIBase.anim_pop_hide(this.root, Laya.Handler.create(this, function() {
                e.locking = !1,
                e.enable = !1
            }))
        }
        ,
        i
    }(t.UIBase);
    t.UI_Agesuccess = e
}(uiscript || (uiscript = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), uiscript;
!function(t) {
    var e = function(e) {
        function i() {
            var t = e.call(this, new ui.lobby.agexianeUI) || this;
            return i.Inst = t,
            t
        }
        return __extends(i, e),
        i.prototype.onCreate = function() {
            var t = this;
            this.root = this.me.getChildByName("agepending").getChildByName("root"),
            this.btn_confirm = this.root.getChildByName("btn_confirm"),
            this.btn_close = this.root.getChildByName("btn_close"),
            this.xiaofei = this.root.getChildByName("xiaofei"),
            this.shangxian = this.root.getChildByName("shangxian"),
            this.btn_confirm.clickHandler = Laya.Handler.create(this, function() {
                t.locking || t.close()
            }, null, !1),
            this.btn_close.clickHandler = Laya.Handler.create(this, function() {
                t.locking || t.close()
            }, null, !1)
        }
        ,
        i.prototype.show = function(e, i) {
            var n = this;
            this.enable = !0,
            this.locking = !0,
            this.xiaofei.text = e.toString();
            var a = 0;
            a = i < 16 ? 5e3 : 2e4,
            this.shangxian.text = a.toString(),
            t.UIBase.anim_pop_out(this.root, Laya.Handler.create(this, function() {
                n.locking = !1
            }))
        }
        ,
        i.prototype.close = function() {
            var e = this;
            this.locking = !0,
            t.UIBase.anim_pop_hide(this.root, Laya.Handler.create(this, function() {
                e.locking = !1,
                e.enable = !1
            }))
        }
        ,
        i
    }(t.UIBase);
    t.UI_Agexiane = e
}(uiscript || (uiscript = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), uiscript;
!function(t) {
    var e = function(e) {
        function i() {
            return e.call(this, new ui.mj.alUI) || this
        }
        return __extends(i, e),
        i.Show = function() {
            var e = new i;
            t.UIMgr.Inst.AddMJUI(e),
            Laya.timer.frameOnce(5, this, function() {
                e.show()
            })
        }
        ,
        i.prototype.show = function() {
            var t = this;
            this.me.visible = !0,
            this.me.start.play(0, !1),
            Laya.timer.once(1300, this, function() {
                t.me.visible = !1,
                t.me.destroy(!0)
            })
        }
        ,
        i
    }(t.UIBase);
    t.UI_AL = e
}(uiscript || (uiscript = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), uiscript;
!function(t) {
    var e = function(e) {
        function i() {
            var t = e.call(this, new ui.common.anotherloginUI) || this;
            return i.Inst = t,
            t
        }
        return __extends(i, e),
        i.prototype.onCreate = function() {
            this.root = this.me.getChildByName("root"),
            this.root.getChildByName("btn").clickHandler = Laya.Handler.create(this, this.hide, null, !1)
        }
        ,
        i.prototype.show = function() {
            this.me.visible = !0,
            Laya.LocalStorage.setItem("_pre_sociotype", ""),
            app.Log.info_net("UI_AnotherLogin  close net"),
            game.LobbyNetMgr.Inst.Close(),
            game.MJNetMgr.Inst && game.MJNetMgr.Inst.Close(),
            t.UIBase.anim_pop_out(this.root, null)
        }
        ,
        i.prototype.hide = function() {
            if (Laya.LocalStorage.setItem("_pre_sociotype", ""),
            Laya.Browser.window.conch) {
                Laya.PlatformClass.createClass("layaair.majsoul.mjmgr").call("restart")
            } else
                Laya.Browser.window.location.href = GameMgr.Inst.link_url
        }
        ,
        i.Inst = null,
        i
    }(t.UIBase);
    t.UI_AnotherLogin = e
}(uiscript || (uiscript = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), uiscript;
!function(t) {
    var e;
    !function(t) {
        t[t.none = 0] = "none",
        t[t.daoju = 1] = "daoju",
        t[t.gift = 2] = "gift",
        t[t.fudai = 3] = "fudai",
        t[t.character_view = 4] = "character_view",
        t[t.common_view = 5] = "common_view"
    }(e = t.EItemCategory || (t.EItemCategory = {}));
    var i = function(i) {
        function n() {
            var t = i.call(this, new ui.lobby.bagUI) || this;
            return t.container_top = null,
            t.container_content = null,
            t.locking = !1,
            t.tabs = [],
            t.page_item = null,
            t.page_gift = null,
            t.page_desktop = null,
            t.select_index = 0,
            n.Inst = t,
            t
        }
        return __extends(n, i),
        n.init = function() {
            var t = this;
            app.NetAgent.AddListener2Lobby("NotifyAccountUpdate", Laya.Handler.create(this, function(e) {
                var i = e.update;
                i && i.bag && t.update_data(i.bag.update_items)
            }, null, !1)),
            this.fetch()
        }
        ,
        n.fetch = function() {
            var e = this;
            this._item_map = {},
            app.NetAgent.sendReq2Lobby("Lobby", "fetchBagInfo", {}, function(i, n) {
                if (i || n.error)
                    t.UIMgr.Inst.showNetReqError("fetchBagInfo", i, n);
                else {
                    app.Log.log("背包信息：" + JSON.stringify(n));
                    var a = n.bag;
                    if (a && a.items)
                        for (var r = 0; r < a.items.length; r++) {
                            var s = a.items[r].item_id
                              , o = a.items[r].stack
                              , l = cfg.item_definition.item.get(s);
                            l && (e._item_map[s] = {
                                item_id: s,
                                count: o,
                                category: l.category
                            })
                        }
                }
            })
        }
        ,
        n.find_item = function(t) {
            var e = this._item_map[t];
            return e ? {
                item_id: e.item_id,
                category: e.category,
                count: e.count
            } : null
        }
        ,
        n.get_item_count = function(t) {
            var e = this.find_item(t);
            if (e)
                return e.count;
            if (100001 == t) {
                var i = GameMgr.Inst.account_data.diamond;
                return GameMgr.inGooglePlay && GameMgr.Inst.account_numerical_resource[101001] && (i += GameMgr.Inst.account_numerical_resource[101001]),
                GameMgr.inChina && GameMgr.Inst.account_numerical_resource[101002] && (i += GameMgr.Inst.account_numerical_resource[101002]),
                i
            }
            return 100002 == t ? GameMgr.Inst.access_token.gold : 0
        }
        ,
        n.find_items_by_category = function(t) {
            var e = [];
            for (var i in this._item_map)
                this._item_map[i].category == t && e.push({
                    item_id: this._item_map[i].item_id,
                    category: this._item_map[i].category,
                    count: this._item_map[i].count
                });
            return e
        }
        ,
        n.update_data = function(t) {
            for (r = 0; r < t.length; r++) {
                var e = t[r].item_id
                  , i = t[r].stack;
                i > 0 ? this._item_map.hasOwnProperty(e.toString()) ? this._item_map[e].count = i : this._item_map[e] = {
                    item_id: e,
                    count: i,
                    category: cfg.item_definition.item.get(e).category
                } : this._item_map.hasOwnProperty(e.toString()) && (this._item_map[e] = 0,
                delete this._item_map[e])
            }
            this.Inst && this.Inst.when_data_change();
            for (r = 0; r < t.length; r++) {
                e = t[r].item_id;
                if (this._item_listener.hasOwnProperty(e.toString()))
                    for (var n = this._item_listener[e], a = 0; a < n.length; a++)
                        n[a].run()
            }
            for (var r = 0; r < this._all_item_listener.length; r++)
                this._all_item_listener[r].run()
        }
        ,
        n.add_item_listener = function(t, e) {
            this._item_listener.hasOwnProperty(t.toString()) || (this._item_listener[t] = []),
            this._item_listener[t].push(e)
        }
        ,
        n.remove_item_listener = function(t, e) {
            var i = this._item_listener[t];
            if (i)
                for (var n = 0; n < i.length; n++)
                    if (i[n] === e) {
                        i[n] = i[i.length - 1],
                        i.pop();
                        break
                    }
        }
        ,
        n.add_all_item_listener = function(t) {
            this._all_item_listener.push(t)
        }
        ,
        n.remove_all_item_listener = function(t) {
            for (var e = this._all_item_listener, i = 0; i < e.length; i++)
                if (e[i] === t) {
                    e[i] = e[e.length - 1],
                    e.pop();
                    break
                }
        }
        ,
        n.prototype.onCreate = function() {
            var e = this;
            this.container_top = this.me.getChildByName("top"),
            this.container_top.getChildByName("btn_back").clickHandler = Laya.Handler.create(this, function() {
                e.locking || e.hide(Laya.Handler.create(e, function() {
                    t.UI_Lobby.Inst.enable = !0
                }))
            }, null, !1),
            this.container_content = this.me.getChildByName("content");
            for (var i = function(t) {
                n.tabs.push(n.container_content.getChildByName("tabs").getChildAt(t)),
                n.tabs[t].clickHandler = Laya.Handler.create(n, function() {
                    e.select_index != t && e.on_change_tab(t)
                }, null, !1)
            }, n = this, a = 0; a < 4; a++)
                i(a);
            this.page_item = new t.UI_Bag_PageItem(this.container_content.getChildByName("page_items")),
            this.page_gift = new t.UI_Bag_PageGift(this.container_content.getChildByName("page_gift")),
            this.page_desktop = new t.UI_Bag_PageDesktop(this.container_content.getChildByName("page_desktop"))
        }
        ,
        n.prototype.show = function() {
            var e = this;
            this.enable = !0,
            this.locking = !0,
            t.UIBase.anim_alpha_in(this.container_top, {
                y: -30
            }, 200),
            t.UIBase.anim_alpha_in(this.container_content, {
                y: 30
            }, 200),
            Laya.timer.once(300, this, function() {
                e.locking = !1
            }),
            this.on_change_tab(0),
            game.Scene_Lobby.Inst.change_bg("indoor", !1)
        }
        ,
        n.prototype.hide = function(e) {
            var i = this;
            this.locking = !0,
            t.UIBase.anim_alpha_out(this.container_top, {
                y: -30
            }, 200),
            t.UIBase.anim_alpha_out(this.container_content, {
                y: 30
            }, 200),
            Laya.timer.once(300, this, function() {
                i.locking = !1,
                i.enable = !1,
                e && e.run()
            })
        }
        ,
        n.prototype.onDisable = function() {
            this.page_desktop.me.visible && this.page_desktop.close()
        }
        ,
        n.prototype.on_change_tab = function(t) {
            this.select_index = t;
            for (var i = 0; i < this.tabs.length; i++)
                this.tabs[i].skin = game.Tools.localUISrc(t == i ? "myres/shop/tab_choose.png" : "myres/shop/tab_unchoose.png"),
                this.tabs[i].getChildAt(0).color = t == i ? "#d9b263" : "#8cb65f";
            switch (this.page_item.close(),
            this.page_gift.close(),
            this.page_desktop.close(),
            t) {
            case 0:
                this.page_item.show(e.daoju);
                break;
            case 1:
                this.page_gift.show();
                break;
            case 2:
                this.page_item.show(e.character_view);
                break;
            case 3:
                this.page_desktop.show()
            }
        }
        ,
        n.prototype.when_data_change = function() {
            this.page_item.me.visible && this.page_item.when_update_data(),
            this.page_gift.me.visible && this.page_gift.when_update_data()
        }
        ,
        n._item_map = {},
        n._item_listener = {},
        n._all_item_listener = [],
        n.Inst = null,
        n
    }(t.UIBase);
    t.UI_Bag = i
}(uiscript || (uiscript = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), uiscript;
!function(t) {
    var e = function(e) {
        function i() {
            var t = e.call(this, new ui.lobby.chang_nicknameUI) || this;
            return t.locking = !1,
            i.Inst = t,
            t
        }
        return __extends(i, e),
        i.prototype.onCreate = function() {
            var t = this;
            this.root = this.me.getChildByName("root"),
            this.container_input = this.root.getChildByName("container_input"),
            this.lb = this.container_input.getChildByName("lb"),
            this.input = this.container_input.getChildByName("txtinput"),
            this.input_no = this.container_input.getChildByName("no"),
            this.btn_confirm = this.container_input.getChildByName("btn_confirm"),
            this.notice = this.container_input.getChildByName("nochange"),
            this.btn_confirm.clickHandler = Laya.Handler.create(this, this.onBtnConfrim, null, !1),
            this.input.on("focus", this, function() {
                t.lb.visible = !1,
                t.input_no.visible = !1
            }),
            this.input.on("blur", this, function() {
                t.lb.visible = !t.input.text || "" == t.input.text
            }),
            this.input.on("input", this, function() {
                t.input.text && t.input.text
            }),
            this.container_no = this.root.getChildByName("container_no"),
            this.label_count = this.container_no.getChildByName("count"),
            this.root.getChildByName("btn_close").clickHandler = Laya.Handler.create(this, function() {
                t.close()
            }, null, !1),
            this.container_input.getChildByName("en_no_space").visible = "en" == GameMgr.client_language
        }
        ,
        i.prototype.show = function() {
            var e = this
              , i = Date.now() / 1e3
              , n = 30 - Math.floor((i - GameMgr.Inst.last_mod_name_time) / 3600 / 24);
            if (n > 0)
                this.container_no.visible = !0,
                this.label_count.text = n.toString(),
                this.container_input.visible = !1;
            else {
                this.container_input.visible = !0,
                this.container_no.visible = !1,
                this.input_no.visible = !1,
                this.lb.visible = !0,
                this.input.text = "",
                this.notice.text = game.Tools.strOfLocalization(2675);
                var a = this.container_input.getChildByName("price")
                  , r = cfg.item_definition.item.get(302013);
                game.LoadMgr.setImgSkin(a.getChildByName("icon"), r.icon);
                var s = a.getChildByName("count");
                s.text = "x1",
                t.UI_Bag.get_item_count(302013) > 0 ? (s.color = "#00ff00",
                game.Tools.setGrayDisable(this.btn_confirm, !1)) : (s.color = "#ff0000",
                game.Tools.setGrayDisable(this.btn_confirm, !0)),
                game.Tools.child_align_center(a, [10, 10, 10])
            }
            this.enable = !0,
            this.locking = !0,
            t.UIBase.anim_pop_out(this.root, Laya.Handler.create(this, function() {
                e.locking = !1
            }))
        }
        ,
        i.prototype.have_invalid_char = function(t) {
            for (var e = 0; e < t.length; e++) {
                var i = t.charCodeAt(e);
                if (!(i >= "a".charCodeAt(0) && i <= "z".charCodeAt(0)) && !(i >= "A".charCodeAt(0) && i <= "Z".charCodeAt(0) || i >= 11904 && i <= 40959)) {
                    for (var n = !1, a = 0; a < "~@!#%&()_+={}:;<>".length; a++)
                        if ("~@!#%&()_+={}:;<>"[a] == t[e]) {
                            n = !0;
                            break
                        }
                    if (!n)
                        return !0
                }
            }
            return !1
        }
        ,
        i.prototype.onBtnConfrim = function() {
            var e = this;
            if (!this.locking && "" != this.input.text) {
                for (var i = this.input.text, n = 0, a = 0, r = 0; r < i.length; r++) {
                    if (i.charCodeAt(r) > 255) {
                        if (n + 2 > 14)
                            break;
                        n += 2
                    } else {
                        if (n + 1 > 14)
                            break;
                        n += 1
                    }
                    a++
                }
                if (a == i.length) {
                    var s = this.input.text;
                    this.have_invalid_char(s) || t.UI_Entrance.Accountforbidden(s) ? this.input_no.visible = !0 : (game.Tools.setGrayDisable(this.btn_confirm, !0),
                    app.NetAgent.sendReq2Lobby("Lobby", "modifyNickname", {
                        nickname: s,
                        use_item_id: 302013
                    }, function(i, n) {
                        i || n.error ? (t.UIMgr.Inst.showNetReqError("modifyNickname", i, n),
                        game.Tools.setGrayDisable(e.btn_confirm, !1)) : (GameMgr.Inst.account_data.nickname = s,
                        GameMgr.Inst.last_mod_name_time = Date.now() / 1e3,
                        t.UI_PlayerInfo.Inst.refreshBaseInfo(),
                        t.UI_Lobby.Inst.top.refresh(),
                        e.close())
                    }))
                } else
                    t.UIMgr.Inst.ShowErrorInfo(game.Tools.strOfLocalization(2750))
            }
        }
        ,
        i.prototype.close = function() {
            var e = this;
            this.locking = !0,
            t.UIBase.anim_pop_hide(this.root, Laya.Handler.create(this, function() {
                e.locking = !1,
                e.enable = !1
            }))
        }
        ,
        i
    }(t.UIBase);
    t.UI_Change_Nickname = e
}(uiscript || (uiscript = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), uiscript;
!function(t) {
    var e = function(e) {
        function i() {
            var t = e.call(this, new ui.both_ui.character_star_upUI) || this;
            t.ress = [],
            t.effect_path = "scene/scene_shengjiban.ls",
            t.locking = !1,
            i.Inst = t,
            t.ress = [];
            var n = "";
            return "chs" != GameMgr.client_language && (n += GameMgr.client_language + "/"),
            t.ress.push(n + "myres/star_up/levelup.png"),
            t.ress.push(n + "myres/star_up/bg.jpg"),
            t.ress.push(n + "myres/star_up/bang_heart.png"),
            Laya.loader.load(t.ress, null, null, "image"),
            t
        }
        return __extends(i, e),
        i.prototype.onCreate = function() {
            var e = this;
            this.blackbg = this.me.getChildByName("blackbg"),
            this.btn_bigclose = this.me.getChildByName("bigclose"),
            this.btn_bigclose.clickHandler = Laya.Handler.create(this, function() {
                e.locking || e.close()
            }, null, !1),
            this.root = this.me.getChildByName("root"),
            this.container_avatar = this.root.getChildByName("container_avatar"),
            this.avatar0 = new t.UI_Character_Skin(this.container_avatar.getChildByName("avatar0")),
            this.avatar1 = new t.UI_Character_Skin(this.container_avatar.getChildByName("avatar1")),
            this.avatar1.me.visible = !1,
            this.bg = this.root.getChildByName("bg"),
            this.img_word = this.root.getChildByName("container_hearts").getChildByName("img_word"),
            this.container_hearts = this.root.getChildByName("container_hearts"),
            this.hearts = [];
            for (i = 0; i < 5; i++)
                this.hearts.push(this.container_hearts.getChildByName("heart" + i));
            this.bang = this.container_hearts.getChildByName("bang"),
            this.bang_imgs = [];
            for (var i = 0; i < 5; i++)
                this.bang_imgs.push(this.bang.getChildAt(i));
            this.btn_close = this.root.getChildByName("btn_close"),
            this.btn_close.clickHandler = Laya.Handler.create(this, function() {
                e.locking || e.close()
            }, null, !1),
            this.block_chat = new t.UI_Character_Chat(this.me.getChildByName("chat")),
            this.container_effect = this.me.getChildByName("container_effect")
        }
        ,
        i.prototype.show = function(t, e) {
            var i = this;
            this.locking = !0,
            Laya.timer.once(2e3, this, function() {
                i.locking = !1
            }),
            this.reset(),
            this.enable = !0,
            this.chara_info = t,
            this.back_func = e;
            var n = cfg.item_definition.skin.get(this.chara_info.skin);
            this.avatar1.me.visible = !1,
            n && this.avatar0.setSkin(this.chara_info.skin, "full");
            for (var a = 0; a < this.hearts.length; a++)
                if (a >= 5)
                    this.hearts[a].visible = !1,
                    this.bang_imgs[a].visible = !1;
                else {
                    this.hearts[a].visible = !0,
                    this.hearts[a].x = 314 + 107 * a - 214,
                    this.bang_imgs[a].visible = !0;
                    var r = this.hearts[a].getChildByName("v").mask;
                    a < this.chara_info.level ? r.scaleY = 1 : r.scaleY = 0,
                    t.is_upgraded ? this.hearts[a].getChildByName("v").getChildByName("full").skin = game.Tools.localUISrc("myres/bothui/heart_gold.png") : this.hearts[a].getChildByName("v").getChildByName("full").skin = game.Tools.localUISrc("myres/bothui/bf_heart.png")
                }
            if (this.bang.visible = !1,
            this.img_word.visible = !0,
            this.container_hearts.visible = !0,
            this.me.in.play(0, !1),
            this.block_chat.me.visible = !1,
            this.btn_bigclose.visible = !1,
            view.AudioMgr.refresh_music_volume(!0),
            Laya.loader.create(this.effect_path),
            this.chara_info.is_upgraded) {
                var s = cfg.item_definition.character.get(this.chara_info.charid).full_fetter_skin;
                game.LoadMgr.loadResImage([cfg.item_definition.skin.get(s).path + "/full.png"])
            }
            Laya.timer.once(1400, this, function() {
                i.bang.visible = !0,
                i.me.bang.play(0, !1),
                Laya.timer.once(1550, i, function() {
                    i.bang.visible = !1,
                    i.chara_info.is_upgraded ? i.change_full_fetter_skin() : i.when_over()
                }),
                i.chara_info.is_upgraded || Laya.timer.once(500, i, function() {
                    var t = Laya.loader.getRes(i.effect_path);
                    t && (i.container_effect.addChild(t),
                    t.visible = !0),
                    view.AudioMgr.PlayAudio(113)
                })
            })
        }
        ,
        i.prototype.reset = function() {
            this.bg.skin = "",
            this.img_word.skin = "",
            this.bg.skin = game.Tools.localUISrc("myres/star_up/bg.jpg"),
            this.img_word.skin = game.Tools.localUISrc("myres/star_up/levelup.png");
            for (var t = 0; t < this.bang_imgs.length; t++)
                this.bang_imgs[t].skin = "",
                this.bang_imgs[t].skin = game.Tools.localUISrc("myres/star_up/bang_heart.png")
        }
        ,
        i.prototype.change_full_fetter_skin = function() {
            var t = this;
            if (this.enable) {
                var e = cfg.item_definition.character.get(this.chara_info.charid);
                if (e) {
                    cfg.item_definition.skin.get(e.full_fetter_skin) && (this.avatar1.setSkin(this.chara_info.skin, "full"),
                    this.avatar1.me.visible = !0,
                    this.avatar1.me.filters = [new Laya.ColorFilter([0, 0, 0, 0, 255, 0, 0, 0, 0, 255, 0, 0, 0, 0, 255, 0, 0, 0, 1, 0])],
                    this.avatar1.me.alpha = 0,
                    Laya.Tween.to(this.avatar1.me, {
                        alpha: 1
                    }, 1e3, null, Laya.Handler.create(this, function() {
                        t.enable && (Laya.timer.once(1e3, t, function() {
                            t.avatar0.setSkin(e.full_fetter_skin, "full"),
                            t.avatar1.me.visible = !1,
                            Laya.timer.once(500, t, function() {
                                t.when_over()
                            })
                        }),
                        Laya.timer.once(1e3, t, function() {
                            var e = Laya.loader.getRes(t.effect_path);
                            e && (t.container_effect.addChild(e),
                            e.visible = !0),
                            view.AudioMgr.PlayAudio(113)
                        }))
                    })))
                }
            }
        }
        ,
        i.prototype.when_over = function() {
            var t = this
              , e = "";
            if (!this.chara_info.is_upgraded)
                switch (this.chara_info.level) {
                case 1:
                    e = "";
                    break;
                case 2:
                    e = "lobby_levelup1";
                    break;
                case 3:
                    e = "lobby_levelup2";
                    break;
                case 4:
                    e = "lobby_levelup3";
                    break;
                case 5:
                    e = "lobby_levelmax"
                }
            var i = cfg.item_definition.character.get(this.chara_info.charid)
              , n = cfg.voice.sound.getGroup(i.sound)
              , a = 0;
            if ("" != e) {
                for (var r = "", s = "", o = 0; o < n.length; o++)
                    if (n[o].type == e) {
                        r = n[o]["words_" + GameMgr.client_language],
                        s = n[o].path,
                        a = n[o].time_length;
                        break
                    }
                this.block_chat.show(r),
                this.sound_channel = view.AudioMgr.PlaySound(s, i.sound_volume),
                this.img_word.visible = !1,
                this.container_hearts.visible = !1
            }
            Laya.timer.once(a + 2e3, this, function() {
                t.btn_bigclose.visible = !0
            })
        }
        ,
        i.prototype.onDisable = function() {
            view.AudioMgr.refresh_music_volume(!1);
            for (e = 0; e < this.ress.length; e++)
                Laya.loader.clearTextureRes(this.ress[e]);
            if (this.avatar0.clear(),
            this.avatar1.clear(),
            this.chara_info.is_upgraded)
                for (var e = 0; e < t.UI_Sushe.characters.length; e++)
                    if (t.UI_Sushe.characters[e].charid == this.chara_info.charid) {
                        t.UI_Sushe.characters[e].level = 5,
                        t.UI_Sushe.characters[e].exp = 0,
                        t.UI_Sushe.characters[e].skin = cfg.item_definition.character.get(this.chara_info.charid).full_fetter_skin,
                        t.UI_Sushe.main_character_id == this.chara_info.charid && (GameMgr.Inst.account_data.avatar_id = t.UI_Sushe.characters[e].skin);
                        break
                    }
            this.chara_info = null,
            Laya.timer.clearAll(this),
            this.sound_channel && (this.sound_channel.stop(),
            Laya.SoundManager.removeChannel(this.sound_channel),
            this.sound_channel = null);
            var i = Laya.loader.getRes(this.effect_path);
            i && i.destroy(!0)
        }
        ,
        i.prototype.close = function() {
            this.locking = !0,
            this.enable = !1,
            this.back_func && this.back_func.run()
        }
        ,
        i.Inst = null,
        i
    }(t.UIBase);
    t.UI_Character_star_up = e
}(uiscript || (uiscript = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), uiscript;
!function(t) {
    var e = function(e) {
        function i() {
            var t = e.call(this, new ui.lobby.checkhuiyuUI) || this;
            return i.Inst = t,
            t
        }
        return __extends(i, e),
        i.prototype.onCreate = function() {
            var e = this;
            this.root = this.me.getChildByName("root"),
            this.btn_close = this.root.getChildByName("btn_close"),
            this.btn_chongzhi = this.root.getChildByName("btn_buy"),
            this.btn_confirm = this.root.getChildByName("btn_confirm"),
            this.notice1 = this.root.getChildByName("notice1"),
            this.notice2 = this.root.getChildByName("notice2"),
            this.notice3 = this.root.getChildByName("notice3"),
            this.btn_close.clickHandler = Laya.Handler.create(this, function() {
                e.locking = !0,
                t.UIBase.anim_pop_hide(e.root, Laya.Handler.create(e, function() {
                    e.locking = !1,
                    e.enable = !1
                }))
            }, null, !1),
            this.btn_confirm.clickHandler = Laya.Handler.create(this, function() {
                e.locking = !0,
                t.UIBase.anim_pop_hide(e.root, Laya.Handler.create(e, function() {
                    e.locking = !1,
                    e.enable = !1
                }))
            }, null, !1),
            this.btn_chongzhi.clickHandler = Laya.Handler.create(this, function() {
                e.func_locking && e.func_locking.run() || (t.UI_PiPeiYuYue.Inst.enable ? t.UI_Popout.PopOutNoTitle(game.Tools.strOfLocalization(204), null) : (e.func_close ? e.func_close.runWith(Laya.Handler.create(e, function() {
                    t.UI_Recharge.Inst.show("huiyu")
                }, null, !1)) : (e.locking = !0,
                t.UIBase.anim_pop_hide(e.root, Laya.Handler.create(e, function() {
                    e.locking = !1,
                    e.enable = !1
                }))),
                e.enable = !1))
            }, null, !1)
        }
        ,
        i.prototype.show = function(e, i, n) {
            var a = this;
            this.locking = !0,
            this.func_close = i,
            this.func_locking = n,
            this.enable = !0,
            this.root.visible = !0,
            t.UIBase.anim_pop_out(this.root, Laya.Handler.create(this, function() {
                a.locking = !1
            }));
            var r = GameMgr.Inst.account_data.diamond
              , s = 0;
            GameMgr.inGooglePlay && GameMgr.Inst.account_numerical_resource[101001] && (s += GameMgr.Inst.account_numerical_resource[101001]),
            GameMgr.inChina && GameMgr.Inst.account_numerical_resource[101002] && (s += GameMgr.Inst.account_numerical_resource[101002]),
            this.notice2.text = r.toString(),
            this.notice1.text = s.toString(),
            this.notice3.text = (s + r).toString()
        }
        ,
        i.Inst = null,
        i.first = !0,
        i
    }(t.UIBase);
    t.UI_checkhuiyu = e
}(uiscript || (uiscript = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), uiscript;
!function(t) {
    var e = function(t) {
        function e() {
            var e = t.call(this, new ui.mj.chipenghuUI) || this;
            return e.container_Detail = null,
            e.btn_cancel = null,
            e.btn_detail_back = null,
            e.label_title = null,
            e.op_btns = new Object,
            e
        }
        return __extends(e, t),
        e.prototype.onCreate = function() {
            var t = this.me.getChildByName("container_btns");
            this.container_btns = t;
            for (i = 0; i < this.container_btns.numChildren; i++) {
                var e = this.container_btns.getChildAt(i);
                this.op_btns[e.name] = e,
                e.visible = !1,
                e.clickHandler = new Laya.Handler(this,this.onClickOpBtn,[e.name])
            }
            this.container_Detail = this.me.getChildByName("container_detail"),
            this.container_Detail.visible = !1;
            for (var i = 0; i < 6; i++) {
                var n = this.container_Detail.getChildByName("container_chooses").getChildByName("c" + i);
                n.visible = !1,
                n.clickHandler = laya.utils.Handler.create(this, this.onClickDetail, [i], !1)
            }
            this.btn_detail_back = this.container_Detail.getChildByName("btn_back"),
            this.btn_detail_back.clickHandler = new Laya.Handler(this,this.onDetailBack,null,!1),
            this.btn_cancel = this.me.getChildByName("btn_cancel"),
            this.btn_cancel.visible = !1,
            this.label_title = this.container_Detail.getChildByName("container_title").getChildByName("lab_title"),
            this.label_title.text = ""
        }
        ,
        e.prototype.show = function(t) {}
        ,
        e.prototype.onClickOpBtn = function(t) {}
        ,
        e.prototype.onClickDetail = function(t) {}
        ,
        e.prototype.onDetailBack = function() {}
        ,
        e.prototype.showOp = function(t) {
            this.container_Detail.visible = !1,
            this.container_btns.visible = !0,
            this.btn_cancel.visible = !1;
            for (var e = this.container_btns.width, i = 0, n = 0, a = this.container_btns.numChildren - 1; a >= 0; a--) {
                for (var r = !1, s = this.container_btns.getChildAt(a), o = 0; o < t.length; o++)
                    if (t[o] == s.name) {
                        r = !0;
                        break
                    }
                r ? (s.visible = !0,
                s.x = e - s.width,
                s.y = i,
                e -= s.width + 0,
                3 == ++n && (i -= 180,
                e = this.container_btns.width,
                n = 0)) : s.visible = !1
            }
            Laya.Tween.from(this.container_btns, {
                x: 940,
                alpha: 0
            }, 160)
        }
        ,
        e.prototype.showDetail = function(t, e) {
            this.container_btns.visible = !1,
            this.btn_cancel.visible = !1;
            var i = this.container_Detail.getChildByName("container_title")
              , n = (i.getChildByName("lab_title"),
            this.container_Detail.getChildByName("container_chooses"))
              , a = 0
              , r = n.getChildByName("c0").getChildByName("img0").width
              , s = .5 * r;
            this.label_title.text = t;
            for (var o = "myres2/mjp/" + GameMgr.Inst.mjp_view + "/ui/", l = 0; l < 6; l++) {
                var h = n.getChildByName("c" + l);
                if (l < e.length) {
                    for (var c = e[l].split("|"), u = 0; u < 4; u++) {
                        var _ = h.getChildByName("img" + u);
                        u < c.length ? (_.skin = game.Tools.localUISrc(o + c[u] + ".png"),
                        _.x = u * r,
                        _.y = 0,
                        _.visible = !0) : _.visible = !1
                    }
                    h.width = c.length * r,
                    0 != l && (a += s),
                    h.x = a,
                    a += h.width,
                    h.y = -23,
                    h.visible = !0
                } else
                    h.visible = !1
            }
            n.width = a,
            this.container_Detail.width = a + 240,
            i.x = .5 * this.container_Detail.width,
            n.x = 120,
            this.btn_detail_back.x = this.container_Detail.width - 56,
            this.container_Detail.visible = !0,
            this.container_Detail.x = 960 - this.container_Detail.width / 2
        }
        ,
        e
    }(t.UIBase);
    t.UI_PlayerOperation = e
}(uiscript || (uiscript = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), uiscript;
!function(t) {
    var e = function(e) {
        function i() {
            var t = e.call(this) || this;
            return t._data = new Object,
            t.choosed_op = mjcore.E_PlayOperation.eat,
            t._oplist = [],
            i.Inst = t,
            t
        }
        return __extends(i, e),
        i.prototype.show = function(t) {
            for (var e = [], i = 0; i < t.length; i++)
                switch (t[i].type) {
                case mjcore.E_PlayOperation.eat:
                    e.push("btn_chi"),
                    this._data.chi = t[i].combination;
                    break;
                case mjcore.E_PlayOperation.peng:
                    e.push("btn_peng"),
                    this._data.peng = t[i].combination;
                    break;
                case mjcore.E_PlayOperation.ming_gang:
                    e.push("btn_gang");
                    break;
                case mjcore.E_PlayOperation.rong:
                    e.push("btn_hu")
                }
            e.push("btn_cancel"),
            this._oplist = e,
            this.showOp(e),
            this.enable = !0,
            view.DesktopMgr.Inst.ShowChiPengEffect(),
            view.AudioMgr.PlayAudio(202)
        }
        ,
        i.prototype.onClickOpBtn = function(t) {
            if (view.DesktopMgr.Inst.mode == view.EMJMode.play)
                switch (view.AudioMgr.PlayAudio(101),
                t) {
                case "btn_chi":
                    this.onBtn_Chi();
                    break;
                case "btn_peng":
                    this.onBtn_Peng();
                    break;
                case "btn_gang":
                    this.onBtn_Gang();
                    break;
                case "btn_hu":
                    this.onBtn_Hu();
                    break;
                case "btn_cancel":
                    this.onBtn_Cancel()
                }
        }
        ,
        i.prototype.onClickDetail = function(t) {
            view.DesktopMgr.Inst.mode == view.EMJMode.play && (view.AudioMgr.PlayAudio(101),
            app.NetAgent.sendReq2MJ("FastTest", "inputChiPengGang", {
                type: this.choosed_op,
                index: t
            }, function(t, e) {}),
            view.DesktopMgr.Inst.WhenDoOperation())
        }
        ,
        i.prototype.onDetailBack = function() {
            this.showOp(this._oplist),
            view.AudioMgr.PlayAudio(101)
        }
        ,
        i.prototype.onBtn_Chi = function() {
            this._data.chi.length > 1 ? (this.choosed_op = mjcore.E_PlayOperation.eat,
            this.showDetail(game.Tools.strOfLocalization(2038), this._data.chi)) : (app.NetAgent.sendReq2MJ("FastTest", "inputChiPengGang", {
                type: mjcore.E_PlayOperation.eat,
                index: 0,
                timeuse: t.UI_DesktopInfo.Inst._timecd.timeuse
            }, function(t, e) {}),
            view.DesktopMgr.Inst.WhenDoOperation())
        }
        ,
        i.prototype.onBtn_Peng = function() {
            this._data.peng.length > 1 ? (this.choosed_op = mjcore.E_PlayOperation.peng,
            this.showDetail(game.Tools.strOfLocalization(2039), this._data.peng)) : (app.NetAgent.sendReq2MJ("FastTest", "inputChiPengGang", {
                type: mjcore.E_PlayOperation.peng,
                index: 0,
                timeuse: t.UI_DesktopInfo.Inst._timecd.timeuse
            }, function(t, e) {}),
            view.DesktopMgr.Inst.WhenDoOperation())
        }
        ,
        i.prototype.onBtn_Gang = function() {
            app.NetAgent.sendReq2MJ("FastTest", "inputChiPengGang", {
                type: mjcore.E_PlayOperation.ming_gang,
                index: 0,
                timeuse: t.UI_DesktopInfo.Inst._timecd.timeuse
            }, function(t, e) {}),
            view.DesktopMgr.Inst.WhenDoOperation()
        }
        ,
        i.prototype.onBtn_Hu = function() {
            app.NetAgent.sendReq2MJ("FastTest", "inputChiPengGang", {
                type: mjcore.E_PlayOperation.rong,
                index: 0,
                timeuse: t.UI_DesktopInfo.Inst._timecd.timeuse
            }, function(t, e) {}),
            view.DesktopMgr.Inst.WhenDoOperation()
        }
        ,
        i.prototype.onBtn_Cancel = function() {
            app.NetAgent.sendReq2MJ("FastTest", "inputChiPengGang", {
                cancel_operation: !0,
                timeuse: t.UI_DesktopInfo.Inst._timecd.timeuse
            }, function(t, e) {}),
            view.DesktopMgr.Inst.WhenDoOperation()
        }
        ,
        i.prototype.onDisable = function() {
            view.DesktopMgr.Inst.CloseChiPngEffect(),
            Laya.timer.clearAll(this)
        }
        ,
        i.prototype.onDoubleClick = function() {
            this.onBtn_Cancel()
        }
        ,
        i.Inst = null,
        i
    }(t.UI_PlayerOperation);
    t.UI_ChiPengHu = e
}(uiscript || (uiscript = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), uiscript;
!function(t) {
    var e = function(e) {
        function i() {
            return e.call(this, new ui.entrance.choose_languageUI) || this
        }
        return __extends(i, e),
        i.show = function(e) {
            if (!this._inited) {
                this._complete = e,
                this._inited = !0;
                var n = new i;
                t.UIMgr.Inst.AddLobbyUI(n),
                Laya.timer.frameOnce(5, this, function() {
                    n._show()
                })
            }
        }
        ,
        i.prototype.onCreate = function() {
            var t = this;
            this.root = this.me.getChildByName("root"),
            this.scorllview = this.root.getChildByName("lst").scriptMap["capsui.CScrollView"],
            this.lst = [],
            this.lst.push({
                name: "简体中文",
                language: "chs"
            }),
            this.lst.push({
                name: "繁体中文",
                language: "chs_t"
            }),
            this.lst.push({
                name: "日文",
                language: "jp"
            }),
            this.lst.push({
                name: "英文",
                language: "en"
            }),
            this.scorllview.init_scrollview(Laya.Handler.create(this, function(e) {
                var i = e.index
                  , n = e.container;
                n.label = t.lst[i].name,
                n.clickHandler = Laya.Handler.create(t, function() {
                    if (Laya.LocalStorage.setItem("lang", t.lst[i].language),
                    t.enable = !1,
                    t.me.destroy(!0),
                    Laya.Browser.window.conch) {
                        Laya.PlatformClass.createClass("layaair.majsoul.mjmgr").call("restart")
                    } else
                        Laya.Browser.window.location.href = GameMgr.Inst.link_url
                }, null, !1)
            }, null, !1)),
            this.me.getChildByName("jump").clickHandler = Laya.Handler.create(this, function() {
                t.enable = !1,
                t.me.destroy(!0),
                i._complete && i._complete.run()
            }, null, !1)
        }
        ,
        i.prototype._show = function() {
            this.enable = !0,
            this.scorllview.reset(),
            this.scorllview.addItem(this.lst.length);
            var t = "当前语言：";
            switch (GameMgr.client_language) {
            case "chs":
                t += "简体中文";
                break;
            case "chs_t":
                t += "繁体中文";
                break;
            case "jp":
                t += "日文";
                break;
            case "en":
                t += "英文";
                break;
            default:
                t += "未知"
            }
            this.me.getChildByName("now").text = t
        }
        ,
        i._ips = [],
        i._inited = !1,
        i._complete = null,
        i
    }(t.UIBase);
    t.UI_ChooseLanguage = e
}(uiscript || (uiscript = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), uiscript;
!function(t) {
    var e = function(e) {
        function i() {
            return e.call(this, new ui.entrance.chooseserverUI) || this
        }
        return __extends(i, e),
        i.show = function(e) {
            if (!this._inited)
                if (this._complete = e,
                this._inited = !0,
                this._ips = GameMgr.config_data.ip,
                1 == this._ips.length)
                    this._linkLobby(0);
                else {
                    var n = new i;
                    t.UIMgr.Inst.AddLobbyUI(n),
                    Laya.timer.frameOnce(5, this, function() {
                        n._show()
                    })
                }
        }
        ,
        i._linkLobby = function(t) {
            var e = this._ips[t];
            game.LobbyNetMgr.gateway_name = e.name,
            game.LobbyNetMgr.gateway_regions = e.region_urls,
            game.LobbyNetMgr.Inst.OpenConnect("", null),
            this._complete.run()
        }
        ,
        i._linkLobbyStr = function(t) {
            game.LobbyNetMgr.gateway_name = "自选：" + t,
            game.LobbyNetMgr.gateway_regions = {
                mainland: "http://" + t + "/api/v0/recommend_list"
            },
            game.LocalStorage.setItem("test_server_url", t),
            game.LobbyNetMgr.Inst.OpenConnect("", null),
            this._complete.run()
        }
        ,
        i.do_guanzhan = function() {
            var t = 0
              , e = []
              , i = function(t) {
                var e = net.MessageWrapper.decodeMessage(t.action_data);
                return {
                    timestamp: t.timestamp,
                    category: t.action_category,
                    name: e.$type.name,
                    data: e
                }
            }
              , n = function() {
                if (t > 30)
                    console.log(JSON.stringify(e));
                else {
                    var a = new Laya.HttpRequest;
                    a.once(Laya.Event.COMPLETE, this, function(a) {
                        e.push({
                            index: t,
                            split: "==================================================="
                        });
                        var r = new Laya.Byte;
                        r.writeArrayBuffer(a);
                        for (var s = net.MessageWrapper.decodeMessage(r.getUint8Array(0, r.length)), o = 0; o < s.actions.length; o++)
                            e.push(i(s.actions[o]));
                        t++,
                        n()
                    }),
                    a.once(Laya.Event.ERROR, this, function(t) {});
                    a.send("guanzhan/" + t, "", "get", "arraybuffer", [])
                }
            };
            n()
        }
        ,
        i.prototype.onCreate = function() {
            var t = this;
            this.root = this.me.getChildByName("root"),
            this.scorllview = this.root.getChildByName("lst").scriptMap["capsui.CScrollView"],
            this.scorllview.init_scrollview(Laya.Handler.create(this, function(e) {
                var n = e.index
                  , a = e.container;
                a.label = i._ips[n].name,
                a.clickHandler = Laya.Handler.create(t, function() {
                    i._linkLobby(n),
                    t.enable = !1,
                    t.me.destroy(!0)
                }, null, !1)
            }, null, !1)),
            this.input = this.root.getChildByName("input"),
            this.root.getChildByName("enter").clickHandler = new Laya.Handler(this,function() {
                i._linkLobbyStr(t.input.text),
                t.enable = !1,
                t.me.destroy(!0)
            }
            )
        }
        ,
        i.prototype._show = function() {
            this.enable = !0,
            this.scorllview.reset(),
            this.scorllview.addItem(i._ips.length);
            var t = game.LocalStorage.getItem("test_server_url");
            t && (this.input.text = t)
        }
        ,
        i._ips = [],
        i._inited = !1,
        i._complete = null,
        i
    }(t.UIBase);
    t.UI_ChooseServer = e
}(uiscript || (uiscript = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), uiscript;
!function(t) {
    var e = function(e) {
        function i() {
            var t = e.call(this, new ui.common.closeappUI) || this;
            return t.locking = !1,
            i.Inst = t,
            t
        }
        return __extends(i, e),
        i.prototype.onCreate = function() {
            var e = this;
            this.root = this.me.getChildByName("root"),
            this.root.getChildByName("btn_confirm").clickHandler = Laya.Handler.create(this, function() {
                e.locking || (e.close(),
                Laya.Browser.window.conch && Laya.Browser.window.conch.exit && Laya.Browser.window.conch.exit())
            }, null, !1),
            this.root.getChildByName("btn_cancel").clickHandler = Laya.Handler.create(this, function() {
                e.locking || e.close()
            }, null, !1),
            this.root.getChildByName("btn_cancel").filters = [new Laya.ColorFilter([.3086, .6094, .082, 0, 0, .3086, .6094, .082, 0, 0, .3086, .6094, .082, 0, 0, 0, 0, 0, 1, 0])],
            this.desc = this.root.getChildByName("desc"),
            this.desc.text = game.Tools.strOfLocalization(22),
            this.locking = !1,
            GameMgr.inConch && Laya.Browser.window.conch.setOnBackPressedFunction && Laya.Browser.window.conch.setOnBackPressedFunction(function() {
                e.locking || t.UI_CloseApp.Inst.show()
            })
        }
        ,
        i.prototype.show = function() {
            var e = this;
            this.locking = !0,
            this.enable = !0,
            t.UIBase.anim_pop_out(this.root, Laya.Handler.create(this, function() {
                e.locking = !1
            }))
        }
        ,
        i.prototype.close = function() {
            var e = this;
            this.locking = !0,
            t.UIBase.anim_pop_hide(this.root, Laya.Handler.create(this, function() {
                e.locking = !1,
                e.enable = !1
            }))
        }
        ,
        i.Inst = null,
        i
    }(t.UIBase);
    t.UI_CloseApp = e
}(uiscript || (uiscript = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), uiscript;
!function(t) {
    var e = function(t) {
        function e() {
            var i = t.call(this, new ui.common.commonUI) || this;
            return i.label_net_lobby = null,
            i.label_net_mj = null,
            i.label_fps = null,
            i._fps_count = 0,
            i._last_time = 0,
            e.Inst = i,
            i
        }
        return __extends(e, t),
        e.prototype.onCreate = function() {
            var t = this.me.getChildByName("container_net");
            this.label_net_lobby = t.getChildByName("lobby"),
            this.label_net_mj = t.getChildByName("mj"),
            this.label_fps = t.getChildByName("fps"),
            this.label_net_lobby.text = "",
            this.label_net_mj.text = "",
            this.label_fps.text = ""
        }
        ,
        e.prototype.onEnable = function() {
            this._fps_count = 0,
            this._last_time = Laya.timer.currTimer,
            game.LobbyNetMgr.Inst.refreshCommonShow()
        }
        ,
        e.prototype.update = function() {
            this._fps_count++;
            var t = Laya.timer.currTimer - this._last_time;
            t >= 500 && (this.label_fps.text = "fps:" + Math.floor(this._fps_count / t * 1e3),
            this._fps_count = 0,
            this._last_time = Laya.timer.currTimer)
        }
        ,
        e.Inst = null,
        e
    }(t.UIBase);
    t.UI_Common = e
}(uiscript || (uiscript = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), uiscript;
!function(t) {
    var e = function() {
        function t(t) {
            var e = this;
            this._during_drag = !1,
            this.me = t,
            this.bar = this.me.getChildByName("val"),
            this.point = this.me.getChildByName("point"),
            this.me.on("mousedown", this, function() {
                e._during_drag = !0,
                e.rate = e.me.mouseX / e.me.width
            }),
            this.me.on("mousemove", this, function() {
                e._during_drag && (e.rate = e.me.mouseX / e.me.width)
            }),
            this.me.on("mouseout", this, function() {
                e._during_drag = !1
            }),
            this.me.on("mouseup", this, function() {
                e._during_drag = !1
            })
        }
        return Object.defineProperty(t.prototype, "rate", {
            get: function() {
                return this._rate
            },
            set: function(t) {
                this._rate = t,
                this._rate < 0 ? this._rate = 0 : this._rate > 1 && (this._rate = 1),
                this.me.event("change"),
                this.bar.width = this._rate * this.me.width,
                this.point.x = this._rate * this.me.width
            },
            enumerable: !0,
            configurable: !0
        }),
        t.prototype.initset = function(t) {
            this._rate = t,
            this._rate < 0 ? this._rate = 0 : this._rate > 1 && (this._rate = 1),
            this.bar.width = this._rate * this.me.width,
            this.point.x = this._rate * this.me.width
        }
        ,
        t
    }()
      , i = (function() {}(),
    function() {}(),
    function() {}(),
    function(i) {
        function n() {
            var t = i.call(this, new ui.both_ui.configUI) || this;
            return t.music_controll = null,
            t.audio_controll = null,
            t.lizhi_controll = null,
            t.fps_controll = null,
            t.fpslow_controll = null,
            t.click1_controll = null,
            t.click2_controll = null,
            t.click3_controll = null,
            t.comment_0_controll = null,
            t.comment_1_controll = null,
            t.comment_2_controll = null,
            t.CVvoice_01 = null,
            t.CVvoice = [],
            t.locking = !1,
            t.btn_restart = null,
            t.btn_save = null,
            t._scrollbar = null,
            t._scrollpoint = null,
            t._drag_scroll = !1,
            t.label_download_server = null,
            t.label_game_server = null,
            t.bottoncrew = null,
            t.common = null,
            t.perfer = null,
            t.cvoice = null,
            t.other = null,
            t.CV_Cells = [],
            n.Inst = t,
            t
        }
        return __extends(n, i),
        n.prototype.onCreate = function() {
            var i = this;
            this.root = this.me.getChildByName("root"),
            this.concenter = this.root.getChildByName("Panel").getChildByName("ConCenter"),
            this.perfercenter = this.root.getChildByName("Panel").getChildByName("PreCenter"),
            this.cvcenter = this.root.getChildByName("Panel").getChildByName("CVCenter"),
            this.othercenter = this.root.getChildByName("Panel").getChildByName("OtherCenter"),
            this.panel = this.root.getChildByName("Panel"),
            this.panel.vScrollBar.visible = !1,
            this._scrollbar = this.root.getChildByName("scrollbar"),
            this._scrollpoint = this._scrollbar.getChildByName("scrollpoint"),
            this.panel.vScrollBar.max = .4 * this._scrollbar.height,
            this.CVboxParent = this.panel.getChildByName("CVCenter").getChildByName("CharacterVoice"),
            this.CVbox_templete = this.panel.getChildByName("CVCenter").getChildByName("CharacterVoice").getChildByName("templete"),
            this._scrollbar && (this._scrollbar.on("mousedown", this, function() {
                i._drag_scroll = !0,
                i.panel.vScrollBar.stopScroll(),
                i.panel.vScrollBar.value = i._scrollbar.mouseY / i._scrollbar.height * i.panel.vScrollBar.max
            }),
            this._scrollbar.on("mousemove", this, function() {
                i._drag_scroll && (i.panel.vScrollBar.stopScroll(),
                i.panel.vScrollBar.value = i._scrollbar.mouseY / i._scrollbar.height * i.panel.vScrollBar.max)
            }),
            this._scrollbar.on("mouseup", this, function() {
                i._drag_scroll = !1
            }),
            this._scrollbar.on("mouseout", this, function() {
                i._drag_scroll = !1
            }),
            this.panel.vScrollBar.on("change", this, function() {
                i._scrollpoint.y = i._scrollbar.height * i.panel.vScrollBar.value / i.panel.vScrollBar.max
            })),
            this.root.getChildByName("btn_close").clickHandler = Laya.Handler.create(this, function() {
                i.locking || i.hide()
            }, null, !1),
            this.root.getChildByName("btn_logout").clickHandler = Laya.Handler.create(this, function() {
                t.UI_SecondConfirm.Inst.show(game.Tools.strOfLocalization(2718), Laya.Handler.create(i, function() {
                    if (app.NetAgent.sendReq2Lobby("Lobby", "logout", {}, function() {}),
                    Laya.LocalStorage.setItem("_pre_sociotype", ""),
                    Laya.Browser.window.conch) {
                        Laya.PlatformClass.createClass("layaair.majsoul.mjmgr").call("restart")
                    } else
                        Laya.Browser.window.location.href = GameMgr.Inst.link_url
                })),
                i.hide()
            }, null, !1),
            this.bottoncrew = this.root.getChildByName("ButtonCrew"),
            this.common = this.root.getChildByName("ButtonCrew").getChildByName("btn0"),
            this.perfer = this.root.getChildByName("ButtonCrew").getChildByName("btn1"),
            this.cvoice = this.root.getChildByName("ButtonCrew").getChildByName("btn2"),
            this.other = this.root.getChildByName("ButtonCrew").getChildByName("btn3");
            this.bottoncrew.getChildAt(0),
            this.bottoncrew.getChildAt(1),
            this.bottoncrew.getChildAt(2),
            this.bottoncrew.getChildAt(3);
            this.common.clickHandler = Laya.Handler.create(this, function() {
                i.locking || (i.concenter.visible = !0,
                i.perfercenter.visible = !1,
                i.cvcenter.visible = !1,
                i.othercenter.visible = !1,
                i._scrollpoint.y = 0,
                i.refreshBtnCrew(0),
                i.panel.vScrollBar.value = 0)
            }, null, !1),
            this.perfer.clickHandler = Laya.Handler.create(this, function() {
                i.locking || (i.concenter.visible = !1,
                i.perfercenter.visible = !0,
                i.cvcenter.visible = !1,
                i.othercenter.visible = !1,
                i._scrollpoint.y = 0,
                i.refreshBtnCrew(1),
                i.panel.vScrollBar.value = 0)
            }, null, !1),
            this.cvoice.clickHandler = Laya.Handler.create(this, function() {
                i.locking || (i.concenter.visible = !1,
                i.perfercenter.visible = !1,
                i.cvcenter.visible = !0,
                i.othercenter.visible = !1,
                i._scrollpoint.y = 0,
                i.refreshBtnCrew(2),
                i.panel.vScrollBar.value = 0)
            }, null, !1),
            this.other.clickHandler = Laya.Handler.create(this, function() {
                i.locking || (i.concenter.visible = !1,
                i.perfercenter.visible = !1,
                i.cvcenter.visible = !1,
                i.othercenter.visible = !0,
                i._scrollpoint.y = 0,
                i.refreshBtnCrew(3),
                i.panel.vScrollBar.value = 0)
            }, null, !1),
            this.music_controll = {
                slider: new e(this.panel.getChildByName("ConCenter").getChildByName("audio").getChildByName("music").getChildByName("slider")),
                btn_mute: this.panel.getChildByName("ConCenter").getChildByName("audio").getChildByName("music").getChildByName("checkbox").getChildByName("btn"),
                check: this.panel.getChildByName("ConCenter").getChildByName("audio").getChildByName("music").getChildByName("checkbox").getChildByName("checkbox")
            },
            this.audio_controll = {
                slider: new e(this.panel.getChildByName("ConCenter").getChildByName("audio").getChildByName("audio").getChildByName("slider")),
                btn_mute: this.panel.getChildByName("ConCenter").getChildByName("audio").getChildByName("audio").getChildByName("checkbox").getChildByName("btn"),
                check: this.panel.getChildByName("ConCenter").getChildByName("audio").getChildByName("audio").getChildByName("checkbox").getChildByName("checkbox")
            },
            this.lizhi_controll = {
                slider: new e(this.panel.getChildByName("ConCenter").getChildByName("audio").getChildByName("lizhi").getChildByName("slider")),
                btn_mute: this.panel.getChildByName("ConCenter").getChildByName("audio").getChildByName("lizhi").getChildByName("checkbox").getChildByName("btn"),
                check: this.panel.getChildByName("ConCenter").getChildByName("audio").getChildByName("lizhi").getChildByName("checkbox").getChildByName("checkbox")
            },
            this.fps_controll = {
                btn: this.panel.getChildByName("ConCenter").getChildByName("other").getChildByName("fps").getChildByName("checkbox").getChildByName("btn"),
                check: this.panel.getChildByName("ConCenter").getChildByName("other").getChildByName("fps").getChildByName("checkbox").getChildByName("checkbox"),
                label: this.panel.getChildByName("ConCenter").getChildByName("other").getChildByName("fps").getChildByName("checkbox").getChildByName("label")
            },
            this.fpslow_controll = {
                btn: this.panel.getChildByName("ConCenter").getChildByName("other").getChildByName("fpslow").getChildByName("checkbox").getChildByName("btn"),
                check: this.panel.getChildByName("ConCenter").getChildByName("other").getChildByName("fpslow").getChildByName("checkbox").getChildByName("checkbox"),
                label: this.panel.getChildByName("ConCenter").getChildByName("other").getChildByName("fpslow").getChildByName("checkbox").getChildByName("label")
            },
            this.click1_controll = {
                btn: this.panel.getChildByName("PreCenter").getChildByName("Confrontation").getChildByName("click1").getChildByName("checkbox").getChildByName("btn"),
                check: this.panel.getChildByName("PreCenter").getChildByName("Confrontation").getChildByName("click1").getChildByName("checkbox").getChildByName("checkbox"),
                label: this.panel.getChildByName("PreCenter").getChildByName("Confrontation").getChildByName("click1").getChildByName("checkbox").getChildByName("label")
            },
            this.click2_controll = {
                btn: this.panel.getChildByName("PreCenter").getChildByName("Confrontation").getChildByName("click2").getChildByName("checkbox").getChildByName("btn"),
                check: this.panel.getChildByName("PreCenter").getChildByName("Confrontation").getChildByName("click2").getChildByName("checkbox").getChildByName("checkbox"),
                label: this.panel.getChildByName("PreCenter").getChildByName("Confrontation").getChildByName("click2").getChildByName("checkbox").getChildByName("label")
            },
            this.click3_controll = {
                btn: this.panel.getChildByName("PreCenter").getChildByName("Confrontation").getChildByName("click3").getChildByName("checkbox").getChildByName("btn"),
                check: this.panel.getChildByName("PreCenter").getChildByName("Confrontation").getChildByName("click3").getChildByName("checkbox").getChildByName("checkbox"),
                label: this.panel.getChildByName("PreCenter").getChildByName("Confrontation").getChildByName("click3").getChildByName("checkbox").getChildByName("label")
            },
            this.comment_0_controll = {
                btn: this.panel.getChildByName("PreCenter").getChildByName("comment").getChildByName("click1").getChildByName("checkbox").getChildByName("btn"),
                check: this.panel.getChildByName("PreCenter").getChildByName("comment").getChildByName("click1").getChildByName("checkbox").getChildByName("checkbox"),
                label: this.panel.getChildByName("PreCenter").getChildByName("comment").getChildByName("click1").getChildByName("checkbox").getChildByName("label")
            },
            this.comment_1_controll = {
                btn: this.panel.getChildByName("PreCenter").getChildByName("comment").getChildByName("click2").getChildByName("checkbox").getChildByName("btn"),
                check: this.panel.getChildByName("PreCenter").getChildByName("comment").getChildByName("click2").getChildByName("checkbox").getChildByName("checkbox"),
                label: this.panel.getChildByName("PreCenter").getChildByName("comment").getChildByName("click2").getChildByName("checkbox").getChildByName("label")
            },
            this.comment_2_controll = {
                btn: this.panel.getChildByName("PreCenter").getChildByName("comment").getChildByName("click3").getChildByName("checkbox").getChildByName("btn"),
                check: this.panel.getChildByName("PreCenter").getChildByName("comment").getChildByName("click3").getChildByName("checkbox").getChildByName("checkbox"),
                label: this.panel.getChildByName("PreCenter").getChildByName("comment").getChildByName("click3").getChildByName("checkbox").getChildByName("label")
            },
            this.Tileset = this.panel.getChildByName("PreCenter").getChildByName("Tileset"),
            this.Tileset_1 = this.panel.getChildByName("PreCenter").getChildByName("Tileset").getChildByName("click1"),
            this.Tileset_2 = this.panel.getChildByName("PreCenter").getChildByName("Tileset").getChildByName("click2"),
            this.Tilesetcheck1 = this.Tileset_1.getChildByName("checkbox").getChildByName("checkbox"),
            this.Tilesetcheck2 = this.Tileset_2.getChildByName("checkbox").getChildByName("checkbox");
            var n = this.panel.getChildByName("OtherCenter").getChildByName("Other")
              , a = this.panel.getChildByName("OtherCenter").getChildByName("renzheng");
            a.y = 273,
            n.getChildByName("btn_gift").clickHandler = new Laya.Handler(this,function() {
                i.hide(),
                t.UI_Giftcode.Inst.show()
            }
            ),
            n.getChildByName("btn_rule").clickHandler = new Laya.Handler(this,function() {
                i.hide(),
                t.UI_Rules.Inst.show(0)
            }
            ),
            n.getChildByName("jp").visible = !1,
            n.getChildByName("en").visible = !1,
            "en" == GameMgr.client_language ? (n.getChildByName("en").visible = !0,
            a.y = 348,
            n.getChildByName("en").getChildByName("btn0").clickHandler = new Laya.Handler(this,function() {
                i.hide(),
                t.UI_User_Xieyi_enjp.Inst.show("docs/contact_us.txt")
            }
            ),
            n.getChildByName("en").getChildByName("btn1").clickHandler = new Laya.Handler(this,function() {
                i.hide(),
                t.UI_User_Xieyi_enjp.Inst.show("docs/term_of_service.txt")
            }
            ),
            n.getChildByName("en").getChildByName("btn2").clickHandler = new Laya.Handler(this,function() {
                i.hide(),
                t.UI_User_Xieyi_enjp.Inst.show("docs/privacy_policy.txt")
            }
            )) : "jp" == GameMgr.client_language && (n.getChildByName("jp").visible = !0,
            a.y = 429,
            n.getChildByName("jp").getChildByName("btn0").clickHandler = new Laya.Handler(this,function() {
                i.hide(),
                t.UI_User_Xieyi_enjp.Inst.show("docs/jp_liyongguiyue.txt")
            }
            ),
            n.getChildByName("jp").getChildByName("btn1").clickHandler = new Laya.Handler(this,function() {
                i.hide(),
                t.UI_User_Xieyi_enjp.Inst.show("docs/jp_falv1.txt")
            }
            ),
            n.getChildByName("jp").getChildByName("btn2").clickHandler = new Laya.Handler(this,function() {
                i.hide(),
                t.UI_User_Xieyi_enjp.Inst.show("docs/jp_yinsixieyi.txt")
            }
            ),
            n.getChildByName("jp").getChildByName("btn3").clickHandler = new Laya.Handler(this,function() {
                i.hide(),
                t.UI_User_Xieyi_enjp.Inst.show("docs/jp_falv2.txt")
            }
            )),
            this.music_controll.btn_mute.clickHandler = Laya.Handler.create(this, function() {
                i.locking || (view.AudioMgr.musicMuted = !view.AudioMgr.musicMuted,
                i.refreshMusicMute())
            }, null, !1),
            this.audio_controll.btn_mute.clickHandler = Laya.Handler.create(this, function() {
                i.locking || (view.AudioMgr.audioMuted = !view.AudioMgr.audioMuted,
                i.refreshAudioMute())
            }, null, !1),
            this.lizhi_controll.btn_mute.clickHandler = Laya.Handler.create(this, function() {
                i.locking || (view.AudioMgr.lizhiMuted = !view.AudioMgr.lizhiMuted,
                i.refreshlizhiMute())
            }, null, !1),
            this.music_controll.slider.me.on("change", this, function() {
                i.locking || (view.AudioMgr.musicVolume = i.music_controll.slider.rate,
                view.AudioMgr.musicMuted = !1,
                i.refreshMusicMute())
            }),
            this.audio_controll.slider.me.on("change", this, function() {
                i.locking || (view.AudioMgr.audioVolume = i.audio_controll.slider.rate,
                view.AudioMgr.audioMuted = !1,
                i.refreshAudioMute())
            }),
            this.lizhi_controll.slider.me.on("change", this, function() {
                i.locking || (view.AudioMgr.lizhiVolume = i.lizhi_controll.slider.rate,
                view.AudioMgr.lizhiMuted = !1,
                i.refreshlizhiMute())
            }),
            this.fps_controll.btn.clickHandler = Laya.Handler.create(this, function() {
                if (!i.locking) {
                    var t = Laya.LocalStorage.getItem("fpsmode");
                    "fast" != t && (t = "fast",
                    i.btn_restart.visible = !0,
                    Laya.LocalStorage.setItem("fpsmode", t),
                    i.refreshFps())
                }
            }, null, !1),
            this.fpslow_controll.btn.clickHandler = Laya.Handler.create(this, function() {
                if (!i.locking) {
                    var t = Laya.LocalStorage.getItem("fpsmode");
                    "slow" != t && (t = "slow",
                    i.btn_restart.visible = !0,
                    Laya.LocalStorage.setItem("fpsmode", t),
                    i.refreshFps())
                }
            }, null, !1),
            this.btn_restart = this.root.getChildByName("btn_restart"),
            this.btn_restart.clickHandler = Laya.Handler.create(this, function() {
                if (Laya.Browser.window.conch) {
                    Laya.PlatformClass.createClass("layaair.majsoul.mjmgr").call("restart")
                } else
                    Laya.Browser.window.location.href = GameMgr.Inst.link_url
            }, null, !1),
            this.click1_controll.btn.clickHandler = Laya.Handler.create(this, function() {
                i.click1_controll.check.visible = !0,
                i.click2_controll.check.visible = !1,
                i.click1_controll.label.color = "#cad4f7",
                i.click2_controll.label.color = "#9ba1b2",
                view.DesktopMgr.click_prefer = 0,
                Laya.LocalStorage.setItem("click_prefer", "0")
            }, null, !1),
            this.click2_controll.btn.clickHandler = Laya.Handler.create(this, function() {
                i.click2_controll.check.visible = !0,
                i.click1_controll.check.visible = !1,
                i.click2_controll.label.color = "#cad4f7",
                i.click1_controll.label.color = "#9ba1b2",
                view.DesktopMgr.click_prefer = 1,
                Laya.LocalStorage.setItem("click_prefer", "1")
            }, null, !1),
            this.click3_controll.btn.clickHandler = Laya.Handler.create(this, function() {
                view.DesktopMgr.double_click_pass ^= 1,
                i.click3_controll.check.visible = 1 == view.DesktopMgr.double_click_pass,
                Laya.LocalStorage.setItem("double_click_pass", view.DesktopMgr.double_click_pass.toString())
            }, null, !1),
            this.comment_0_controll.btn.clickHandler = Laya.Handler.create(this, function() {
                i.comment_0_controll.check.visible || (i.comment_0_controll.check.visible = !0,
                i.comment_1_controll.check.visible = !1,
                i.comment_2_controll.check.visible = !1,
                i.comment_0_controll.label.color = "#cad4f7",
                i.comment_1_controll.label.color = "#9ba1b2",
                i.comment_2_controll.label.color = "#9ba1b2",
                app.NetAgent.sendReq2Lobby("Lobby", "updateCommentSetting", {
                    comment_allow: 0
                }, function(e, n) {
                    e || n.error ? (t.UIMgr.Inst.showNetReqError("updateCommentSetting", e, n),
                    i.comment_0_controll.check.visible = !1) : GameMgr.Inst.comment_allow = 0
                }))
            }, null, !1),
            this.comment_1_controll.btn.clickHandler = Laya.Handler.create(this, function() {
                i.comment_1_controll.check.visible || (i.comment_0_controll.check.visible = !1,
                i.comment_1_controll.check.visible = !0,
                i.comment_2_controll.check.visible = !1,
                i.comment_1_controll.label.color = "#cad4f7",
                i.comment_0_controll.label.color = "#9ba1b2",
                i.comment_2_controll.label.color = "#9ba1b2",
                app.NetAgent.sendReq2Lobby("Lobby", "updateCommentSetting", {
                    comment_allow: 1
                }, function(e, n) {
                    e || n.error ? (t.UIMgr.Inst.showNetReqError("updateCommentSetting", e, n),
                    i.comment_1_controll.check.visible = !1) : GameMgr.Inst.comment_allow = 1
                }))
            }, null, !1),
            this.comment_2_controll.btn.clickHandler = Laya.Handler.create(this, function() {
                i.comment_2_controll.check.visible || (i.comment_0_controll.check.visible = !1,
                i.comment_1_controll.check.visible = !1,
                i.comment_2_controll.check.visible = !0,
                i.comment_2_controll.label.color = "#cad4f7",
                i.comment_0_controll.label.color = "#9ba1b2",
                i.comment_1_controll.label.color = "#9ba1b2",
                app.NetAgent.sendReq2Lobby("Lobby", "updateCommentSetting", {
                    comment_allow: 2
                }, function(e, n) {
                    e || n.error ? (t.UIMgr.Inst.showNetReqError("updateCommentSetting", e, n),
                    i.comment_2_controll.check.visible = !1) : GameMgr.Inst.comment_allow = 2
                }))
            }, null, !1),
            this.Tileset_1.getChildByName("checkbox").getChildByName("btn").clickHandler = Laya.Handler.create(this, function() {
                i.Tilesetcheck1.visible || (i.Tilesetcheck1.visible = !0,
                i.Tilesetcheck2.visible = !1,
                i.changeTileset(!0))
            }, null, !1),
            this.Tileset_2.getChildByName("checkbox").getChildByName("btn").clickHandler = Laya.Handler.create(this, function() {
                i.Tilesetcheck2.visible || (i.Tilesetcheck2.visible = !0,
                i.Tilesetcheck1.visible = !1,
                i.changeTileset(!1))
            }, null, !1),
            this.root.getChildByName("version").text = game.Tools.strOfLocalization(2040) + ":" + game.ResourceVersion.version,
            this.CVclone(),
            this.LabelColorInit()
        }
        ,
        n.prototype.changeTileset = function(t) {
            game.LocalStorage.setItem("en_mjp", t ? "true" : "false"),
            view.DesktopMgr.en_mjp = t,
            GameMgr.Inst.load_mjp_view(GameMgr.Inst.mjp_item_id)
        }
        ,
        n.prototype.CVclone = function() {
            var t = this;
            this.CVbox_templete.visible = !1;
            for (l = 0; l < 8; l++) {
                var i = this.CVbox_templete.scriptMap["capsui.UICopy"].getNodeClone();
                this.CV_Cells.push(i),
                i.visible = !1
            }
            for (var n = 0, a = 0, r = 200001, s = function(i) {
                var s = o.CVboxParent.getChildAt(i);
                s.visible = !0,
                s.name = "CVvoice_" + i;
                var l = null;
                i % 2 == 0 ? (s.x = -15,
                s.y = 110 + 110 * n,
                n++) : (s.x = 510,
                s.y = 110 + 110 * a,
                a++),
                l = r,
                r++,
                o.CVvoice[i] = {
                    slider: new e(o.panel.getChildByName("CVCenter").getChildByName("CharacterVoice").getChildByName(s.name).getChildByName("slider")),
                    btn_mute: o.panel.getChildByName("CVCenter").getChildByName("CharacterVoice").getChildByName(s.name).getChildByName("checkbox").getChildByName("btn"),
                    check: o.panel.getChildByName("CVCenter").getChildByName("CharacterVoice").getChildByName(s.name).getChildByName("checkbox").getChildByName("checkbox"),
                    img: o.panel.getChildByName("CVCenter").getChildByName("CharacterVoice").getChildByName(s.name).getChildByName("Character"),
                    id: l
                },
                o.CVvoice[i].btn_mute.clickHandler = Laya.Handler.create(o, function() {
                    t.locking || (view.AudioMgr.setCVmute(l, !view.AudioMgr.getCVmute(l)),
                    t.CharacterVocie(i, t.CVvoice[i].id))
                }, null, !1),
                o.CVvoice[i].slider.me.on("change", o, function() {
                    t.locking || (view.AudioMgr.setCVvolume(l, t.CVvoice[i].slider.rate),
                    view.AudioMgr.setCVmute(l, !1),
                    t.CharacterVocie(i, t.CVvoice[i].id))
                })
            }, o = this, l = 0; l < this.CV_Cells.length; l++)
                s(l)
        }
        ,
        n.prototype.hide = function() {
            var e = this;
            this.locking = !0,
            t.UIBase.anim_pop_hide(this.root, Laya.Handler.create(this, function() {
                e.locking = !1,
                e.enable = !1
            }))
        }
        ,
        n.prototype.renzhen = function() {
            var e = this;
            if ("chs" != GameMgr.client_language)
                return this.panel.getChildByName("OtherCenter").getChildByName("renzheng").visible = !1,
                void this.panel.refresh();
            var i = this.panel.getChildByName("OtherCenter").getChildByName("renzheng").getChildByName("RealName")
              , n = i.getChildByName("other");
            if (t.UI_ShiMingRenZheng.renzhenged) {
                var a = (r = i.getChildByName("btn")).getChildByName("label");
                a.text = "已认证",
                a.color = "#72f882",
                n.text = "",
                r.mouseEnabled = !1
            } else {
                n.text = "尚未认证",
                n.color = "#ff5757";
                var r = i.getChildByName("btn");
                r.visible = !0,
                r.clickHandler = Laya.Handler.create(this, function() {
                    e.locking || (e.hide(),
                    t.UI_ShiMingRenZheng.Inst.show())
                }, null, !1)
            }
        }
        ,
        n.prototype.refreshMusicMute = function() {
            this.music_controll.check.visible = !view.AudioMgr.musicMuted,
            this.music_controll.slider.bar.gray = view.AudioMgr.musicMuted,
            this.music_controll.slider.point.gray = view.AudioMgr.musicMuted
        }
        ,
        n.prototype.refreshAudioMute = function() {
            this.audio_controll.check.visible = !view.AudioMgr.audioMuted,
            this.audio_controll.slider.bar.gray = view.AudioMgr.audioMuted,
            this.audio_controll.slider.point.gray = view.AudioMgr.audioMuted
        }
        ,
        n.prototype.refreshlizhiMute = function() {
            this.lizhi_controll.check.visible = !view.AudioMgr.lizhiMuted,
            this.lizhi_controll.slider.bar.gray = view.AudioMgr.lizhiMuted,
            this.lizhi_controll.slider.point.gray = view.AudioMgr.lizhiMuted
        }
        ,
        n.prototype.refreshFps = function() {
            "slow" == Laya.LocalStorage.getItem("fpsmode") ? (this.fps_controll.check.visible = !1,
            this.fpslow_controll.check.visible = !0,
            this.fps_controll.label.color = "#9ba1b2",
            this.fpslow_controll.label.color = "#cad4f7") : (this.fps_controll.check.visible = !0,
            this.fpslow_controll.check.visible = !1,
            this.fps_controll.label.color = "#cad4f7",
            this.fpslow_controll.label.color = "#9ba1b2")
        }
        ,
        n.prototype.CharacterVocie = function(t, e) {
            this.CVvoice[t].check.visible = !view.AudioMgr.getCVmute(e),
            this.CVvoice[t].slider.bar.gray = view.AudioMgr.getCVmute(e),
            this.CVvoice[t].slider.point.gray = view.AudioMgr.getCVmute(e),
            this.CVvoice[t].slider.bar.width = view.AudioMgr.getCVvolume(e) * this.CVvoice[t].slider.me.width,
            this.CVvoice[t].slider.point.x = view.AudioMgr.getCVvolume(e) * this.CVvoice[t].slider.me.width
        }
        ,
        n.prototype.panelstart = function() {
            this.concenter.visible = !0,
            this.perfercenter.visible = !1,
            this.cvcenter.visible = !1,
            this.othercenter.visible = !1,
            this.refreshBtnCrew(0)
        }
        ,
        n.prototype.refreshBtnCrew = function(t) {
            for (var e = 0; e < 4; e++) {
                i = this.bottoncrew.getChildByName("btn" + e);
                this.bottoncrew.setChildIndex(i, 0),
                i.skin = game.Tools.localUISrc("myres/bothui/tab_unchoose2.png")
            }
            var i = this.bottoncrew.getChildByName("btn" + t);
            this.bottoncrew.setChildIndex(i, this.bottoncrew.numChildren - 1),
            i.skin = game.Tools.localUISrc("myres/bothui/tab_choosed2.png"),
            this.panel.refresh()
        }
        ,
        n.prototype.LabelColorInit = function() {
            this.fps_controll.check.visible ? (this.fps_controll.label.color = "#9ba1b2",
            this.fpslow_controll.label.color = "#cad4f7") : (this.fps_controll.label.color = "#cad4f7",
            this.fpslow_controll.label.color = "#9ba1b2"),
            this.click1_controll.check.visible ? (this.click1_controll.label.color = "#cad4f7",
            this.click2_controll.label.color = "#9ba1b2") : (this.click1_controll.label.color = "#9ba1b2",
            this.click2_controll.label.color = "#cad4f7"),
            this.comment_0_controll.check.visible ? (this.comment_0_controll.label.color = "#cad4f7",
            this.comment_1_controll.label.color = "#9ba1b2",
            this.comment_2_controll.label.color = "#9ba1b2") : this.comment_1_controll.check.visible ? (this.comment_0_controll.label.color = "#9ba1b2",
            this.comment_1_controll.label.color = "#cad4f7",
            this.comment_2_controll.label.color = "#9ba1b2") : (this.comment_0_controll.label.color = "#9ba1b2",
            this.comment_1_controll.label.color = "#9ba1b2",
            this.comment_2_controll.label.color = "#cad4f7")
        }
        ,
        n.prototype.show = function() {
            var e = this;
            GameMgr.Inst.BehavioralStatistics(17),
            this.audio_controll.slider.initset(view.AudioMgr.audioVolume),
            this.music_controll.slider.initset(view.AudioMgr.musicVolume),
            this.lizhi_controll.slider.initset(view.AudioMgr.lizhiVolume),
            this.refreshMusicMute(),
            this.refreshAudioMute(),
            this.refreshlizhiMute(),
            this.refreshFps(),
            this.renzhen(),
            this.panelstart(),
            this.Tileset.visible = !1,
            this.perfercenter.height = 500,
            "en" == GameMgr.client_language && (this.Tileset.visible = !0,
            this.perfercenter.height = 770);
            for (var i = 0, n = 200001; n < 200009; n++)
                this.CharacterVocie(i, n),
                i++;
            if (this.locking = !0,
            this.enable = !0,
            this.click1_controll.check.visible = 0 == view.DesktopMgr.click_prefer,
            this.click2_controll.check.visible = 0 != view.DesktopMgr.click_prefer,
            this.click3_controll.check.visible = 1 == view.DesktopMgr.double_click_pass,
            this.comment_0_controll.check.visible = 0 == GameMgr.Inst.comment_allow,
            this.comment_1_controll.check.visible = 1 == GameMgr.Inst.comment_allow,
            this.comment_2_controll.check.visible = 2 == GameMgr.Inst.comment_allow,
            this.Tileset.visible) {
                var a = game.LocalStorage.getItem("en_mjp")
                  , r = !0;
                r = !a || null == a || "false" != a,
                this.Tilesetcheck1.visible = r,
                this.Tilesetcheck2.visible = !r
            }
            t.UI_Lobby.Inst.enable ? game.Tools.setGrayDisable(this.Tileset, !1) : game.Tools.setGrayDisable(this.Tileset, !0),
            this.panel.vScrollBar.value = 0,
            this._drag_scroll = !1,
            this._scrollpoint.y = 0;
            for (n = 0; n < this.CV_Cells.length; n++) {
                var s = 200001 + n
                  , o = cfg.item_definition.character.get(s)
                  , l = cfg.item_definition.skin.get(o.init_skin);
                game.LoadMgr.setImgSkin(this.CVvoice[n].img, l.path + "/smallhead.png")
            }
            t.UIBase.anim_pop_out(this.root, Laya.Handler.create(this, function() {
                e.locking = !1
            }))
        }
        ,
        n.Inst = null,
        n
    }(t.UIBase));
    t.UI_Config = i
}(uiscript || (uiscript = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), uiscript;
!function(t) {
    var e = function(t) {
        function e() {
            var i = t.call(this, new ui.both_ui.courseUI) || this;
            return i.locking = !1,
            i.loadover = [],
            i.urls = ["course/course0.png", "course/course1.png", "course/course2.png", "course/course3.png", "course/course4.png", "course/course5.png", "course/course6.png", "course/course7.png", "course/course8.png"],
            i.pageindex = 0,
            e.Inst = i,
            i
        }
        return __extends(e, t),
        e.prototype.onCreate = function() {}
        ,
        e.prototype.show = function(t) {
            var e = this;
            void 0 === t && (t = null),
            this.enable = !0,
            this.func_complete = t,
            this.locking = !0,
            this.root.alpha = 0,
            Laya.Tween.to(this.root, {
                alpha: 1
            }, 120, null, Laya.Handler.create(this, function() {
                e.locking = !1
            })),
            this.showPage(0);
            for (var i = function(t) {
                n.loadover.push(!1),
                Laya.loader.load(n.urls[t], Laya.Handler.create(n, function() {
                    Laya.timer.frameOnce(3, e, function() {
                        e.loadover[t] = !0,
                        e.enable && e.pageindex == t && (e.loading.visible = !1,
                        e.page.source = Laya.loader.getRes(e.urls[t]),
                        e.page.visible = !0),
                        e.enable || Laya.loader.clearTextureRes(e.urls[t])
                    })
                }))
            }, n = this, a = 0; a < this.urls.length; a++)
                i(a)
        }
        ,
        e.prototype.close = function() {
            var t = this;
            this.locking = !0,
            this.root.alpha = 1,
            Laya.Tween.to(this.root, {
                alpha: 0
            }, 120, null, Laya.Handler.create(this, function() {
                t.locking = !1,
                t.enable = !1;
                for (var e = 0; e < t.urls.length; e++)
                    t.loadover[e] && Laya.loader.clearTextureRes(t.urls[e]);
                t.func_complete && t.func_complete.run()
            }))
        }
        ,
        e.prototype.showPage = function(t) {
            this.pageindex = t,
            this.btn_left.visible = 0 != t,
            this.btn_right.visible = t != this.urls.length - 1,
            this.loadover[t] ? (this.page.visible = !0,
            this.page.source = Laya.loader.getRes(this.urls[t]),
            this.loading.visible = !1) : (this.page.visible = !1,
            this.loading.visible = !0)
        }
        ,
        e
    }(t.UIBase);
    t.UI_Course = e
}(uiscript || (uiscript = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), uiscript;
!function(t) {
    var e;
    !function(t) {
        t[t.none = 0] = "none",
        t[t.liqi4 = 1] = "liqi4",
        t[t.liqi3 = 2] = "liqi3"
    }(e || (e = {}));
    var i;
    !function(t) {
        t[t.none = 0] = "none",
        t[t.friend_room = 1] = "friend_room",
        t[t.matching = 2] = "matching"
    }(i || (i = {}));
    var n = function() {
        function t(t) {
            this.me = t
        }
        return t.prototype.show = function(t, e, i) {}
        ,
        t.prototype.reset = function() {}
        ,
        t
    }()
      , a = function(t) {
        function e(e) {
            var i = t.call(this, e) || this;
            i.container_hand = null,
            i.img_hands = [],
            i.label_noinfo = null,
            i.container_title = null,
            i.container_hand = i.me.getChildByName("container_hand"),
            i.img_hands = [];
            for (var n = 0; n < i.container_hand.numChildren; n++) {
                var a = i.container_hand.getChildAt(n);
                a.visible = !1,
                i.img_hands.push(a)
            }
            return i.container_title = i.me.getChildByName("container_title"),
            i.label_noinfo = i.me.getChildByName("label_noinfo"),
            i
        }
        return __extends(e, t),
        e.prototype.show = function(t, e, i) {
            var n = null;
            if (t.statistic_data)
                for (var a = 0; a < t.statistic_data.length; a++) {
                    var r = t.statistic_data[a];
                    if (e == r.mahjong_category && i == r.game_category) {
                        n = r.statistic;
                        break
                    }
                }
            if (n && n.highest_hu) {
                this.container_hand.visible = !0,
                this.container_title.visible = !0,
                this._showDaHe(n.highest_hu.hands, n.highest_hu.ming, n.highest_hu.hupai);
                var s = 0;
                if (n.highest_hu.title_id)
                    s = n.highest_hu.title_id;
                else if (n.highest_hu.title)
                    switch (n.highest_hu.title) {
                    case "满贯":
                        s = mjcore.E_Dadian_Title.E_Dadian_Title_manguan;
                        break;
                    case "跳满":
                        s = mjcore.E_Dadian_Title.E_Dadian_Title_tiaoman;
                        break;
                    case "倍满":
                        s = mjcore.E_Dadian_Title.E_Dadian_Title_beiman;
                        break;
                    case "三倍满":
                        s = mjcore.E_Dadian_Title.E_Dadian_Title_sanbeiman;
                        break;
                    case "累积役满":
                        s = mjcore.E_Dadian_Title.E_Dadian_Title_leijiyiman;
                        break;
                    case "役满":
                        s = mjcore.E_Dadian_Title.E_Dadian_Title_yiman;
                        break;
                    case "两倍役满":
                        s = mjcore.E_Dadian_Title.E_Dadian_Title_yiman2;
                        break;
                    case "三倍役满":
                        s = mjcore.E_Dadian_Title.E_Dadian_Title_yiman3;
                        break;
                    case "四倍役满":
                        s = mjcore.E_Dadian_Title.E_Dadian_Title_yiman4;
                        break;
                    case "五倍役满":
                        s = mjcore.E_Dadian_Title.E_Dadian_Title_yiman5;
                        break;
                    case "六倍役满":
                        s = mjcore.E_Dadian_Title.E_Dadian_Title_yiman6
                    }
                this._setTitle(s),
                this.label_noinfo.visible = !1
            } else
                this.container_hand.visible = !1,
                this.container_title.visible = !1,
                this.label_noinfo.visible = !0
        }
        ,
        e.prototype.reset = function() {
            this.container_hand.visible = !1,
            this.label_noinfo.visible = !1,
            this.container_title.visible = !1
        }
        ,
        e.prototype._showDaHe = function(t, e, i) {
            for (var n = this.img_hands[0].width, a = .5 * n, r = 0; r < this.img_hands.length; r++)
                this.img_hands[r].visible = !1;
            for (var s = 0, o = 0, l = "myres2/mjp/" + game.GameUtility.get_common_view_res_name(game.ECommonView.mjp) + "/ui/", r = 0; r < t.length; r++)
                this.img_hands[s].skin = game.Tools.localUISrc(l + t[r] + ".png"),
                this.img_hands[s].x = o,
                this.img_hands[s].y = 0,
                o += n,
                this.img_hands[s].visible = !0,
                s++;
            if (e && e.length > 0) {
                o += a;
                for (r = 0; r < e.length; r++) {
                    var h = e[r];
                    if (")" != h.charAt(h.length - 1)) {
                        if (1 == (u = h.split("|")).length) {
                            f = u[0].charAt(1);
                            "0" == (d = u[0].charAt(0)) && (d = "5");
                            for (y = 0; y < 4; y++) {
                                v = "";
                                v = 0 == y || 3 == y ? "back" : 1 == y && "5" == d && "z" != f ? "0" + f : d + f,
                                this.img_hands[s].skin = game.Tools.localUISrc(l + v + ".png"),
                                this.img_hands[s].x = o,
                                this.img_hands[s].y = 0,
                                o += n,
                                this.img_hands[s].visible = !0,
                                s++
                            }
                        } else
                            for (y = 0; y < u.length; y++) {
                                v = u[y].toString();
                                this.img_hands[s].skin = game.Tools.localUISrc(l + v + ".png"),
                                this.img_hands[s].x = o,
                                this.img_hands[s].y = 0,
                                o += n,
                                this.img_hands[s].visible = !0,
                                s++
                            }
                    } else {
                        for (var c = "", u = [], _ = 0; _ < h.length; _++)
                            if ("(" == h.charAt(_)) {
                                c = h.substring(0, _),
                                u = h.substring(_ + 1, h.length - 1).split(",");
                                break
                            }
                        if ("angang" == c) {
                            for (var d = u[0].charAt(0), f = u[0].charAt(1), p = 0, m = 0; m < u.length; m++)
                                "0" == u[m].charAt(0) && p++;
                            p > 0 && (d = "5");
                            for (var g = 0; g < u.length; g++) {
                                v = "";
                                v = 0 == g || 3 == g ? "back" : g <= p ? "0" + f : d + f,
                                this.img_hands[s].skin = game.Tools.localUISrc(l + v + ".png"),
                                this.img_hands[s].x = o,
                                this.img_hands[s].y = 0,
                                o += n,
                                this.img_hands[s].visible = !0,
                                s++
                            }
                        } else
                            for (var y = 0; y < u.length; y++) {
                                var v = u[y];
                                this.img_hands[s].skin = game.Tools.localUISrc(l + v + ".png"),
                                this.img_hands[s].x = o,
                                this.img_hands[s].y = 0,
                                o += n,
                                this.img_hands[s].visible = !0,
                                s++
                            }
                    }
                }
            }
            o += a,
            this.img_hands[s].skin = game.Tools.localUISrc(l + i + ".png"),
            this.img_hands[s].x = o,
            this.img_hands[s].y = 0,
            o += n,
            this.img_hands[s].visible = !0;
            var b = -.12 * (++s - 14) / 4 + .65;
            this.container_hand.scaleX = this.container_hand.scaleY = b
        }
        ,
        e.prototype._setTitle = function(t) {
            for (n = 0; n < this.container_title.numChildren; n++)
                this.container_title.getChildAt(n).visible = !1;
            if ("chs" == GameMgr.client_language) {
                e = [];
                switch (t) {
                case mjcore.E_Dadian_Title.E_Dadian_Title_manguan:
                    e = ["", "", "man", "guan"];
                    break;
                case mjcore.E_Dadian_Title.E_Dadian_Title_tiaoman:
                    e = ["", "", "tiao", "man"];
                    break;
                case mjcore.E_Dadian_Title.E_Dadian_Title_beiman:
                    e = ["", "", "bei", "man"];
                    break;
                case mjcore.E_Dadian_Title.E_Dadian_Title_sanbeiman:
                    e = ["", "san", "bei", "man"];
                    break;
                case mjcore.E_Dadian_Title.E_Dadian_Title_leijiyiman:
                    e = ["lei", "ji", "yi", "man"];
                    break;
                case mjcore.E_Dadian_Title.E_Dadian_Title_yiman:
                    e = ["", "", "yi", "man"];
                    break;
                case mjcore.E_Dadian_Title.E_Dadian_Title_yiman2:
                    e = ["liang", "bei", "yi", "man"];
                    break;
                case mjcore.E_Dadian_Title.E_Dadian_Title_yiman3:
                    e = ["san", "bei", "yi", "man"];
                    break;
                case mjcore.E_Dadian_Title.E_Dadian_Title_yiman4:
                    e = ["si", "bei", "yi", "man"];
                    break;
                case mjcore.E_Dadian_Title.E_Dadian_Title_yiman5:
                    e = ["wu", "bei", "yi", "man"];
                    break;
                case mjcore.E_Dadian_Title.E_Dadian_Title_yiman6:
                    e = ["liu", "bei", "yi", "man"]
                }
                (i = this.container_title.getChildByName("chs")).visible = !0;
                for (n = 0; n < i.numChildren; n++)
                    i.getChildAt(n).visible = !1;
                for (n = 0; n < e.length; n++)
                    if ("" != e[n]) {
                        (a = i.getChildAt(n)).visible = !0,
                        a.skin = "myres/word_" + e[n] + ".png"
                    }
            } else if ("en" == GameMgr.client_language) {
                (i = this.container_title.getChildByName("en")).visible = !0;
                a = i.getChildAt(0);
                switch (t) {
                case mjcore.E_Dadian_Title.E_Dadian_Title_manguan:
                    a.skin = "en/myres/Mangan.png";
                    break;
                case mjcore.E_Dadian_Title.E_Dadian_Title_tiaoman:
                    a.skin = "en/myres/Haneman.png";
                    break;
                case mjcore.E_Dadian_Title.E_Dadian_Title_beiman:
                    a.skin = "en/myres/Baiman.png";
                    break;
                case mjcore.E_Dadian_Title.E_Dadian_Title_sanbeiman:
                    a.skin = "en/myres/Sanbaiman.png";
                    break;
                case mjcore.E_Dadian_Title.E_Dadian_Title_leijiyiman:
                case mjcore.E_Dadian_Title.E_Dadian_Title_yiman:
                    a.skin = "en/myres/Yakuman.png";
                    break;
                case mjcore.E_Dadian_Title.E_Dadian_Title_yiman2:
                    a.skin = "en/myres/Double Yakuman.png";
                    break;
                case mjcore.E_Dadian_Title.E_Dadian_Title_yiman3:
                    a.skin = "en/myres/Triple Yakuman.png";
                    break;
                case mjcore.E_Dadian_Title.E_Dadian_Title_yiman4:
                    a.skin = "en/myres/Quadruple Yakuman.png";
                    break;
                case mjcore.E_Dadian_Title.E_Dadian_Title_yiman5:
                    a.skin = "en/myres/Quintuple Yakuman.png";
                    break;
                case mjcore.E_Dadian_Title.E_Dadian_Title_yiman6:
                    a.skin = "en/myres/Sextuple Yakuman.png"
                }
            } else if ("jp" == GameMgr.client_language) {
                var e = [];
                switch (t) {
                case mjcore.E_Dadian_Title.E_Dadian_Title_manguan:
                    e = ["", "", "man", "guan"];
                    break;
                case mjcore.E_Dadian_Title.E_Dadian_Title_tiaoman:
                    e = ["", "", "tiao", "man"];
                    break;
                case mjcore.E_Dadian_Title.E_Dadian_Title_beiman:
                    e = ["", "", "bei", "man"];
                    break;
                case mjcore.E_Dadian_Title.E_Dadian_Title_sanbeiman:
                    e = ["", "san", "bei", "man"];
                    break;
                case mjcore.E_Dadian_Title.E_Dadian_Title_leijiyiman:
                    e = ["shu", "ji", "yi", "man"];
                    break;
                case mjcore.E_Dadian_Title.E_Dadian_Title_yiman:
                    e = ["", "", "yi", "man"];
                    break;
                case mjcore.E_Dadian_Title.E_Dadian_Title_yiman2:
                    e = ["er", "bei", "yi", "man"];
                    break;
                case mjcore.E_Dadian_Title.E_Dadian_Title_yiman3:
                    e = ["san", "bei", "yi", "man"];
                    break;
                case mjcore.E_Dadian_Title.E_Dadian_Title_yiman4:
                    e = ["si", "bei", "yi", "man"];
                    break;
                case mjcore.E_Dadian_Title.E_Dadian_Title_yiman5:
                    e = ["wu", "bei", "yi", "man"];
                    break;
                case mjcore.E_Dadian_Title.E_Dadian_Title_yiman6:
                    e = ["liu", "bei", "yi", "man"]
                }
                var i = this.container_title.getChildByName("chs");
                i.visible = !0;
                for (n = 0; n < i.numChildren; n++)
                    i.getChildAt(n).visible = !1;
                for (var n = 0; n < e.length; n++)
                    if ("" != e[n]) {
                        var a;
                        (a = i.getChildAt(n)).visible = !0,
                        a.skin = "jp/myres/word_" + e[n] + ".png"
                    }
            }
        }
        ,
        e
    }(n)
      , r = function(e) {
        function i(i) {
            var n = e.call(this, i) || this;
            n.fengge = [],
            n.radar_triangle = [];
            var a = n.me;
            n.fengge.push(a.getChildByName("gong")),
            n.fengge.push(a.getChildByName("su")),
            n.fengge.push(a.getChildByName("fang")),
            n.fengge.push(a.getChildByName("yun"));
            for (s = 0; s < 4; s++)
                n.radar_triangle.push(a.getChildByName("radar").getChildByName("sanjiao" + s.toString()));
            var r = n.me.getChildByName("what");
            if (r && (r.clickHandler = Laya.Handler.create(n, function() {
                t.UI_InfoLite.Inst.show(game.Tools.strOfLocalization(51))
            }, null, !1)),
            "en" == GameMgr.client_language)
                for (var s = 0; s < n.fengge.length; s++)
                    n.fengge[s].x = 150;
            return n
        }
        return __extends(i, e),
        i.prototype.show = function(t, e, i) {
            var n = this
              , a = null;
            if (t.statistic_data)
                for (var r = 0; r < t.statistic_data.length; r++) {
                    var s = t.statistic_data[r];
                    if (e == s.mahjong_category && i == s.game_category) {
                        a = s.statistic;
                        break
                    }
                }
            var o = [0, 0, 0, 0];
            if (a && a.recent_20_hu_summary && a.recent_20_hu_summary.total_count > 0) {
                (l = (a.recent_20_hu_summary.average_hu_point - 3e3) / 5e3 * 100) < 0 ? l = 0 : l > 100 && (l = 100),
                o[0] = l
            }
            if (a && a.recent_round && a.recent_round.total_count > 0) {
                a.recent_round.rong_count + a.recent_round.zimo_count == 0 ? o[1] = 0 : (o[1] = ((a.recent_round.rong_count + a.recent_round.zimo_count) / a.recent_round.total_count - .1) / .3 * 100,
                o[1] < 0 ? o[1] = 0 : o[1] > 100 && (o[1] = 100));
                (l = 100 * (1.12 - a.recent_round.fangchong_count / a.recent_round.total_count * 3.4)) < 0 ? l = 0 : l > 100 && (l = 100),
                o[2] = l
            }
            if (a && a.recent_10_hu_summary && a.recent_10_hu_summary.total_fanshu > 0) {
                var l = a.recent_10_hu_summary.total_xuanshang / a.recent_10_hu_summary.total_fanshu * 1.5 * 100;
                l = l < 0 ? 0 : l > 100 ? 100 : l,
                o[3] = l
            }
            this._showRadar([0, 0, 0, 0]),
            Laya.timer.once(500, this, function() {
                Laya.timer.clearAll(n);
                var t = Laya.timer.currTimer
                  , e = function() {
                    var i = Laya.timer.currTimer - t;
                    if (i >= 300)
                        n._showRadar(o),
                        Laya.timer.clear(n, e);
                    else {
                        for (var a = Laya.Ease.linearNone(i, 0, 1, 300), r = [], s = 0; s < o.length; s++)
                            r.push(o[s] * a);
                        n._showRadar(r)
                    }
                };
                Laya.timer.frameLoop(1, n, e, null, !0)
            })
        }
        ,
        i.prototype.reset = function() {
            Laya.timer.clearAll(this),
            this._showRadar([0, 0, 0, 0])
        }
        ,
        i.prototype._showRadar = function(t) {
            for (e = 0; e < t.length; e++)
                this.fengge[e].text = Math.floor(t[e]).toString();
            for (var e = 0; e < t.length; e++)
                for (var i = 0; i < 2; i++) {
                    var n = this.radar_triangle[e].getChildByName(0 == i ? "nei" : "wai")
                      , a = t[e] / 20
                      , r = t[(e + 1) % t.length] / 20;
                    a <= .2 && (a = .2),
                    a >= 4.8 && (a = 4.8),
                    r <= .2 && (r = .2),
                    r >= 4.8 && (r = 4.8),
                    1 == i && (a += .3,
                    r += .3);
                    var s = 180 * Math.atan(r / a) / 3.1415926
                      , o = 108 * a / 5
                      , l = 108 * r / 5;
                    n.rotation = s,
                    n.x = .5 * o,
                    n.y = 108 - .5 * l,
                    n.width = n.height = Math.sqrt(o * o + l * l) + 10
                }
        }
        ,
        i
    }(n)
      , s = function(t) {
        function i(e) {
            var i = t.call(this, e) || this;
            i.zoushi_points = [],
            i.zoushi_lines = [];
            for (var n = i.me, a = n.getChildByName("lines"), r = 0; r < a.numChildren; r++)
                i.zoushi_lines.push(a.getChildAt(r));
            for (var s = n.getChildByName("points"), r = 0; r < s.numChildren; r++)
                i.zoushi_points.push(s.getChildAt(r));
            return "en" == GameMgr.client_language && (e.getChildByName("lb1").getChildByName("w").text = "st",
            e.getChildByName("lb2").getChildByName("w").text = "nd",
            e.getChildByName("lb3").getChildByName("w").text = "rd",
            e.getChildByName("lb4").getChildByName("w").text = "th",
            e.getChildByName("lb1").getChildByName("w").y = 32,
            e.getChildByName("lb2").getChildByName("w").y = 32,
            e.getChildByName("lb3").getChildByName("w").y = 32,
            e.getChildByName("lb4").getChildByName("w").y = 32),
            i
        }
        return __extends(i, t),
        i.prototype.show = function(t, i, n) {
            var a = this
              , r = null;
            if (t.statistic_data)
                for (var s = 0; s < t.statistic_data.length; s++) {
                    var o = t.statistic_data[s];
                    if (i == o.mahjong_category && n == o.game_category) {
                        r = o.statistic;
                        break
                    }
                }
            if (r && r.recent_ranks) {
                Laya.timer.clearAll(this);
                var l = r.recent_ranks;
                this._showZoushi([], 0),
                Laya.timer.clearAll(this),
                Laya.timer.once(500, this, function() {
                    var t = l.length >= 10 ? 10 : l.length
                      , e = Laya.timer.currTimer;
                    Laya.timer.frameLoop(1, a, function() {
                        var i = .01 * (Laya.timer.currTimer - e);
                        i >= t ? (a._showZoushi(l, t),
                        Laya.timer.clearAll(a)) : a._showZoushi(l, i)
                    }, null, !0)
                })
            } else
                Laya.timer.clearAll(this),
                this._showZoushi([], 0);
            this.me.getChildByName("line4").visible = i == e.liqi4,
            this.me.getChildByName("lb4").visible = i == e.liqi4
        }
        ,
        i.prototype.reset = function() {
            this._showZoushi([], 0)
        }
        ,
        i.prototype._showZoushi = function(t, e) {
            var i = 0;
            i = t.length >= 10 ? t.length - 10 : 0;
            for (r = 0; r < this.zoushi_points.length; r++)
                this.zoushi_points[r].visible = !1;
            for (r = 0; r < this.zoushi_lines.length; r++)
                this.zoushi_lines[r].visible = !1;
            for (var n = [], a = Math.floor(e), r = 0; r + i < t.length; r++) {
                var s = -705 * (9 - r) / 9 + 1755
                  , o = -129 * (4 - t[r + i]) / 3 + 991;
                n.push(new Laya.Vector2(s,o))
            }
            for (r = 0; r < n.length && !(r > a); r++)
                if (this.zoushi_points[r].visible = !0,
                this.zoushi_points[r].x = n[r].x,
                this.zoushi_points[r].y = n[r].y,
                r + 1 < n.length)
                    if (r == a) {
                        var l = e - a;
                        if (l > .001) {
                            this.zoushi_lines[r].visible = !0,
                            this.zoushi_lines[r].x = n[r].x,
                            this.zoushi_lines[r].y = n[r].y;
                            var h = n[r + 1].y - n[r].y
                              , c = n[r + 1].x - n[r].x
                              , u = 180 * Math.atan(h / c) / 3.1415926;
                            this.zoushi_lines[r].rotation = u,
                            this.zoushi_lines[r].width = Math.sqrt(c * c + h * h) * l
                        }
                    } else {
                        this.zoushi_lines[r].visible = !0,
                        this.zoushi_lines[r].x = n[r].x,
                        this.zoushi_lines[r].y = n[r].y;
                        var h = n[r + 1].y - n[r].y
                          , c = n[r + 1].x - n[r].x
                          , u = 180 * Math.atan(h / c) / 3.1415926;
                        this.zoushi_lines[r].rotation = u,
                        this.zoushi_lines[r].width = Math.sqrt(c * c + h * h)
                    }
        }
        ,
        i
    }(n)
      , o = function(t) {
        function n(e, i) {
            var n = t.call(this, e) || this;
            return n.type = 0,
            n.btn = null,
            n.arrow = null,
            n.indetail = !1,
            n.container_detail = null,
            n.h_hide = 0,
            n.h_detail = 0,
            n.type = i,
            n.btn = n.me.getChildByName("btn"),
            n.btn.clickHandler = Laya.Handler.create(n, n.switchState, null, !1),
            n.arrow = n.btn.getChildByName("arrow"),
            n.container_detail = n.me.getChildByName("detail"),
            n.h_detail = 310,
            n.h_hide = n.btn.height,
            n.container_detail.visible = !1,
            n.indetail = !1,
            n.me.height = n.btn.height,
            n.arrow.rotation = 0,
            n._pos1 = n.container_detail.getChildByName("pos1"),
            n._pos2 = n.container_detail.getChildByName("pos2"),
            n._pos3 = n.container_detail.getChildByName("pos3"),
            n._pos4 = n.container_detail.getChildByName("pos4"),
            n._knockout = n.container_detail.getChildByName("knockout"),
            n._changci = n.container_detail.getChildByName("changci"),
            n._dadian = n.container_detail.getChildByName("dadian"),
            n._shunwei = n.container_detail.getChildByName("shunwei"),
            n._lianzhuang = n.container_detail.getChildByName("lianzhuang"),
            n._hule = n.container_detail.getChildByName("hule"),
            n._shunwei = n.container_detail.getChildByName("shunwei"),
            n._hupai = n.container_detail.getChildByName("hupai"),
            n._zimo = n.container_detail.getChildByName("zimo"),
            n._fangchong = n.container_detail.getChildByName("fangchong"),
            n._fulu = n.container_detail.getChildByName("fulu"),
            n._liqi = n.container_detail.getChildByName("liqi"),
            n
        }
        return __extends(n, t),
        n.prototype.show = function(t, n, a) {
            this._pos1.text = "--/--",
            this._pos2.text = "--/--",
            this._pos3.text = "--/--",
            this._pos4.text = "--/--",
            this._knockout.text = "--/--",
            this._changci.text = "--/--",
            this._dadian.text = "--/--",
            this._shunwei.text = "--/--",
            this._lianzhuang.text = "--/--",
            this._hule.text = "--/--",
            this._hupai.text = "--/--",
            this._zimo.text = "--/--",
            this._fangchong.text = "--/--",
            this._fulu.text = "--/--",
            this._liqi.text = "--/--",
            n == e.liqi3 ? (this._pos4.visible = !1,
            this._knockout.y = 140) : (this._pos4.visible = !0,
            this._knockout.y = 183);
            var r = t.detail_data;
            if (r) {
                var s = null;
                if (a == i.friend_room ? s = r.friend_room_statistic : a == i.matching && (s = r.rank_statistic.total_statistic.all_level_statistic),
                s) {
                    var o = 0;
                    n == e.liqi4 ? 1 == this.type ? o = 1 : 2 == this.type && (o = 2) : n == e.liqi3 && (1 == this.type ? o = 11 : 2 == this.type && (o = 12));
                    for (var l = 0; l < s.game_mode.length; l++) {
                        var h = s.game_mode[l];
                        if (h.mode == o) {
                            var c = h.game_count_sum;
                            if (c > 0) {
                                this._pos1.text = (h.game_final_position[0] / c * 100).toFixed(2).toString() + "%",
                                this._pos2.text = (h.game_final_position[1] / c * 100).toFixed(2).toString() + "%",
                                this._pos3.text = (h.game_final_position[2] / c * 100).toFixed(2).toString() + "%",
                                this._pos4 && (this._pos4.text = (h.game_final_position[3] / c * 100).toFixed(2).toString() + "%"),
                                this._knockout.text = (h.fly_count / c * 100).toFixed(2).toString() + "%",
                                this._changci.text = c.toString();
                                for (var u = 0, _ = 0; _ < 4; _++)
                                    u += (_ + 1) * h.game_final_position[_];
                                this._shunwei.text = (u / c).toFixed(2).toString()
                            } else
                                this._pos1.text = "--/--",
                                this._pos2.text = "--/--",
                                this._pos3.text = "--/--",
                                this._pos4 && (this._pos4.text = "--/--"),
                                this._knockout.text = "--/--",
                                this._changci.text = c.toString(),
                                this._shunwei.text = "--/--";
                            var d = 0
                              , f = 0
                              , p = 0
                              , m = 0;
                            if (h.round_end)
                                for (var g = 0; g < h.round_end.length; g++) {
                                    d += h.round_end[g].sum;
                                    var y = h.round_end[g].type;
                                    y == mjcore.E_Round_Result.zimo && (p += h.round_end[g].sum),
                                    y == mjcore.E_Round_Result.rong || y == mjcore.E_Round_Result.zimo ? f += h.round_end[g].sum : y == mjcore.E_Round_Result.fangchong && (m += h.round_end[g].sum)
                                }
                            d > 0 ? (this._hupai.text = (f / d * 100).toFixed(2).toString() + "%",
                            this._fangchong.text = (m / d * 100).toFixed(2).toString() + "%",
                            this._fulu.text = (h.ming_count_sum / d * 100).toFixed(2).toString() + "%",
                            this._liqi.text = (h.liqi_count_sum / d * 100).toFixed(2).toString() + "%") : (this._hupai.text = "--/--",
                            this._fangchong.text = "--/--",
                            this._fulu.text = "--/--",
                            this._liqi.text = "--/--"),
                            f > 0 ? (this._dadian.text = (h.dadian_sum / f).toFixed(0),
                            this._zimo.text = (p / f * 100).toFixed(2).toString() + "%",
                            this._hule.text = (h.xun_count_sum / f).toFixed(2)) : (this._dadian.text = "--/--",
                            this._zimo.text = "--/--",
                            this._hule.text = "--/--"),
                            null != h.highest_lianzhuang && void 0 != h.highest_lianzhuang ? this._lianzhuang.text = h.highest_lianzhuang : this._lianzhuang.text = "--/--"
                        }
                    }
                }
            }
        }
        ,
        n.prototype.reset = function() {
            this.container_detail.visible = !1,
            this.indetail = !1,
            this.me.height = this.btn.height,
            this.arrow.rotation = 0,
            this.container_detail.alpha = 1,
            this._pos1.text = "--/--",
            this._pos2.text = "--/--",
            this._pos3.text = "--/--",
            this._pos4 && (this._pos4.text = "--/--"),
            this._knockout.text = "--/--",
            this._changci.text = "--/--",
            this._dadian.text = "--/--",
            this._shunwei.text = "--/--",
            this._lianzhuang.text = "--/--",
            this._hule.text = "--/--",
            this._hupai.text = "--/--",
            this._zimo.text = "--/--",
            this._fangchong.text = "--/--",
            this._fulu.text = "--/--",
            this._liqi.text = "--/--"
        }
        ,
        n.prototype.switchState = function() {
            var t = this;
            this.indetail = !this.indetail,
            Laya.timer.clearAll(this),
            this.indetail ? (this.me.height = this.h_detail,
            Laya.Tween.to(this.arrow, {
                rotation: -180
            }, 200, Laya.Ease.strongOut),
            Laya.timer.once(0, this, function() {
                t.container_detail.visible = !0
            })) : (Laya.Tween.to(this.arrow, {
                rotation: 0
            }, 200, Laya.Ease.strongOut),
            this.container_detail.visible = !1,
            this.me.height = this.h_hide)
        }
        ,
        n
    }(n)
      , l = function(t) {
        function n(e) {
            var i = t.call(this, e) || this;
            i.item_height = 50,
            i.btn = null,
            i.arrow = null,
            i.indetail = !1,
            i.container_detail = null,
            i.cells = [],
            i.items = [],
            i.h_hide = 0,
            i.h_detail = 0,
            i.btn = i.me.getChildByName("btn"),
            i.btn.clickHandler = Laya.Handler.create(i, i.switchState, null, !1),
            i.arrow = i.btn.getChildByName("arrow"),
            i.container_detail = i.me.getChildByName("detail");
            var n = i.container_detail.getChildByName("templete");
            n.visible = !1,
            i.items = [],
            i.cells = [];
            for (var a = 0; a < 100; a++)
                i.cells.push(n.scriptMap["capsui.UICopy"].getNodeClone());
            return i
        }
        return __extends(n, t),
        n.prototype.reset = function() {
            this.container_detail.visible = !1,
            this.indetail = !1,
            this.me.height = this.btn.height,
            this.arrow.rotation = 0;
            for (var t = 0; t < this.items.length; t++)
                this.items[t].label_count.text = "0";
            this.container_detail.alpha = 1
        }
        ,
        n.prototype.show = function(t, n, a) {
            for (var r = this, s = 0; s < this.cells.length; s++)
                this.cells[s].visible = !1;
            var o = 10;
            this.items = [];
            var l = -1;
            cfg.fan.fan.forEach(function(t) {
                if (46 != t.id && !(34 == t.id && n != e.liqi3 || 17 == t.id && n == e.liqi3)) {
                    if (35 == t.id) {
                        var i = r.cells[r.items.length];
                        i.y = o,
                        o += r.item_height;
                        var a = i.getChildByName("fan")
                          , s = i.getChildByName("count")
                          , h = i.getChildByName("line");
                        if (a.text = game.Tools.strOfLocalization(2154),
                        s.text = "0",
                        i.visible = !0,
                        l < 0) {
                            l = 0;
                            for (var c = "", u = 0; u < 50; u++)
                                c += "-";
                            h.text = c,
                            l = h.textField.textWidth / 50
                        }
                        if (l > 0) {
                            for (var _ = Math.floor((660 - a.textField.textWidth * a.scaleX) / l), c = "", u = 0; u < _; u++)
                                c += "-";
                            h.text = c
                        }
                        var d = {
                            id: -1,
                            count: 0,
                            label_count: s
                        };
                        r.items.push(d)
                    }
                    var f = r.cells[r.items.length];
                    f.y = o,
                    o += r.item_height;
                    var p = f.getChildByName("fan")
                      , m = f.getChildByName("count")
                      , g = f.getChildByName("line");
                    if (p.text = t["name_" + GameMgr.client_language],
                    m.text = "0",
                    f.visible = !0,
                    l < 0) {
                        l = 0;
                        for (var c = "", u = 0; u < 50; u++)
                            c += "-";
                        g.text = c,
                        l = g.textField.textWidth / 50
                    }
                    if (l > 0) {
                        for (var _ = Math.floor((660 - p.textField.textWidth * p.scaleX) / l), c = "", u = 0; u < _; u++)
                            c += "-";
                        g.text = c
                    }
                    r.items.push({
                        id: t.id,
                        count: 0,
                        label_count: m
                    })
                }
            }),
            this.h_detail = o + 80,
            this.h_hide = this.btn.height,
            this.container_detail.visible = !1,
            this.indetail = !1,
            this.me.height = this.btn.height,
            this.arrow.rotation = 0;
            for (s = 0; s < this.items.length; s++)
                this.items[s].label_count.text = "0";
            var h = t.detail_data;
            if (h) {
                var c = null;
                if (a == i.friend_room ? c = h.friend_room_statistic : a == i.matching && (c = h.rank_statistic.total_statistic.all_level_statistic),
                c && (c = c.fan_achieved),
                c) {
                    var u = null
                      , _ = 1;
                    n == e.liqi3 && (_ = 2);
                    for (s = 0; s < c.length; s++)
                        if (c[s].mahjong_category == _) {
                            u = c[s];
                            break
                        }
                    if (u) {
                        for (s = 0; s < u.fan.length; s++)
                            for (var d = 0; d < this.items.length; d++)
                                if (this.items[d].id == u.fan[s].fan_id) {
                                    this.items[d].count = u.fan[s].sum,
                                    this.items[d].label_count.text = this.items[d].count.toString();
                                    break
                                }
                        if (null != u.liujumanguan)
                            for (s = 0; s < this.items.length; s++)
                                if (-1 == this.items[s].id) {
                                    this.items[s].count = u.liujumanguan,
                                    this.items[s].label_count.text = this.items[s].count.toString();
                                    break
                                }
                    }
                }
            }
        }
        ,
        n.prototype.switchState = function() {
            var t = this;
            this.indetail = !this.indetail,
            Laya.timer.clearAll(this),
            this.indetail ? (this.me.height = this.h_detail,
            Laya.Tween.to(this.arrow, {
                rotation: -180
            }, 200, Laya.Ease.strongOut),
            Laya.timer.once(0, this, function() {
                t.container_detail.visible = !0
            })) : (Laya.Tween.to(this.arrow, {
                rotation: 0
            }, 200, Laya.Ease.strongOut),
            this.container_detail.visible = !1,
            this.me.height = this.h_hide)
        }
        ,
        n
    }(n)
      , h = function() {
        function t(t, e) {
            var n = this;
            this.game_category = 0,
            this.me = t,
            this.father = e,
            this.btn_friend = this.me.getChildByName("btn_friend"),
            this.btn_friend.clickHandler = new Laya.Handler(this,function() {
                n.game_category !== i.friend_room && (n.changeTab(i.friend_room),
                n.father.changeGameCategory(i.friend_room))
            }
            ),
            this.btn_pipei = this.me.getChildByName("btn_pipei"),
            this.btn_pipei.clickHandler = new Laya.Handler(this,function() {
                n.game_category !== i.matching && (n.changeTab(i.matching),
                n.father.changeGameCategory(i.matching))
            }
            ),
            game.Tools.labelLocalizationSize(this.btn_pipei.getChildAt(0), 175, 1),
            game.Tools.labelLocalizationSize(this.btn_friend.getChildAt(0), 175, 1)
        }
        return t.prototype.changeTab = function(t) {
            this.game_category !== t && (this.game_category = t,
            this.refreshShow())
        }
        ,
        t.prototype.refreshMJ = function(t) {
            t == e.liqi3 ? (this.btn_pipei.visible = !1,
            this.btn_friend.x = 51) : (this.btn_pipei.visible = !0,
            this.btn_friend.x = "chs" == GameMgr.client_language ? 250 : 290)
        }
        ,
        t.prototype.refreshShow = function() {
            this.btn_friend.skin = game.Tools.localUISrc(this.game_category == i.friend_room ? "myres/bothui/tab2_choosed.png" : "myres/bothui/tab2_unchoose.png"),
            this.btn_friend.getChildAt(0).color = this.game_category == i.friend_room ? "#6a7eb1" : "#48577a",
            this.btn_pipei.skin = game.Tools.localUISrc(this.game_category == i.matching ? "myres/bothui/tab2_choosed.png" : "myres/bothui/tab2_unchoose.png"),
            this.btn_pipei.getChildAt(0).color = this.game_category == i.matching ? "#6a7eb1" : "#48577a",
            this.game_category == i.friend_room ? this.me.setChildIndex(this.btn_friend, this.me.numChildren - 1) : this.me.setChildIndex(this.btn_pipei, this.me.numChildren - 1)
        }
        ,
        t
    }()
      , c = function() {
        function t(t) {
            var c = this;
            this.me = null,
            this.panel = null,
            this.blocks = [],
            this.tabs = null,
            this._data = null,
            this._last_time = 0,
            this._drag_scroll = !1,
            this.data = null,
            this.mj_category = e.none,
            this.game_categroy = i.none,
            this.total_h = 0,
            this.me = t,
            this.panel = this.me.getChildByName("content"),
            this.panel.vScrollBarSkin = "",
            this.scrollbar = this.me.getChildByName("scrollbar_light").scriptMap["capsui.CScrollBar"],
            this.scrollbar.init(!1, null),
            this.panel.vScrollBar.on("change", this, function() {
                c.total_h <= 0 ? c.scrollbar.setVal(0, 1) : c.scrollbar.setVal(c.panel.vScrollBar.value / c.panel.vScrollBar.max, c.panel.height / c.total_h)
            }),
            this.blocks.push(new a(this.panel.getChildByName("dahe"))),
            this.blocks.push(new r(this.panel.getChildByName("fengge"))),
            this.blocks.push(new s(this.panel.getChildByName("zoushi"))),
            this.blocks.push(new n(this.panel.getChildByName("blank0"))),
            this.blocks.push(new o(this.panel.getChildByName("mode1"),1)),
            this.blocks.push(new o(this.panel.getChildByName("mode2"),2)),
            this.blocks.push(new l(this.panel.getChildByName("fan"))),
            this.blocks.push(new n(this.panel.getChildByName("blank"))),
            this.tabs = new h(this.me.parent.getChildByName("tabs"),this)
        }
        return t.prototype.reset = function() {
            for (var t = 0, e = 0; e < this.blocks.length; e++)
                this.blocks[e].reset(),
                this.blocks[e].me.y = t,
                t += this.blocks[e].me.height
        }
        ,
        t.prototype.setData = function(t) {
            this.data = t,
            this.mj_category = e.liqi4,
            this.game_categroy = i.matching,
            this.tabs.refreshMJ(e.liqi4),
            this.tabs.changeTab(i.matching),
            this.refreshShow()
        }
        ,
        t.prototype.changeMJCategory = function(t) {
            var n = t;
            n != this.mj_category && (this.mj_category = n,
            this.tabs.refreshMJ(n),
            n == e.liqi3 ? (this.game_categroy = i.friend_room,
            this.tabs.changeTab(i.friend_room)) : (this.game_categroy = i.matching,
            this.tabs.changeTab(i.matching)),
            this.refreshShow())
        }
        ,
        t.prototype.changeGameCategory = function(t) {
            t != this.game_categroy && (this.game_categroy = t,
            this.refreshShow())
        }
        ,
        t.prototype.refreshShow = function() {
            var t = 0;
            this.panel.vScrollBar.value = 0,
            this.panel.vScrollBar.stopScroll();
            for (var e = 0; e < this.blocks.length; e++)
                this.blocks[e].reset(),
                this.blocks[e].show(this.data, this.mj_category, this.game_categroy),
                this.blocks[e].me.y = t,
                t += this.blocks[e].me.height;
            this.total_h = t,
            this._last_time = Laya.timer.currTimer,
            Laya.timer.clearAll(this),
            Laya.timer.frameLoop(1, this, this.update, null, !0),
            this.scrollbar.reset(),
            this.scrollbar.setVal(this.panel.vScrollBar.value / this.panel.vScrollBar.max, this.panel.height / this.total_h)
        }
        ,
        t.prototype.close = function() {
            Laya.timer.clearAll(this)
        }
        ,
        t.prototype.update = function() {
            for (var t = 0, e = (this.panel.vScrollBar.value,
            this.panel.vScrollBar.max,
            0); e < this.blocks.length; e++) {
                var i = this.blocks[e].me.y
                  , n = Math.abs(i - t);
                if (n < .001)
                    this.blocks[e].me.y = t;
                else {
                    var a = Math.sqrt(2 * n / (1400 / 22500))
                      , r = Laya.timer.currTimer - this._last_time;
                    if (r >= a)
                        this.blocks[e].me.y = t;
                    else {
                        var s = 1400 / 22500 * .5 * (a - r) * (a - r);
                        this.blocks[e].me.y = i < t ? t - s : t + s
                    }
                }
                t += this.blocks[e].me.height
            }
            this.panel.refresh(),
            this.total_h = t,
            this.scrollbar.setVal(this.panel.vScrollBar.value / this.panel.vScrollBar.max, this.panel.height / this.total_h),
            this._last_time = Laya.timer.currTimer
        }
        ,
        t
    }();
    t.UI_PlayerData = c
}(uiscript || (uiscript = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), uiscript;
!function(t) {
    var e = function() {
        return function(t) {
            this.me = t
        }
    }()
      , i = function(t) {
        function e(e, i, n) {
            var a = t.call(this, e) || this;
            a._on_change = null,
            a._current_index = 0,
            a._toggles = [],
            a._on_change = n,
            a._current_index = i;
            for (var s = function(t) {
                var e = o.me.getChildByName("toggle_" + t);
                if (!e)
                    return "break";
                e.clickHandler = Laya.Handler.create(o, function() {
                    a.change_index(t)
                }, null, !1);
                var i = e.getChildAt(0);
                t == o._current_index ? (e.skin = game.Tools.localUISrc(r.skin_choosed),
                i.color = r.color_choosed) : (e.skin = game.Tools.localUISrc(r.skin_unchoose),
                i.color = r.color_unchoose),
                o._toggles.push({
                    btn: e,
                    label: i
                })
            }, o = this, l = 0; l < 6; l++) {
                if ("break" === s(l))
                    break
            }
            return a
        }
        return __extends(e, t),
        Object.defineProperty(e.prototype, "index", {
            get: function() {
                return this._current_index
            },
            enumerable: !0,
            configurable: !0
        }),
        e.prototype.change_index = function(t) {
            if (this._current_index != t) {
                for (var e = 0; e < this._toggles.length; e++)
                    e == t ? (this._toggles[e].btn.skin = game.Tools.localUISrc(r.skin_choosed),
                    this._toggles[e].label.color = r.color_choosed) : (this._toggles[e].btn.skin = game.Tools.localUISrc(r.skin_unchoose),
                    this._toggles[e].label.color = r.color_unchoose);
                this._current_index = t,
                this._on_change && this._on_change.runWith(t)
            }
        }
        ,
        e.prototype.setTexts = function(t) {
            for (var e = 0; e < this._toggles.length; e++)
                e < t.length ? (this._toggles[e].label.text = t[e],
                this._toggles[e].btn.visible = !0) : this._toggles[e].btn.visible = !1
        }
        ,
        e
    }(e)
      , n = function(t) {
        function e() {
            return null !== t && t.apply(this, arguments) || this
        }
        return __extends(e, t),
        e
    }(e)
      , a = function(e) {
        function i(i, n, a) {
            var r = e.call(this, i) || this;
            r._on_change = null,
            r._label = null,
            r._current_num = 0,
            r._on_change = a;
            var s = r.me.getChildByName("btn");
            return s.clickHandler = Laya.Handler.create(r, function() {
                t.UI_NumberInput.Inst.show(game.Tools.strOfLocalization(2043), Laya.Handler.create(r, function(t) {
                    0 != t && t != r._current_num && r._on_change && r._on_change.runWith(t)
                }), null)
            }, null, !1),
            r._label = s.getChildAt(1),
            r.change_num(n),
            r
        }
        return __extends(i, e),
        Object.defineProperty(i.prototype, "num", {
            get: function() {
                return this._current_num
            },
            enumerable: !0,
            configurable: !0
        }),
        i.prototype.change_num = function(t) {
            this._current_num = t,
            this._label.text = t.toString()
        }
        ,
        i
    }(e)
      , r = function(e) {
        function r() {
            var t = e.call(this, new ui.lobby.create_roomUI) || this;
            return t.__moshi = null,
            t.__jushu = null,
            t.__time = null,
            t.__test_paipu = null,
            t.__test_paicount = null,
            t.__gaojishezhi = null,
            t.__split_line = null,
            t.__qishidianshu = null,
            t.__fandian = null,
            t.__zimosun = null,
            t.__chibaopai = null,
            t.__shiduan = null,
            t.__bianjietishi = null,
            t.__guanzhan = null,
            t.__ailevel = null,
            t.container_top = null,
            t.container_content = null,
            t.panel = null,
            t._scrollbar = null,
            t._scrollpoint = null,
            t.locking = !1,
            t._btn_create_cd = 0,
            t.tournament_id = 0,
            t._blocks = [],
            t._drag_scroll = !1,
            r.Inst = t,
            t
        }
        return __extends(r, e),
        r.Show = function() {
            this.Inst.show()
        }
        ,
        r.prototype.onCreate = function() {
            var e = this
              , r = this.me.getChildByName("container_create_room");
            this.container_top = r.getChildByName("top"),
            this.container_content = r.getChildByName("content"),
            this.panel = this.container_content.getChildByName("panel"),
            this.__moshi = new i(this.panel.getChildByName("moshi"),0,Laya.Handler.create(this, function(t) {
                0 == t ? (e.__qishidianshu.change_num(25e3),
                e.__fandian.change_num(3e4),
                e.__chibaopai.setTexts([game.Tools.strOfLocalization(2044), game.Tools.strOfLocalization(2045), game.Tools.strOfLocalization(2046)])) : (e.__qishidianshu.change_num(35e3),
                e.__fandian.change_num(4e4),
                e.__chibaopai.setTexts([game.Tools.strOfLocalization(2044), game.Tools.strOfLocalization(2047)]),
                e.__chibaopai.index > 1 && e.__chibaopai.change_index(1)),
                e.__zimosun.me.visible = 0 != e.__gaojishezhi.index && 1 == e.__moshi.index,
                e._refreshShow()
            }, null, !1)),
            this.__jushu = new i(this.panel.getChildByName("jushu"),2,Laya.Handler.create(this, function(t) {}, null, !1)),
            this.__time = new i(this.panel.getChildByName("time"),2,null),
            this.__test_paipu = new i(this.panel.getChildByName("test_paipu"),0,null),
            this.__test_paicount = new i(this.panel.getChildByName("test_paicount"),0,null),
            this.__gaojishezhi = new i(this.panel.getChildByName("gaojishezhi"),0,Laya.Handler.create(this, function(t) {
                e.__qishidianshu.change_num(0 == e.__moshi.index ? 25e3 : 35e3),
                e.__fandian.change_num(0 == e.__moshi.index ? 3e4 : 4e4),
                e.__chibaopai.change_index(1),
                e.__chibaopai.setTexts(0 == e.__moshi.index ? [game.Tools.strOfLocalization(2044), game.Tools.strOfLocalization(2045), game.Tools.strOfLocalization(2046)] : [game.Tools.strOfLocalization(2044), game.Tools.strOfLocalization(2047)]),
                e.__shiduan.change_index(0),
                e.__bianjietishi.change_index(0),
                e.__ailevel.change_index(0),
                e.__guanzhan.change_index(0),
                e.__zimosun.change_index(0),
                e.__split_line.me.visible = 0 != t,
                e.__qishidianshu.me.visible = 0 != t,
                e.__fandian.me.visible = 0 != t,
                e.__zimosun.me.visible = 0 != t && 1 == e.__moshi.index,
                e.__chibaopai.me.visible = 0 != t,
                e.__shiduan.me.visible = 0 != t,
                e.__bianjietishi.me.visible = 0 != t,
                e.__guanzhan.me.visible = 0 != t,
                e.__ailevel.me.visible = 0 != t,
                e._refreshShow()
            }, null, !1)),
            this.__split_line = new n(this.panel.getChildByName("split_line")),
            this.__qishidianshu = new a(this.panel.getChildByName("qishidianshu"),25e3,Laya.Handler.create(this, function(t) {
                (t = 100 * Math.ceil(t / 100)) < 100 && (t = 100),
                t >= 2e5 && (t = 2e5),
                t > e.__fandian.num && e.__fandian.change_num(t),
                e.__qishidianshu.change_num(t)
            }, null, !1)),
            this.__fandian = new a(this.panel.getChildByName("fandian"),3e4,Laya.Handler.create(this, function(t) {
                (t = 100 * Math.ceil(t / 100)) < 100 && (t = 100),
                t >= 2e5 && (t = 2e5),
                t < e.__qishidianshu.num && (t = e.__qishidianshu.num),
                e.__fandian.change_num(t)
            }, null, !1)),
            this.__zimosun = new i(this.panel.getChildByName("zimosun"),0,null),
            this.__chibaopai = new i(this.panel.getChildByName("chibaopai"),1,null),
            this.__shiduan = new i(this.panel.getChildByName("shiduan"),0,null),
            this.__bianjietishi = new i(this.panel.getChildByName("bianjietishi"),0,null),
            this.__guanzhan = new i(this.panel.getChildByName("guanzhan"),0,Laya.Handler.create(this, function(t) {
                1 != t || 0 != e.__jushu.index && 3 != e.__jushu.index || e.__guanzhan.change_index(0)
            }, null, !1)),
            this.__ailevel = new i(this.panel.getChildByName("ailevel"),0,Laya.Handler.create(this, function(t) {}, null, !1)),
            this.__shiduan.me.getChildByName("what").clickHandler = Laya.Handler.create(this, function() {
                t.UI_InfoLite.Inst.show(game.Tools.strOfLocalization(54))
            }, null, !1),
            this.__bianjietishi.me.getChildByName("what").clickHandler = Laya.Handler.create(this, function() {
                t.UI_InfoLite.Inst.show(game.Tools.strOfLocalization(53))
            }, null, !1),
            this.panel.getChildByName("moshi").getChildByName("what").clickHandler = Laya.Handler.create(this, function() {
                t.UI_InfoLite.Inst.show(game.Tools.strOfLocalization(57))
            }, null, !1),
            this.panel.getChildByName("zimosun").getChildByName("what").clickHandler = Laya.Handler.create(this, function() {
                t.UI_InfoLite.Inst.show(game.Tools.strOfLocalization(63))
            }, null, !1);
            for (var s = 2; s < this.panel.numChildren; s++) {
                var o = this.panel.getChildAt(s)
                  , l = o.getChildByName("what");
                l && (l.x = 106 - o.getChildByName("img_info").displayWidth - 30,
                l.y = o.getChildByName("img_info").y)
            }
            this._blocks.push(this.__moshi),
            this._blocks.push(this.__jushu),
            this._blocks.push(this.__time),
            this._blocks.push(this.__test_paipu),
            this._blocks.push(this.__test_paicount),
            this._blocks.push(this.__gaojishezhi),
            this._blocks.push(this.__split_line),
            this._blocks.push(this.__qishidianshu),
            this._blocks.push(this.__fandian),
            this._blocks.push(this.__zimosun),
            this._blocks.push(this.__chibaopai),
            this._blocks.push(this.__shiduan),
            this._blocks.push(this.__bianjietishi),
            this._blocks.push(this.__guanzhan),
            this._blocks.push(this.__ailevel),
            this.__test_paipu.me.visible = !GameMgr.inRelease,
            this.__test_paicount.me.visible = !GameMgr.inRelease,
            this.__split_line.me.visible = !1,
            this.__qishidianshu.me.visible = !1,
            this.__fandian.me.visible = !1,
            this.__zimosun.me.visible = !1,
            this.__chibaopai.me.visible = !1,
            this.__shiduan.me.visible = !1,
            this.__bianjietishi.me.visible = !1,
            this.__guanzhan.me.visible = !1,
            this.__ailevel.me.visible = !1,
            this.panel.vScrollBar.visible = !1,
            this.container_top.getChildByName("btn_cancel").clickHandler = Laya.Handler.create(this, function() {
                e.locking || e.hide(Laya.Handler.create(e, function() {
                    t.UIMgr.Inst.showLobby()
                }))
            }, null, !1),
            this.container_content.getChildByName("btn_create").clickHandler = Laya.Handler.create(this, this._btnCreateRoom, null, !1),
            this._scrollbar = this.container_content.getChildByName("scrollbar"),
            this._scrollpoint = this._scrollbar.getChildByName("scrollpoint"),
            this._scrollbar && (this._scrollbar.on("mousedown", this, function() {
                e._drag_scroll = !0;
                var t = e._scrollbar.mouseY / e._scrollbar.height;
                e.panel.vScrollBar.value = e.panel.vScrollBar.max * t
            }),
            this._scrollbar.on("mousemove", this, function() {
                if (e._drag_scroll) {
                    var t = e._scrollbar.mouseY / e._scrollbar.height;
                    e.panel.vScrollBar.value = e.panel.vScrollBar.max * t
                }
            }),
            this._scrollbar.on("mouseup", this, function() {
                e._drag_scroll = !1
            }),
            this._scrollbar.on("mouseout", this, function() {
                e._drag_scroll = !1
            })),
            Laya.timer.frameLoop(1, this, function() {
                if (e.enable && e._scrollbar.visible) {
                    var t = e.panel.vScrollBar.max > 0 ? e.panel.vScrollBar.value / e.panel.vScrollBar.max : 0;
                    e._scrollpoint.y = e._scrollbar.height * t
                }
            })
        }
        ,
        r.prototype.show = function() {
            var e = this;
            this.tournament_id = 0,
            this._drag_scroll = !1,
            this.panel.vScrollBar.stopScroll(),
            cfg.tournament.tournaments.forEach(function(i) {
                if (0 == e.tournament_id) {
                    var n = t.UI_Bag.find_item(i.game_ticket_id);
                    n && n.count > 0 && (e.tournament_id = i.id)
                }
            }),
            this._refreshShow(),
            this.enable = !0,
            t.UIBase.anim_alpha_in(this.container_top, {
                y: -30
            }, 150),
            t.UIBase.anim_alpha_in(this.container_content, {
                y: 30
            }, 150),
            this.locking = !0,
            Laya.timer.once(200, this, function() {
                e.locking = !1,
                e._btn_create_cd = 0
            })
        }
        ,
        r.prototype.hide = function(e) {
            var i = this;
            void 0 === e && (e = null),
            t.UIBase.anim_alpha_out(this.container_top, {
                y: -30
            }, 150),
            t.UIBase.anim_alpha_out(this.container_content, {
                y: 30
            }, 150),
            this.locking = !0,
            Laya.timer.once(200, this, function() {
                i.locking = !1,
                i.enable = !1,
                e && e.run()
            })
        }
        ,
        r.prototype._btnCreateRoom = function() {
            var e = this;
            if (!(this.locking || Laya.timer.currTimer < this._btn_create_cd)) {
                var i = 10 * this.__moshi.index + this.__jushu.index;
                0 == this.__jushu.index && (i += 4),
                this._btn_create_cd = Laya.timer.currTimer + 5e3;
                var n = 0;
                switch (i) {
                case 0:
                case 1:
                case 2:
                    n = 4;
                    break;
                case 3:
                    n = 1;
                    break;
                case 4:
                    n = 4;
                    break;
                case 10:
                case 11:
                case 12:
                    n = 3;
                    break;
                case 13:
                    n = 1;
                    break;
                case 14:
                    n = 3
                }
                var a = {};
                switch (a.init_point = this.__qishidianshu.num,
                a.fandian = this.__fandian.num,
                0 == this.__moshi.index ? a.dora_count = 0 == this.__chibaopai.index ? 0 : 1 == this.__chibaopai.index ? 3 : 4 : a.dora_count = 0 == this.__chibaopai.index ? 0 : 1 == this.__chibaopai.index ? 2 : 3,
                a.shiduan = 0 == this.__shiduan.index,
                a.bianjietishi = 0 == this.__bianjietishi.index,
                this.__time.index) {
                case 0:
                    a.time_fixed = 3,
                    a.time_add = 5;
                    break;
                case 1:
                    a.time_fixed = 5,
                    a.time_add = 10;
                    break;
                case 2:
                    a.time_fixed = 5,
                    a.time_add = 20;
                    break;
                case 3:
                    a.time_fixed = 60,
                    a.time_add = 0
                }
                a.ai_level = this.__ailevel.index + 1,
                1 == this.__moshi.index && (a.have_zimosun = 0 == this.__zimosun.index);
                var r = GameMgr.inRelease;
                r = !0;
                var s = {};
                GameMgr.inRelease || (s.paixing = this.__test_paipu.index,
                s.left_count = this.__test_paicount.index,
                0 == this.__test_paipu.index && 0 == this.__test_paicount.index || (r = !1));
                var o = 1 == this.__guanzhan.index;
                app.NetAgent.sendReq2Lobby("Lobby", "createRoom", {
                    player_count: n,
                    mode: {
                        mode: i,
                        ai: r,
                        detail_rule: a,
                        testing_environment: s
                    },
                    public_live: o
                }, function(i, n) {
                    e._btn_create_cd = Laya.timer.currTimer,
                    i || n.error ? t.UIMgr.Inst.showNetReqError("createRoom", i, n) : e.hide(Laya.Handler.create(e, function() {
                        t.UI_WaitingRoom.Inst.updateData(n.room),
                        t.UIMgr.Inst.ShowWaitingRoom()
                    }))
                })
            }
        }
        ,
        r.prototype._refreshShow = function() {
            for (var t = this.panel.vScrollBar.max > 0 ? this.panel.vScrollBar.value / this.panel.vScrollBar.max : 0, e = 0, i = 0; i < this._blocks.length; i++)
                this._blocks[i].me.visible ? (this._blocks[i].me.y = e,
                e += this._blocks[i].me.height) : this._blocks[i].me.y = 0;
            this.panel.refresh(),
            e < this.panel.height ? (this.panel.vScrollBar.value = 0,
            this._scrollbar.visible = !1) : (this.panel.vScrollBar.value = this.panel.vScrollBar.max * t,
            this._scrollbar.visible = !0)
        }
        ,
        r.Inst = null,
        r.skin_unchoose = "myres/room/btn_choosen_no.png",
        r.skin_choosed = "myres/room/btn_choosen.png",
        r.color_unchoose = "#c1ac8b",
        r.color_choosed = "#894b4b",
        r
    }(t.UIBase);
    t.UI_Create_Room = r
}(uiscript || (uiscript = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), uiscript;
!function(t) {
    var e = function() {
        function t(e) {
            this.me = null,
            this._container_c0 = null,
            this._img_countdown_c0 = [],
            this._container_c1 = null,
            this._img_countdown_c1 = [],
            this._img_countdown_plus = null,
            this._img_countdown_add = [],
            this._start = 0,
            this._pre_sec = 0,
            this._fix = 0,
            this._add = 0,
            this._pre_time = 0,
            t.Inst = this,
            this.me = e,
            this._container_c0 = this.me.getChildByName("c0");
            for (i = 0; i < 2; i++)
                this._img_countdown_c0.push(this._container_c0.getChildByName("num" + i));
            this._container_c1 = this.me.getChildByName("c1");
            for (i = 0; i < 2; i++)
                this._img_countdown_c1.push(this._container_c1.getChildByName("num" + i));
            for (var i = 0; i < 2; i++)
                this._img_countdown_add.push(this.me.getChildByName("plus").getChildByName("add_" + i));
            this._img_countdown_plus = this.me.getChildByName("plus"),
            this.me.visible = !1
        }
        return Object.defineProperty(t.prototype, "timeuse", {
            get: function() {
                return this.me.visible ? Math.floor((Laya.timer.currTimer - this._start) / 1e3) : 0
            },
            enumerable: !0,
            configurable: !0
        }),
        t.prototype.reset = function() {
            this.me.visible = !1,
            Laya.timer.clearAll(this)
        }
        ,
        t.prototype.showCD = function(t, e) {
            var i = this;
            this.me.visible = !0,
            this._start = Laya.timer.currTimer,
            this._fix = Math.floor(t / 1e3),
            this._add = Math.floor(e / 1e3),
            this._pre_sec = -1,
            this._pre_time = Laya.timer.currTimer,
            this._show(),
            Laya.timer.frameLoop(1, this, function() {
                var t = Laya.timer.currTimer - i._pre_time;
                i._pre_time = Laya.timer.currTimer,
                view.DesktopMgr.Inst.timestoped ? i._start += t : i._show()
            })
        }
        ,
        t.prototype.close = function() {
            this.reset()
        }
        ,
        t.prototype._show = function() {
            var t = this._fix + this._add - this.timeuse;
            if (t <= 0)
                return view.DesktopMgr.Inst.OperationTimeOut(),
                void this.reset();
            if (t != this._pre_sec) {
                if (this._pre_sec = t,
                t > this._add) {
                    for (var e = (t - this._add).toString(), i = 0; i < this._img_countdown_c0.length; i++) {
                        a = this._img_countdown_c0[i];
                        i < e.length ? (a.visible = !0,
                        a.skin = game.Tools.localUISrc("myres/mjdesktop/t_" + e[e.length - i - 1] + ".png")) : a.visible = !1
                    }
                    if (0 != this._add) {
                        this._img_countdown_plus.visible = !0;
                        for (var n = this._add.toString(), i = 0; i < this._img_countdown_add.length; i++) {
                            a = this._img_countdown_add[i];
                            i < n.length ? (a.visible = !0,
                            a.skin = game.Tools.localUISrc("myres/mjdesktop/at_" + n[i] + ".png")) : a.visible = !1
                        }
                    } else {
                        this._img_countdown_plus.visible = !1;
                        for (i = 0; i < this._img_countdown_add.length; i++)
                            this._img_countdown_add[i].visible = !1
                    }
                } else {
                    this._img_countdown_plus.visible = !1;
                    for (var e = t.toString(), i = 0; i < this._img_countdown_c0.length; i++) {
                        var a = this._img_countdown_c0[i];
                        i < e.length ? (a.visible = !0,
                        a.skin = game.Tools.localUISrc("myres/mjdesktop/at_" + e[e.length - 1 - i] + ".png")) : a.visible = !1
                    }
                }
                if (t > 3) {
                    this._container_c1.visible = !1;
                    for (i = 0; i < this._img_countdown_c0.length; i++)
                        this._img_countdown_c0[i].alpha = 1;
                    this._img_countdown_plus.alpha = 1,
                    this._container_c0.alpha = 1,
                    this._container_c1.alpha = 1
                } else {
                    view.AudioMgr.PlayAudio(205),
                    this._container_c1.visible = !0;
                    for (i = 0; i < this._img_countdown_c0.length; i++)
                        this._img_countdown_c0[i].alpha = 1;
                    this._img_countdown_plus.alpha = 1,
                    this._container_c0.alpha = 1,
                    this._container_c1.alpha = 1;
                    for (i = 0; i < this._img_countdown_c1.length; i++)
                        this._img_countdown_c1[i].visible = this._img_countdown_c0[i].visible,
                        this._img_countdown_c1[i].skin = game.Tools.localUISrc(this._img_countdown_c0[i].skin);
                    r.Inst.me.cd1.play(0, !1)
                }
            }
        }
        ,
        t.Inst = null,
        t
    }()
      , i = function() {
        function t(t) {
            this.timer_id = 0,
            this.last_returned = !1,
            this.me = t
        }
        return t.prototype.begin_refresh = function() {
            this.timer_id && clearTimeout(this.timer_id),
            this.last_returned = !0,
            this._loop_refresh_delay(),
            Laya.timer.clearAll(this),
            Laya.timer.loop(100, this, this._loop_show)
        }
        ,
        t.prototype.close_refresh = function() {
            this.timer_id && (clearTimeout(this.timer_id),
            this.timer_id = 0),
            this.last_returned = !1,
            Laya.timer.clearAll(this)
        }
        ,
        t.prototype._loop_refresh_delay = function() {
            var t = this
              , e = 2e3;
            if (game.MJNetMgr.Inst.connect_state == game.EConnectState.connecting && this.last_returned) {
                var i = app.NetAgent.mj_network_delay;
                e = i < 300 ? 2e3 : i < 800 ? 2500 + i : 4e3 + .5 * i,
                app.NetAgent.sendReq2MJ("FastTest", "checkNetworkDelay", {}, function() {
                    t.last_returned = !0
                }),
                this.last_returned = !1
            } else
                e = 1e3;
            this.timer_id = setTimeout(this._loop_refresh_delay.bind(this), e)
        }
        ,
        t.prototype._loop_show = function() {
            if (game.MJNetMgr.Inst.connect_state != game.EConnectState.connecting)
                this.me.skin = game.Tools.localUISrc("myres/mjdesktop/signal_bad.png");
            else {
                var t = app.NetAgent.mj_network_delay;
                this.me.skin = t < 300 ? game.Tools.localUISrc("myres/mjdesktop/signal_good.png") : t < 800 ? game.Tools.localUISrc("myres/mjdesktop/signal_normal.png") : game.Tools.localUISrc("myres/mjdesktop/signal_bad.png")
            }
        }
        ,
        t
    }()
      , n = function() {
        function t(t, e) {
            var i = this;
            this.enable = !1,
            this.emj_banned = !1,
            this.locking = !1,
            this.localposition = e,
            this.me = t,
            this.btn_banemj = t.getChildByName("btn_banemj"),
            this.btn_banemj_origin_x = this.btn_banemj.x,
            this.btn_banemj_origin_y = this.btn_banemj.y,
            this.img_bannedemj = this.btn_banemj.getChildByName("banned"),
            this.btn_seeinfo = t.getChildByName("btn_seeinfo"),
            this.btn_seeinfo_origin_x = this.btn_seeinfo.x,
            this.btn_seeinfo_origin_y = this.btn_seeinfo.y,
            this.btn_change = t.getChildByName("btn_change"),
            this.btn_change_origin_x = this.btn_change.x,
            this.btn_change_origin_y = this.btn_change.y,
            this.btn_banemj.clickHandler = Laya.Handler.create(this, function() {
                i.locking || (i.emj_banned = !i.emj_banned,
                i.img_bannedemj.visible = !i.emj_banned,
                i.close())
            }, null, !1),
            this.btn_seeinfo.clickHandler = Laya.Handler.create(this, function() {
                i.locking || (i.close(),
                r.Inst.btn_seeinfo(i.localposition))
            }, null, !1),
            this.btn_change.clickHandler = Laya.Handler.create(this, function() {
                i.locking || (i.close(),
                view.DesktopMgr.Inst.changeMainbody(view.DesktopMgr.Inst.localPosition2Seat(i.localposition)))
            }, null, !1),
            this.me.clickHandler = Laya.Handler.create(this, function() {
                i.locking || i.switch()
            }, null, !1)
        }
        return t.prototype.reset = function(t, e, i) {
            Laya.timer.clearAll(this),
            this.locking = !1,
            this.enable = !1,
            this.showinfo = t,
            this.showemj = e,
            this.showchange = i,
            this.emj_banned = !1,
            this.btn_banemj.visible = !1,
            this.btn_seeinfo.visible = !1,
            this.img_bannedemj.visible = !this.emj_banned,
            this.btn_change.visible = !1
        }
        ,
        t.prototype.onChangeSeat = function(t, e, i) {
            this.showinfo = t,
            this.showemj = e,
            this.showchange = i,
            this.enable = !1,
            this.btn_banemj.visible = !1,
            this.btn_seeinfo.visible = !1,
            this.btn_change.visible = !1
        }
        ,
        t.prototype.switch = function() {
            var t = this;
            this.locking || (this.enable ? this.close() : (this.enable = !0,
            this.locking = !0,
            this.showinfo ? (this.btn_seeinfo.visible = !0,
            this.btn_seeinfo.scaleX = this.btn_seeinfo.scaleY = 1,
            this.btn_seeinfo.x = this.btn_seeinfo_origin_x,
            this.btn_seeinfo.y = this.btn_seeinfo_origin_y,
            this.btn_seeinfo.alpha = 1,
            Laya.Tween.from(this.btn_seeinfo, {
                x: 80,
                y: 80,
                scaleX: 0,
                scaleY: 0,
                alpha: 0
            }, 150, Laya.Ease.backOut)) : this.btn_seeinfo.visible = !1,
            this.showemj ? (this.img_bannedemj.visible = !this.emj_banned,
            this.btn_banemj.visible = !0,
            this.btn_banemj.scaleX = this.btn_banemj.scaleY = 1,
            this.btn_banemj.x = this.btn_banemj_origin_x,
            this.btn_banemj.y = this.btn_banemj_origin_y,
            this.btn_banemj.alpha = 1,
            Laya.Tween.from(this.btn_banemj, {
                x: 80,
                y: 80,
                scaleX: 0,
                scaleY: 0,
                alpha: 0
            }, 150, Laya.Ease.backOut)) : this.btn_banemj.visible = !1,
            this.showchange ? (this.btn_change.visible = !0,
            this.btn_change.scaleX = this.btn_change.scaleY = 1,
            this.btn_change.x = this.btn_change_origin_x,
            this.btn_change.y = this.btn_change_origin_y,
            this.btn_change.alpha = 1,
            Laya.Tween.from(this.btn_change, {
                x: 80,
                y: 80,
                scaleX: 0,
                scaleY: 0,
                alpha: 0
            }, 150, Laya.Ease.backOut)) : this.btn_change.visible = !1,
            Laya.timer.once(150, this, function() {
                t.locking = !1
            })))
        }
        ,
        t.prototype.close = function() {
            var t = this;
            this.enable = !1,
            this.locking = !0,
            Laya.Tween.to(this.btn_banemj, {
                x: 80,
                y: 80,
                scaleX: 0,
                scaleY: 0,
                alpha: 0
            }, 150, Laya.Ease.backOut),
            Laya.Tween.to(this.btn_seeinfo, {
                x: 80,
                y: 80,
                scaleX: 0,
                scaleY: 0,
                alpha: 0
            }, 150, Laya.Ease.backOut),
            Laya.Tween.to(this.btn_change, {
                x: 80,
                y: 80,
                scaleX: 0,
                scaleY: 0,
                alpha: 0
            }, 150, Laya.Ease.backOut),
            Laya.timer.once(150, this, function() {
                t.locking = !1,
                t.btn_banemj.visible = !1,
                t.btn_seeinfo.visible = !1,
                t.btn_change.visible = !1
            })
        }
        ,
        t
    }()
      , a = function() {
        function t(t) {
            var e = this;
            this.btn_emos = [],
            this.emos = [],
            this.allgray = !1,
            this.me = t,
            this.btn_chat = this.me.getChildByName("btn_chat"),
            this.btn_chat.clickHandler = new Laya.Handler(this,function() {
                e.switchShow()
            }
            ),
            this.scrollbar = this.me.getChildByName("scrollbar_light").scriptMap["capsui.CScrollBar"],
            this.scrollview = this.me.scriptMap["capsui.CScrollView"],
            this.scrollview.init_scrollview(new Laya.Handler(this,this.render_item), -1, 3),
            this.scrollview.reset(),
            this.scrollbar.init(!1, null),
            this.scrollview.me.on("ratechange", this, function() {
                e.scrollview.total_height > 0 ? e.scrollbar.setVal(e.scrollview.rate, e.scrollview.view_height / e.scrollview.total_height) : e.scrollbar.setVal(0, 1)
            }),
            "chs" != GameMgr.client_language ? (t.getChildAt(5).visible = !1,
            t.getChildAt(6).visible = !0) : (t.getChildAt(5).visible = !0,
            t.getChildAt(6).visible = !1)
        }
        return t.prototype.initRoom = function() {
            var t = view.DesktopMgr.Inst.main_role_character_info
              , e = cfg.item_definition.character.find(t.charid);
            this.emos = [];
            for (i = 0; i < 9; i++)
                this.emos.push({
                    path: e.emo + "/" + i + ".png",
                    sub_id: i
                });
            if (t.extra_emoji)
                for (var i = 0; i < t.extra_emoji.length; i++)
                    this.emos.push({
                        path: e.emo + "/" + t.extra_emoji[i] + ".png",
                        sub_id: t.extra_emoji[i]
                    });
            this.allgray = !1,
            this.scrollbar.reset(),
            this.scrollview.reset(),
            this.scrollview.addItem(this.emos.length),
            this.btn_chat.disabled = !1,
            this.me.x = 1903
        }
        ,
        t.prototype.render_item = function(t) {
            var e = this
              , i = t.index
              , n = t.container
              , a = this.emos[i]
              , r = n.getChildByName("btn");
            r.skin = game.LoadMgr.getResImageSkin(a.path),
            this.allgray ? game.Tools.setGrayDisable(r, !0) : (game.Tools.setGrayDisable(r, !1),
            r.clickHandler = Laya.Handler.create(this, function() {
                GameMgr.Inst.BehavioralStatistics(22),
                app.NetAgent.sendReq2MJ("FastTest", "broadcastInGame", {
                    content: JSON.stringify({
                        emo: a.sub_id
                    }),
                    except_self: !1
                }, function(t, e) {}),
                e.change_all_gray(!0),
                Laya.timer.once(4e3, e, function() {
                    e.change_all_gray(!1)
                }),
                e.switchShow()
            }, null, !1))
        }
        ,
        t.prototype.change_all_gray = function(t) {
            this.allgray = t,
            this.scrollview.wantToRefreshAll()
        }
        ,
        t.prototype.switchShow = function() {
            var t = this
              , e = 0;
            e = this.me.x < 1600 ? 1903 : 1382,
            Laya.Tween.to(this.me, {
                x: e
            }, 200, Laya.Ease.strongOut, Laya.Handler.create(this, function() {
                t.btn_chat.disabled = !1
            }), 0, !0, !0),
            this.btn_chat.disabled = !0
        }
        ,
        t
    }()
      , r = function(r) {
        function s() {
            var t = r.call(this, new ui.mj.desktopInfoUI) || this;
            return t.container_doras = null,
            t.doras = [],
            t.label_md5 = null,
            t.container_gamemode = null,
            t.label_gamemode = null,
            t.btn_auto_moqie = null,
            t.btn_auto_nofulu = null,
            t.btn_auto_hule = null,
            t.img_zhenting = null,
            t.btn_double_pass = null,
            t._network_delay = null,
            t._timecd = null,
            t._player_infos = [],
            t._container_fun = null,
            t.showscoredeltaing = !1,
            t.arrow = null,
            t._btn_leave = null,
            t._btn_fanzhong = null,
            t.block_emo = null,
            app.NetAgent.AddListener2MJ("NotifyGameBroadcast", Laya.Handler.create(t, function(e) {
                t.onGameBroadcast(e)
            })),
            app.NetAgent.AddListener2MJ("NotifyPlayerConnectionState", Laya.Handler.create(t, function(e) {
                t.onPlayerConnectionState(e)
            })),
            t
        }
        return __extends(s, r),
        s.prototype.onCreate = function() {
            var r = this;
            s.Inst = this,
            this.doras = new Array;
            var o = this.me.getChildByName("container_lefttop")
              , l = o.getChildByName("container_doras");
            this.container_doras = l,
            this.container_gamemode = o.getChildByName("gamemode"),
            this.label_gamemode = this.container_gamemode.getChildByName("lb_mode"),
            this.label_md5 = o.getChildByName("MD5"),
            o.getChildByName("btn_md5change").clickHandler = Laya.Handler.create(this, function() {
                if (r.label_md5.visible)
                    Laya.timer.clearAll(r.label_md5),
                    r.label_md5.visible = !1,
                    r.container_doras.visible = !0;
                else {
                    r.label_md5.visible = !0,
                    r.label_md5.text = game.Tools.strOfLocalization(2048) + view.DesktopMgr.Inst.md5,
                    r.container_doras.visible = !1;
                    var t = r;
                    Laya.timer.once(5e3, r.label_md5, function() {
                        t.label_md5.visible = !1,
                        t.container_doras.visible = !0
                    })
                }
            }, null, !1);
            for (h = 0; h < l.numChildren; h++)
                this.doras.push(l.getChildAt(h));
            for (var h = 0; h < 4; h++) {
                var c = this.me.getChildByName("container_player_" + h)
                  , u = {};
                u.container = c,
                u.head = new t.UI_Head(c.getChildByName("head")),
                u.face = c.getChildByName("head").getChildAt(0).getChildAt(0),
                u.face.visible = !1,
                u.name = c.getChildByName("container_name").getChildByName("label_name"),
                u.container_shout = c.getChildByName("container_shout"),
                u.container_shout.visible = !1,
                u.illust = u.container_shout.getChildByName("illust").getChildByName("illust"),
                u.illustrect = t.UIRect.CreateFromSprite(u.illust),
                u.shout_origin_x = u.container_shout.x,
                u.shout_origin_y = u.container_shout.y,
                u.container_emo = c.getChildByName("chat_bubble"),
                u.emo = new t.UI_Character_Emo(u.container_emo.getChildByName("content")),
                u.container_emo.visible = !1,
                u.disconnect = c.getChildByName("head").getChildAt(0).getChildByName("disconnect"),
                u.disconnect.visible = !1,
                u.title = new t.UI_PlayerTitle(c.getChildByName("title")),
                0 == h ? c.getChildByName("btn_seeinfo").clickHandler = Laya.Handler.create(this, function() {
                    r.btn_seeinfo(0)
                }, null, !1) : u.headbtn = new n(c.getChildByName("btn_head"),h),
                this._player_infos.push(u)
            }
            this._timecd = new e(this.me.getChildByName("container_countdown")),
            this.img_zhenting = this.me.getChildByName("img_zhenting"),
            this.img_zhenting.visible = !1,
            this._initFunc(),
            this.block_emo = new a(this.me.getChildByName("container_chat_choose")),
            this.me.getChildByName("btn_change_score").clickHandler = Laya.Handler.create(this, this.onBtnShowScoreDelta, null, !1),
            this._btn_leave = this.me.getChildByName("container_righttop").getChildByName("btn_leave"),
            this.me.getChildByName("container_righttop").getChildByName("btn_leave").clickHandler = Laya.Handler.create(this, function() {
                view.DesktopMgr.Inst.mode == view.EMJMode.play ? view.DesktopMgr.Inst.gameing && t.UI_SecondConfirm.Inst.show(game.Tools.strOfLocalization(21), Laya.Handler.create(r, function() {
                    if (view.DesktopMgr.Inst.gameing) {
                        for (var t = 0, e = 0; e < view.DesktopMgr.Inst.player_datas.length; e++) {
                            var i = view.DesktopMgr.Inst.player_datas[e];
                            i && null != i.account_id && 0 != i.account_id && t++
                        }
                        1 == t ? app.NetAgent.sendReq2MJ("FastTest", "terminateGame", {}, function(t, e) {
                            game.Scene_MJ.Inst.GameEnd()
                        }) : game.Scene_MJ.Inst.ForceOut()
                    }
                })) : game.Scene_MJ.Inst.ForceOut()
            }, null, !1),
            this.me.getChildByName("container_righttop").getChildByName("btn_set").clickHandler = Laya.Handler.create(this, function() {
                t.UI_Config.Inst.show()
            }, null, !1),
            this._btn_fanzhong = this.me.getChildByName("container_righttop").getChildByName("btn_fanzhong"),
            this._btn_fanzhong.clickHandler = Laya.Handler.create(this, function() {
                t.UI_Rules.Inst.show()
            }, null, !1),
            this.btn_double_pass = this.me.getChildByName("btn_double_pass"),
            this.btn_double_pass.visible = !1;
            var _ = 0;
            this.btn_double_pass.clickHandler = Laya.Handler.create(this, function() {
                if (view.DesktopMgr.double_click_pass) {
                    var e = Laya.timer.currTimer;
                    if (_ + 300 > e) {
                        if (t.UI_ChiPengHu.Inst.enable)
                            t.UI_ChiPengHu.Inst.onDoubleClick();
                        else {
                            var i = view.DesktopMgr.Inst.mainrole.can_discard;
                            t.UI_LiQiZiMo.Inst.enable && (i = t.UI_LiQiZiMo.Inst.onDoubleClick(i)),
                            i && view.DesktopMgr.Inst.mainrole.onDoubleClick()
                        }
                        _ = 0
                    } else
                        _ = e
                }
            }, null, !1),
            this._network_delay = new i(this.me.getChildByName("img_signal"))
        }
        ,
        s.prototype.onGameBroadcast = function(t) {
            app.Log.log("NotifyGameBroadcast " + JSON.stringify(t));
            var e = view.DesktopMgr.Inst.seat2LocalPosition(t.seat)
              , i = JSON.parse(t.content);
            null != i.emo && void 0 != i.emo && this.onShowEmo(e, i.emo)
        }
        ,
        s.prototype.onPlayerConnectionState = function(t) {
            app.Log.log("NotifyPlayerConnectionState msg: " + JSON.stringify(t));
            var e = t.seat;
            if (view.DesktopMgr.player_link_state || (view.DesktopMgr.player_link_state = [view.ELink_State.NULL, view.ELink_State.NULL, view.ELink_State.NULL, view.ELink_State.NULL]),
            view.DesktopMgr.player_link_state && e < view.DesktopMgr.player_link_state.length && (view.DesktopMgr.player_link_state[e] = t.state),
            this.enable) {
                var i = view.DesktopMgr.Inst.seat2LocalPosition(e);
                this._player_infos[i].disconnect.visible = t.state != view.ELink_State.READY
            }
        }
        ,
        s.prototype._initFunc = function() {
            var t = this;
            this._container_fun = this.me.getChildByName("container_func");
            var e = this._container_fun.getChildByName("btn_func")
              , i = this._container_fun.getChildByName("btn_func2");
            e.clickHandler = i.clickHandler = new Laya.Handler(this,function() {
                var i = 0;
                t._container_fun.x < -400 ? (i = -274,
                t.arrow.scaleX = 1) : (i = -528,
                t.arrow.scaleX = -1),
                Laya.Tween.to(t._container_fun, {
                    x: i
                }, 200, Laya.Ease.strongOut, Laya.Handler.create(t, function() {
                    e.disabled = !1
                }), 0, !0, !0),
                e.disabled = !0
            }
            ,null,!1);
            var n = this._container_fun.getChildByName("btn_autolipai")
              , a = this._container_fun.getChildByName("btn_autolipai2");
            this.refreshFuncBtnShow(n, !0),
            n.clickHandler = a.clickHandler = Laya.Handler.create(this, function() {
                view.DesktopMgr.Inst.setAutoLiPai(!view.DesktopMgr.Inst.auto_liqi),
                t.refreshFuncBtnShow(n, view.DesktopMgr.Inst.auto_liqi),
                Laya.LocalStorage.setItem("autolipai", view.DesktopMgr.Inst.auto_liqi ? "true" : "false")
            }, null, !1);
            var r = this._container_fun.getChildByName("btn_autohu")
              , s = this._container_fun.getChildByName("btn_autohu2");
            this.refreshFuncBtnShow(r, !1),
            r.clickHandler = s.clickHandler = Laya.Handler.create(this, function() {
                view.DesktopMgr.Inst.setAutoHule(!view.DesktopMgr.Inst.auto_hule),
                t.refreshFuncBtnShow(r, view.DesktopMgr.Inst.auto_hule)
            }, null, !1);
            var o = this._container_fun.getChildByName("btn_autonoming")
              , l = this._container_fun.getChildByName("btn_autonoming2");
            this.refreshFuncBtnShow(o, !1),
            o.clickHandler = l.clickHandler = Laya.Handler.create(this, function() {
                view.DesktopMgr.Inst.setAutoNoFulu(!view.DesktopMgr.Inst.auto_nofulu),
                t.refreshFuncBtnShow(o, view.DesktopMgr.Inst.auto_nofulu)
            }, null, !1);
            var h = this._container_fun.getChildByName("btn_automoqie")
              , c = this._container_fun.getChildByName("btn_automoqie2");
            this.refreshFuncBtnShow(h, !1),
            h.clickHandler = c.clickHandler = Laya.Handler.create(this, function() {
                view.DesktopMgr.Inst.setAutoMoQie(!view.DesktopMgr.Inst.auto_moqie),
                t.refreshFuncBtnShow(h, view.DesktopMgr.Inst.auto_moqie)
            }, null, !1),
            Laya.Browser.onPC && !GameMgr.inConch ? (e.visible = !1,
            s.visible = !0,
            a.visible = !0,
            l.visible = !0,
            c.visible = !0) : (e.visible = !0,
            s.visible = !1,
            a.visible = !1,
            l.visible = !1,
            c.visible = !1),
            this.arrow = this._container_fun.getChildByName("arrow"),
            this.arrow.scaleX = -1
        }
        ,
        s.prototype.noAutoLipai = function() {
            var t = this._container_fun.getChildByName("btn_autolipai");
            view.DesktopMgr.Inst.auto_liqi = !0,
            t.clickHandler.run()
        }
        ,
        s.prototype.resetFunc = function() {
            var t = Laya.LocalStorage.getItem("autolipai")
              , e = !0;
            e = !t || "" == t || "true" == t;
            var i = this._container_fun.getChildByName("btn_autolipai");
            this.refreshFuncBtnShow(i, e),
            Laya.LocalStorage.setItem("autolipai", e ? "true" : "false"),
            view.DesktopMgr.Inst.setAutoLiPai(e);
            var n = this._container_fun.getChildByName("btn_autohu");
            this.refreshFuncBtnShow(n, view.DesktopMgr.Inst.auto_hule);
            var a = this._container_fun.getChildByName("btn_autonoming");
            this.refreshFuncBtnShow(a, view.DesktopMgr.Inst.auto_nofulu);
            var r = this._container_fun.getChildByName("btn_automoqie");
            this.refreshFuncBtnShow(r, view.DesktopMgr.Inst.auto_moqie),
            this._container_fun.x = -528,
            this.arrow.scaleX = -1
        }
        ,
        s.prototype.setDora = function(t, e) {
            if (t < 0 || t >= this.doras.length)
                console.error("setDora pos错误");
            else {
                var i = "myres2/mjp/" + GameMgr.Inst.mjp_view + "/ui/";
                this.doras[t].skin = game.Tools.localUISrc(i + e.toString() + ".png")
            }
        }
        ,
        s.prototype.initRoom = function() {
            var t = this;
            if (view.DesktopMgr.Inst.mode == view.EMJMode.play || view.DesktopMgr.Inst.mode == view.EMJMode.live_broadcast) {
                for (var e = {}, i = 0; i < view.DesktopMgr.Inst.player_datas.length; i++) {
                    for (var n = view.DesktopMgr.Inst.player_datas[i].character, a = n.charid, r = cfg.item_definition.character.find(a).emo, s = 0; s < 9; s++) {
                        e[o = r + "/" + s.toString() + ".png"] = 1
                    }
                    if (n.extra_emoji)
                        for (s = 0; s < n.extra_emoji.length; s++) {
                            var o = r + "/" + n.extra_emoji[s].toString() + ".png";
                            e[o] = 1
                        }
                }
                var l = [];
                for (var h in e)
                    l.push(h);
                game.LoadMgr.loadResImage(l, Laya.Handler.create(this, function() {
                    t.block_emo.initRoom()
                }))
            }
            if (this._btn_leave.visible = !0,
            this._btn_fanzhong.visible = !1,
            view.DesktopMgr.Inst.mode == view.EMJMode.play) {
                for (var c = 0, i = 0; i < view.DesktopMgr.Inst.player_datas.length; i++) {
                    (u = view.DesktopMgr.Inst.player_datas[i]) && null != u.account_id && 0 != u.account_id && c++
                }
                (c > 1 || 4 == view.DesktopMgr.Inst.game_config.category) && (this._btn_leave.visible = !1,
                this._btn_fanzhong.visible = !0)
            }
            for (i = 0; i < view.DesktopMgr.Inst.player_datas.length; i++) {
                var u = view.DesktopMgr.Inst.player_datas[i];
                u && null != u.account_id && 0 != u.account_id && 0
            }
            if (this.block_emo.me.visible = view.DesktopMgr.Inst.mode == view.EMJMode.play,
            this._container_fun.visible = view.DesktopMgr.Inst.mode == view.EMJMode.play,
            this.enable = !0,
            this.setLiqibang(0),
            this.setBen(0),
            view.DesktopMgr.Inst.game_config) {
                var _ = view.DesktopMgr.Inst.game_config
                  , d = game.Tools.get_room_desc(_);
                this.label_gamemode.text = d.text,
                this.container_gamemode.visible = !0
            } else
                this.container_gamemode.visible = !1;
            this.btn_double_pass.visible = view.DesktopMgr.Inst.mode == view.EMJMode.play,
            view.DesktopMgr.Inst.mode == view.EMJMode.play ? (this._network_delay.begin_refresh(),
            this._network_delay.me.visible = !0) : this._network_delay.me.visible = !1
        }
        ,
        s.prototype.onCloseRoom = function() {
            this._network_delay.close_refresh()
        }
        ,
        s.prototype.refreshSeat = function(t) {
            void 0 === t && (t = !1);
            view.DesktopMgr.Inst.seat;
            for (var e = view.DesktopMgr.Inst.player_datas, i = 0; i < 4; i++) {
                var n = view.DesktopMgr.Inst.localPosition2Seat(i)
                  , a = this._player_infos[i];
                if (n < 0)
                    a.container.visible = !1;
                else {
                    if (a.container.visible = !0,
                    a.name.text = e[n].nickname,
                    a.head.id = e[n].avatar_id,
                    a.avatar = e[n].avatar_id,
                    a.head.setEmo(""),
                    0 != i) {
                        var r = e[n].account_id && 0 != e[n].account_id && view.DesktopMgr.Inst.mode != view.EMJMode.paipu
                          , s = e[n].account_id && 0 != e[n].account_id && view.DesktopMgr.Inst.mode == view.EMJMode.play
                          , o = view.DesktopMgr.Inst.mode != view.EMJMode.play;
                        t ? a.headbtn.onChangeSeat(r, s, o) : a.headbtn.reset(r, s, o)
                    }
                    e[n].title ? a.title.id = game.Tools.titleLocalization(e[n].account_id, e[n].title) : a.title.id = 0
                }
            }
        }
        ,
        s.prototype.refreshLinks = function() {
            view.DesktopMgr.Inst.seat;
            for (var t = 0; t < 4; t++) {
                var e = view.DesktopMgr.Inst.localPosition2Seat(t);
                view.DesktopMgr.Inst.mode == view.EMJMode.play ? this._player_infos[t].disconnect.visible = -1 != e && 0 != t && view.DesktopMgr.player_link_state[e] != view.ELink_State.READY : view.DesktopMgr.Inst.mode == view.EMJMode.live_broadcast ? -1 == e || 0 == view.DesktopMgr.Inst.player_datas[e].account_id ? this._player_infos[t].disconnect.visible = !1 : this._player_infos[t].disconnect.visible = view.DesktopMgr.player_link_state[e] != view.ELink_State.READY : view.DesktopMgr.Inst.mode == view.EMJMode.paipu && (this._player_infos[t].disconnect.visible = !1)
            }
        }
        ,
        s.prototype.setBen = function(t) {
            t > 99 && (t = 99);
            var e = this.me.getChildByName("container_lefttop")
              , i = e.getChildByName("num_ben_0")
              , n = e.getChildByName("num_ben_1");
            t >= 10 ? (i.skin = game.Tools.localUISrc("myres/mjdesktop/w_" + Math.floor(t / 10).toString() + ".png"),
            n.skin = game.Tools.localUISrc("myres/mjdesktop/w_" + (t % 10).toString() + ".png"),
            n.visible = !0) : (i.skin = game.Tools.localUISrc("myres/mjdesktop/w_" + (t % 10).toString() + ".png"),
            n.visible = !1)
        }
        ,
        s.prototype.setLiqibang = function(t) {
            t > 99 && (t = 99);
            var e = this.me.getChildByName("container_lefttop")
              , i = e.getChildByName("num_lizhi_0")
              , n = e.getChildByName("num_lizhi_1");
            t >= 10 ? (n.skin = game.Tools.localUISrc("myres/mjdesktop/w_" + (t % 10).toString() + ".png"),
            i.skin = game.Tools.localUISrc("myres/mjdesktop/w_" + Math.floor(t / 10).toString() + ".png"),
            n.visible = !0) : (i.skin = game.Tools.localUISrc("myres/mjdesktop/w_" + t.toString() + ".png"),
            n.visible = !1)
        }
        ,
        s.prototype.reset_rounds = function() {
            this.closeCountDown(),
            this.showscoredeltaing = !1,
            view.DesktopMgr.Inst.setScoreDelta(!1);
            for (var t = "myres2/mjp/" + GameMgr.Inst.mjp_view + "/ui/", e = 0; e < this.doras.length; e++)
                this.doras[e].skin = game.Tools.localUISrc(t + "back.png");
            for (e = 0; e < 4; e++)
                this._player_infos[e].container_emo.visible = !1,
                this._player_infos[e].head.setEmo("");
            this._timecd.reset(),
            Laya.timer.clearAll(this),
            Laya.timer.clearAll(this.label_md5),
            this.container_doras.visible = !0,
            this.label_md5.visible = !1
        }
        ,
        s.prototype.showCountDown = function(t, e) {
            this._timecd.showCD(t, e)
        }
        ,
        s.prototype.setZhenting = function(t) {
            this.img_zhenting.visible = t
        }
        ,
        s.prototype.shout = function(t, e, i) {
            app.Log.log("shout:" + t + " type:" + e);
            try {
                var n = this._player_infos[t]
                  , a = n.container_shout
                  , r = a.getChildByName("img_content")
                  , s = a.getChildByName("illust").getChildByName("illust");
                "" == e ? r.visible = !1 : (r.visible = !0,
                r.skin = game.Tools.localUISrc("myres/mjdesktop/shout_" + e + ".png")),
                game.Tools.charaPart(i.avatar_id, s, "half", n.illustrect);
                var o = 0
                  , l = 0;
                switch (t) {
                case 0:
                    o = -105,
                    l = 0;
                    break;
                case 1:
                    o = 500,
                    l = 0;
                    break;
                case 2:
                    o = 0,
                    l = -300;
                    break;
                default:
                    o = -500,
                    l = 0
                }
                a.visible = !0,
                a.alpha = 0,
                a.x = n.shout_origin_x + o,
                a.y = n.shout_origin_y + l,
                Laya.Tween.to(a, {
                    alpha: 1,
                    x: n.shout_origin_x,
                    y: n.shout_origin_y
                }, 70),
                Laya.Tween.to(a, {
                    alpha: 0
                }, 150, null, null, 600),
                Laya.timer.once(800, this, function() {
                    Laya.loader.clearTextureRes(s.skin),
                    a.visible = !1
                })
            } catch (t) {
                var h = {};
                h.error = t.message,
                h.stack = t.stack,
                h.method = "shout",
                h.class = "UI_DesktopInfos",
                GameMgr.Inst.onFatalError(h)
            }
        }
        ,
        s.prototype.closeCountDown = function() {
            this._timecd.close()
        }
        ,
        s.prototype.refreshFuncBtnShow = function(t, e) {
            var i = t.getChildByName("img_choosed");
            t.getChildByName("out").color = e ? "#3bd647" : "#7992b3",
            i.visible = e
        }
        ,
        s.prototype.onShowEmo = function(t, e) {
            var i = this._player_infos[t];
            if (0 == t || !i.headbtn.emj_banned) {
                var n = i.container_emo
                  , a = view.DesktopMgr.Inst.player_datas[view.DesktopMgr.Inst.localPosition2Seat(t)].character.charid;
                i.emo.setSkin(a, e),
                n.visible = !0,
                n.scaleX = n.scaleY = 0,
                Laya.Tween.to(n, {
                    scaleX: 1,
                    scaleY: 1
                }, 120, null, null, 0, !0, !0),
                Laya.timer.once(3e3, this, function() {
                    Laya.Tween.to(n, {
                        scaleX: 0,
                        scaleY: 0
                    }, 120, null, null, 0, !0, !0)
                }),
                Laya.timer.once(3500, this, function() {
                    n.visible = !1
                })
            }
        }
        ,
        s.prototype.changeHeadEmo = function(t, e, i) {
            var n = view.DesktopMgr.Inst.seat2LocalPosition(t);
            this._player_infos[n]
        }
        ,
        s.prototype.onBtnShowScoreDelta = function() {
            var t = this;
            this.showscoredeltaing || (this.showscoredeltaing = !0,
            view.DesktopMgr.Inst.setScoreDelta(!0),
            Laya.timer.once(5e3, this, function() {
                t.showscoredeltaing = !1,
                view.DesktopMgr.Inst.setScoreDelta(!1)
            }))
        }
        ,
        s.prototype.btn_seeinfo = function(e) {
            if (view.DesktopMgr.Inst.mode != view.EMJMode.paipu && view.DesktopMgr.Inst.gameing) {
                var i = view.DesktopMgr.Inst.player_datas[view.DesktopMgr.Inst.localPosition2Seat(e)].account_id;
                0 != i && t.UI_OtherPlayerInfo.Inst.show(i)
            }
        }
        ,
        s.Inst = null,
        s
    }(t.UIBase);
    t.UI_DesktopInfo = r
}(uiscript || (uiscript = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), uiscript;
!function(t) {
    var e = function(e) {
        function i() {
            var t = e.call(this, new ui.common.disconnectUI) || this;
            return t.root = null,
            t.txt_info = null,
            t.txt_dot = null,
            t.state = 0,
            t.count = 0,
            i.Inst = t,
            t
        }
        return __extends(i, e),
        i.prototype.onCreate = function() {
            this.root = this.me.getChildByName("root"),
            this.txt_info = this.root.getChildByName("text"),
            this.txt_dot = this.root.getChildByName("text_dot")
        }
        ,
        i.prototype.show = function() {
            1 == this.state || (0 == this.state ? (this.enable = !0,
            Laya.timer.clearAll(this),
            this.refreshInfo(),
            t.UIBase.anim_pop_out(this.root, null),
            Laya.timer.loop(500, this, this.refreshInfo)) : 2 == this.state ? (Laya.timer.clearAll(this),
            this.refreshInfo(),
            Laya.timer.loop(500, this, this.refreshInfo)) : 3 == this.state && (Laya.timer.clearAll(this),
            this.refreshInfo(),
            this.root.scaleX = 1,
            this.root.scaleY = 1,
            this.root.alpha = 1,
            t.UIBase.anim_pop_out(this.root, null),
            Laya.timer.loop(500, this, this.refreshInfo))),
            this.state = 1,
            t.UIMgr.Inst.disableMouse()
        }
        ,
        i.prototype.hide = function() {
            var e = this;
            this.state = 2,
            Laya.timer.clearAll(this),
            Laya.timer.once(1e3, this, function() {
                e.state = 3,
                t.UIBase.anim_pop_hide(e.root, Laya.Handler.create(e, function() {
                    e.state = 0,
                    e.enable = !1,
                    t.UIMgr.Inst.enableMouse()
                }))
            })
        }
        ,
        i.prototype.refreshInfo = function() {
            this.count = (this.count + 1) % 4;
            for (var t = "", e = 0; e < this.count; e++)
                t += ".";
            game.LobbyNetMgr.Inst.connect_state == game.EConnectState.disconnect ? (this.txt_info.text = game.Tools.strOfLocalization(2049),
            this.txt_dot.text = "") : game.LobbyNetMgr.Inst.connect_state == game.EConnectState.reconnecting ? (this.txt_info.text = game.Tools.strOfLocalization(2050),
            this.txt_dot.text = t) : game.LobbyNetMgr.Inst.connect_state == game.EConnectState.none || game.LobbyNetMgr.Inst.connect_state == game.EConnectState.tryconnect ? (this.txt_info.text = game.Tools.strOfLocalization(2051),
            this.txt_dot.text = "") : game.LobbyNetMgr.Inst.connect_state == game.EConnectState.connecting && (game.MJNetMgr.Inst.connect_state == game.EConnectState.none || game.MJNetMgr.Inst.connect_state == game.EConnectState.tryconnect || game.MJNetMgr.Inst.connect_state == game.EConnectState.connecting ? (this.txt_info.text = game.Tools.strOfLocalization(2052),
            this.txt_dot.text = "",
            this.hide()) : game.MJNetMgr.Inst.connect_state == game.EConnectState.disconnect ? (this.txt_info.text = game.Tools.strOfLocalization(2049),
            this.txt_dot.text = "") : game.MJNetMgr.Inst.connect_state == game.EConnectState.reconnecting && (this.txt_info.text = game.Tools.strOfLocalization(2050),
            this.txt_dot.text = t))
        }
        ,
        i.Inst = null,
        i
    }(t.UIBase);
    t.UI_Disconnect = e
}(uiscript || (uiscript = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), uiscript;
!function(t) {
    var e = function() {
        function t(e) {
            this.me = e,
            t.scene_entrance = "jp" == GameMgr.client_language ? "scene/entrance_jp.ls" : "en" == GameMgr.client_language ? "scene/entrance_en.ls" : "scene/entrance.ls"
        }
        return t.prototype.show = function() {
            this.scene = Laya.loader.getRes(t.scene_entrance),
            this.me.addChild(this.scene),
            this.scene.visible = !0
        }
        ,
        t.prototype.close = function() {
            Laya.timer.clearAll(this),
            this.scene.visible = !1,
            this.scene.destroy(!0)
        }
        ,
        t.scene_entrance = "",
        t
    }()
      , i = function() {
        function e(e, i) {
            var n = this;
            this.btn_cd = 0,
            this.root = e,
            this.connect_loading = i,
            this.connect_loading.visible = !1,
            this.round = this.connect_loading.getChildByName("loading").getChildByName("round"),
            this.content = this.root.getChildByName("content");
            var a = function(t) {
                var e = {
                    container: t,
                    input: t.getChildByName("txtinput"),
                    lb: t.getChildByName("lb"),
                    yes: t.getChildByName("yes"),
                    no: t.getChildByName("no")
                };
                return e.input.text = "",
                e.lb.visible = !0,
                e.yes.visible = !1,
                e.no.visible = !1,
                e.input.on("focus", n, function() {
                    e.lb.visible = !1,
                    e.yes.visible = !1,
                    e.no.visible = !1
                }),
                e.input.on("blur", n, function() {
                    e.lb.visible = !e.input.text || "" == e.input.text
                }),
                e.input.on("input", n, function() {}),
                e
            };
            this.account = a(this.content.getChildByName("container_account")),
            this.password0 = a(this.content.getChildByName("container_mima")),
            this.password1 = a(this.content.getChildByName("container_mima2")),
            this.btn_close = this.content.getChildByName("btn_close"),
            this.btn_close.clickHandler = Laya.Handler.create(this, function() {
                n.locking || n.close()
            }, null, !1),
            this.btn_regist = this.content.getChildByName("btn_regist"),
            this.btn_regist.clickHandler = Laya.Handler.create(this, function() {
                n.locking || n.onRegist()
            }, null, !1),
            this.root.visible = !1,
            this.locking = !1,
            this.container_social = this.content.getChildByName("social"),
            "chs" == GameMgr.client_language && (this.container_social.x = 15,
            this.container_social.y = 475),
            this.social_btns = [];
            for (l = 0; l < 4; l++)
                this.social_btns.push(this.container_social.getChildByName("btn" + l)),
                this.social_btns[l].visible = !1;
            var r = [];
            "chs" == GameMgr.client_language && (r = [{
                img: "myres/entrance/weibo.png",
                type: 2
            }, {
                img: "myres/entrance/QQ.png",
                type: 3
            }, {
                img: "myres/entrance/weixin.png",
                type: 1
            }]),
            "jp" == GameMgr.client_language && (r = [{
                img: "myres/entrance/google.png",
                type: 8
            }, {
                img: "myres/entrance/tiwtter.png",
                type: 10
            }]),
            "en" == GameMgr.client_language && (r = [{
                img: "myres/entrance/google.png",
                type: 8
            }, {
                img: "myres/entrance/facebook.png",
                type: 9
            }, {
                img: "myres/entrance/tiwtter.png",
                type: 10
            }]);
            for (var s = function(t) {
                var e = o.social_btns[t];
                t < r.length ? (e.visible = !0,
                e.getChildAt(0).skin = game.Tools.localUISrc(r[t].img),
                e.clickHandler = new Laya.Handler(o,function() {
                    h.trySocio(r[t].type)
                }
                ),
                e.x = 465 * t / (r.length - 1) - 40) : e.visible = !1
            }, o = this, l = 0; l < r.length; l++)
                s(l);
            (r.length = 2) && (this.social_btns[0].x = 115,
            this.social_btns[1].x = 270),
            this.container_checkbox = this.content.getChildByName("checkbox"),
            this.checkbox = this.container_checkbox.getChildByName("checkbox"),
            this.container_checkbox.getChildByName("btn_lock").clickHandler = Laya.Handler.create(this, function() {
                t.UI_User_Xieyi.Inst.show(Laya.Handler.create(n, function() {
                    n.onchangecheck(!0)
                }))
            }, null, !1),
            this.container_checkbox.getChildByName("btn_check").clickHandler = Laya.Handler.create(this, function() {
                n.onchangecheck(!n.checkbox.visible)
            }, null, !1)
        }
        return e.prototype.close = function() {
            var e = this;
            this.locking = !0,
            t.UIBase.anim_pop_hide(this.content, Laya.Handler.create(this, function() {
                e.locking = !1,
                e.root.visible = !1
            })),
            Laya.timer.clearAll(this)
        }
        ,
        e.prototype.show = function() {
            var e = this;
            this.root.visible = !0,
            this.locking = !0,
            this.btn_cd = 0,
            t.UIBase.anim_pop_out(this.content, Laya.Handler.create(this, function() {
                e.locking = !1
            })),
            this.account.input.text = "",
            this.account.lb.visible = !0,
            this.account.yes.visible = !1,
            this.account.no.visible = !1,
            this.password0.input.text = "",
            this.password0.lb.visible = !0,
            this.password0.yes.visible = !1,
            this.password0.no.visible = !1,
            this.password1.input.text = "",
            this.password1.lb.visible = !0,
            this.password1.yes.visible = !1,
            this.password1.no.visible = !1,
            this.account.container.visible = !0,
            this.password0.container.visible = !0,
            this.password1.container.visible = !0,
            this.connect_loading.visible = !1;
            var i = Laya.timer.currTimer;
            Laya.timer.frameLoop(1, this, function() {
                e.round.rotation = (Laya.timer.currTimer - i) / 2e3 * 360
            }),
            this.onchangecheck(!0)
        }
        ,
        e.prototype.onRegist = function() {
            var t = this;
            if (!(Laya.timer.currTimer < this.btn_cd)) {
                var e = this.account.input.text
                  , i = this.password0.input.text
                  , n = this.password1.input.text;
                e.length < 1 ? this.account.no.visible = !0 : h.Accountforbidden(e) ? this.account.no.visible = !0 : !i || i.length < 6 ? this.password0.no.visible = !0 : n == i ? (this.btn_cd = Laya.timer.currTimer + 800,
                game.LobbyNetMgr.Inst.isOK && h.Inst.server_region_name == game.LobbyNetMgr.gateway_region_name ? h.Inst._try_regist_account(e, i) : (this.account.container.visible = !1,
                this.password0.container.visible = !1,
                this.password1.container.visible = !1,
                this.connect_loading.visible = !0,
                Laya.timer.once(500, this, function() {
                    game.LobbyNetMgr.Inst.OpenConnect(h.Inst.server_region_name, Laya.Handler.create(t, function(n) {
                        n.open ? h.Inst._try_regist_account(e, i) : n.maintenance ? h.Inst.showMaintenance(n.maintenance) : h.Inst.showInfo(n.info),
                        t.account.container.visible = !0,
                        t.password0.container.visible = !0,
                        t.password1.container.visible = !0,
                        t.connect_loading.visible = !1
                    }))
                }))) : this.password1.no.visible = !0
            }
        }
        ,
        e.prototype.onchangecheck = function(t) {
            this.checkbox.visible = t,
            this.btn_regist.visible = t,
            this.container_social.visible = t
        }
        ,
        e
    }()
      , n = function() {
        function e(t) {
            var e = this;
            this.me = t,
            this.root = this.me.getChildByName("container"),
            this.info = this.root.getChildByName("text"),
            this.me.visible = !1,
            this.root.getChildByName("btn").clickHandler = Laya.Handler.create(this, function() {
                e.close()
            }, null, !1)
        }
        return e.prototype.show = function(e, i) {
            this.info.text = e,
            this.me.visible = !0,
            this.root.getChildByName("einfo").text = i ? app.Log.getCacheLog() : "",
            t.UIBase.anim_pop_out(this.root, null)
        }
        ,
        e.prototype.close = function() {
            var e = this;
            t.UIBase.anim_pop_hide(this.root, Laya.Handler.create(this, function() {
                e.me.visible = !1
            }))
        }
        ,
        e
    }()
      , a = function() {
        function e(t) {
            var e = this;
            this.me = t,
            this.root = this.me.getChildByName("container"),
            this.info = this.root.getChildByName("text"),
            this.me.visible = !1,
            this.root.getChildByName("btn").clickHandler = Laya.Handler.create(this, function() {
                e.close()
            }, null, !1)
        }
        return e.prototype.show = function(e) {
            this.info.text = e,
            this.me.visible = !0,
            t.UIBase.anim_pop_out(this.root, null)
        }
        ,
        e.prototype.close = function() {
            var e = this;
            t.UIBase.anim_pop_hide(this.root, Laya.Handler.create(this, function() {
                e.me.visible = !1
            }))
        }
        ,
        e
    }()
      , r = function() {
        function e(t) {
            var e = this;
            this.me = t,
            this.root = this.me.getChildByName("container"),
            this.info = this.root.getChildByName("text"),
            this.me.visible = !1,
            this.root.getChildByName("btn").clickHandler = Laya.Handler.create(this, function() {
                e.close()
            }, null, !1)
        }
        return e.prototype.show = function(e) {
            this.info.text = e,
            this.me.visible = !0,
            t.UIBase.anim_pop_out(this.root, null)
        }
        ,
        e.prototype.close = function() {
            var e = this;
            t.UIBase.anim_pop_hide(this.root, Laya.Handler.create(this, function() {
                e.me.visible = !1
            }))
        }
        ,
        e
    }()
      , s = function() {
        function t(t) {
            this.me = t,
            this.round = this.me.getChildByName("round"),
            this.word = this.me.getChildByName("word"),
            this.icon = this.me.getChildByName("icon"),
            this.me.visible = !1
        }
        return t.prototype.show = function(t) {
            var e = this;
            if (!this.me.visible) {
                this.me.visible = !0;
                var i = Laya.timer.currTimer;
                if (Laya.timer.frameLoop(1, this, function() {
                    e.round.rotation = (Laya.timer.currTimer - i) / 2e3 * 360
                }),
                this.word.text = game.Tools.strOfLocalization(2053),
                0 == t)
                    this.icon.visible = !1,
                    this.word.y = 150;
                else
                    switch (this.icon.visible = !0,
                    this.word.y = 195,
                    t) {
                    case 1:
                    case 4:
                        this.icon.skin = game.Tools.localUISrc("myres/entrance/weixin.png");
                        break;
                    case 2:
                    case 5:
                        this.icon.skin = game.Tools.localUISrc("myres/entrance/weibo.png");
                        break;
                    case 3:
                    case 6:
                        this.icon.skin = game.Tools.localUISrc("myres/entrance/QQ.png");
                        break;
                    case 7:
                        this.icon.skin = game.Tools.localUISrc("myres/entrance/yostar.png");
                        break;
                    case 8:
                        this.icon.skin = game.Tools.localUISrc("myres/entrance/google.png");
                        break;
                    case 9:
                        this.icon.skin = game.Tools.localUISrc("myres/entrance/facebook.png");
                        break;
                    case 10:
                        this.icon.skin = game.Tools.localUISrc("myres/entrance/tiwtter.png");
                        break;
                    default:
                        this.icon.visible = !1
                    }
            }
        }
        ,
        t.prototype.close = function() {
            Laya.timer.clearAll(this),
            this.me.visible = !1
        }
        ,
        t
    }()
      , o = function() {
        function e(t) {
            var e = this;
            this.btns = [],
            this.me = t,
            this.root = this.me.getChildByName("container"),
            this.me.visible = !1,
            this.root.getChildByName("btn_close").clickHandler = Laya.Handler.create(this, function() {
                e.close()
            }, null, !1);
            for (var i = function(t) {
                var i = n.root.getChildByName("btn" + t);
                n.btns.push(i),
                i.clickHandler = new Laya.Handler(n,function() {
                    h.Inst.showServer(t),
                    e.close()
                }
                )
            }, n = this, a = 0; a < 2; a++)
                i(a)
        }
        return e.prototype.show = function() {
            this.me.visible = !0,
            t.UIBase.anim_pop_out(this.root, null),
            game.LobbyNetMgr.gateway_regions.mainland ? this.btns[0].visible = !0 : this.btns[0].visible = !1,
            this.btns[1].visible = !1
        }
        ,
        e.prototype.close = function() {
            var e = this;
            t.UIBase.anim_pop_hide(this.root, Laya.Handler.create(this, function() {
                e.me.visible = !1
            }))
        }
        ,
        e
    }()
      , l = function() {
        function e(e) {
            var i = this;
            this.saveflag = !0,
            this.locking = !1,
            this.last_mail_time = -1,
            this.me = e,
            this.me.visible = !1,
            this.root = this.me.getChildByName("jpenroot"),
            this.root.getChildByName("btn_close").clickHandler = Laya.Handler.create(this, function() {
                i.locking || i.close()
            }, null, !1),
            this.input_account = this.root.getChildByName("container_mail").getChildByName("txtinput"),
            this.label_account_no = this.root.getChildByName("container_mail").getChildByName("no"),
            this.input_account.on("input", this, function() {
                i.label_account_no.visible && (i.label_account_no.visible = !1),
                "" != i.input_code.text && "" != i.input_account.text && game.Tools.setGrayDisable(i.btn_regist, !1)
            }),
            this.input_code = this.root.getChildByName("container_yanzhengma").getChildByName("txtinput"),
            this.input_code.on("input", this, function() {
                "" != i.input_code.text && "" != i.input_account.text && game.Tools.setGrayDisable(i.btn_regist, !1)
            }),
            this.btn_getcode = this.root.getChildByName("sendbutton").getChildByName("btn"),
            this.btn_getcode.clickHandler = new Laya.Handler(this,function() {
                var t = i.input_account.text;
                /^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/.test(t) ? (Yo.request({
                    account: t,
                    lang: "jp" == GameMgr.client_language ? "ja" : "en"
                }).then(function(t) {
                    t ? 0 === t.result ? h.Inst.showInfo(game.Tools.strOfLocalization(2688)) : 50003 === t.result ? h.Inst.showError(game.Tools.strOfLocalization(2684)) : 50004 === t.result ? h.Inst.showError(game.Tools.strOfLocalization(2685)) : h.Inst.showError(game.Tools.strOfLocalization(2683)) : h.Inst.showError(game.Tools.strOfLocalization(2683))
                }),
                i.last_mail_time = Laya.timer.currTimer,
                i.refresh_code_state()) : i.label_account_no.visible = !0
            }
            ),
            this.btn_regist = this.root.getChildByName("btn_enter"),
            this.btn_regist.clickHandler = new Laya.Handler(this,function() {
                if (!i.locking) {
                    app.Log.log("btn mail login");
                    var t = i.input_account.text;
                    Yo.submit({
                        account: i.input_account.text,
                        code: i.input_code.text
                    }).then(function(e) {
                        e ? (app.Log.log("mail login submit result:" + e.result),
                        0 === e.result ? (game.LocalStorage.setItem("mail_account", t),
                        h.onSocioBack(7, e.token, e.uid)) : 50016 === e.result ? (h.Inst.showError(game.Tools.strOfLocalization(2686)),
                        h.Inst.showContainerLogin()) : 50009 === e.result ? (h.Inst.showError(game.Tools.strOfLocalization(2687)),
                        h.Inst.showContainerLogin()) : (h.Inst.showError(game.Tools.strOfLocalization(2689)),
                        h.Inst.showContainerLogin())) : (app.Log.log("mail login submit result: no"),
                        h.Inst.showError(game.Tools.strOfLocalization(2689)),
                        h.Inst.showContainerLogin())
                    }),
                    1 == i.saveflag ? (game.LocalStorage.setItem("useremail", i.input_account.text),
                    game.LocalStorage.setItem("saveflag", "true")) : (game.LocalStorage.setItem("useremail", ""),
                    game.LocalStorage.setItem("saveflag", "false")),
                    i.close(),
                    h.Inst.showLoginLoading(7)
                }
            }
            ),
            this.label_info = this.root.getChildByName("sendbutton").getChildByName("label");
            var n = this.root.getChildByName("checkxieyi");
            this.checkbox = n.getChildByName("checkbox"),
            n.getChildByName("btn_check").clickHandler = new Laya.Handler(this,function() {
                i.checkbox.visible = !i.checkbox.visible,
                i.btn_regist.visible = i.checkbox.visible
            }
            );
            var a;
            "jp" == GameMgr.client_language ? (n.getChildByName("en").visible = !1,
            a = n.getChildByName("jp")) : (n.getChildByName("jp").visible = !1,
            a = n.getChildByName("en")),
            n.getChildByName("btn_check").clickHandler = new Laya.Handler(this,function() {
                i.checkbox.visible = !i.checkbox.visible,
                i.btn_regist.visible = i.checkbox.visible
            }
            ),
            a.getChildByName("guize").clickHandler = Laya.Handler.create(this, function() {
                "jp" == GameMgr.client_language ? t.UI_User_Xieyi_enjp.Inst.show("docs/jp_liyongguiyue.txt") : "en" == GameMgr.client_language && t.UI_User_Xieyi_enjp.Inst.show("docs/term_of_service.txt")
            }, null, !1),
            a.getChildByName("yinsi").clickHandler = Laya.Handler.create(this, function() {
                "jp" == GameMgr.client_language ? t.UI_User_Xieyi_enjp.Inst.show("docs/jp_yinsixieyi.txt") : "en" == GameMgr.client_language && t.UI_User_Xieyi_enjp.Inst.show("docs/privacy_policy.txt")
            }, null, !1)
        }
        return e.prototype.onchangecheck = function(t) {
            this.checkbox.visible = t,
            this.btn_regist.visible = t,
            this.root.getChildByName("checkxieyi").visible = t
        }
        ,
        e.prototype.show = function() {
            var e = this;
            this.locking = !0,
            this.me.visible = !0,
            t.UIBase.anim_pop_out(this.root, Laya.Handler.create(this, function() {
                e.locking = !1
            })),
            this.input_account.text = "",
            this.label_account_no.visible = !1,
            this.input_code.text = "",
            this.checkbox.visible = !0,
            this.btn_regist.visible = !0;
            var i = game.LocalStorage.getItem("saveflag")
              , n = game.LocalStorage.getItem("useremail");
            "true" == i && (this.input_account.text = n,
            app.Log.log(n)),
            game.Tools.setGrayDisable(this.btn_regist, !0),
            Laya.timer.clearAll(this),
            this.refresh_code_state(),
            Laya.timer.loop(100, this, function() {
                e.refresh_code_state()
            })
        }
        ,
        e.prototype.refresh_code_state = function() {
            var t = 1e8;
            game.Tools.setGrayDisable(this.btn_getcode, !0),
            this.last_mail_time > 0 && (t = Laya.timer.currTimer - this.last_mail_time),
            t < 6e4 ? (this.label_info.underline = !1,
            t = Math.ceil((6e4 - t) / 1e3),
            this.label_info.text = game.Tools.strOfLocalization(2682, [t.toString()]),
            this.label_info.underline = !1,
            game.Tools.setGrayDisable(this.btn_getcode, !0)) : (this.label_info.text = game.Tools.strOfLocalization(2720),
            this.label_info.underline = !0,
            game.Tools.setGrayDisable(this.btn_getcode, !1))
        }
        ,
        e.prototype.close = function() {
            var e = this;
            this.locking = !0,
            t.UIBase.anim_pop_hide(this.root, Laya.Handler.create(this, function() {
                e.locking = !1,
                e.me.visible = !1,
                Laya.timer.clearAll(e)
            }))
        }
        ,
        e
    }()
      , h = function(h) {
        function c() {
            var t = h.call(this, new ui.entrance.entranceUI) || this;
            return t.scene = null,
            t.txt_account = null,
            t.txt_password = null,
            t.btn_login_cd = 0,
            t.login_loading = null,
            t.page_regist = null,
            t.page_maillogin = null,
            t.container_extendInfo = null,
            t._errorinfo = null,
            t._prohibitionInfo = null,
            t._maintenanceInfo = null,
            t.page_server = null,
            t.server_index = 0,
            t.xieyiflag = 0,
            c.Inst = t,
            t
        }
        return __extends(c, h),
        c.trySocio = function(t) {
            var e = Laya.LocalStorage.getItem("_pre_sociotype")
              , i = -1;
            e && "" != e && (i = parseInt(e));
            var n = !0;
            if (i === t)
                if (t >= 1 && t <= 6) {
                    var a = Laya.LocalStorage.getItem("_pre_code");
                    a && "" != a && (n = !1,
                    this.onSocioBack(t, a, null))
                } else if (7 == t)
                    ;
                else if (t >= 8 && t <= 10) {
                    var r = game.LocalStorage.getItem("yostar_token");
                    r || (r = "");
                    var s = game.LocalStorage.getItem("yostar_uid");
                    s || (s = ""),
                    "" != r && "" != s && (n = !1,
                    this.onSocioBack(t, r, s))
                }
            if (n)
                if (GameMgr.inConch) {
                    var o = Laya.PlatformClass.createClass("layaair.majsoul.mjmgr");
                    1 == t ? o.call("wxLogin") : 2 == t ? o.call("weiboLogin") : 3 == t && o.call("qqLogin")
                } else if (GameMgr.iniOSWebview) {
                    var l = "";
                    switch (t) {
                    case 1:
                        l = "wxLogin";
                        break;
                    case 2:
                        l = "wbLogin";
                        break;
                    case 3:
                        l = "qqLogin"
                    }
                    if (l) {
                        var h = this;
                        Laya.Browser.window.wkbridge.callNative(l, "", function(e) {
                            h.onSocioBack(t + 3, e, null)
                        })
                    }
                } else {
                    var c = window.location.href;
                    if (-1 != c.indexOf("?") && (c = c.split("?")[0]),
                    1 == t) {
                        u = "https://open.weixin.qq.com/connect/qrconnect?";
                        u += "appid=wx2a0c2449cab74448",
                        u += "&response_type=code",
                        u += "&redirect_uri=" + encodeURI("http://www.majsoul.com/0?xdsfdl=1-" + c),
                        u += "&scope=snsapi_login",
                        Laya.Browser.window.location.href = u
                    } else if (2 == t) {
                        u = "https://api.weibo.com/oauth2/authorize?";
                        u += "client_id=399644784",
                        u += "&redirect_uri=http://www.majsoul.com/0?xdsfdl=2-" + c,
                        Laya.Browser.window.location.href = u
                    } else if (3 == t) {
                        var u = "https://graph.qq.com/oauth2.0/authorize?";
                        u += "response_type=code",
                        u += "&client_id=101480027",
                        u += "&redirect_uri=" + encodeURI("http://www.majsoul.com/0"),
                        u += "&state=xdsfdl3",
                        Laya.Browser.window.location.href = u
                    } else if (7 == t)
                        this.Inst && this.Inst.showMailLogin();
                    else if (8 == t) {
                        _ = GameMgr.Inst.link_url + "redirect/";
                        GameMgr.inRelease ? _ += GameMgr.client_language : _ += "tt",
                        _ += "/yo_google.html",
                        "jp" == GameMgr.client_language ? Yo.googleJaAuth({
                            redirect_uri: _,
                            openNewWindow: !1
                        }) : Yo.googleAuth({
                            redirect_uri: _,
                            openNewWindow: !1
                        })
                    } else if (9 == t) {
                        _ = GameMgr.Inst.link_url + "redirect/";
                        GameMgr.inRelease ? _ += GameMgr.client_language : _ += "tt",
                        _ += "/yo_facebook.html",
                        Yo.facebookAuth({
                            redirect_uri: _,
                            openNewWindow: !1
                        })
                    } else if (10 == t) {
                        var _ = GameMgr.Inst.link_url + "redirect/";
                        GameMgr.inRelease ? _ += GameMgr.client_language : _ += "tt",
                        _ += "/yo_tiwtter.html",
                        "jp" == GameMgr.client_language ? Yo.twitterJaAuth({
                            redirect_uri: _,
                            openNewWindow: !1
                        }) : Yo.twitterAuth({
                            redirect_uri: _,
                            openNewWindow: !1
                        })
                    }
                }
        }
        ,
        c.onSocioBack = function(t, e, i) {
            app.Log.log("!!!!!!!!!!!!!!! " + t + " " + e),
            this.Inst && this.Inst._onSocioBack(t, e, i)
        }
        ,
        Object.defineProperty(c.prototype, "server_region_name", {
            get: function() {
                switch (this.server_index) {
                case 0:
                    return "mainland";
                case 1:
                    return "hk";
                default:
                    return ""
                }
            },
            enumerable: !0,
            configurable: !0
        }),
        c.prototype.onCreate = function() {
            var t = this
              , h = this.me.getChildByName("root");
            this.container_login = this.me.getChildByName("root").getChildByName("container_login");
            var u = function(e) {
                var i = {
                    container: e,
                    input: e.getChildByName("txtinput"),
                    lb: e.getChildByName("lb")
                };
                return i.input.text = "",
                i.lb.visible = !0,
                i.input.on("focus", t, function() {
                    i.lb.visible = !1
                }),
                i.input.on("blur", t, function() {
                    i.lb.visible = !i.input.text || "" == i.input.text
                }),
                i.input.on("input", t, function() {}),
                i
            };
            this.page_server = new o(this.me.getChildByName("servers")),
            this.label_server = this.container_login.getChildByName("chs").getChildByName("lb").getChildByName("word"),
            this.container_login.getChildByName("chs").getChildByName("lb").getChildByName("btn").clickHandler = new Laya.Handler(this,function() {
                t.page_server.show()
            }
            ),
            "chs" != GameMgr.client_language && (this.container_login.getChildByName("chs").getChildByName("lb").visible = !1,
            this.container_login.getChildByName("chs").getChildByName("img_lb").visible = !1),
            this.txt_account = u(this.container_login.getChildByName("chs").getChildByName("container_account")),
            this.txt_password = u(this.container_login.getChildByName("chs").getChildByName("container_mima")),
            this.txt_account.input.on(laya.events.Event.KEY_DOWN, this.txt_account.input, function(e) {
                e.keyCode === Laya.Keyboard.ENTER && t._btn_login()
            }),
            this.txt_password.input.on(laya.events.Event.KEY_DOWN, this.txt_account.input, function(e) {
                e.keyCode === Laya.Keyboard.ENTER && t._btn_login()
            }),
            this.container_extendInfo = h.getChildByName("extendinfo"),
            this.container_extendInfo.visible = !1,
            this.container_login.getChildByName("chs").getChildByName("btn_regist").clickHandler = Laya.Handler.create(this, function() {
                t.page_regist.show()
            }, null, !1),
            this.container_login.getChildByName("chs").getChildByName("btn_enter").clickHandler = Laya.Handler.create(this, this._btn_login, null, !1),
            this.login_loading = new s(h.getChildByName("loading_login")),
            this.page_regist = new i(this.me.getChildByName("page_regist"),this.me.getChildByName("regist_connecting")),
            this.page_maillogin = new l(this.me.getChildByName("mail_login")),
            this._errorinfo = new n(this.me.getChildByName("error")),
            this._prohibitionInfo = new a(this.me.getChildByName("Prohibition")),
            this._maintenanceInfo = new r(this.me.getChildByName("maintenance")),
            this.scene = new e(this.me.getChildByName("scene")),
            this.container_social = this.container_login.getChildByName("social"),
            this.social_btns = [];
            for (p = 0; p < 4; p++)
                this.social_btns.push(this.container_social.getChildByName("btn" + p)),
                this.social_btns[p].visible = !1;
            var _ = [];
            "chs" == GameMgr.client_language && (_ = [{
                img: "myres/entrance/weibo.png",
                type: 2
            }, {
                img: "myres/entrance/QQ.png",
                type: 3
            }, {
                img: "myres/entrance/weixin.png",
                type: 1
            }]),
            "jp" == GameMgr.client_language && (_ = [{
                img: "myres/entrance/google.png",
                type: 8
            }, {
                img: "myres/entrance/tiwtter.png",
                type: 10
            }]),
            "en" == GameMgr.client_language && (_ = [{
                img: "myres/entrance/google.png",
                type: 8
            }, {
                img: "myres/entrance/facebook.png",
                type: 9
            }, {
                img: "myres/entrance/tiwtter.png",
                type: 10
            }]);
            for (var d = function(t) {
                var e = f.social_btns[t];
                t < _.length ? (e.visible = !0,
                e.getChildAt(0).skin = game.Tools.localUISrc(_[t].img),
                e.clickHandler = new Laya.Handler(f,function() {
                    c.trySocio(_[t].type)
                }
                ),
                e.x = 340 * t / (_.length - 1) + 55) : e.visible = !1
            }, f = this, p = 0; p < this.social_btns.length; p++)
                d(p);
            2 == _.length && (this.social_btns[0].x = 340 / 3 + 55,
            this.social_btns[1].x = 680 / 3 + 55),
            this.me.getChildByName("infos").getChildByName("btn").clickHandler = Laya.Handler.create(this, function() {
                GameMgr.inConch || game.Tools.open_new_window("http://sq.ccm.gov.cn/ccnt/sczr/service/business/emark/toDetail/2c1d78cce7104e28b8898e2c0fc3d803")
            }, null, !1),
            this.me.getChildByName("infos").visible = !1
        }
        ,
        c.prototype.ModelJpEn = function() {
            var t = this.container_login.getChildByName("jpen")
              , e = t.getChildByName("btn_enter");
            e.clickHandler = Laya.Handler.create(this, function() {
                !function(t) {
                    1 == t && c.trySocio(7)
                }(!0)
            }, null, !1);
            var i = t.getChildByName("checksave")
              , n = i.getChildByName("checkbox");
            i.getChildByName("btn_check").clickHandler = new Laya.Handler(this,function() {
                n.visible = !n.visible
            }
            )
        }
        ,
        c.prototype.show = function() {
            var t = this;
            "chs" == GameMgr.client_language ? (this.container_social.x = 40,
            this.container_social.y = 475) : (this.container_login.getChildByName("chs").visible = !1,
            this.container_login.getChildByName("jpen").visible = !0,
            this.ModelJpEn()),
            -1 != GameMgr.Inst.beinvited_roomid ? (this.container_extendInfo.visible = !0,
            this.container_extendInfo.getChildAt(0).text = game.Tools.strOfLocalization(2054) + ":" + GameMgr.Inst.beinvited_roomid) : "" != GameMgr.Inst.outsee_paipuid ? (this.container_extendInfo.visible = !0,
            this.container_extendInfo.getChildAt(0).text = game.Tools.strOfLocalization(2055)) : this.container_extendInfo.visible = !1,
            this.me.getChildByName("root").getChildByName("version").text = game.ResourceVersion.version;
            var e = Laya.LocalStorage.getItem("_pre_sociotype")
              , i = Laya.LocalStorage.getItem("ssssoooodd");
            i || (i = "");
            var n = -1;
            if (e && "" != e && (n = parseInt(e)),
            app.Log.log("sociotype:" + n),
            n < 0 || n > 10)
                this.showContainerLogin();
            else if (0 == n)
                "" != i ? (Laya.timer.once(600, this, function() {
                    t._try_socio_check(n, i)
                }),
                this.showLoginLoading(0)) : this.showContainerLogin();
            else if (n >= 1 && n <= 6) {
                var a = Laya.LocalStorage.getItem("_pre_code");
                a || (a = ""),
                "" != a || "" != i ? (this.showLoginLoading(n),
                Laya.timer.once(500, this, function() {
                    a && "" != a ? t._loginby_sociocode(n, a) : t._try_socio_check(n, i)
                })) : this.showContainerLogin()
            } else if (n >= 7 && n <= 10 && "chs" != GameMgr.client_language && Yo.login) {
                var r = game.LocalStorage.getItem("yostar_token");
                r || (r = "");
                var s = game.LocalStorage.getItem("yostar_uid");
                s || (s = ""),
                "" != s && "" != r ? (this.showLoginLoading(n),
                Laya.timer.once(500, this, function() {
                    t._login_2_yostar(n, r, s)
                })) : this.showContainerLogin()
            } else
                this.showContainerLogin();
            this.scene.show(),
            this.enable = !0,
            "hk" == game.LobbyNetMgr.gateway_region_name ? this.showServer(1) : this.showServer(0)
        }
        ,
        c.prototype._onSocioBack = function(t, e, i) {
            var n = this;
            this.showLoginLoading(t),
            Laya.timer.once(500, this, function() {
                e && "" != e ? (Laya.LocalStorage.setItem("_pre_sociotype", t.toString()),
                i ? n._login_2_yostar(t, e, i) : (Laya.LocalStorage.setItem("_pre_code", e),
                n._loginby_sociocode(t, e))) : n.showContainerLogin()
            })
        }
        ,
        c.prototype.showContainerLogin = function() {
            if ("" == this.txt_account.input.text) {
                var t = game.LocalStorage.getItem("account");
                t && "" != t ? (this.txt_account.input.text = t,
                this.txt_account.lb.visible = !1) : (this.txt_account.input.text = "",
                this.txt_account.lb.visible = !0)
            }
            var e = game.LocalStorage.getItem("password");
            e && "" != e ? (this.txt_password.input.text = e,
            this.txt_password.lb.visible = !1) : (this.txt_password.input.text = "",
            this.txt_password.lb.visible = !0),
            this.container_login.visible = !0,
            this.login_loading.close()
        }
        ,
        c.prototype.showLoginLoading = function(t) {
            this.container_login.visible = !1,
            this.login_loading.show(t)
        }
        ,
        c.prototype._btn_login = function() {
            var t = this
              , e = this.txt_account.input.text
              , i = this.txt_password.input.text;
            e && "" != e ? i && "" != i ? Laya.timer.currTimer < this.btn_login_cd || (this.multiLogin() ? this.showInfo(game.Tools.strOfLocalization(2058)) : (this.btn_login_cd = Laya.timer.currTimer + 3e3,
            this.showLoginLoading(0),
            game.LobbyNetMgr.Inst.isOK && c.Inst.server_region_name == game.LobbyNetMgr.gateway_region_name ? c.Inst._try_login_account(e, i) : game.LobbyNetMgr.Inst.OpenConnect(c.Inst.server_region_name, Laya.Handler.create(this, function(n) {
                n.open ? c.Inst._try_login_account(e, i) : (n.maintenance ? t.showMaintenance(n.maintenance) : t.showInfo(n.info),
                t.showContainerLogin(),
                t.btn_login_cd = 0)
            })))) : this.showInfo(game.Tools.strOfLocalization(2057)) : this.showInfo(game.Tools.strOfLocalization(2056))
        }
        ,
        c.prototype._try_regist_account = function(t, e) {
            var i = this;
            app.NetAgent.sendReq2Lobby("Lobby", "signup", {
                account: t,
                password: GameMgr.encodeP(e)
            }, function(n, a) {
                n ? (i.showError(game.Tools.strOfLocalization(2059), n),
                app.Log.Error(n.message)) : a.error ? (i.showError(game.Tools.strOfLocalization(2060), a.error.code),
                app.Log.Error(game.Tools.strOfLocalization(2219, [JSON.stringify(a)]))) : (game.LocalStorage.setItem("account", t),
                game.LocalStorage.setItem("password", e),
                i._try_login_account(t, e))
            })
        }
        ,
        c.prototype._try_login_account = function(t, e) {
            var i = this;
            if (this.multiLogin())
                return this.showInfo(game.Tools.strOfLocalization(2058)),
                void this.showContainerLogin();
            var n = {};
            GameMgr.inConch ? n.device_type = "app" : (Laya.Browser.onPC && (n.device_type = "pc"),
            Laya.Browser.onIPad && (n.device_type = "ipad"),
            Laya.Browser.onMobile && (n.device_type = "mobile")),
            Laya.Browser.onMac && (n.os = "mac"),
            Laya.Browser.onIOS && (n.os = "ios"),
            (Laya.Browser.onAndriod || Laya.Browser.onAndroid) && (n.os = "android"),
            Laya.Browser.onWeiXin && (n.browser = "weixin"),
            Laya.Browser.onSafari && (n.browser = "safari"),
            Laya.Browser.onFirefox && (n.browser = "firefox"),
            Laya.Browser.onEdge && (n.browser = "edge"),
            Laya.Browser.onMiniGame && (n.browser = "minigame");
            var a = [];
            GameMgr.inGooglePlay && a.push(1),
            GameMgr.inChina && a.push(2),
            game.LocalStorage.setItem("account", t),
            game.LocalStorage.setItem("password", e),
            app.NetAgent.sendReq2Lobby("Lobby", "login", {
                account: t,
                password: GameMgr.encodeP(e),
                reconnect: !1,
                device: n,
                random_key: GameMgr.device_id,
                client_version: game.ResourceVersion.version,
                gen_access_token: !0,
                currency_platforms: a
            }, function(n, a) {
                i.btn_login_cd = 0,
                n ? (i.showError(game.Tools.strOfLocalization(2061), n),
                i.showContainerLogin()) : a.error ? (503 == a.error.code ? i.showProhibition(a.error) : i.showError("", a.error.code),
                i.showContainerLogin()) : (Laya.LocalStorage.setItem("_pre_sociotype", "0"),
                game.LocalStorage.setItem("account", t),
                game.LocalStorage.setItem("password", e),
                GameMgr.Inst.account = t,
                GameMgr.Inst.password = e,
                GameMgr.Inst.sociotype = 0,
                i._onLoginSuccess(0, a))
            })
        }
        ,
        c.prototype._login_2_yostar = function(t, e, i) {
            app.Log.log("login_2_yostar sociotype:" + t + " token:" + e + " uid:" + i);
            var n = this
              , a = function(t) {
                switch (t) {
                case 1:
                    n.showError(game.Tools.strOfLocalization(2677));
                    break;
                case 2:
                    n.showError(game.Tools.strOfLocalization(2678));
                    break;
                case 3:
                    n.showError(game.Tools.strOfLocalization(2679));
                    break;
                case 4:
                    n.showError(game.Tools.strOfLocalization(2680));
                    break;
                default:
                    n.showError(game.Tools.strOfLocalization(2676))
                }
                Laya.LocalStorage.setItem("_pre_sociotype", ""),
                n.showContainerLogin()
            };
            Yo.login && Yo.login({
                uid: i,
                token: e
            }).then(function(r) {
                r ? (app.Log.log("yo login data.result:" + r.result),
                0 == r.result ? (game.LocalStorage.setItem("yostar_token", e),
                game.LocalStorage.setItem("yostar_uid", i),
                GameMgr.Inst.yostar_accessToken = r.accessToken,
                n._loginby_sociocode(t, r.accessToken, i)) : a(r.result)) : (app.Log.log("yo login data.result: no"),
                a(-1))
            })
        }
        ,
        c.prototype._loginby_sociocode = function(t, e, i) {
            var n = this;
            if (void 0 === i && (i = ""),
            app.Log.log("_loginby_sociocode0 sociotype:" + t + ", code:" + e + ", uid:" + i),
            game.LobbyNetMgr.Inst.isOK && c.Inst.server_region_name == game.LobbyNetMgr.gateway_region_name) {
                Laya.LocalStorage.setItem("_pre_code", ""),
                Laya.LocalStorage.setItem("_pre_sociotype", ""),
                app.Log.log("_loginby_sociocode1 sociotype" + t + " code:" + e + " uid:" + i);
                var a = {
                    type: t,
                    code: e
                };
                i && (a.uid = i),
                app.NetAgent.sendReq2Lobby("Lobby", "oauth2Auth", a, function(e, i) {
                    e ? (app.Log.log("oauth2Auth err:" + e),
                    n.showError(game.Tools.strOfLocalization(2059), e),
                    app.Log.Error(e.message),
                    n.showContainerLogin()) : (app.Log.log("oauth2Auth res: " + JSON.stringify(i)),
                    i.error ? (n.showError(game.Tools.strOfLocalization(2062), i.error.code),
                    n.showContainerLogin()) : n._try_socio_check(t, i.access_token))
                })
            } else
                game.LobbyNetMgr.Inst.OpenConnect(c.Inst.server_region_name, Laya.Handler.create(this, function(a) {
                    a.open ? n._loginby_sociocode(t, e, i) : (a.maintenance ? n.showMaintenance(a.maintenance) : n.showInfo(a.info),
                    n.showContainerLogin())
                }))
        }
        ,
        c.prototype._try_socio_check = function(t, e) {
            var i = this;
            if (this.multiLogin())
                return this.showInfo(game.Tools.strOfLocalization(2058)),
                void this.showContainerLogin();
            game.LobbyNetMgr.Inst.isOK && c.Inst.server_region_name == game.LobbyNetMgr.gateway_region_name ? (app.Log.log("_try_socio_check sociotype" + t + " access_token:" + e),
            app.NetAgent.sendReq2Lobby("Lobby", "oauth2Check", {
                type: t,
                access_token: e
            }, function(n, a) {
                n ? (i.showError(game.Tools.strOfLocalization(2059), n),
                app.Log.Error(n.message),
                i.showContainerLogin()) : (app.Log.log("oauth2Check res: " + JSON.stringify(a)),
                a.error ? (i.showError(game.Tools.strOfLocalization(2062), a.error.code),
                i.showContainerLogin()) : a.has_account ? i._try_login_socio(t, e) : i._try_regist_socio(t, e))
            })) : game.LobbyNetMgr.Inst.OpenConnect(c.Inst.server_region_name, Laya.Handler.create(this, function(n) {
                n.open ? i._try_socio_check(t, e) : (n.maintenance ? i.showMaintenance(n.maintenance) : i.showInfo(n.info),
                i.showContainerLogin())
            }))
        }
        ,
        c.prototype._try_regist_socio = function(t, e) {
            var i = this;
            app.Log.log("_try_regist_socio sociotype" + t + " access_token:" + e);
            var n = Laya.LocalStorage.getItem("__ad_s");
            n && (GameMgr.Inst._ad_str = n);
            var a = {};
            a.type = t,
            a.access_token = e,
            GameMgr.Inst._ad_str && (a.advertise_str = GameMgr.Inst._ad_str),
            7 == t && (a.email = game.LocalStorage.getItem("mail_account")),
            app.NetAgent.sendReq2Lobby("Lobby", "oauth2Signup", a, function(n, a) {
                n ? (app.Log.log("oauth2Signup err:" + n),
                i.showError(game.Tools.strOfLocalization(2059), n),
                app.Log.Error(n.message),
                i.showContainerLogin()) : (app.Log.log("oauth2Signup res: " + JSON.stringify(a)),
                a.error ? (i.showError(game.Tools.strOfLocalization(2060), a.error.code),
                app.Log.Error(game.Tools.strOfLocalization(2219, [JSON.stringify(a)])),
                i.showContainerLogin()) : (app.PlayerBehaviorStatistic.fb_trace_force(app.EBehaviorType.CompleteRegistration),
                i._try_login_socio(t, e)))
            })
        }
        ,
        c.prototype._try_login_socio = function(t, e) {
            var i = this;
            if (this.multiLogin())
                return this.showError(game.Tools.strOfLocalization(2058)),
                void this.showContainerLogin();
            app.Log.log("_try_login_socio sociotype" + t + " access_token:" + e);
            var n = {};
            GameMgr.inConch ? n.device_type = "app" : (Laya.Browser.onPC && (n.device_type = "pc"),
            Laya.Browser.onIPad && (n.device_type = "ipad"),
            Laya.Browser.onMobile && (n.device_type = "mobile")),
            Laya.Browser.onMac && (n.os = "mac"),
            Laya.Browser.onIOS && (n.os = "ios"),
            (Laya.Browser.onAndriod || Laya.Browser.onAndroid) && (n.os = "android"),
            Laya.Browser.onWeiXin && (n.browser = "weixin"),
            Laya.Browser.onSafari && (n.browser = "safari"),
            Laya.Browser.onFirefox && (n.browser = "firefox"),
            Laya.Browser.onEdge && (n.browser = "edge"),
            Laya.Browser.onMiniGame && (n.browser = "minigame");
            var a = [];
            GameMgr.inGooglePlay && a.push(1),
            GameMgr.inChina && a.push(2),
            app.NetAgent.sendReq2Lobby("Lobby", "oauth2Login", {
                type: t,
                access_token: e,
                reconnect: !1,
                device: n,
                random_key: GameMgr.device_id,
                client_version: game.ResourceVersion.version,
                currency_platforms: a
            }, function(n, a) {
                i.btn_login_cd = 0,
                n ? (app.Log.log("oauth2Login err:" + n),
                i.showError(game.Tools.strOfLocalization(2061), n),
                i.showContainerLogin()) : (app.Log.log("oauth2Login res: " + JSON.stringify(a)),
                a.error ? (503 == a.error.code ? i.showProhibition(a.error) : i.showError("", a.error.code),
                i.showContainerLogin()) : (Laya.LocalStorage.setItem("_pre_sociotype", t.toString()),
                Laya.LocalStorage.setItem("ssssoooodd", e),
                GameMgr.Inst.sociotype = t,
                GameMgr.Inst.access_token = e,
                i._onLoginSuccess(t, a)))
            })
        }
        ,
        c.prototype._onLoginSuccess = function(e, i) {
            var n = this;
            if (app.Log.log("登陆：" + JSON.stringify(i)),
            GameMgr.Inst.account_id = i.account_id,
            GameMgr.Inst.account_data = i.account,
            GameMgr.Inst.account_numerical_resource = {},
            i.account.platform_diamond)
                for (var a = i.account.platform_diamond, r = 0; r < a.length; r++)
                    GameMgr.Inst.account_numerical_resource[a[r].id] = a[r].count;
            GameMgr.Inst.account_refresh_time = Laya.timer.currTimer,
            i.game_info && (GameMgr.Inst.ingame = !0,
            GameMgr.Inst.mj_server_location = i.game_info.location,
            GameMgr.Inst.mj_game_token = i.game_info.connect_token,
            GameMgr.Inst.mj_game_uuid = i.game_info.game_uuid),
            i.access_token && (Laya.LocalStorage.setItem("_pre_sociotype", e.toString()),
            Laya.LocalStorage.setItem("ssssoooodd", i.access_token),
            GameMgr.Inst.sociotype = e,
            GameMgr.Inst.access_token = i.access_token),
            Laya.LocalStorage.removeItem("__ad_s"),
            t.UI_Loading.Inst.show("load_lobby"),
            this.enable = !1,
            this.scene.close(),
            this.page_regist.close(),
            this.login_loading.close(),
            t.UIMgr.Inst.openLobbyUI(Laya.Handler.create(this, function() {
                GameMgr.Inst.afterLogin(),
                GameMgr.Inst.account_data.anti_addiction && t.UIMgr.Inst.ShowPreventAddiction(),
                n.destroy(),
                n.disposeRes()
            }), Laya.Handler.create(this, function(e) {
                return t.UI_Loading.Inst.setProgressVal(.2 * e)
            }, null, !1))
        }
        ,
        c.prototype.showMailLogin = function() {
            this.page_maillogin.show()
        }
        ,
        c.prototype.showInfo = function(t) {
            var e = "";
            t && (e += t),
            this._errorinfo.show(e, !1)
        }
        ,
        c.prototype.showError = function(t, e, i) {
            void 0 === e && (e = -1),
            void 0 === i && (i = "");
            var n = "";
            t && (n += t),
            -1 != e && (n.length > 0 && (n += ","),
            cfg.info.error.get(e) ? n += cfg.info.error.get(e)[GameMgr.client_language] : n += game.Tools.strOfLocalization(2063) + "(" + e + ")"),
            i && (n += ", info:" + i),
            this._errorinfo.show(n, !1)
        }
        ,
        c.prototype.showProhibition = function(t) {
            var e = game.Tools.strOfLocalization(2064) + "\n";
            if (t.u32_params && t.u32_params.length >= 2)
                if (0 == t.u32_params[1])
                    e += game.Tools.strOfLocalization(2065) + "\n";
                else {
                    var i = t.u32_params[0] + t.u32_params[1];
                    e += game.Tools.strOfLocalization(2066) + game.Tools.time2YearMounthDate(i) + " " + game.Tools.time2HourMinute(i) + "\n"
                }
            t.str_params && t.str_params.length > 0 && (e += game.Tools.strOfLocalization(2067) + t.str_params[0]),
            this._prohibitionInfo.show(e)
        }
        ,
        c.prototype.showServer = function(t) {
            0 == t ? (Laya.LocalStorage.setItem("gateway_region", "mainland"),
            this.server_index = 0,
            this.label_server.text = game.Tools.strOfLocalization(2217)) : 1 == t && (Laya.LocalStorage.setItem("gateway_region", "hk"),
            this.server_index = 1,
            this.label_server.text = game.Tools.strOfLocalization(2218))
        }
        ,
        c.prototype.showMaintenance = function(t) {
            this._maintenanceInfo.show(t)
        }
        ,
        c.Accountforbidden = function(t) {
            var e = !1;
            return cfg.info.forbidden.forEach(function(i, n) {
                "" != i.word && t.indexOf(i.word) >= 0 && (e = !0)
            }),
            e
        }
        ,
        c.prototype.multiLogin = function() {
            var t = Laya.LocalStorage.getItem("dolllt");
            return !(!t || "" == t) && game.Tools.currentTime < parseFloat(t) + 1.5
        }
        ,
        c.prototype.disposeRes = function() {
            Laya.Loader.clearTextureRes("res/atlas/myres/entrance.atlas");
            var t = "";
            t = "en" == GameMgr.client_language ? "scene/Assets/Resource/entrance/icon_color_en.png" : "jp" == GameMgr.client_language ? "scene/Assets/Resource/entrance/icon_color_jp.png" : "scene/Assets/Resource/entrance/icon_color.png",
            Laya.loader.getRes(t).dispose(!0)
        }
        ,
        c.Inst = null,
        c
    }(t.UIBase);
    t.UI_Entrance = h
}(uiscript || (uiscript = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), uiscript;
!function(t) {
    var e = function(e) {
        function i() {
            var t = e.call(this, new ui.common.errorinfoUI) || this;
            return t.locking = !1,
            t
        }
        return __extends(i, e),
        i.prototype.onCreate = function() {
            this.root = this.me.getChildByName("root"),
            this.info = this.root.getChildByName("text"),
            this.blackbg = this.me.getChildByName("blackbg"),
            this.btn_cancel = this.root.getChildByName("btn_cancel"),
            this.btn_restart = this.root.getChildByName("btn_restart"),
            this.btn_cancel.clickHandler = Laya.Handler.create(this, this.close, null, !1),
            this.btn_restart.clickHandler = Laya.Handler.create(this, function() {
                if (Laya.Browser.window.conch) {
                    Laya.PlatformClass.createClass("layaair.majsoul.mjmgr").call("restart")
                } else
                    Laya.Browser.window.location.href = GameMgr.Inst.link_url
            }, null, !1),
            this.btn_restart.visible = !1,
            this.btn_cancel.visible = !1,
            this.blackbg.visible = !1
        }
        ,
        i.prototype.showStr = function(t) {
            this.btn_cancel.visible = !0,
            this.info.text = t,
            this._show()
        }
        ,
        i.prototype.showNetReqError = function(t, e, i) {
            this.btn_cancel.visible = !0;
            var n = ""
              , a = ""
              , r = !0;
            if (GameMgr.inRelease || (n += "发送" + t + "出错\n"),
            e && "" != e) {
                var s = "";
                if (s = e.message ? e.message : e,
                a = "错误：" + s,
                "TIMEOUT" == s && (s = game.Tools.strOfLocalization(11)),
                n += s,
                !GameMgr.inRelease)
                    switch (n += "\n",
                    game.LobbyNetMgr.Inst.connect_state) {
                    case game.EConnectState.none:
                        n += "服务器未连接";
                        break;
                    case game.EConnectState.tryconnect:
                        n += "服务器正在尝试连接";
                        break;
                    case game.EConnectState.reconnecting:
                        n += "服务器正在重连";
                        break;
                    case game.EConnectState.connecting:
                        n += "服务器连接正常";
                        break;
                    case game.EConnectState.disconnect:
                        n += "服务器断开连接"
                    }
            } else if (i && i.error && i.error.code) {
                r = !1;
                var o = i.error.code
                  , l = cfg.info.error.get(o);
                l ? (n += l[GameMgr.client_language],
                a = l.chs) : (n += game.Tools.strOfLocalization(2068) + o,
                a = "一个未收录的异常：" + o)
            }
            this.info.text = n,
            this._show();
            var h = {};
            h.timestamp = Math.floor(Date.now() / 1e3),
            h.fatal = !1,
            h.lobby_ip = app.NetAgent.lobby_ip,
            h.mj_ip = app.NetAgent.mj_ip,
            GameMgr.Inst && (h.account_id = GameMgr.Inst.account_id,
            GameMgr.Inst.client_endpoint ? h.client_endpoint = JSON.stringify(GameMgr.Inst.client_endpoint) : h.client_endpoint = "null",
            h.client_region = GameMgr.ClientRegion,
            h.gateway_region_name = game.LobbyNetMgr.gateway_region_name),
            h.client_version = game.ResourceVersion.version,
            h.device = game.Tools.deviceInfo,
            h.method = t,
            h.send_info = a;
            var c = {};
            if (c.standardinfo = h,
            GameMgr.inRelease) {
                if (r) {
                    (new Laya.HttpRequest).send(GameMgr.error_url, "data=" + JSON.stringify(c), "post")
                }
            } else
                app.Log.log(JSON.stringify(c))
        }
        ,
        i.prototype.showFatalError = function() {
            this.enable = !0,
            this.info.text = game.Tools.strOfLocalization(14),
            this.blackbg.visible = !0,
            this.btn_restart.visible = !0
        }
        ,
        i.prototype._show = function() {
            var e = this;
            this.me.visible = !0,
            this.locking = !0,
            t.UIBase.anim_pop_out(this.root, Laya.Handler.create(this, function() {
                e.locking = !1
            }))
        }
        ,
        i.prototype.close = function() {
            var e = this;
            this.locking || (this.locking = !0,
            t.UIBase.anim_pop_hide(this.root, Laya.Handler.create(this, function() {
                e.locking = !1,
                e.me.visible = !1,
                e.me.destroy(!0)
            })))
        }
        ,
        i
    }(t.UIBase);
    t.UI_ErrorInfo = e
}(uiscript || (uiscript = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), uiscript;
!function(t) {
    var e;
    !function(t) {
        t[t.none = 0] = "none",
        t[t.build = 1] = "build",
        t[t.showing = 2] = "showing"
    }(e || (e = {}));
    var i = function(i) {
        function n() {
            var t = i.call(this, new ui.mj.fightbeginUI) || this;
            return t.cells = [],
            t.effect_winlose = null,
            t
        }
        return __extends(n, i),
        n.show = function(i) {
            var a = this;
            app.Log.log("UI_FightBegin show"),
            null != this._Inst && this._Inst.destroy(),
            this._state = e.build;
            var r = new n;
            this._Inst = r,
            t.UIMgr.Inst.AddMJUI(r),
            Laya.timer.frameOnce(5, this, function() {
                i && i.run(),
                a._state == e.build ? (a._state = e.showing,
                r._onShow()) : a._state == e.none && r && (r.destroy(),
                a._Inst = null)
            })
        }
        ,
        n.hide = function() {
            var t = this;
            if (app.Log.log("UI_FightBegin hide"),
            this._state == e.showing) {
                var i = this._Inst._onHide();
                return Laya.timer.once(i, this, function() {
                    t._Inst.destroy(),
                    t._Inst = null
                }),
                this._state = e.none,
                i
            }
            return this._state = e.none,
            0
        }
        ,
        n.prototype.onCreate = function() {
            app.Log.log("UI_FightBegin onCreate");
            for (var e = 0; e < 4; e++) {
                var i = this.me.getChildByName("container_" + e.toString());
                this.cells.push({
                    container: i,
                    body: i.getChildByName("illust").getChildByName("body").getChildByName("body"),
                    rect: t.UIRect.CreateFromSprite(i.getChildByName("illust").getChildByName("body").getChildByName("body")),
                    name: i.getChildByName("container_name").getChildByName("label_name"),
                    x: i.x,
                    y: i.y,
                    rank: new t.UI_Level(i.getChildByName("container_name").getChildByName("rank")),
                    title: new t.UI_PlayerTitle(i.getChildByName("container_name").getChildByName("title"))
                })
            }
        }
        ,
        n.prototype._onShow = function() {
            var t = this;
            this.enable = !0,
            app.Log.log("UI_FightBegin _onShow"),
            this.me.alpha = 1;
            for (var e = function(t) {
                var e = i.cells[t]
                  , n = view.DesktopMgr.Inst.localPosition2Seat(t);
                if (-1 == n)
                    e.container.getChildByName("illust").visible = !1,
                    e.container.getChildByName("container_name").visible = !1;
                else {
                    e.container.getChildByName("illust").visible = !0,
                    e.container.getChildByName("container_name").visible = !0;
                    var a = view.DesktopMgr.Inst.player_datas[n];
                    e.name.text = a.nickname,
                    1 == t || 3 == t ? game.Tools.charaPart(a.avatar_id, e.body, "full", e.rect) : game.Tools.charaPart(a.avatar_id, e.body, "half", e.rect),
                    e.rank.id = a.level.id,
                    e.title.id = game.Tools.titleLocalization(a.account_id, a.title)
                }
                var r = 0
                  , s = 0;
                switch (t) {
                case 0:
                    r = 1491,
                    s = 860;
                    break;
                case 1:
                    r = 2056,
                    s = 726;
                    break;
                case 2:
                    r = -757,
                    s = -875;
                    break;
                case 3:
                    r = -1298,
                    s = 612
                }
                e.container.visible = !0,
                e.container.x = r,
                e.container.y = s,
                Laya.timer.once(500, i, function() {
                    Laya.Tween.to(e.container, {
                        x: e.x,
                        y: e.y
                    }, 400, Laya.Ease.strongIn)
                })
            }, i = this, n = 0; n < 4; n++)
                e(n);
            Laya.timer.once(700, this, function() {
                view.AudioMgr.PlayAudio(225)
            }),
            Laya.timer.once(1200, this, function() {
                var e = "";
                e = "en" == GameMgr.client_language ? "scene/effect_winlose_en.lh" : "scene/effect_winlose.lh",
                t.effect_winlose = game.FrontEffect.Inst.create_ui_effect(t.me.getChildByName("container_effect"), e, new Laya.Point(0,0), 1)
            }),
            Laya.timer.once(2200, this, function() {
                view.AudioMgr.PlayCharactorSound(view.DesktopMgr.Inst.main_role_character_info, "game_start")
            })
        }
        ,
        n.prototype._onHide = function() {
            var t = this;
            Laya.timer.clearAll(this);
            var e = "UI_FightBegin _onHide ";
            if (this.cells) {
                e += "count=" + this.cells.length;
                for (a = 0; a < this.cells.length; a++)
                    this.cells[a] ? e += "T" : e += "N"
            } else
                e += "nocells";
            app.Log.log(e);
            for (var i = function(t) {
                var e = n.cells[t];
                if (!e)
                    return "continue";
                var i = view.DesktopMgr.Inst.localPosition2Seat(t);
                if (-1 == i)
                    e.container.getChildByName("illust").visible = !1,
                    e.container.getChildByName("container_name").visible = !1;
                else {
                    e.container.getChildByName("illust").visible = !0,
                    e.container.getChildByName("container_name").visible = !0;
                    var a = view.DesktopMgr.Inst.player_datas[i];
                    e.name.text = a.nickname
                }
                var r = 0
                  , s = 0;
                switch (t) {
                case 0:
                    r = 1491,
                    s = 860;
                    break;
                case 1:
                    r = 2056,
                    s = 726;
                    break;
                case 2:
                    r = -757,
                    s = -875;
                    break;
                case 3:
                    r = -1298,
                    s = 612
                }
                Laya.Tween.to(e.container, {
                    x: r,
                    y: s
                }, 400, Laya.Ease.strongIn),
                Laya.timer.once(500, n, function() {
                    Laya.loader.clearTextureRes(e.body.skin),
                    e.container.visible = !1
                })
            }, n = this, a = 0; a < 4 && a < this.cells.length; a++)
                i(a);
            return this.effect_winlose && this.effect_winlose.destory(),
            Laya.timer.once(100, this, function() {
                Laya.Tween.to(t.me, {
                    alpha: 0
                }, 300)
            }),
            Laya.timer.once(400, this, function() {
                t.enable = !1
            }),
            500
        }
        ,
        n._Inst = null,
        n._state = e.none,
        n
    }(t.UIBase);
    t.UI_FightBegin = i
}(uiscript || (uiscript = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), uiscript;
!function(t) {
    var e = function(t) {
        function e() {
            var i = t.call(this, new ui.both_ui.fly_tipsUI) || this;
            return i.templete = null,
            i.clone = null,
            i.last_tips = null,
            e.Inst = i,
            i
        }
        return __extends(e, t),
        e.ShowTips = function(t) {
            this.Inst && this.Inst._fly_tips(t)
        }
        ,
        e.prototype.onCreate = function() {
            this.templete = this.me.getChildByName("templete"),
            this.templete.visible = !1,
            this.clone = this.templete.scriptMap["capsui.UICopy"]
        }
        ,
        e.prototype._fly_tips = function(t) {
            var e = this;
            this.enable = !0;
            var i = this.clone.getNodeClone();
            i.text = t;
            var n = 540;
            this.last_tips && (n = Math.max(n, this.last_tips.y + 50)),
            i.y = n,
            i.visible = !0,
            this.last_tips = i,
            Laya.Tween.to(i, {
                y: n - 150,
                alpha: 0
            }, 1500, Laya.Ease.linearNone, Laya.Handler.create(this, function() {
                e.last_tips === i && (e.last_tips.destroy(!0),
                e.last_tips = null,
                e.enable = !1)
            }))
        }
        ,
        e
    }(t.UIBase);
    t.UI_FlyTips = e
}(uiscript || (uiscript = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), uiscript;
!function(t) {
    var e = function() {
        function e(t) {
            var e = this;
            this.cells = [],
            this.fun_change = null,
            this.noinfo = null,
            this.sortlist = [],
            this.count_limit = null,
            this.me = t;
            var i = this.me.getChildByName("scrollview");
            this.nolimitlist = i.scriptMap["capsui.NoLimitList"],
            this.nolimitlist.init_nolimitlist(Laya.Handler.create(this, this._loadInfo, null, !1), Laya.Handler.create(this, function(t) {
                e.setItem(t.index, t.container)
            }, null, !1)),
            this.nolimitlist.reset(),
            this.fun_change = Laya.Handler.create(this, this.onListenerMsg, null, !1),
            this.noinfo = this.me.getChildByName("noinfo"),
            this.cells = [],
            this.count_limit = this.me.getChildByName("count_limit"),
            this.count_limit.text = "--/--"
        }
        return e.prototype.show = function() {
            this.me.visible = !0,
            game.FriendMgr.addListener(this.fun_change),
            this.refresh()
        }
        ,
        e.prototype.close = function() {
            game.FriendMgr.removeListener(this.fun_change),
            this.me.visible = !1
        }
        ,
        e.prototype.findcell = function(t) {
            for (var e = 0; e < this.cells.length; e++)
                if (this.cells[e].container === t)
                    return this.cells[e];
            return null
        }
        ,
        e.prototype.setItem = function(e, i) {
            var n = this;
            if (this.me.visible) {
                var r = this.findcell(i);
                null == r && (r = {
                    container: i,
                    head: new t.UI_Head(i.getChildByName("head")),
                    level: new t.UI_Level(i.getChildByName("rank")),
                    title: new t.UI_PlayerTitle(i.getChildByName("title")),
                    btn_check: i.getChildByName("check"),
                    btn_delete: i.getChildByName("delete"),
                    btn_ob: i.getChildByName("ob"),
                    name: i.getChildByName("name"),
                    state: i.getChildByName("state"),
                    account_id: 0
                },
                this.cells.push(r));
                var s = game.FriendMgr.friend_list[this.sortlist[e]];
                r.head.id = s.base.avatar_id;
                var o = s.base.level || {
                    id: 10101,
                    score: 0
                };
                r.level.id = o.id,
                r.title.id = s.base.title,
                r.name.text = s.base.nickname;
                var l = r.state
                  , h = "";
                if (s.state.is_online) {
                    var c = game.Tools.playState2Desc(s.state.playing);
                    "" != c ? (l.text = game.Tools.strOfLocalization(2069, [c]),
                    l.color = "#a9d94d",
                    h = s.state.playing.game_uuid) : (l.text = game.Tools.strOfLocalization(2071),
                    l.color = "#58c4db")
                } else
                    l.text = game.Tools.time2Desc(s.state.logout_time) + game.Tools.strOfLocalization(2072),
                    l.color = "#8c8c8c";
                var u = s.base.account_id;
                r.account_id = s.base.account_id,
                r.btn_check.clickHandler = Laya.Handler.create(this, function() {
                    t.UI_OtherPlayerInfo.Inst.show(u)
                }, null, !1),
                game.Tools.setGrayDisable(r.btn_delete, !1),
                r.btn_delete.clickHandler = Laya.Handler.create(this, function() {
                    game.Tools.setGrayDisable(r.btn_delete, !0),
                    t.UI_SecondConfirm.Inst.show(game.Tools.strOfLocalization(2073, [s.base.nickname]), Laya.Handler.create(n, function() {
                        app.NetAgent.sendReq2Lobby("Lobby", "removeFriend", {
                            target_id: u
                        }, function(e, i) {
                            game.Tools.setGrayDisable(r.btn_delete, !1),
                            e || i.error ? t.UIMgr.Inst.showNetReqError("removeFriend", e, i) : game.FriendMgr.removeFriend(u)
                        })
                    }), Laya.Handler.create(n, function() {
                        game.Tools.setGrayDisable(r.btn_delete, !1)
                    }, null, !1), 1111, 560)
                }, null, !1);
                var _ = r.btn_ob;
                if ("" != h) {
                    var d = 0;
                    _.clickHandler = Laya.Handler.create(this, function() {
                        t.UI_PiPeiYuYue.Inst.enable ? t.UI_Popout.PopOutNoTitle(game.Tools.strOfLocalization(204), null) : Laya.timer.currTimer < d || (d = Laya.timer.currTimer + 1e3,
                        t.UI_Live_Broadcast.fetchInfo(h, Laya.Handler.create(n, function(e) {
                            d = 0,
                            e.success && a.Inst.close(Laya.Handler.create(n, function() {
                                t.UI_Live_Broadcast.goToWatch(h, e.data, u)
                            }))
                        }, null, !1)))
                    }, null, !1),
                    game.Tools.setGrayDisable(_, !1)
                } else
                    game.Tools.setGrayDisable(_, !0)
            }
        }
        ,
        e.prototype.onListenerMsg = function(t) {
            var e = this.nolimitlist.rate;
            this.refresh(),
            this.nolimitlist.rate = e
        }
        ,
        e.prototype._loadInfo = function(t) {
            this.nolimitlist.loadOver(!0, game.FriendMgr.friend_list.length - this.nolimitlist.value_count)
        }
        ,
        e.prototype.refresh = function() {
            this.sortlist = [];
            for (var t = game.FriendMgr.friend_list, e = 0; e < t.length; e++)
                this.sortlist.push(e);
            this.sortlist = this.sortlist.sort(function(e, i) {
                var n = t[e]
                  , a = 0;
                if (n.state.is_online) {
                    a += "" != (o = game.Tools.playState2Desc(n.state.playing)) ? 6e10 : 3e10,
                    a += -n.state.login_time
                } else
                    a += n.state.logout_time;
                var r = t[i]
                  , s = 0;
                if (r.state.is_online) {
                    var o = game.Tools.playState2Desc(r.state.playing);
                    s += "" != o ? 6e10 : 3e10,
                    s += -r.state.login_time
                } else
                    s += r.state.logout_time;
                return s - a
            }),
            this.nolimitlist.reset(),
            this.nolimitlist.total_count = game.FriendMgr.friend_list.length,
            this.noinfo.visible = 0 == this.nolimitlist.total_count,
            300 == game.FriendMgr.friend_max_count ? this.count_limit.visible = !1 : (this.count_limit.text = t.length + "/" + game.FriendMgr.friend_max_count,
            this.count_limit.visible = !0)
        }
        ,
        e
    }()
      , i = function() {
        function e(t) {
            var e = this;
            this.playerinfos = [],
            this.me = t;
            var i = this.me.getChildByName("scrollview");
            this.nolimitlist = i.scriptMap["capsui.NoLimitList"],
            this.nolimitlist.init_nolimitlist(Laya.Handler.create(this, this._loadInfo, null, !1), Laya.Handler.create(this, function(t) {
                e.setItem(t.index, t.container, t.cache_data)
            }, null, !1)),
            this.nolimitlist.reset(),
            this.noinfo = this.me.getChildByName("noinfo")
        }
        return e.prototype.onEnable = function() {
            this.me.visible = !0,
            this.refresh()
        }
        ,
        e.prototype.onDisable = function() {
            this.me.visible = !1
        }
        ,
        e.prototype.setItem = function(e, i, n) {
            var a = this;
            if (this.me.visible) {
                n.hasOwnProperty("name") || (n.head = new t.UI_Head(i.getChildByName("head")),
                n.level = new t.UI_Level(i.getChildByName("rank")),
                n.name = i.getChildByName("name"),
                n.state = i.getChildByName("state"),
                n.btn_check = i.getChildByName("check"),
                n.btn_agree = i.getChildByName("agree"),
                n.btn_reject = i.getChildByName("reject"),
                n.title = new t.UI_PlayerTitle(i.getChildByName("title")));
                var r = this.playerinfos[e];
                n.head.id = r.info.avatar_id,
                n.level.id = r.info.level.id,
                n.name.text = r.info.nickname,
                n.title.id = r.info.title;
                var s = r.account_id;
                n.state.text = game.Tools.time2Desc(r.apply_time),
                n.btn_check.clickHandler = Laya.Handler.create(this, function() {
                    t.UI_OtherPlayerInfo.Inst.show(s)
                }),
                game.Tools.setGrayDisable(n.btn_agree, !1),
                n.btn_agree.clickHandler = Laya.Handler.create(this, function() {
                    game.Tools.setGrayDisable(n.btn_agree, !0),
                    app.NetAgent.sendReq2Lobby("Lobby", "handleFriendApply", {
                        target_id: s,
                        method: 1
                    }, function(e, i) {
                        game.Tools.setGrayDisable(n.btn_agree, !1),
                        e || i.error ? t.UIMgr.Inst.showNetReqError("handleFriendApply", e, i) : a.removeItem(s)
                    })
                }, null, !1),
                game.Tools.setGrayDisable(n.btn_reject, !1),
                n.btn_reject.clickHandler = Laya.Handler.create(this, function() {
                    game.Tools.setGrayDisable(n.btn_reject, !0),
                    app.NetAgent.sendReq2Lobby("Lobby", "handleFriendApply", {
                        target_id: s,
                        method: 2
                    }, function(e, i) {
                        game.Tools.setGrayDisable(n.btn_reject, !1),
                        e || i.error ? t.UIMgr.Inst.showNetReqError("handleFriendApply", e, i) : a.removeItem(s)
                    })
                }, null, !1)
            }
        }
        ,
        e.prototype.removeItem = function(t) {
            for (var e = -1, i = 0; i < this.playerinfos.length; i++)
                if (this.playerinfos[i].account_id == t) {
                    e = i;
                    for (var n = i; n < this.playerinfos.length - 1; n++)
                        this.playerinfos[n] = this.playerinfos[n + 1];
                    this.playerinfos.pop();
                    break
                }
            game.FriendMgr.delFriendApply(t),
            -1 != e && this.nolimitlist.delItem(e),
            a.Inst.refreshRedpoint(),
            this.noinfo.visible = 0 == this.playerinfos.length
        }
        ,
        e.prototype._loadInfo = function(e) {
            for (var i = this, n = [], a = 0; a < 20 && a + e < this.playerinfos.length; a++)
                n.push(this.playerinfos[e + a].account_id);
            0 == n.length ? (game.Tools.debugFetchMultiAccountBrief("apply_friend", e, this.nolimitlist.total_count, this.nolimitlist.value_count),
            this.nolimitlist.loadOver(!1, 0)) : app.NetAgent.sendReq2Lobby("Lobby", "fetchMultiAccountBrief", {
                account_id_list: n
            }, function(n, a) {
                if (n || a.error)
                    t.UIMgr.Inst.showNetReqError("fetchMultiAccountBrief", n, a),
                    i.nolimitlist.loadOver(!1, 0);
                else {
                    for (var r = -1, s = 0; s < a.players.length; s++) {
                        if (i.playerinfos[e + s].info = a.players[s],
                        i.playerinfos[e + s].account_id != a.players[s].account_id) {
                            r = e + s;
                            break
                        }
                        i.playerinfos[e + s].info = a.players[s]
                    }
                    -1 != r ? (t.UIMgr.Inst.ShowErrorInfo(game.Tools.strOfLocalization(2074, [(r + 1).toString()])),
                    i.nolimitlist.loadOver(!1, 0)) : i.nolimitlist.loadOver(!0, a.players.length)
                }
            })
        }
        ,
        e.prototype.refresh = function() {
            this.nolimitlist.reset(),
            this.playerinfos = [],
            this.noinfo.visible = !1;
            for (var t = 0; t < game.FriendMgr.friendapply_list.length; t++)
                this.playerinfos.push({
                    account_id: game.FriendMgr.friendapply_list[t].account_id,
                    apply_time: game.FriendMgr.friendapply_list[t].apply_time
                });
            this.playerinfos = this.playerinfos.sort(function(t, e) {
                return t.apply_time - e.apply_time
            }),
            this.nolimitlist.total_count = this.playerinfos.length,
            this.noinfo.visible = 0 == this.playerinfos.length
        }
        ,
        e
    }()
      , n = function() {
        function e(t) {
            var e = this;
            this.playerinfos = [],
            this.searchend = !1,
            this.timecd = {},
            this.searchnext = !1,
            this.me = t;
            var i = this.me.getChildByName("scrollview");
            this.nolimitlist = i.scriptMap["capsui.NoLimitList"],
            this.nolimitlist.init_nolimitlist(Laya.Handler.create(this, this._loadInfo, null, !1), Laya.Handler.create(this, function(t) {
                e.setItem(t.index, t.container, t.cache_data)
            }, null, !1)),
            this.nolimitlist.reset(),
            this.input = this.me.getChildByName("input").getChildAt(0),
            this.btn_search = this.me.getChildByName("search"),
            this.btn_search.clickHandler = Laya.Handler.create(this, function() {
                "" != e.input.text && (e.playerinfos = [],
                e.nolimitlist.reset(),
                e.searchnext = !1,
                e.searchend = !1,
                e.nolimitlist.total_count = 1,
                game.Tools.setGrayDisable(e.btn_search, !0),
                Laya.timer.once(3e3, e, function() {
                    game.Tools.setGrayDisable(e.btn_search, !1)
                }))
            }, null, !1)
        }
        return e.prototype.onEnable = function() {
            this.me.visible = !0,
            this.nolimitlist.reset(),
            this.playerinfos = [],
            this.input.text = "",
            this.searchend = !0,
            this.timecd = {},
            game.Tools.setGrayDisable(this.btn_search, !1)
        }
        ,
        e.prototype.onDisable = function() {
            this.me.visible = !1
        }
        ,
        e.prototype.setItem = function(e, i, n) {
            var a = this;
            if (this.me.visible)
                for (var r = function(r) {
                    var o = "p" + r;
                    if (!n.hasOwnProperty(o)) {
                        var l = {
                            container: i.getChildByName(o),
                            head: new t.UI_Head(i.getChildByName(o).getChildByName("head")),
                            add_1: i.getChildByName(o).getChildByName("add_1"),
                            btn_add: i.getChildByName(o).getChildByName("add"),
                            name: i.getChildByName(o).getChildByName("name"),
                            title: new t.UI_PlayerTitle(i.getChildByName(o).getChildByName("title"))
                        };
                        n[o] = l
                    }
                    var h = n[o]
                      , c = 2 * e + r;
                    if (c >= s.playerinfos.length)
                        h.container.visible = !1;
                    else {
                        h.container.visible = !0;
                        var u = s.playerinfos[c];
                        h.head.id = u.info.avatar_id,
                        h.name.text = u.info.nickname,
                        h.title.id = u.info.title;
                        var _ = u.account_id;
                        if (game.FriendMgr.find(_))
                            h.add_1.visible = !0,
                            h.add_1.text = game.Tools.strOfLocalization(2075),
                            h.btn_add.visible = !1;
                        else if (u.info.added)
                            h.add_1.visible = !0,
                            h.add_1.text = game.Tools.strOfLocalization(2076),
                            h.btn_add.visible = !1;
                        else {
                            h.add_1.visible = !1,
                            h.btn_add.visible = !0;
                            var d = 0;
                            s.timecd.hasOwnProperty(_.toString()) && (d = s.timecd[_.toString()] + 1e4 - Laya.timer.currTimer) < 0 && (d = 0);
                            var f = h.btn_add;
                            Laya.timer.clearAll(f),
                            d > 0 && (game.Tools.setGrayDisable(f, !0),
                            Laya.timer.once(d, f, function() {
                                game.Tools.setGrayDisable(f, !1)
                            })),
                            game.Tools.setGrayDisable(f, !1),
                            f.clickHandler = Laya.Handler.create(s, function() {
                                a.timecd[_.toString()] = Laya.timer.currTimer,
                                app.NetAgent.sendReq2Lobby("Lobby", "applyFriend", {
                                    target_id: _
                                }, function(e, i) {
                                    (e || i.error) && t.UIMgr.Inst.showNetReqError("applyFriend", e, i)
                                }),
                                h.add_1.visible = !0,
                                h.add_1.text = game.Tools.strOfLocalization(2076),
                                h.btn_add.visible = !1,
                                u.info.added = !0
                            }, null, !1)
                        }
                    }
                }, s = this, o = 0; o < 2; o++)
                    r(o)
        }
        ,
        e.prototype._loadInfo = function(e) {
            var i = this;
            e >= 50 ? this.nolimitlist.loadOver(!1, 0) : app.NetAgent.sendReq2Lobby("Lobby", "searchAccountByPattern", {
                search_next: this.searchnext,
                pattern: this.input.text
            }, function(n, a) {
                if (n || a.error)
                    return t.UIMgr.Inst.showNetReqError("searchAccountByPattern", n, a),
                    void i.nolimitlist.loadOver(!1, 0);
                var r = i.playerinfos.length;
                if (i.searchend = a.is_finished,
                i.searchend ? i.nolimitlist.total_count = Math.ceil(i.playerinfos.length / 2) : (i.nolimitlist.total_count = Math.ceil(i.playerinfos.length / 2) + 1,
                i.searchnext = !0),
                a.match_accounts && 0 != a.match_accounts.length || a.decode_id) {
                    var s = [];
                    if (0 == i.nolimitlist.value_count && a.decode_id && a.decode_id != GameMgr.Inst.account_id && s.push(a.decode_id),
                    a.match_accounts)
                        for (var o = 0; o < a.match_accounts.length; o++)
                            s.push(a.match_accounts[o]);
                    0 == s.length ? (game.Tools.debugFetchMultiAccountBrief("search_friend", e, i.nolimitlist.total_count, i.nolimitlist.value_count),
                    i.nolimitlist.loadOver(!1, 0)) : app.NetAgent.sendReq2Lobby("Lobby", "fetchMultiAccountBrief", {
                        account_id_list: s
                    }, function(e, n) {
                        if (e || n.error)
                            t.UIMgr.Inst.showNetReqError("fetchMultiAccountBrief", e, n),
                            i.nolimitlist.loadOver(!1, 0);
                        else {
                            for (var a = -1, o = 0; o < n.players.length; o++) {
                                if (s[o] != n.players[o].account_id) {
                                    a = r + o;
                                    break
                                }
                                i.playerinfos.push({
                                    account_id: s[o],
                                    info: n.players[o]
                                })
                            }
                            -1 != a ? (t.UIMgr.Inst.ShowErrorInfo(game.Tools.strOfLocalization(2074, [(a + 1).toString()])),
                            i.nolimitlist.loadOver(!1, 0)) : i.nolimitlist.loadOver(!0, Math.ceil(i.playerinfos.length / 2) - i.nolimitlist.value_count)
                        }
                    })
                } else
                    i.nolimitlist.loadOver(!0, 0)
            })
        }
        ,
        e
    }()
      , a = function(a) {
        function r() {
            var t = a.call(this, new ui.lobby.friendUI) || this;
            return t.page_friend = null,
            t.page_apply = null,
            t.page_search = null,
            t.root = null,
            t.top = null,
            t.tabs = [],
            t.redpoint = null,
            t.label_id = null,
            t.currentpage = -1,
            t.locking = !1,
            r.Inst = t,
            t
        }
        return __extends(r, a),
        r.prototype.onCreate = function() {
            var a = this;
            this.top = this.me.getChildByName("top"),
            this.root = this.me.getChildByName("root"),
            this.page_friend = new e(this.root.getChildByName("page_friend")),
            this.page_apply = new i(this.root.getChildByName("page_apply")),
            this.page_search = new n(this.root.getChildByName("page_find"));
            for (var r = 0; r < this.root.getChildByName("tabs").numChildren; r++) {
                var s = this.root.getChildByName("tabs").getChildAt(r);
                s.clickHandler = Laya.Handler.create(this, this.showpage, [r], !1),
                this.tabs.push(s)
            }
            this.redpoint = this.root.getChildByName("tabs").getChildByName("btn_applylist").getChildByName("redpoint"),
            this.redpoint.visible = !1,
            this.page_friend.me.visible = !1,
            this.page_apply.me.visible = !1,
            this.page_search.me.visible = !1,
            this.top.getChildByName("btn_back").clickHandler = Laya.Handler.create(this, function() {
                a.locking || a.close(Laya.Handler.create(a, function() {
                    t.UIMgr.Inst.showLobby()
                }))
            }, null, !1),
            this.label_id = this.root.getChildByName("id").getChildByName("id")
        }
        ,
        r.prototype.show = function() {
            var e = this;
            game.Scene_Lobby.Inst.change_bg("indoor", !1),
            this.currentpage = -1,
            this.locking = !0,
            this.enable = !0,
            t.UIBase.anim_alpha_in(this.top, {
                y: -30
            }, 200),
            t.UIBase.anim_alpha_in(this.root, {
                y: 30
            }, 200),
            Laya.timer.once(200, this, function() {
                e.locking = !1,
                e.showpage(0)
            }),
            this.refreshRedpoint(),
            this.label_id.text = game.Tools.encode_account_id2(GameMgr.Inst.account_id).toString()
        }
        ,
        r.prototype.refreshRedpoint = function() {
            this.redpoint.visible = game.FriendMgr.friendapply_list && game.FriendMgr.friendapply_list.length > 0
        }
        ,
        r.prototype.close = function(e) {
            var i = this;
            this.locking = !0,
            t.UIBase.anim_alpha_out(this.top, {
                y: -30
            }, 200),
            t.UIBase.anim_alpha_out(this.root, {
                y: 30
            }, 200),
            Laya.timer.once(200, this, function() {
                i.locking = !1,
                i.enable = !1,
                e && e.run()
            })
        }
        ,
        r.prototype.onDisable = function() {
            this.currentpage && (this.tabs[this.currentpage].skin = game.Tools.localUISrc("myres/shop/tab_unchoose.png"),
            this.currentpage = -1),
            this.page_friend.close(),
            this.page_apply.onDisable(),
            this.page_search.onDisable()
        }
        ,
        r.prototype.showpage = function(t) {
            if (this.currentpage != t) {
                if (-1 != this.currentpage)
                    switch (this.tabs[this.currentpage].skin = game.Tools.localUISrc("myres/shop/tab_unchoose.png"),
                    this.currentpage) {
                    case 0:
                        this.page_friend.close();
                        break;
                    case 1:
                        this.page_apply.onDisable();
                        break;
                    case 2:
                        this.page_search.onDisable()
                    }
                switch (this.currentpage = t,
                this.tabs[this.currentpage].skin = game.Tools.localUISrc("myres/shop/tab_choose.png"),
                this.currentpage) {
                case 0:
                    this.page_friend.show();
                    break;
                case 1:
                    this.page_apply.onEnable();
                    break;
                case 2:
                    this.page_search.onEnable()
                }
            }
        }
        ,
        r
    }(t.UIBase);
    t.UI_Friend = a
}(uiscript || (uiscript = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), uiscript;
!function(t) {
    var e = function() {
        function t(t, e, i) {
            this.me = t,
            this.anim_in = e,
            this.anim_out = i,
            this.img_title = this.me.getChildByName("img_title")
        }
        return t.prototype.show = function(t) {
            this.img_title.skin = game.LoadMgr.getResImageSkin(cfg.achievement.achievement.find(t).icon),
            this.anim_in && this.anim_in.play(0, !1)
        }
        ,
        t.prototype.hide = function() {
            this.anim_out.play(0, !1)
        }
        ,
        t
    }()
      , i = function(i) {
        function n() {
            var t = i.call(this, new ui.mj.gameendUI) || this;
            return t.btn_next = null,
            t.players = [],
            t.root = null,
            t.illust = null,
            t.origin_illust_rect = null,
            t.step = 0,
            t.second_step = 0,
            t.locking = !1,
            t.page_gettitle = null,
            t.newachievements = [],
            t.duringshowing = !1,
            n.Inst = t,
            t
        }
        return __extends(n, i),
        n.prototype.onCreate = function() {
            var i = this;
            this.root = this.me.getChildByName("root"),
            this.illust = this.root.getChildByName("illust"),
            this.origin_illust_rect = t.UIRect.CreateFromSprite(this.illust),
            this.btn_next = this.root.getChildByName("btn_next"),
            this.btn_next.clickHandler = Laya.Handler.create(this, function() {
                i.onConfirm()
            }, null, !1);
            for (var n = 0; n < 4; n++) {
                var a = this.me.getChildByName("root").getChildByName("p" + n.toString());
                this.players.push({
                    root: a,
                    label_name: a.getChildByName("label_name"),
                    label_score: a.getChildByName("val"),
                    container_score: a.getChildByName("container_score"),
                    label_g0: a.getChildByName("img_g0").getChildByName("val"),
                    label_g1: a.getChildByName("img_g1").getChildByName("val"),
                    x: a.x,
                    img_mySelf: a.getChildByName("myself"),
                    head: new t.UI_Head(a.getChildByName("head"))
                })
            }
            this.page_gettitle = new e(this.root.getChildByName("gettitle"),this.me.title_in,this.me.title_out)
        }
        ,
        n.prototype.show = function() {
            var e = this
              , i = view.DesktopMgr.Inst.gameEndResult;
            if (null == i)
                return t.UIMgr.Inst.ShowErrorInfo(game.Tools.strOfLocalization(2077)),
                void game.Scene_MJ.Inst.GameEnd();
            this.duringshowing = !0,
            this.page_gettitle.me.visible = !1,
            this.root.alpha = 0,
            Laya.Tween.to(this.root, {
                alpha: 1
            }, 1e3);
            for (o = 0; o < this.players.length; o++)
                this.players[o].root.visible = !1;
            var n = [];
            n = i.players;
            var a = view.DesktopMgr.Inst.player_datas[n[0].seat];
            game.Tools.charaPart(a.avatar_id, this.illust, "full", this.origin_illust_rect),
            view.DesktopMgr.Inst.mode == view.EMJMode.play && a.character && Laya.timer.once(1800 + 800 * n.length - 500, this, function() {
                view.AudioMgr.PlayCharactorSound(a.character, "game_top")
            });
            for (var r = function(e) {
                var i = n[e]
                  , a = s.players[e];
                i.gold >= 0 ? (a.label_g0.text = "+" + i.gold,
                a.label_g0.color = "#4ea583") : (a.label_g0.text = i.gold.toString(),
                a.label_g0.color = "#ff3451"),
                i.grading_score >= 0 ? (a.label_g1.text = "+" + i.grading_score,
                a.label_g1.color = "#4ea583") : (a.label_g1.text = i.grading_score,
                a.label_g1.color = "#ff3451"),
                a.label_g1.text = (i.grading_score >= 0 ? "+" : "") + i.grading_score,
                a.label_name.text = view.DesktopMgr.Inst.player_datas[i.seat].nickname,
                a.head.id = view.DesktopMgr.Inst.player_datas[i.seat].avatar_id;
                var r = i.total_point / 1e3;
                r > 0 ? (a.label_score.text = "+" + r.toString(),
                a.label_score.color = "#45c36a") : (a.label_score.text = r.toString(),
                a.label_score.color = "#f94538");
                for (var o = i.part_point_1.toString(), l = 0; l < a.container_score.numChildren; l++)
                    a.container_score.getChildAt(l).visible = !1;
                for (var h = 0; h < o.length && h < a.container_score.numChildren; h++) {
                    var c = a.container_score.getChildByName((a.container_score.numChildren - 1 - h).toString())
                      , u = o.charAt(h);
                    c.skin = "-" == u ? game.Tools.localUISrc("myres/mjdesktop/ww_minus.png") : game.Tools.localUISrc("myres/mjdesktop/ww_" + u + ".png"),
                    c.visible = !0
                }
                a.root.visible = !1,
                a.img_mySelf.visible = i.seat == view.DesktopMgr.Inst.seat,
                i.seat == view.DesktopMgr.Inst.seat && (view.DesktopMgr.Inst.ptchange = i.grading_score),
                Laya.timer.once(1800 + 800 * e, s, function() {
                    a.root.visible = !0,
                    t.UIBase.anim_alpha_in(a.root, {
                        x: -200
                    }, 200, 0, null, Laya.Ease.strongIn),
                    0 == e ? view.AudioMgr.PlayAudio(218) : view.AudioMgr.PlayAudio(219)
                })
            }, s = this, o = 0; o < n.length; o++)
                r(o);
            this.locking = !0,
            this.btn_next.visible = !1,
            Laya.timer.once(1800 + 800 * n.length, this, function() {
                e.locking = !1,
                e.btn_next.visible = !0
            }),
            this.enable = !0,
            Laya.timer.once(3500, this, GameMgr.Inst.updateAccountInfo),
            4 == view.DesktopMgr.Inst.game_config.category && view.DesktopMgr.Inst.mode == view.EMJMode.play && Laya.timer.once(1100, this, function() {
                GameMgr.Inst.custom_match_id = view.DesktopMgr.Inst.game_config.meta.customized_contest_uid
            }),
            this.step = 0
        }
        ,
        n.prototype.onConfirm = function() {
            var e = this;
            if (!this.locking)
                if (0 == this.step)
                    this.step = 30,
                    this.onConfirm();
                else if (30 == this.step)
                    view.DesktopMgr.Inst.levelchangeinfo ? (this.btn_next.visible = !1,
                    this.closeRankList(Laya.Handler.create(this, function() {
                        t.UI_RankChange.Inst.show(Laya.Handler.create(e, function() {
                            e.step = 31,
                            e.btn_next.visible = !0
                        }))
                    }))) : (this.step = 50,
                    this.onConfirm());
                else if (31 == this.step)
                    t.UI_RankChange.Inst.close(),
                    this.step = 50,
                    this.onConfirm();
                else if (50 == this.step)
                    view.DesktopMgr.Inst.rewardinfo && view.DesktopMgr.Inst.rewardinfo.match_chest ? (this.btn_next.visible = !1,
                    this.closeRankList(Laya.Handler.create(this, function() {
                        t.UI_MJReward.Inst.show(Laya.Handler.create(e, function() {
                            e.step = 51,
                            e.btn_next.visible = !0
                        }))
                    }))) : (this.step = 60,
                    this.onConfirm());
                else if (51 == this.step)
                    t.UI_MJReward.Inst.close(),
                    this.step = 60,
                    this.onConfirm();
                else if (60 == this.step) {
                    var i = t.UI_MJTask_Progress.needShow();
                    app.Log.log("pengding need show lst:" + i.length),
                    i.length > 0 ? (this.btn_next.visible = !1,
                    this.closeRankList(Laya.Handler.create(this, function() {
                        t.UI_MJTask_Progress.Inst.show(i, Laya.Handler.create(e, function() {
                            e.step = 70,
                            e.btn_next.visible = !0
                        }))
                    }))) : (this.step = 70,
                    this.onConfirm())
                } else if (70 == this.step) {
                    var n = view.DesktopMgr.Inst.activity_reward;
                    n && n.activity_reward && n.activity_reward.length > 0 ? (this.btn_next.visible = !1,
                    this.closeRankList(Laya.Handler.create(this, function() {
                        t.UI_MJReward_Activity.Inst.show(n, Laya.Handler.create(e, function() {
                            e.step = 80,
                            e.btn_next.visible = !0
                        }))
                    }))) : (this.step = 80,
                    this.onConfirm())
                } else
                    80 == this.step ? (this.step = 81,
                    this.onConfirm()) : 81 == this.step && (this.enable = !1,
                    Laya.loader.clearTextureRes(this.illust.skin),
                    game.Scene_MJ.Inst.GameEnd())
        }
        ,
        n.prototype.forceclose = function() {
            this.enable = !1,
            Laya.timer.clearAll(this)
        }
        ,
        n.prototype.closeRankList = function(e) {
            var i = this;
            if (this.duringshowing) {
                this.duringshowing = !1;
                for (var n = 0; n < this.players.length; n++)
                    t.UIBase.anim_alpha_out(this.players[n].root, {
                        x: 100
                    }, 200, 0, null, Laya.Ease.backIn);
                t.UIBase.anim_alpha_out(this.illust, {}, 200, 0, Laya.Handler.create(this, function() {
                    Laya.loader.clearTextureRes(i.illust.skin),
                    game.Tools.charaPart(GameMgr.Inst.account_data.avatar_id, i.illust, "full", i.origin_illust_rect),
                    i.illust.getChildAt(0).visible = !1,
                    t.UIBase.anim_alpha_in(i.illust, {}, 200, 100)
                })),
                view.AudioMgr.PlayAudio(228),
                Laya.timer.once(500, this, function() {
                    e.run()
                })
            } else
                e.run()
        }
        ,
        n.Inst = null,
        n
    }(t.UIBase);
    t.UI_GameEnd = i
}(uiscript || (uiscript = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), uiscript;
!function(t) {
    var e = function(e) {
        function i() {
            var t = e.call(this, new ui.mj.gamestopUI) || this;
            return i.Inst = t,
            t
        }
        return __extends(i, e),
        i.prototype.onCreate = function() {
            this.blackbg = this.me.getChildByName("blackbg"),
            this.root = this.me.getChildByName("root"),
            this.label_dots = this.root.getChildByName("dots")
        }
        ,
        i.prototype.show = function() {
            var e = this;
            if (!this.enable) {
                this.enable = !0,
                view.DesktopMgr.Inst.mode == view.EMJMode.play ? (this.blackbg.visible = !0,
                this.blackbg.alpha = 0,
                Laya.Tween.to(this.blackbg, {
                    alpha: .3
                }, 200)) : this.blackbg.visible = !1,
                this.root.scaleX = this.root.scaleY = 1,
                t.UIBase.anim_pop_out(this.root, null),
                Laya.timer.clearAll(this);
                var i = 0;
                Laya.timer.loop(1e3, this, function() {
                    for (var t = "", n = 0; n < i; n++)
                        t += ".";
                    i = (i + 1) % 4,
                    e.label_dots.text = t
                })
            }
        }
        ,
        i.prototype.close = function() {
            this.enable = !1,
            Laya.timer.clearAll(this)
        }
        ,
        i
    }(t.UIBase);
    t.UI_GameStop = e
}(uiscript || (uiscript = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), uiscript;
!function(t) {
    var e = function(e) {
        function i() {
            var t = e.call(this, new ui.both_ui.getrewardUI) || this;
            return t.items = [],
            i.Inst = t,
            t
        }
        return __extends(i, e),
        i.prototype.onCreate = function() {
            var e = this;
            this.root = this.me.getChildByName("root");
            var i = this.root.getChildByName("items");
            this.container_items = i;
            for (var n = 0; n < i.numChildren; n++) {
                var a = i.getChildAt(n);
                this.items.push({
                    container: a,
                    icon: new t.UI_Item_Skin(a.getChildByName("icon")),
                    count: a.getChildByName("count"),
                    name: a.getChildByName("name")
                })
            }
            this.btn_close = this.me.getChildByName("btn_close"),
            this.btn_close.clickHandler = Laya.Handler.create(this, function() {
                e.locking || e.close()
            }, null, !1)
        }
        ,
        i.prototype.show = function(t, e) {
            var i = this;
            this.enable = !0,
            this.complete = e;
            for (var n = function(e) {
                if (e < t.length) {
                    a.items[e].container.visible = !0;
                    var n = game.GameUtility.get_item_view(t[e].id);
                    a.items[e].icon.setSkin(n.icon),
                    a.items[e].name.text = n.name,
                    a.items[e].count.text = t[e].count.toString(),
                    a.items[e].container.x = a.container_items.width / 2 - 210 * (t.length - 1) / 2 + 210 * e,
                    a.items[e].container.y = 72,
                    a.items[e].container.scaleX = 0,
                    a.items[e].container.scaleY = 0,
                    a.items[e].container.alpha = 0,
                    a.items[e].name.alpha = 0,
                    a.items[e].count.alpha = 0,
                    Laya.Tween.to(a.items[e].container, {
                        scaleX: 1,
                        scaleY: 1,
                        alpha: 1
                    }, 200, Laya.Ease.backOut, Laya.Handler.create(a, function() {
                        i.items[e].name.alpha = 1,
                        i.items[e].count.alpha = 1
                    }), 150 * e + 400)
                } else
                    a.items[e].container.visible = !1
            }, a = this, r = 0; r < this.items.length; r++)
                n(r);
            this.btn_close.visible = !1,
            this.root.alpha = 1,
            this.root.scaleY = 1,
            this.locking = !0,
            this.me.in.play(0, !1),
            Laya.timer.once(400 + 150 * t.length, this, function() {
                i.locking = !1,
                i.btn_close.visible = !0
            })
        }
        ,
        i.prototype.close = function() {
            var t = this;
            this.locking = !0,
            this.me.out.play(0, !1),
            Laya.timer.once(200, this, function() {
                t.locking = !1,
                t.enable = !1,
                t.complete && t.complete.run()
            })
        }
        ,
        i.Inst = null,
        i
    }(t.UIBase);
    t.UI_Getrewardextends = e
}(uiscript || (uiscript = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), uiscript;
!function(t) {
    var e = function(t) {
        function e() {
            var i = t.call(this, new ui.both_ui.gettitleUI) || this;
            return e.Inst = i,
            i
        }
        return __extends(e, t),
        e.prototype.onCreate = function() {
            var t = this;
            this.root = this.me.getChildByName("root"),
            this.icon = this.root.getChildByName("icon"),
            this.btn_close = this.me.getChildByName("btn_close"),
            this.btn_close.clickHandler = Laya.Handler.create(this, function() {
                t.locking || t.close()
            }, null, !1)
        }
        ,
        e.prototype.show = function(t, e) {
            var i = this;
            this.enable = !0,
            this.complete = e,
            this.icon.skin = game.LoadMgr.getResImageSkin(cfg.item_definition.title.get(t).icon),
            this.btn_close.visible = !1,
            this.root.alpha = 1,
            this.locking = !0,
            this.me.in.play(0, !1),
            Laya.timer.once(1e3, this, function() {
                i.locking = !1,
                i.btn_close.visible = !0
            })
        }
        ,
        e.prototype.close = function() {
            var t = this;
            this.locking = !0,
            this.me.out.play(0, !1),
            Laya.timer.once(200, this, function() {
                t.locking = !1,
                t.enable = !1,
                t.complete && t.complete.run()
            })
        }
        ,
        e.Inst = null,
        e
    }(t.UIBase);
    t.UI_Gettitle = e
}(uiscript || (uiscript = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), uiscript;
!function(t) {
    var e = function(e) {
        function i() {
            var t = e.call(this, new ui.both_ui.gitfcodeUI) || this;
            return i.Inst = t,
            t
        }
        return __extends(i, e),
        i.prototype.onCreate = function() {
            var e = this;
            this.root = this.me.getChildByName("root"),
            this.input = this.root.getChildByName("input"),
            this.root.getChildByName("btn_close").clickHandler = Laya.Handler.create(this, function() {
                e.locking || e.close()
            }, null, !1),
            this.btn_confirm = this.root.getChildByName("btn_confirm"),
            this.btn_confirm.clickHandler = Laya.Handler.create(this, function() {
                e.locking || e.btn_cd > Laya.timer.currTimer || (e.btn_cd = Laya.timer.currTimer + 1e3,
                app.NetAgent.sendReq2Lobby("Lobby", "useGiftCode", {
                    code: e.input.text
                }, function(i, n) {
                    e.btn_cd = 0,
                    i || n.error ? t.UIMgr.Inst.showNetReqError("useGiftCode", i, n) : game.Tools.showRewards(n, null)
                }))
            }, null, !1),
            this.input.on("input", this, function() {
                e.btn_confirm.visible = 12 == e.input.text.length
            })
        }
        ,
        i.prototype.show = function() {
            var e = this;
            this.enable = !0,
            this.locking = !0,
            this.input.text = "",
            this.btn_cd = 0,
            this.btn_confirm.visible = !1,
            t.UIBase.anim_pop_out(this.root, Laya.Handler.create(this, function() {
                e.locking = !1
            }))
        }
        ,
        i.prototype.close = function() {
            var e = this;
            this.locking = !0,
            t.UIBase.anim_pop_hide(this.root, Laya.Handler.create(this, function() {
                e.locking = !1,
                e.enable = !1
            }))
        }
        ,
        i.Inst = null,
        i
    }(t.UIBase);
    t.UI_Giftcode = e
}(uiscript || (uiscript = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), uiscript;
!function(t) {
    var e = function(e) {
        function i() {
            var t = e.call(this, new ui.common.hangup_logoutUI) || this;
            return i.Inst = t,
            t
        }
        return __extends(i, e),
        i.prototype.onCreate = function() {
            this.root = this.me.getChildByName("root"),
            this.root.getChildByName("btn").clickHandler = Laya.Handler.create(this, this.hide, null, !1)
        }
        ,
        i.prototype.show = function() {
            this.me.visible = !0,
            app.Log.info_net("UI_Hanguplogout  close net"),
            game.LobbyNetMgr.Inst.Close(),
            game.MJNetMgr.Inst && game.MJNetMgr.Inst.Close(),
            t.UIBase.anim_pop_out(this.root, null)
        }
        ,
        i.prototype.hide = function() {
            if (Laya.Browser.window.conch) {
                Laya.PlatformClass.createClass("layaair.majsoul.mjmgr").call("restart")
            } else
                Laya.Browser.window.location.href = GameMgr.Inst.link_url
        }
        ,
        i.Inst = null,
        i
    }(t.UIBase);
    t.UI_Hanguplogout = e
}(uiscript || (uiscript = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), uiscript;
!function(t) {
    var e = function(e) {
        function i() {
            var t = e.call(this, new ui.mj.hangup_warnUI) || this;
            return i.Inst = t,
            t
        }
        return __extends(i, e),
        i.prototype.onCreate = function() {
            var t = this;
            this.blackbg = this.me.getChildByName("blackbg"),
            this.root = this.me.getChildByName("root"),
            this.root.getChildByName("btn_confirm").clickHandler = new Laya.Handler(this,function() {
                t.locking || (view.DesktopMgr.Inst.hangupCount = 0,
                t.close())
            }
            )
        }
        ,
        i.prototype.show = function() {
            var e = this;
            this.locking = !0,
            this.enable = !0,
            this.blackbg.alpha = 0,
            Laya.Tween.to(this.blackbg, {
                alpha: .3
            }, 150),
            t.UIBase.anim_pop_out(this.root, Laya.Handler.create(this, function() {
                e.locking = !1
            }))
        }
        ,
        i.prototype.close = function() {
            var e = this;
            this.locking = !0,
            Laya.Tween.to(this.blackbg, {
                alpha: 0
            }, 150),
            t.UIBase.anim_pop_hide(this.root, Laya.Handler.create(this, function() {
                e.locking = !1,
                e.enable = !1
            }))
        }
        ,
        i
    }(t.UIBase);
    t.UI_Hangup_Warn = e
}(uiscript || (uiscript = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), uiscript;
!function(t) {
    var e = function(e) {
        function i() {
            var t = e.call(this, new ui.mj.hu_cutinUI) || this;
            return t.illust = null,
            t.rect = null,
            t.effect = null,
            t.secen = null,
            i.Inst = t,
            t
        }
        return __extends(i, e),
        i.show = function(e) {
            var n = this;
            this.Inst && this.Inst.destroy(),
            t.UIMgr.Inst.AddMJUI(this.Inst = new i);
            var a = Laya.timer.currFrame;
            Laya.loader.create("scene/hucutin.ls", Laya.Handler.create(this, function() {
                var t = 5 + a - Laya.timer.currFrame;
                t < 0 && (t = 1),
                Laya.timer.frameOnce(t, n, function() {
                    n.Inst._onShow(e)
                })
            }))
        }
        ,
        i.prototype.onCreate = function() {
            this.illust = this.me.getChildByName("root").getChildByName("container_illust").getChildByName("illust"),
            this.rect = t.UIRect.CreateFromSprite(this.illust),
            this.effect = this.me.getChildByName("root").getChildByName("effect"),
            this.secen = Laya.loader.getRes("scene/hucutin.ls"),
            this.effect.addChild(this.secen),
            this.secen.visible = !0
        }
        ,
        i.prototype._onShow = function(t) {
            var e = this;
            this.enable = !0,
            game.Tools.charaPart(t, this.illust, "half", this.rect),
            this.me.cutin.play(0, !1),
            view.AudioMgr.PlayAudio(206),
            Laya.timer.once(1100, this, function() {
                e.secen.visible = !1
            }),
            Laya.timer.once(1800, this, function() {
                e._onHide()
            })
        }
        ,
        i.prototype._onHide = function() {
            this.enable = !1,
            Laya.loader.clearTextureRes(this.illust.skin),
            this.destroy(),
            i.Inst = null
        }
        ,
        i.Inst = null,
        i
    }(t.UIBase);
    t.UI_HuCutIn = e
}(uiscript || (uiscript = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), uiscript;
!function(t) {
    var e = function(t) {
        function e() {
            var i = t.call(this, new ui.mj.huleshowUI) || this;
            return i.black_mask = null,
            i.container_rong = null,
            i.container_zimo = null,
            i.container_liuju = null,
            e.Inst = i,
            i
        }
        return __extends(e, t),
        e.prototype.onCreate = function() {
            this.black_mask = this.me.getChildByName("black_mask"),
            this.container_rong = this.me.getChildByName("container_rong"),
            this.container_zimo = this.me.getChildByName("container_zimo"),
            this.container_liuju = this.me.getChildByName("container_liuju")
        }
        ,
        e.prototype.showRong = function(t) {
            var e = this;
            this.container_liuju.visible = !1,
            this.container_zimo.visible = !1,
            this.container_rong.visible = !0;
            for (var i = [], n = 0; n < 4; n++)
                i.push(this.container_rong.getChildByName(n.toString())),
                i[n].visible = !1;
            this.black_mask.alpha = 0;
            for (var a = function(e) {
                var n = i[t[e]];
                n.visible = !0,
                n.alpha = 0,
                n.scaleX = 3,
                n.scaleY = 3,
                Laya.Tween.to(n, {
                    alpha: 1,
                    scaleX: 1,
                    scaleY: 1
                }, 200, Laya.Ease.strongIn, null, 300, !0),
                Laya.timer.once(300 + 30 * e, r, function() {
                    view.DesktopMgr.Inst.players[t[e]].PlaySound("act_ron")
                }),
                Laya.Tween.to(n, {
                    alpha: 0
                }, 0, Laya.Ease.strongIn, null, 1200)
            }, r = this, n = 0; n < t.length; n++)
                a(n);
            Laya.timer.once(1200, this, function() {
                e.enable = !1
            }),
            this.enable = !0
        }
        ,
        e.prototype.showZimo = function(t) {
            var e = this;
            this.container_liuju.visible = !1,
            this.container_rong.visible = !1,
            this.container_zimo.visible = !0;
            for (var i = [], n = 0; n < 4; n++)
                i.push(this.container_zimo.getChildByName(n.toString())),
                i[n].visible = !1;
            this.black_mask.alpha = 0;
            for (var a = function(e) {
                var n = i[t[e]];
                n.visible = !0,
                n.alpha = 0,
                n.scaleX = 3,
                n.scaleY = 3,
                Laya.Tween.to(n, {
                    alpha: 1,
                    scaleX: 1,
                    scaleY: 1
                }, 200, Laya.Ease.strongIn, null, 300, !0),
                Laya.timer.once(300, r, function() {
                    view.DesktopMgr.Inst.players[t[e]].PlaySound("act_tumo")
                }),
                Laya.Tween.to(n, {
                    alpha: 0
                }, 0, Laya.Ease.strongIn, null, 1200)
            }, r = this, n = 0; n < t.length; n++)
                a(n);
            Laya.timer.once(1200, this, function() {
                e.enable = !1
            }),
            this.enable = !0
        }
        ,
        e.prototype.showLiuJu = function(t) {
            var e = this;
            this.container_liuju.visible = !0,
            this.container_zimo.visible = !1,
            this.container_rong.visible = !1;
            for (var i = [], n = [], a = 0; a < 4; a++)
                i.push(this.container_liuju.getChildByName(a.toString())),
                i[a].visible = !1,
                n.push(this.container_liuju.getChildByName("no" + a)),
                n[a].visible = !1;
            for (a = 0; a < 4; a++)
                this.container_liuju.getChildByName("t" + a).visible = !1;
            this.black_mask.alpha = 0,
            Laya.Tween.to(this.black_mask, {
                alpha: .4
            }, 150);
            var r = this.container_liuju.getChildByName("title");
            r.alpha = 0,
            Laya.Tween.to(r, {
                alpha: 1
            }, 150);
            for (var s = "myres2/mjp/" + GameMgr.Inst.mjp_view + "/ui/", a = 0; a < 4; a++) {
                this.container_liuju.getChildByName("t" + a).visible = !1
            }
            for (var o = function(e) {
                var n = (e + view.DesktopMgr.Inst.index_ju) % view.DesktopMgr.Inst.player_count
                  , a = view.DesktopMgr.Inst.seat2LocalPosition(n)
                  , r = l.container_liuju.getChildByName("t" + a);
                if (t[n].tings && t[n].tings.length > 0) {
                    var o = i[a];
                    r.visible = !0;
                    for (var h = [], c = 0; c < t[n].tings.length; c++)
                        h.push(mjcore.MJPai.Create(t[n].tings[c].tile)),
                        h[c].dora = !1;
                    h = h.sort(mjcore.MJPai.Distance);
                    for (c = 0; c < r.numChildren; c++) {
                        var u = r.getChildAt(c);
                        c < h.length ? (u.visible = !0,
                        u.skin = game.Tools.localUISrc(s + h[c].toString() + ".png"),
                        u.x = 17 + 66 * c) : u.visible = !1
                    }
                    var _ = 34 + 60 * h.length + 6 * (h.length - 1);
                    if (r.width = _,
                    r.width < 350 || 2 == a || 0 == a ? r.x = o.x + o.width / 2 - _ / 2 : 1 == a ? r.x = o.x + 350 - _ : 3 == a && (r.x = o.x + o.width / 2 - 175),
                    r.alpha = 0,
                    Laya.Tween.to(r, {
                        alpha: 1
                    }, 150, Laya.Ease.strongIn, null, 300, !0),
                    o.visible = !0,
                    o.alpha = 0,
                    o.skin = game.Tools.localUISrc("myres/mjdesktop/show_tingpai.png"),
                    Laya.Tween.to(o, {
                        alpha: 1
                    }, 150, Laya.Ease.strongIn, null, 300, !0),
                    n == view.DesktopMgr.Inst.seat) {
                        var d = game.Tools.get_chara_audio(view.DesktopMgr.Inst.player_datas[n].character, "gameend_tingpai");
                        d && Laya.timer.once(300, l, function() {
                            view.AudioMgr.PlaySound(d.path, d.volume, null)
                        })
                    }
                } else if (r.visible = !1,
                n == view.DesktopMgr.Inst.seat) {
                    var f = game.Tools.get_chara_audio(view.DesktopMgr.Inst.player_datas[n].character, "gameend_noting");
                    f && Laya.timer.once(300, l, function() {
                        view.AudioMgr.PlaySound(f.path, f.volume, null)
                    })
                }
            }, l = this, h = 0; h < view.DesktopMgr.Inst.player_count; h++)
                o(h);
            Laya.timer.once(4500, this, function() {
                e.enable = !1
            }),
            this.enable = !0
        }
        ,
        e.Inst = null,
        e
    }(t.UIBase);
    t.UI_Huleshow = e
}(uiscript || (uiscript = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), uiscript;
!function(t) {
    var e = function() {
        function t(t) {
            this.content = null,
            this.me = t,
            this.btn_open = this.me.getChildByName("btn_open"),
            this.title = this.btn_open.getChildByName("info_title"),
            this.arrow = this.me.getChildByName("btn_open").getChildByName("arrow"),
            this.container_content = this.btn_open.getChildByName("content"),
            this.content = this.container_content.getChildAt(0),
            this.new_flag = this.me.getChildByName("new"),
            this.btn_cd = 0,
            this.isopen = !1,
            this.btn_open.clickHandler = Laya.Handler.create(this, this.switchShow, null, !1)
        }
        return Object.defineProperty(t.prototype, "h", {
            get: function() {
                var t = 0;
                return this.isnew && (t += 8),
                t += 90,
                this.isopen && (t += 40,
                t += this.content_h),
                t
            },
            enumerable: !0,
            configurable: !0
        }),
        t.prototype.onEnable = function(t, e, i) {
            this.announcement_id = t.id,
            this.title.text = t.title,
            this.content.text = t.content,
            this.content_h = this.content.textHeight,
            this.isopen = i,
            this.isnew = e,
            this.btn_cd = 0,
            this.isopen ? (this.container_content.alpha = 1,
            this.container_content.visible = !0,
            this.arrow.rotation = 0) : (this.container_content.visible = !1,
            this.arrow.rotation = -180),
            this.isnew ? (this.new_flag.visible = !0,
            this.btn_open.y = 8) : (this.new_flag.visible = !1,
            this.btn_open.y = 0),
            this.me.height = this.h
        }
        ,
        t.prototype.onDisable = function() {
            this.announcement_id > 0 && this.isopen && this.isnew && (app.NetAgent.sendReq2Lobby("Lobby", "readAnnouncement", {
                announcement_id: this.announcement_id
            }, function(t, e) {}),
            i.read_list.push(this.announcement_id),
            i.Inst.onReadStateChange()),
            this.announcement_id = -1,
            this.me.visible = !1
        }
        ,
        t.prototype.switchShow = function() {
            var t = this;
            Laya.timer.currTimer < this.btn_cd || (this.btn_cd = Laya.timer.currTimer + 200,
            Laya.timer.clearAll(this),
            this.isopen = !this.isopen,
            this.isopen ? (this.container_content.visible = !0,
            Laya.Tween.to(this.container_content, {
                alpha: 1
            }, 200, null, null, 0, !0),
            this.arrow.rotation = 0) : (this.isnew && (this.isnew = !1,
            this.new_flag.visible = !1,
            Laya.Tween.to(this.btn_open, {
                y: 0
            }, 100, Laya.Ease.strongOut),
            i.read_list.push(this.announcement_id),
            app.NetAgent.sendReq2Lobby("Lobby", "readAnnouncement", {
                announcement_id: this.announcement_id
            }, function(t, e) {}),
            i.Inst.onReadStateChange()),
            Laya.Tween.to(this.container_content, {
                alpha: 0
            }, 200, null, Laya.Handler.create(this, function() {
                t.container_content.visible = !1
            }), 0, !0),
            this.arrow.scaleY = 1,
            this.arrow.rotation = -180),
            this.me.height = this.h)
        }
        ,
        t
    }()
      , i = function(i) {
        function n() {
            var t = i.call(this, new ui.lobby.infoUI) || this;
            return t.items = [],
            t._last_time = 0,
            n.Inst = t,
            t
        }
        return __extends(n, i),
        n.lobbyPopout = function() {
            if (!this.first || !this.announcements || 0 == this.announcements.length)
                return !1;
            for (var t = !1, e = [], i = 0; i < n.announcements.length; i++)
                e.push(i);
            for (var a = {}, i = 0; i < n.announcement_sort.length; i++)
                a[n.announcement_sort[i].toString()] = i;
            return e = e.sort(function(t, e) {
                var i = 0
                  , r = n.announcements[t].id.toString();
                i = a.hasOwnProperty(r) ? a[r] : 1e3 + t;
                var s = 0
                  , o = n.announcements[e].id.toString();
                return s = a.hasOwnProperty(o) ? a[o] : 1e3 + e,
                i - s
            }),
            this.announcements.length > 0 && (t = !this.isAnnouncementReaded(this.announcements[e[0]].id)),
            !!t && (this.Inst.show(),
            !0)
        }
        ,
        Object.defineProperty(n, "haveRedPoint", {
            get: function() {
                for (var t = 0; t < this.announcements.length; t++)
                    if (!this.isAnnouncementReaded(this.announcements[t].id))
                        return !0;
                return !1
            },
            enumerable: !0,
            configurable: !0
        }),
        n.Init = function() {
            var e = this;
            this.read_list = [],
            app.NetAgent.sendReq2Lobby("Lobby", "fetchAnnouncement", {}, function(i, n) {
                i || n.error ? t.UIMgr.Inst.showNetReqError("fetchAnnouncement", i, n) : e._refreshAnnouncements(n)
            }),
            app.NetAgent.AddListener2Lobby("NotifyAnnouncementUpdate", Laya.Handler.create(this, this._refreshAnnouncements, null, !1))
        }
        ,
        n._refreshAnnouncements = function(t) {
            if (t.announcements && (this.announcements = t.announcements),
            t.sort && (this.announcement_sort = t.sort),
            t.read_list) {
                this.read_list = [];
                for (var e = 0; e < t.read_list.length; e++)
                    this.read_list.push(t.read_list[e])
            }
        }
        ,
        n.isAnnouncementReaded = function(t) {
            for (var e = 0; e < this.read_list.length; e++)
                if (this.read_list[e] == t)
                    return !0;
            return !1
        }
        ,
        n.prototype.onCreate = function() {
            var t = this;
            this.root = this.me.getChildByName("root"),
            this.root.getChildByName("btn_close").clickHandler = Laya.Handler.create(this, function() {
                t.locking || t.close()
            }, null, !1),
            this.panel = this.root.getChildByName("info"),
            this.panel.vScrollBar.visible = !1,
            this.item_templete = this.panel.getChildByName("templete"),
            this.items = [],
            this.item_templete.visible = !1
        }
        ,
        n.prototype.show = function() {
            var i = this;
            this.enable = !0,
            this.locking = !0;
            var a = 0;
            if (n.announcements.length > this.items.length) {
                a = 5;
                for (var r = this.items.length; r < n.announcements.length; r++) {
                    var s = this.item_templete.scriptMap["capsui.UICopy"].getNodeClone();
                    this.items.push(new e(s))
                }
            }
            this.root.visible = !1,
            Laya.timer.frameOnce(a, this, function() {
                for (var e = [], a = 0; a < n.announcements.length; a++)
                    e.push(a);
                for (var r = {}, a = 0; a < n.announcement_sort.length; a++)
                    r[n.announcement_sort[a].toString()] = a;
                e = e.sort(function(t, e) {
                    var i = 0
                      , a = n.announcements[t].id.toString();
                    i = r.hasOwnProperty(a) ? r[a] : 1e3 + t;
                    var s = 0
                      , o = n.announcements[e].id.toString();
                    return s = r.hasOwnProperty(o) ? r[o] : 1e3 + e,
                    i - s
                });
                for (a = 0; a < i.items.length; a++)
                    if (a >= e.length)
                        i.items[a].me.visible = !1;
                    else {
                        i.items[a].me.visible = !0;
                        var s = n.announcements[e[a]];
                        i.items[a].onEnable(s, !n.isAnnouncementReaded(s.id), 0 == a)
                    }
                i.panel.vScrollBar.stopScroll(),
                i.panel.vScrollBar.value = 0,
                i.panel.refresh(),
                i._last_time = 0,
                i.duringshow = !0,
                i.panel.vScrollBar.value = 0,
                i.root.visible = !0,
                t.UIBase.anim_pop_out(i.root, Laya.Handler.create(i, function() {
                    i.locking = !1
                }))
            })
        }
        ,
        n.prototype.close = function() {
            var e = this;
            this.duringshow = !1,
            this.locking = !0,
            this.panel.vScrollBar.stopScroll(),
            t.UIBase.anim_pop_hide(this.root, Laya.Handler.create(this, function() {
                e.locking = !1,
                e.enable = !1
            }))
        }
        ,
        n.prototype.onDisable = function() {
            this.panel.vScrollBar.stopScroll();
            for (var t = 0; t < this.items.length; t++)
                this.items[t].me.visible && this.items[t].onDisable()
        }
        ,
        n.prototype.update = function() {
            if (this.duringshow) {
                for (var t = 0, e = (this.panel.vScrollBar.value,
                this.panel.vScrollBar.max,
                0); e < this.items.length; e++)
                    if (this.items[e].me.visible) {
                        var i = this.items[e].me.y
                          , n = Math.abs(i - t);
                        if (n < .001)
                            this.items[e].me.y = t;
                        else {
                            var a = Math.sqrt(2 * n / (1400 / 22500))
                              , r = Laya.timer.currTimer - this._last_time;
                            if (r >= a)
                                this.items[e].me.y = t;
                            else {
                                var s = 1400 / 22500 * .5 * (a - r) * (a - r);
                                this.items[e].me.y = i < t ? t - s : t + s
                            }
                        }
                        t += this.items[e].h
                    }
                this.panel.refresh(),
                this._last_time = Laya.timer.currTimer
            }
        }
        ,
        n.prototype.onReadStateChange = function() {
            t.UI_Lobby.Inst.top.refreshRedpoint()
        }
        ,
        n.Inst = null,
        n.announcements = [],
        n.announcement_sort = [],
        n.read_list = [],
        n.first = !0,
        n
    }(t.UIBase);
    t.UI_Info = i
}(uiscript || (uiscript = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), uiscript;
!function(t) {
    var e = function(e) {
        function i() {
            var t = e.call(this, new ui.both_ui.infoliteUI) || this;
            return t.panel = null,
            t.desc = null,
            t.locking = !1,
            i.Inst = t,
            t
        }
        return __extends(i, e),
        i.prototype.onCreate = function() {
            var t = this;
            this.root = this.me.getChildByName("root"),
            this.panel = this.root.getChildByName("content"),
            this.panel.vScrollBar.visible = !1,
            this.desc = this.panel.getChildByName("desc"),
            this.locking = !1,
            this.root.getChildByName("btn_confirm").clickHandler = Laya.Handler.create(this, function() {
                t.close()
            }, null, !1)
        }
        ,
        i.prototype.show = function(e) {
            var i = this;
            this.me.visible = !0,
            this.panel.vScrollBar.value = 0,
            this.desc.text = e,
            this.desc.height = this.desc.textField.textHeight,
            this.locking = !0,
            t.UIBase.anim_pop_out(this.root, Laya.Handler.create(this, function() {
                i.locking = !1
            }))
        }
        ,
        i.prototype.close = function() {
            var e = this;
            this.locking = !0,
            t.UIBase.anim_pop_hide(this.root, Laya.Handler.create(this, function() {
                e.locking = !1,
                e.me.visible = !1
            }))
        }
        ,
        i.Inst = null,
        i
    }(t.UIBase);
    t.UI_InfoLite = e
}(uiscript || (uiscript = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), uiscript;
!function(t) {
    var e = function(e) {
        function i() {
            var t = e.call(this, new ui.mj.info_md5UI) || this;
            return i.Inst = t,
            t
        }
        return __extends(i, e),
        i.prototype.onCreate = function() {
            var t = this;
            this.root = this.me.getChildByName("root"),
            this.root.getChildByName("btn_close").clickHandler = Laya.Handler.create(this, function() {
                t.locking || t.close()
            }, null, !1);
            var e = this.root.getChildByName("content");
            e.vScrollBarSkin = "",
            e.refresh()
        }
        ,
        i.prototype.show = function() {
            var e = this;
            this.locking = !0,
            this.enable = !0,
            t.UIBase.anim_pop_out(this.root, Laya.Handler.create(this, function() {
                e.locking = !1
            }))
        }
        ,
        i.prototype.close = function() {
            var e = this;
            this.locking = !0,
            t.UIBase.anim_pop_hide(this.root, Laya.Handler.create(this, function() {
                e.locking = !1,
                e.enable = !1
            }))
        }
        ,
        i
    }(t.UIBase);
    t.UI_Info_MD5 = e
}(uiscript || (uiscript = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), uiscript;
!function(t) {
    var e = function(e) {
        function i() {
            var t = e.call(this, new ui.lobby.introduceUI) || this;
            return t._blackmask = null,
            t._root = null,
            t._content = null,
            t._locking = !1,
            t._cells = [],
            i.Inst = t,
            t
        }
        return __extends(i, e),
        i.prototype.onCreate = function() {
            var e = this;
            this._blackmask = new t.UI_BlackMask(this.me.getChildByName("bmask"),Laya.Handler.create(this, function() {
                return e._locking
            }, null, !1),Laya.Handler.create(this, this.close, null, !1)),
            this._root = this.me.getChildByName("root"),
            this._content = this._root.getChildByName("content"),
            this._content.vScrollBar.visible = !1;
            var i = this._content.getChildByName("templete");
            i.visible = !1,
            this._cells = [],
            cfg.rank_introduce.rank.forEach(function(t, n) {
                for (var a = 0; a < 4; a++) {
                    var r = i.scriptMap["capsui.UICopy"].getNodeClone();
                    e._cells.push(r)
                }
            }),
            Laya.timer.frameOnce(5, this, function() {
                var t = 0
                  , n = [181, 165, 165, 165]
                  , a = 0
                  , r = 0
                  , s = 0;
                switch (GameMgr.client_language) {
                case "chs":
                    s = 0;
                    break;
                case "jp":
                    s = 4;
                    break;
                case "en":
                    s = 8
                }
                for (var o = i.getChildByName("info"), l = 0, h = 0; h < 4; h++)
                    o.text = cfg.rank_introduce.rank.get(1).info[s + h],
                    n[h] = o.textField.textWidth,
                    l += n[h];
                for (h = 0; h < 4; h++)
                    n[h] = 600 * n[h] / l + (0 == h ? 76 : 0);
                cfg.rank_introduce.rank.forEach(function(i, o) {
                    a = 0;
                    for (var l = 0; l < 4; l++) {
                        var h = e._cells[t++];
                        h.x = a,
                        h.y = r,
                        h.width = n[l],
                        h.height = 76;
                        var c = h.getChildByName("bound");
                        c.x = 0,
                        c.y = 0,
                        c.width = h.width,
                        c.height = h.height;
                        var u = h.getChildByName("info");
                        u.width = h.width / .7 - 20,
                        u.x = .5 * h.width,
                        u.scriptMap["capsui.LabelLocalizationSize"].change_width(u.width),
                        u.text = i.info[l + s],
                        a += h.width - 3
                    }
                    r += 73
                }),
                e._content.refresh()
            })
        }
        ,
        i.prototype.show = function() {
            var e = this;
            this._locking = !0,
            this.enable = !0,
            this._blackmask.show(),
            this._content.vScrollBar.value = 0,
            t.UIBase.anim_pop_out(this._root, Laya.Handler.create(this, function() {
                e._locking = !1
            }))
        }
        ,
        i.prototype.close = function() {
            var e = this;
            this._locking = !0,
            t.UIBase.anim_pop_hide(this._root, Laya.Handler.create(this, function() {
                e._locking = !1,
                e.enable = !1
            }))
        }
        ,
        i.Inst = null,
        i
    }(t.UIBase);
    t.UI_Introduce = e
}(uiscript || (uiscript = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), uiscript;
!function(t) {
    var e = function() {
        function e(e, n) {
            var a = this;
            this.me = e,
            e.visible = !1,
            this.me.x = 543,
            this.me.y = -260,
            this.data = n,
            Laya.timer.frameOnce(5, this, function() {
                a.locking = !0,
                a.me.visible = !0,
                Laya.Tween.to(a.me, {
                    y: -44
                }, 150, Laya.Ease.strongInOut, Laya.Handler.create(a, function() {
                    a.locking = !1
                })),
                a.me.getChildByName("name").text = n.nickname;
                var e = "";
                "en" == GameMgr.client_language ? e += "Room:" : (e += game.Tools.room_mode_desc(n.mode.mode)) && (e += ":"),
                e += n.room_id.toString(),
                a.me.getChildByName("room").text = e,
                a.me.getChildByName("banned").clickHandler = Laya.Handler.create(a, function() {
                    a.locking || (i.addBanned(n.account_id),
                    a.close())
                }, null, !1),
                a.me.getChildByName("cancel").clickHandler = Laya.Handler.create(a, function() {
                    a.locking || (i.onCancel(n.account_id),
                    a.close())
                }, null, !1),
                a.me.getChildByName("join").clickHandler = Laya.Handler.create(a, function() {
                    if (!a.locking)
                        if (t.UI_PiPeiYuYue.Inst.enable)
                            t.UI_Popout.PopOutNoTitle(game.Tools.strOfLocalization(204), null);
                        else {
                            if (i.onCancel(n.account_id),
                            game.Scene_MJ.Inst.active)
                                GameMgr.Inst.beinvited_roomid = n.room_id,
                                game.Scene_MJ.Inst.ForceOut(),
                                t.UIMgr.Inst.closeUIWithTag_Lobby(),
                                t.UIMgr.Inst.closeUIWithTag_Both();
                            else {
                                var e = !1
                                  , r = Laya.Handler.create(a, function(i) {
                                    i ? app.NetAgent.sendReq2Lobby("Lobby", "joinRoom", {
                                        room_id: n.room_id
                                    }, function(i, n) {
                                        i || n.error ? (t.UIMgr.Inst.showNetReqError("joinRoom", i, n),
                                        e && (t.UI_Lobby.Inst.enable = !0)) : (t.UIMgr.Inst.closeUIWithTag_Lobby(),
                                        t.UIMgr.Inst.closeUIWithTag_Both(),
                                        t.UI_WaitingRoom.Inst.updateData(n.room),
                                        t.UIMgr.Inst.ShowWaitingRoom())
                                    }) : e && (t.UI_Lobby.Inst.enable = !0)
                                }, null, !1);
                                t.UI_WaitingRoom.Inst.enable ? (e = !0,
                                t.UI_WaitingRoom.Inst.tryToClose(r)) : t.UI_PiPei.Inst.enable ? t.UI_PiPei.Inst.tryToClose(r) : r.runWith(!0)
                            }
                            a.close()
                        }
                }, null, !1),
                Laya.timer.once(n.time + 18e4 - Laya.timer.currTimer, a, function() {
                    a.locking || (a.close(),
                    i.onCancel(n.account_id))
                })
            })
        }
        return e.prototype.close = function() {
            var t = this;
            this.locking = !0,
            Laya.Tween.to(this.me, {
                y: -260
            }, 150, Laya.Ease.strongOut, Laya.Handler.create(this, function() {
                t.locking = !1,
                i.Inst.onBlockClose(t)
            }))
        }
        ,
        e.prototype.destory = function() {
            this.me.visible = !1,
            this.me.destroy(!0),
            Laya.timer.clearAll(this),
            Laya.Tween.clearAll(this)
        }
        ,
        e
    }()
      , i = function(i) {
        function n() {
            var t = i.call(this, new ui.both_ui.inviteUI) || this;
            return t.templete = null,
            t._blocks = null,
            n.Inst = t,
            t
        }
        return __extends(n, i),
        n.onNewInvite = function(e) {
            var i = JSON.parse(e)
              , n = i.account_id;
            if (!(this._banneds.hasOwnProperty(n.toString()) && Laya.timer.currTimer < this._banneds[n.toString()] + 3e5 || t.UI_WaitingRoom.Inst && t.UI_WaitingRoom.Inst.enable && t.UI_WaitingRoom.Inst.room_id == i.room_id || t.UI_PiPeiChengGong.Inst.enable)) {
                for (var a = {
                    time: Laya.timer.currTimer,
                    room_id: i.room_id,
                    mode: i.mode,
                    account_id: i.account_id,
                    nickname: i.nickname
                }, r = 0; r < this._invites.length; r++)
                    if (this._invites[r].account_id == n) {
                        for (var s = r; s < this._invites.length - 1; s++)
                            this._invites[s] = this._invites[s + 1];
                        this._invites.pop();
                        break
                    }
                this._invites.push(a),
                this.Inst.enable && this.Inst.popout(a)
            }
        }
        ,
        n.addBanned = function(t) {
            this._banneds[t.toString()] = Laya.timer.currTimer,
            this.onCancel(t)
        }
        ,
        n.onCancel = function(t) {
            for (var e = 0; e < this._invites.length; e++)
                if (this._invites[e].account_id == t) {
                    for (var i = e; i < this._invites.length - 1; i++)
                        this._invites[i] = this._invites[i + 1];
                    this._invites.pop();
                    break
                }
        }
        ,
        n.prototype.onCreate = function() {
            this.templete = this.me.getChildByName("templete"),
            this.templete.visible = !1
        }
        ,
        n.prototype.onEnable = function() {
            this._blocks = [];
            for (var t = n._invites, e = [], i = 0; i < t.length; i++)
                Laya.timer.currTimer < t[i].time + 12e4 && e.push(t[i]);
            t = n._invites = e;
            for (i = 0; i < t.length; i++)
                this.popout(t[i])
        }
        ,
        n.prototype.onDisable = function() {
            for (var t = 0; t < this._blocks.length; t++)
                this._blocks[t].destory();
            this._blocks = []
        }
        ,
        n.prototype.popout = function(t) {
            for (var i = [], n = 0; n < this._blocks.length; n++)
                this._blocks[n].data.account_id == t.account_id && i.push(this._blocks[n]);
            for (n = 0; n < i.length; n++)
                this.onBlockClose(i[n]);
            var a = this.templete.scriptMap["capsui.UICopy"].getNodeClone();
            this._blocks.push(new e(a,t))
        }
        ,
        n.prototype.onBlockClose = function(t) {
            for (var e = 0; e < this._blocks.length; e++)
                if (t === this._blocks[e]) {
                    this._blocks[e] = this._blocks[this._blocks.length - 1],
                    t.destory(),
                    this._blocks.pop();
                    break
                }
        }
        ,
        n._invites = [],
        n._banneds = {},
        n
    }(t.UIBase);
    t.UI_Invite = i
}(uiscript || (uiscript = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), uiscript;
!function(t) {
    var e = function(e) {
        function i() {
            var t = e.call(this, new ui.entrance.ios_webview_updateUI) || this;
            return i.Inst = t,
            t
        }
        return __extends(i, e),
        i.show = function(e) {
            var n = new i;
            t.UIMgr.Inst.AddLobbyUI(n),
            Laya.timer.frameOnce(5, this, function() {
                n._show(e)
            })
        }
        ,
        i.prototype._show = function(t) {
            this.enable = !0,
            this.me.getChildByName("root").getChildByName("text").text = t
        }
        ,
        i
    }(t.UIBase);
    t.UI_IOS_Webview_Update = e
}(uiscript || (uiscript = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), uiscript;
!function(t) {
    var e = function(e) {
        function i() {
            var t = e.call(this, new ui.both_ui.itemdetailUI) || this;
            return t.locking = !1,
            t.click_func = null,
            t.container_icon = null,
            i.Inst = t,
            t
        }
        return __extends(i, e),
        i.prototype.onCreate = function() {
            var e = this;
            this.root = this.me.getChildByName("root"),
            this.name = this.root.getChildByName("label_name"),
            this.desc = this.root.getChildByName("desc"),
            this.icon = new t.UI_Item_Skin(this.root.getChildByName("item").getChildByName("icon")),
            this.container_icon = this.root.getChildByName("item"),
            this.locking = !1,
            this.root.getChildByName("btn_close").clickHandler = Laya.Handler.create(this, function() {
                e.locking || e.close()
            }, null, !1)
        }
        ,
        i.prototype.show = function(e) {
            var i = this
              , n = game.GameUtility.get_item_view(e);
            this.name.text = n.name,
            this.desc.text = n.desc,
            this.icon.setSkin(n.icon),
            this.enable = !0,
            this.locking = !0,
            t.UIBase.anim_pop_out(this.root, Laya.Handler.create(this, function() {
                i.locking = !1
            }))
        }
        ,
        i.prototype.close = function() {
            var e = this;
            this.locking = !0,
            t.UIBase.anim_pop_hide(this.root, Laya.Handler.create(this, function() {
                e.locking = !1,
                e.enable = !1
            }))
        }
        ,
        i
    }(t.UIBase);
    t.UI_ItemDetail = e
}(uiscript || (uiscript = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), uiscript;
!function(t) {
    var e = function(t) {
        function e() {
            var i = t.call(this, new ui.both_ui.light_tipsUI) || this;
            return i.locking = !1,
            e.Inst = i,
            i
        }
        return __extends(e, t),
        e.prototype.onCreate = function() {
            var t = this;
            this.root = this.me.getChildByName("root"),
            this.info = this.root.getChildByName("info"),
            this.me.getChildByName("btn_close").clickHandler = Laya.Handler.create(this, function() {
                t.locking || t.close()
            }, null, !1)
        }
        ,
        e.prototype.show = function(t) {
            var e = this;
            this.info.text = t,
            this.root.height = 120 + this.info.textField.textHeight,
            this.enable = !0,
            this.locking = !0,
            this.root.scaleY = 0,
            Laya.timer.clearAll(this),
            Laya.Tween.to(this.root, {
                scaleY: 1
            }, 150, null, Laya.Handler.create(this, function() {
                e.locking = !1
            })),
            Laya.timer.once(3e3, this, function() {
                e.close()
            })
        }
        ,
        e.prototype.close = function() {
            var t = this;
            this.locking = !0,
            Laya.timer.clearAll(this),
            Laya.Tween.to(this.root, {
                scaleY: 0
            }, 150, null, Laya.Handler.create(this, function() {
                t.locking = !1,
                t.enable = !1
            }))
        }
        ,
        e
    }(t.UIBase);
    t.UI_LightTips = e
}(uiscript || (uiscript = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), uiscript;
!function(t) {
    var e;
    !function(t) {
        t[t.normal = 0] = "normal",
        t[t.detail = 1] = "detail",
        t[t.liqiing = 2] = "liqiing"
    }(e || (e = {}));
    var i = function(i) {
        function n() {
            var t = i.call(this) || this;
            return t.c_gang = null,
            t.com_add_gang = null,
            t.com_an_gang = null,
            t.liqi_data = null,
            t._oplist = [],
            t.state = e.normal,
            n.Inst = t,
            t
        }
        return __extends(n, i),
        n.prototype.show = function(t) {
            this.com_add_gang = [],
            this.com_an_gang = [],
            this.liqi_data = [];
            for (var i = [], n = 0; n < t.length; n++)
                switch (t[n].type) {
                case mjcore.E_PlayOperation.babei:
                    i.push("btn_babei");
                    break;
                case mjcore.E_PlayOperation.add_gang:
                    this.com_add_gang = t[n].combination;
                    break;
                case mjcore.E_PlayOperation.an_gang:
                    this.com_an_gang = t[n].combination;
                    break;
                case mjcore.E_PlayOperation.liqi:
                    i.push("btn_lizhi"),
                    this.liqi_data = t[n].combination;
                    break;
                case mjcore.E_PlayOperation.zimo:
                    i.push("btn_zimo");
                    break;
                case mjcore.E_PlayOperation.jiuzhongjiupai:
                    i.push("btn_jiuzhongjiupai")
                }
            this.com_add_gang.length + this.com_an_gang.length > 0 && i.push("btn_gang"),
            i.push("btn_cancel"),
            this._oplist = i,
            this.showOp(i),
            this.enable = !0,
            this.state = e.normal,
            view.AudioMgr.PlayAudio(202)
        }
        ,
        n.prototype.onClickOpBtn = function(t) {
            if (view.DesktopMgr.Inst.mode == view.EMJMode.play)
                switch (view.AudioMgr.PlayAudio(101),
                t) {
                case "btn_gang":
                    this.onBtn_Gang();
                    break;
                case "btn_lizhi":
                    this.onBtn_Liqi();
                    break;
                case "btn_zimo":
                    this.onBtn_Zimo();
                    break;
                case "btn_cancel":
                    this.onBtn_Cancel();
                    break;
                case "btn_jiuzhongjiupai":
                    this.onBtn_Liuju();
                    break;
                case "btn_babei":
                    this.onBtn_BaBei()
                }
        }
        ,
        n.prototype.onDetailBack = function() {
            view.DesktopMgr.Inst.mode == view.EMJMode.play && (this.showOp(this._oplist),
            view.AudioMgr.PlayAudio(101))
        }
        ,
        n.prototype.onClickDetail = function(e) {
            view.AudioMgr.PlayAudio(101),
            this.enable = !1,
            e < this.com_add_gang.length ? app.NetAgent.sendReq2MJ("FastTest", "inputOperation", {
                type: mjcore.E_PlayOperation.add_gang,
                index: e,
                timeuse: t.UI_DesktopInfo.Inst._timecd.timeuse
            }, function(t, e) {}) : app.NetAgent.sendReq2MJ("FastTest", "inputOperation", {
                type: mjcore.E_PlayOperation.an_gang,
                index: e - this.com_add_gang.length,
                timeuse: t.UI_DesktopInfo.Inst._timecd.timeuse
            }, function(t, e) {}),
            view.DesktopMgr.Inst.WhenDoOperation()
        }
        ,
        n.prototype.onBtn_Gang = function() {
            if (this.com_an_gang.length + this.com_add_gang.length == 1)
                1 == this.com_an_gang.length ? app.NetAgent.sendReq2MJ("FastTest", "inputOperation", {
                    type: mjcore.E_PlayOperation.an_gang,
                    index: 0,
                    timeuse: t.UI_DesktopInfo.Inst._timecd.timeuse
                }, function(t, e) {}) : app.NetAgent.sendReq2MJ("FastTest", "inputOperation", {
                    type: mjcore.E_PlayOperation.add_gang,
                    timeuse: t.UI_DesktopInfo.Inst._timecd.timeuse,
                    index: 0
                }, function(t, e) {}),
                this.enable = !1;
            else {
                for (var i = [], n = 0; n < this.com_add_gang.length; n++)
                    i.push(this.com_add_gang[n]);
                for (n = 0; n < this.com_an_gang.length; n++)
                    i.push(this.com_an_gang[n]);
                this.showDetail(game.Tools.strOfLocalization(2078), i),
                this.state = e.detail
            }
        }
        ,
        n.prototype.onLiqiBack = function() {
            this.container_btns.visible = !0,
            this.btn_cancel.visible = !1,
            view.DesktopMgr.Inst.mainrole.LiQiSelect(null, !1),
            this.state = e.normal
        }
        ,
        n.prototype.onBtn_Liqi = function() {
            this.container_btns.visible = !1,
            this.btn_cancel.visible = !0,
            this.btn_cancel.clickHandler = Laya.Handler.create(this, this.onLiqiBack);
            for (var t = [], i = 0; i < this.liqi_data.length; i++)
                t.push(mjcore.MJPai.Create(this.liqi_data[i]));
            view.DesktopMgr.Inst.mainrole.LiQiSelect(t, !0),
            this.state = e.liqiing
        }
        ,
        n.prototype.onBtn_Zimo = function() {
            app.NetAgent.sendReq2MJ("FastTest", "inputOperation", {
                type: mjcore.E_PlayOperation.zimo,
                index: 0,
                timeuse: t.UI_DesktopInfo.Inst._timecd.timeuse
            }, function(t, e) {}),
            view.DesktopMgr.Inst.WhenDoOperation()
        }
        ,
        n.prototype.onBtn_BaBei = function() {
            var e = !1
              , i = view.DesktopMgr.Inst.mainrole;
            i.last_tile && "4z" === i.last_tile.val.toString() && (e = !0),
            app.NetAgent.sendReq2MJ("FastTest", "inputOperation", {
                type: mjcore.E_PlayOperation.babei,
                moqie: e,
                timeuse: t.UI_DesktopInfo.Inst._timecd.timeuse
            }, function(t, e) {}),
            view.DesktopMgr.Inst.WhenDoOperation()
        }
        ,
        n.prototype.onBtn_Liuju = function() {
            app.NetAgent.sendReq2MJ("FastTest", "inputOperation", {
                type: mjcore.E_PlayOperation.jiuzhongjiupai,
                index: 0,
                timeuse: t.UI_DesktopInfo.Inst._timecd.timeuse
            }, function(t, e) {}),
            view.DesktopMgr.Inst.WhenDoOperation()
        }
        ,
        n.prototype.onBtn_Cancel = function() {
            view.DesktopMgr.Inst.mainrole.can_discard || (app.NetAgent.sendReq2MJ("FastTest", "inputOperation", {
                cancel_operation: !0,
                timeuse: t.UI_DesktopInfo.Inst._timecd.timeuse
            }, function(t, e) {}),
            view.DesktopMgr.Inst.WhenDoOperation()),
            this.enable = !1
        }
        ,
        n.prototype.onDoubleClick = function(t) {
            return this.state == e.detail ? (this.onDetailBack(),
            !1) : this.state == e.liqiing ? (this.onLiqiBack(),
            !1) : !!t || (this.onBtn_Cancel(),
            !1)
        }
        ,
        n.prototype.onDisable = function() {
            Laya.timer.clearAll(this)
        }
        ,
        n.Inst = null,
        n
    }(t.UI_PlayerOperation);
    t.UI_LiQiZiMo = i
}(uiscript || (uiscript = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), uiscript;
!function(t) {
    var e = function(e) {
        function i() {
            var t = e.call(this, new ui.mj.liujuUI) || this;
            return t.root = null,
            t.img_title = null,
            t
        }
        return __extends(i, e),
        i.prototype.onCreate = function() {
            this.root = this.me.getChildByName("root"),
            this.img_title = this.root.getChildByName("title")
        }
        ,
        i.prototype.Show = function(t) {
            var e = this;
            this.data = t;
            var i = ""
              , n = "";
            switch (t.type) {
            case mjcore.E_LiuJu.jiuzhongjiupai:
                i = "jiuzhongjiupai",
                n = "gameend_jiuzhongjiupai";
                break;
            case mjcore.E_LiuJu.sanjiahule:
                i = "sanjiahule";
                break;
            case mjcore.E_LiuJu.sifenglianda:
                i = "sifenglianda",
                n = "gameend_sifenglianda";
                break;
            case mjcore.E_LiuJu.sijializhi:
                i = "sijializhi";
                break;
            case mjcore.E_LiuJu.sigangsanle:
                i = "sigangsanle",
                n = "gameend_sigangliuju"
            }
            this.img_title.skin = game.Tools.localUISrc("myres/mjdesktop/" + i + ".png"),
            this.enable = !0,
            Laya.Tween.from(this.root, {
                alpha: 0
            }, 500),
            "" != n && view.AudioMgr.PlayCharactorSound(view.DesktopMgr.Inst.main_role_character_info, n),
            view.DesktopMgr.Inst.mode == view.EMJMode.play ? Laya.timer.once(4e3, this, this.onBtnConfirm) : Laya.timer.once(4e3, this, function() {
                e.enable = !1
            })
        }
        ,
        i.prototype.onDisable = function() {
            Laya.timer.clearAll(this)
        }
        ,
        i.prototype.onBtnConfirm = function() {
            null != view.DesktopMgr.Inst.gameEndResult ? (t.UIMgr.Inst.ShowGameEnd(),
            this.enable = !1) : (view.DesktopMgr.Inst.Reset(),
            Laya.timer.once(200, this, function() {
                app.NetAgent.sendReq2MJ("FastTest", "confirmNewRound", {}, function(t, e) {})
            }))
        }
        ,
        i
    }(t.UIBase);
    t.UI_LiuJu = e
}(uiscript || (uiscript = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), uiscript;
!function(t) {
    var e, i = function() {
        function t(t) {
            var e = this;
            this._show_hand = !1,
            this._show_paopai = !1,
            this.me = t,
            this._btn_out = this.me.getChildByName("btn_out"),
            this._btn_out.clickHandler = Laya.Handler.create(this, function() {
                e.switch()
            }, null, !1),
            this.me.getChildByName("btn_shoupai").clickHandler = Laya.Handler.create(this, function() {
                e._show_hand = !e._show_hand,
                e._choosed_show_hand.visible = e._show_hand,
                view.DesktopMgr.Inst.onShowHandChange(e._show_hand)
            }, null, !1),
            this._choosed_show_hand = this.me.getChildByName("btn_shoupai").getChildByName("choosed"),
            this._choosed_show_paopai = this.me.getChildByName("btn_paopai").getChildByName("choosed"),
            this.me.getChildByName("btn_paopai").clickHandler = Laya.Handler.create(this, function() {
                e._show_paopai = !e._show_paopai,
                e._choosed_show_paopai.visible = e._show_paopai,
                view.DesktopMgr.Inst.onShowPaopaiChange(e._show_paopai)
            }, null, !1),
            this._choosed_show_paopai = this.me.getChildByName("btn_paopai").getChildByName("choosed"),
            this.me.getChildByName("label_word").visible = "chs" == GameMgr.client_language,
            this.me.getChildByName("img_set").visible = "chs" != GameMgr.client_language
        }
        return t.prototype.reset = function() {
            Laya.Tween.clearAll(this),
            this._show_hand = !1,
            this.me.x = -258,
            this._btn_out.disabled = !1,
            this._choosed_show_hand.visible = this._show_hand,
            this._show_paopai = !1,
            this._choosed_show_paopai.visible = this._show_paopai
        }
        ,
        t.prototype.switch = function() {
            var t = this
              , e = -258;
            this.me.x < -100 && (e = -5),
            this._btn_out.disabled = !0,
            Laya.Tween.to(this.me, {
                x: e
            }, 200, Laya.Ease.strongOut, Laya.Handler.create(this, function() {
                t._btn_out.disabled = !1
            }), 0, !0, !0)
        }
        ,
        t
    }();
    !function(t) {
        t[t.none = 0] = "none",
        t[t.gameing = 1] = "gameing",
        t[t.end = 2] = "end",
        t[t.interrupt = 3] = "interrupt"
    }(e || (e = {}));
    var n = function(n) {
        function a() {
            var t = n.call(this, new ui.mj.live_broadcastUI) || this;
            return t.state = e.none,
            t.segments = [],
            t._time0 = 0,
            t._time_start = 0,
            t.segment_index = 0,
            t.unit_index = 0,
            t.during_asknew = !1,
            t.retry_loadtime = 0,
            t.segment_end_millisecond = 0,
            t.guanzhanconfig = null,
            t.do_unit_cd = 0,
            t.time_stop_length = 0,
            t.time_stop_start_time = 0,
            a.Inst = t,
            t
        }
        return __extends(a, n),
        a.fetchInfo = function(e, i) {
            app.NetAgent.sendReq2Lobby("Lobby", "fetchGameLiveInfo", {
                game_uuid: e
            }, function(n, a) {
                n || a.error ? (t.UIMgr.Inst.showNetReqError("fetchGameLiveInfo", n, a),
                i && i.runWith({
                    success: !1
                })) : (app.Log.log("fetchGameLiveInfo res:" + JSON.stringify(a)),
                a.left_start_seconds ? t.UI_WaitOb.Inst.show(e, a.left_start_seconds, i) : i && i.runWith({
                    success: !0,
                    data: a
                }))
            })
        }
        ,
        a.goToWatch = function(e, i, n) {
            var r = this;
            app.Log.log("goToWatch res:" + JSON.stringify(i)),
            t.UI_Loading.Inst.show("enter_mj");
            for (var s = i.live_head, o = [null, null, null, null], l = 0; l < s.players.length; l++) {
                for (var h = -1, c = 0; c < s.seat_list.length; c++)
                    if (s.seat_list[c] == s.players[l].account_id) {
                        h = c;
                        break
                    }
                -1 != h ? o[h] = s.players[l] : app.Log.Error("goToWatch " + JSON.stringify(s.players[l]) + "未找到位置")
            }
            var u = game.Tools.strOfLocalization(2003)
              , _ = s.game_config.mode;
            _.extendinfo && (u = game.Tools.strOfLocalization(2004)),
            _.detail_rule && _.detail_rule.ai_level && (1 === _.detail_rule.ai_level && (u = game.Tools.strOfLocalization(2003)),
            2 === _.detail_rule.ai_level && (u = game.Tools.strOfLocalization(2004)));
            for (l = 0; l < o.length; l++)
                null == o[l] && (o[l] = {
                    nickname: u,
                    avatar_id: 400101,
                    level: {
                        id: 10101
                    },
                    character: {
                        charid: 200001,
                        level: 0,
                        exp: 0,
                        views: [],
                        skin: 400101,
                        is_upgraded: !1
                    }
                });
            game.Scene_MJ.Inst.openMJRoom(o, Laya.Handler.create(this, function() {
                view.DesktopMgr.Inst.initRoom(s.game_config, o, n, view.EMJMode.live_broadcast, Laya.Handler.create(r, function() {
                    t.UI_Loading.Inst.setProgressVal(.7),
                    Laya.timer.once(1e3, r, function() {
                        GameMgr.Inst.EnterMJ(),
                        t.UI_Loading.Inst.setProgressVal(.8),
                        a.Inst.startLive(e, i)
                    })
                }))
            }), Laya.Handler.create(this, function(e) {
                return t.UI_Loading.Inst.setProgressVal(.7 * e)
            }, null, !1))
        }
        ,
        a.prototype.onCreate = function() {
            this.guanzhanconfig = new i(this.me.getChildByName("config"))
        }
        ,
        a.prototype.onDisable = function() {
            Laya.timer.clearAll(this)
        }
        ,
        a.prototype._doRecord = function(t, e, i) {
            try {
                switch (view.DesktopMgr.Inst.ClearOperationShow(),
                t) {
                case "RecordNewRound":
                    return view.ActionNewRound.record(e, i);
                case "RecordDiscardTile":
                    return view.ActionDiscardTile.record(e, i);
                case "RecordDealTile":
                    return view.ActionDealTile.record(e, i);
                case "RecordChiPengGang":
                    return view.ActionChiPengGang.record(e, i);
                case "RecordAnGangAddGang":
                    return view.ActionAnGangAddGang.record(e, i);
                case "RecordHule":
                    return view.ActionHule.record(e);
                case "RecordLiuJu":
                    return view.ActionLiuJu.record(e);
                case "RecordNoTile":
                    return view.ActionNoTile.record(e);
                case "RecordBaBei":
                    return view.ActionBabei.record(e)
                }
            } catch (i) {
                var n = {};
                return n.error = i.message,
                n.stack = i.stack,
                n.method = "ui_live_broadcast doRecord",
                n.name = t,
                n.data = e,
                GameMgr.Inst.onFatalError(n),
                1e6
            }
            return 0
        }
        ,
        a.prototype._doFastRecord = function(t, e, i) {
            try {
                switch (t) {
                case "RecordNewRound":
                    view.ActionNewRound.fastrecord(e, i);
                    break;
                case "RecordDiscardTile":
                    view.ActionDiscardTile.fastrecord(e, i);
                    break;
                case "RecordDealTile":
                    view.ActionDealTile.fastrecord(e, i);
                    break;
                case "RecordChiPengGang":
                    view.ActionChiPengGang.fastrecord(e, i);
                    break;
                case "RecordAnGangAddGang":
                    view.ActionAnGangAddGang.fastrecord(e, i);
                    break;
                case "RecordHule":
                    view.ActionHule.fastrecord(e);
                    break;
                case "RecordLiuJu":
                    view.ActionLiuJu.fastrecord(e);
                    break;
                case "RecordNoTile":
                    view.ActionNoTile.fastrecord(e);
                    break;
                case "RecordBaBei":
                    view.ActionBabei.fastrecord(e)
                }
            } catch (i) {
                var n = {};
                return n.error = i.message,
                n.stack = i.stack,
                n.method = "ui_live_broadcast doFastRecord",
                n.name = t,
                n.data = e,
                GameMgr.Inst.onFatalError(n),
                1e6
            }
        }
        ,
        a.prototype._doUnit = function(e, i, n) {
            if (i) {
                if (1 == e.category)
                    return this._doFastRecord(e.name, e.data, n),
                    view.DesktopMgr.Inst.timestoped || (this.time_stop_length = 0),
                    0;
                if ("GameNewRoundState" == e.name) {
                    for (r = 0; r < e.data.seat_states.length; r++)
                        view.DesktopMgr.player_link_state[r] = e.data.seat_states[r];
                    t.UI_DesktopInfo.Inst.refreshLinks()
                } else
                    "NotifyGameEndResult" == e.name ? (view.DesktopMgr.Inst.gameEndResult = e.data.result,
                    this.enable = !1,
                    t.UIMgr.Inst.ShowGameEnd()) : "NotifyPlayerConnectionState" == e.name ? t.UI_DesktopInfo.Inst.onPlayerConnectionState(e.data) : "GameEndAction" == e.name ? 3 == e.data.state && t.UI_Popout.PopOutNoTitle(game.Tools.strOfLocalization(16), Laya.Handler.create(this, function() {
                        game.Scene_MJ.Inst.ForceOut()
                    })) : "NotifyGamePause" == e.name && (view.DesktopMgr.Inst.setGameStop(e.data.paused),
                    this.time_stop_start_time > 0 && (this.time_stop_length += e.timestamp - this.time_stop_start_time),
                    view.DesktopMgr.Inst.timestoped ? this.time_stop_start_time = e.timestamp : this.time_stop_start_time = -1);
                return -1
            }
            if (1 == e.category) {
                var a = this._doRecord(e.name, e.data, n);
                return view.DesktopMgr.Inst.timestoped || (this.time_stop_length = 0),
                a
            }
            if ("GameNewRoundState" == e.name) {
                for (var r = 0; r < e.data.seat_states.length; r++)
                    view.DesktopMgr.player_link_state[r] = e.data.seat_states[r];
                t.UI_DesktopInfo.Inst.refreshLinks()
            } else
                "NotifyGameEndResult" == e.name ? (view.DesktopMgr.Inst.gameEndResult = e.data.result,
                this.enable = !1,
                t.UIMgr.Inst.ShowGameEnd()) : "NotifyGameBroadcast" == e.name ? t.UI_DesktopInfo.Inst.onGameBroadcast(e.data) : "NotifyPlayerConnectionState" == e.name ? t.UI_DesktopInfo.Inst.onPlayerConnectionState(e.data) : "GameEndAction" == e.name ? 3 == e.data.state && t.UI_Popout.PopOutNoTitle(game.Tools.strOfLocalization(16), Laya.Handler.create(this, function() {
                    game.Scene_MJ.Inst.ForceOut()
                })) : "NotifyGamePause" == e.name && (view.DesktopMgr.Inst.setGameStop(e.data.paused),
                this.time_stop_start_time > 0 && (this.time_stop_length += e.timestamp - this.time_stop_start_time),
                view.DesktopMgr.Inst.timestoped ? this.time_stop_start_time = e.timestamp : this.time_stop_start_time = -1);
            return -1
        }
        ,
        a.prototype._parseUnit = function(t) {
            var e = net.MessageWrapper.decodeMessage(t.action_data);
            return {
                timestamp: t.timestamp,
                category: t.action_category,
                name: e.$type.name,
                data: e
            }
        }
        ,
        a.prototype._loadUnit = function(t, e, i) {
            var n = this
              , a = new Laya.HttpRequest;
            a.once(Laya.Event.COMPLETE, this, function(e) {
                if (i) {
                    var a = new Laya.Byte;
                    a.writeArrayBuffer(e);
                    for (var r = net.MessageWrapper.decodeMessage(a.getUint8Array(0, a.length)), s = [], o = 0; o < r.actions.length; o++)
                        s.push(n._parseUnit(r.actions[o]));
                    i.runWith({
                        success: !0,
                        id: t,
                        units: s
                    })
                }
            }),
            a.once(Laya.Event.ERROR, this, function(e) {
                i && i.runWith({
                    success: !1,
                    id: t
                })
            });
            a.send(e, "", "get", "arraybuffer", [])
        }
        ,
        a.prototype.startLive = function(e, i) {
            var n = this;
            this.segment_index = 0,
            this.segments = [],
            this._time0 = i.now_millisecond;
            var a = 0
              , r = !1;
            this.game_uuid = e,
            this.enable = !0,
            this.guanzhanconfig.reset(),
            this.do_unit_cd = 0;
            for (var s = function(e) {
                if (!r)
                    if (app.Log.log("loadover0 " + JSON.stringify(e)),
                    e.success) {
                        for (var i = 0; i < n.segments.length; i++)
                            if (n.segments[i].segment_id == e.id) {
                                n.segments[i].units = e.units,
                                n.segments[i].loaded = !0;
                                break
                            }
                        app.Log.log("loadover1"),
                        a++,
                        t.UI_Loading.Inst.setProgressVal(.8 + a / n.segments.length * .2),
                        a == n.segments.length && n._onFirstLoadOver()
                    } else
                        app.Log.log("loadover2"),
                        r = !0,
                        t.UIMgr.Inst.ShowErrorInfo(game.Tools.strOfLocalization(15)),
                        n._forceQuit()
            }, o = 0; o < i.segments.length; o++) {
                var l = i.segments[o].segment_id
                  , h = i.segments[o].segment_uri;
                this.segments.push({
                    segment_id: l,
                    uri: h,
                    units: [],
                    loaded: !1
                }),
                this._loadUnit(l, h, Laya.Handler.create(this, s))
            }
        }
        ,
        a.prototype._onFirstLoadOver = function() {
            var i = this;
            if (this._fastSync()) {
                t.UI_Loading.Inst.close(),
                this.state = e.gameing;
                var n = this.segments[this.segments.length - 1].units
                  , a = n[n.length - 1].timestamp;
                this.segment_end_millisecond = a,
                app.Log.log("fastSync over"),
                Laya.timer.loop(100, this, function() {
                    i._timeDoAction(!1)
                }, null, !0),
                Laya.timer.loop(3700, this, function() {
                    i._askNewSegment()
                }, null, !1)
            }
        }
        ,
        a.prototype._unitIsTimeLast = function(t, e) {
            if (t >= this.segments.length)
                return !0;
            var i = this.segments[t];
            if (!i.loaded)
                return !0;
            if (i.units.length <= e)
                return this._unitIsTimeLast(t + 1, 0);
            var n = this._time0 + Laya.timer.currTimer - this._time_start
              , a = i.units[e];
            return a.timestamp > n || 2 == a.category && this._unitIsTimeLast(t, e + 1)
        }
        ,
        a.prototype._getTimeStop = function(t, e, i) {
            var n = 0;
            if (i > 0 && (n = this._time0 + Laya.timer.currTimer - this._time_start - i),
            t >= this.segments.length)
                return n;
            var a = this.segments[t];
            if (!a.loaded)
                return n;
            if (a.units.length <= e)
                return this._getTimeStop(t + 1, 0, i);
            var r = a.units[e]
              , s = this._time0 + Laya.timer.currTimer - this._time_start;
            if (r.timestamp > s)
                return n;
            if (1 == r.category)
                return 0;
            if ("NotifyGamePause" == r.name) {
                var o = 0;
                return i > 0 && (o += r.timestamp - i),
                i = r.data.paused ? r.timestamp : -1,
                o + this._getTimeStop(t, e + 1, i)
            }
            return this._getTimeStop(t, e + 1, i)
        }
        ,
        a.prototype._timeDoAction = function(t) {
            if (this.segment_index >= this.segments.length)
                return !1;
            var e = this.segments[this.segment_index];
            if (!e.loaded)
                return !1;
            if (this.segment_index == this.segments.length - 1 && this.unit_index >= e.units.length)
                return !1;
            var i = e.units[this.unit_index]
              , n = this._time0 + Laya.timer.currTimer - this._time_start;
            if (i.timestamp > n)
                return !0;
            if (app.Log.log("_timeDoAction name:"),
            "NotifyGameEndResult" == i.name)
                return !0;
            if (1 == i.category && Laya.timer.currTimer < this.do_unit_cd && "RecordNewRound" != i.name)
                return !0;
            var a = this._unitIsTimeLast(this.segment_index, this.unit_index + 1);
            if (a && (n -= this._getTimeStop(this.segment_index, this.unit_index + 1, this.time_stop_start_time)),
            t)
                a ? this._doUnit(i, !0, n - i.timestamp) : this._doUnit(i, !0, -1);
            else {
                var r = this._doUnit(i, !1, n - i.timestamp);
                r > 0 && (this.do_unit_cd = Laya.timer.currTimer + r)
            }
            return this.unit_index++,
            this.unit_index >= e.units.length && (this.unit_index = 0,
            this.segment_index++),
            this._timeDoAction(t)
        }
        ,
        a.prototype._askNewSegment = function() {
            var i = this;
            if (this.state == e.gameing && !(this.during_asknew || this.retry_loadtime >= 3) && this.segments[this.segments.length - 1].loaded) {
                this._time0 + Laya.timer.currTimer - this._time_start + 15e3 < this.segment_end_millisecond || (this.during_asknew = !0,
                app.NetAgent.sendReq2Lobby("Lobby", "fetchGameLiveLeftSegment", {
                    game_uuid: this.game_uuid,
                    last_segment_id: this.segments[this.segments.length - 1].segment_id
                }, function(e, n) {
                    if (i.during_asknew = !1,
                    e || n.error)
                        i.retry_loadtime++,
                        i.retry_loadtime >= 3 && t.UIMgr.Inst.showNetReqError("fetchGameLiveLeftSegment", e, n);
                    else {
                        i.retry_loadtime = 0,
                        i.state = n.live_state;
                        var a = n.segments;
                        i.segment_end_millisecond = n.segment_end_millisecond;
                        for (var r = function(t) {
                            if (t.success)
                                for (var e = 0; e < i.segments.length; e++)
                                    if (i.segments[e].segment_id == t.id) {
                                        i.segments[e].units = t.units,
                                        i.segments[e].loaded = !0;
                                        break
                                    }
                        }, s = i.segments[i.segments.length - 1].segment_id, o = 0; o < a.length; o++) {
                            var l = a[o].segment_id
                              , h = a[o].segment_uri;
                            l <= s || (i.segments.push({
                                segment_id: l,
                                uri: h,
                                units: [],
                                loaded: !1
                            }),
                            i._loadUnit(l, h, Laya.Handler.create(i, r, null, !1)))
                        }
                    }
                }))
            }
        }
        ,
        a.prototype._forceQuit = function() {
            this.state = e.none,
            this.enable = !1,
            GameMgr.Inst.EnterLobby()
        }
        ,
        a.prototype._fastSync = function() {
            var e = -1
              , i = -1;
            this.time_stop_start_time = -1,
            this.time_stop_length = 0;
            for (var n = 0; n < this.segments.length; n++)
                for (var a = this.segments[n], r = 0; r < a.units.length; r++)
                    a.units[r].timestamp <= this._time0 && "RecordNewRound" == a.units[r].name && (e = n,
                    i = r);
            if (app.Log.log("_fastSync1: segment=" + e + ", unit=" + i),
            -1 == e) {
                e = 0;
                for (var a = this.segments[0], r = 0; r < a.units.length; r++)
                    if ("RecordNewRound" == a.units[r].name) {
                        e = 0,
                        i = r,
                        this._time0 = a.units[r].timestamp - 50;
                        break
                    }
            }
            return app.Log.log("_fastSync2: segment=" + e + ", unit=" + i),
            -1 == i ? (app.Log.Error("给的数据没有RecordNewRound"),
            t.UIMgr.Inst.ShowErrorInfo(game.Tools.strOfLocalization(15)),
            this._forceQuit(),
            !1) : (this.segment_index = e,
            this.unit_index = i,
            this._time_start = Laya.timer.currTimer,
            this._timeDoAction(!0),
            !0)
        }
        ,
        a.prototype.onChangeMainbody = function() {
            this._time0 = this._time0 + Laya.timer.currTimer - this._time_start,
            this._time_start = Laya.timer.currTimer,
            this.do_unit_cd = 0,
            this._fastSync()
        }
        ,
        a.prototype.onScoreChangeConfirm = function() {
            if (this.do_unit_cd = 0,
            this.segment_index >= this.segments.length)
                return !1;
            var e = this.segments[this.segment_index];
            if (!e.loaded)
                return !1;
            if (this.segment_index == this.segments.length - 1 && this.unit_index >= e.units.length)
                return !1;
            var i = e.units[this.unit_index];
            "NotifyGameEndResult" == i.name && (t.UI_ScoreChange.Inst.enable = !1,
            this._doUnit(i, !1, 0))
        }
        ,
        a
    }(t.UIBase);
    t.UI_Live_Broadcast = n
}(uiscript || (uiscript = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), uiscript;
!function(t) {
    var e = function(e) {
        function i() {
            var t = e.call(this, new ui.common.loadingUI) || this;
            return t.tips = [],
            t.tips_showindex = 0,
            t.tips_changeCD = 0,
            t.current_progress = 0,
            t.pre_t = 0,
            i.Inst = t,
            t
        }
        return __extends(i, e),
        i.prototype.onCreate = function() {
            var t = this;
            this.img_loading = this.me.getChildByName("loading"),
            this.container_waitother = this.me.getChildByName("waitother"),
            this.waitother_label0 = this.container_waitother.getChildByName("count0"),
            this.waitother_label1 = this.container_waitother.getChildByName("count1"),
            this.label_tips = this.me.getChildByName("tips"),
            this.progress_bar = this.me.getChildByName("progress"),
            this.progress_val = this.progress_bar.getChildByName("bar").mask,
            this.img_flower = this.progress_bar.getChildByName("flower"),
            this.progress_label = this.progress_bar.getChildByName("bar").getChildByName("v"),
            this.img_character = this.me.getChildByName("img"),
            cfg.str.str.forEach(function(e) {
                "fighttips" == e.type && t.tips.push(e[GameMgr.client_language])
            })
        }
        ,
        i.prototype.show = function(e) {
            if (this.pre_t = Laya.timer.currTimer,
            this.current_progress = 0,
            this.progress_val.width = 0,
            this.img_flower.x = 0,
            this.progress_label.x = -40,
            this.img_loading.skin = game.Tools.localUISrc("myres/necessary/" + e + ".png"),
            !this.enable) {
                t.UIMgr.Inst.closeUIWithTag_Both(),
                this.enable = !0;
                for (var i = 1; i < this.tips.length; i++) {
                    var n = Math.floor(Math.random() * (i + 1))
                      , a = this.tips[n];
                    this.tips[n] = this.tips[i],
                    this.tips[i] = a
                }
                this.tips_showindex = 0,
                this.tips_changeCD = Laya.timer.currTimer + 5e3,
                this.label_tips.text = this.tips[0],
                this.img_loading.visible = !0,
                this.container_waitother.visible = !1,
                this.starttime = Laya.timer.currTimer,
                this.me.getChildByName("black").visible = !0;
                var r = (Math.floor((game.Tools.currentTime - 1549296e3) / 3600 / 24) % 8 + 8) % 8;
                game.LoadMgr.setImgSkin(this.img_character, "newyear_loading/newyear_" + r + ".png")
            }
        }
        ,
        i.prototype.close = function(t) {
            void 0 === t && (t = null),
            this.enable = !1,
            t && t.run()
        }
        ,
        i.prototype.update = function() {
            var t = Laya.timer.currTimer - this.pre_t;
            this.pre_t = Laya.timer.currTimer,
            this.refresh_flower(),
            this.refresh_progress(t)
        }
        ,
        i.prototype.showLoadCount = function(t, e) {
            this.img_loading.visible = !1,
            this.container_waitother.visible = !0,
            this.waitother_label0.text = t.toString(),
            this.waitother_label1.text = e.toString();
            for (var i = this.container_waitother.displayWidth / this.container_waitother.scaleX + 40, n = 0; n < this.container_waitother.numChildren; n++) {
                var a = this.container_waitother.getChildAt(n);
                a.x = i,
                i += a.textField.textWidth
            }
        }
        ,
        i.prototype.setProgressVal = function(t) {
            this.current_progress = t
        }
        ,
        i.prototype.refresh_flower = function() {
            var t = Laya.timer.currTimer - this.starttime;
            t > 2e3 && (t = 0,
            this.starttime = Laya.timer.currTimer);
            var e = t / 2e3;
            this.img_flower.rotation = 360 * e,
            this.tips_changeCD <= Laya.timer.currTimer && (this.tips_changeCD = Laya.timer.currTimer + 5e3,
            this.tips_showindex = (this.tips_showindex + 1) % this.tips.length,
            this.label_tips.text = this.tips[this.tips_showindex])
        }
        ,
        i.prototype.refresh_progress = function(t) {
            var e = this.progress_bar.width * (.8 * this.current_progress + .2);
            if (this.progress_val.width >= e)
                this.progress_val.width = e;
            else {
                var i = (e - this.progress_val.width) / this.progress_bar.width
                  , n = Math.sqrt(4 * i) * t / 1e3;
                n >= i ? this.progress_val.width = e : this.progress_val.width += n * this.progress_bar.width
            }
            this.progress_label.x = this.progress_val.width - 40,
            this.progress_label.text = (this.progress_val.width / this.progress_bar.width * 100).toFixed(0) + "%",
            this.img_flower.x = this.progress_val.width
        }
        ,
        i.Inst = null,
        i
    }(t.UIBase);
    t.UI_Loading = e
}(uiscript || (uiscript = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), uiscript;
!function(t) {
    var e = function() {
        function e(e) {
            var i = this;
            this.money = null,
            this.rank = null,
            this.me = e,
            this.label_name = e.getChildByName("label_name"),
            this.rank = new t.UI_Level(e.getChildByName("rank")),
            this.money = new t.UI_Money(e,Laya.Handler.create(o.Inst, o.Inst.Hide, null, !1),Laya.Handler.create(this, function() {
                return o.Inst.locking
            }, null, !1)),
            this.title = new t.UI_PlayerTitle(e.getChildByName("img_title")),
            this.btn_playerinfo = e.getChildByName("btn_playerinfo"),
            this.btn_playerinfo.clickHandler = Laya.Handler.create(this, function() {
                t.UI_PlayerInfo.Inst.show(),
                GameMgr.Inst.BehavioralStatistics(13)
            }, null, !1),
            e.getChildByName("btn_activity").clickHandler = Laya.Handler.create(this, function() {
                o.Inst.locking || (t.UI_Activity.Inst.show(),
                GameMgr.Inst.BehavioralStatistics(18))
            }, null, !1),
            e.getChildByName("btn_rank").clickHandler = Laya.Handler.create(this, function() {
                o.Inst.locking || (t.UI_Rank.Inst.show(),
                GameMgr.Inst.BehavioralStatistics(18))
            }, null, !1),
            e.getChildByName("btn_info").clickHandler = Laya.Handler.create(this, function() {
                o.Inst.locking || t.UI_Info.Inst.show()
            }, null, !1),
            e.getChildByName("btn_set").clickHandler = Laya.Handler.create(this, function() {
                o.Inst.locking || t.UI_Config.Inst.show()
            }, null, !1),
            e.getChildByName("btn_help").clickHandler = Laya.Handler.create(this, function() {
                o.Inst.locking || t.UI_Rules.Inst.show()
            }, null, !1),
            e.getChildByName("btn_xinshouyindao").clickHandler = Laya.Handler.create(this, function() {
                o.Inst.locking || (t.UI_PiPeiYuYue.Inst.enable ? t.UI_Popout.PopOutNoTitle(game.Tools.strOfLocalization(204), null) : o.Inst.Hide(Laya.Handler.create(i, function() {
                    t.UI_XinShouYinDao.Inst.show(0, Laya.Handler.create(i, function() {
                        o.Inst.enable = !0
                    }))
                })))
            }, null, !1)
        }
        return e.prototype.refresh = function() {
            var t = GameMgr.Inst.account_data;
            this.label_name.text = t.nickname,
            this.title.id = t.title,
            this.rank.id = t.level.id,
            this.money.onEnable(),
            this.refreshRedpoint()
        }
        ,
        e.prototype.refreshRedpoint = function() {
            this.me.getChildByName("btn_activity").getChildByName("redpoint").visible = t.UI_Mail.haveRedPoint || t.UI_Activity.haveRedPoint,
            this.me.getChildByName("btn_info").getChildByName("redpoint").visible = t.UI_Info.haveRedPoint
        }
        ,
        e
    }()
      , i = function() {
        function e(e) {
            this.me = e,
            this.btn_dajiangsai = e.getChildByName("btn_dajiangsai"),
            this.btn_yibanchang = e.getChildByName("btn_yibanchang"),
            this.btn_yourenfang = e.getChildByName("btn_yourenfang"),
            this.btn_yibanchang.clickHandler = Laya.Handler.create(this, function() {
                o.Inst.setPage(1),
                GameMgr.Inst.BehavioralStatistics(1)
            }, null, !1),
            this.btn_yourenfang.clickHandler = Laya.Handler.create(this, function() {
                o.Inst.setPage(2),
                GameMgr.Inst.BehavioralStatistics(2)
            }, null, !1),
            this.btn_dajiangsai.clickHandler = Laya.Handler.create(this, function() {
                "chs" == GameMgr.client_language ? (GameMgr.Inst.BehavioralStatistics(3),
                o.Inst.setPage(3)) : t.UIMgr.Inst.ShowErrorInfo(game.Tools.strOfLocalization(2749))
            }, null, !1)
        }
        return e.prototype.onEnable = function(t) {
            var e = this;
            this.btn_yibanchang.visible = !1,
            this.btn_dajiangsai.visible = !1,
            this.btn_yourenfang.visible = !1,
            this.btn_yibanchang.alpha = 1,
            this.btn_dajiangsai.alpha = 1,
            this.btn_yourenfang.alpha = 1,
            Laya.timer.once(t, this, function() {
                view.AudioMgr.PlayAudio(104),
                e.btn_yibanchang.x = 700,
                e.btn_yibanchang.y = 405,
                e.btn_yibanchang.scaleX = .2,
                e.btn_yibanchang.scaleY = .2,
                e.btn_yibanchang.visible = !0,
                e.btn_yibanchang.alpha = 0,
                Laya.Tween.to(e.btn_yibanchang, {
                    x: 1183,
                    y: 368,
                    scaleX: 1.2,
                    scaleY: 1.2,
                    alpha: 1
                }, 233, function(t, e, i, n) {
                    return Laya.Ease.backOut(t, e, i, n, 1)
                })
            }),
            Laya.timer.once(t + 100, this, function() {
                view.AudioMgr.PlayAudio(104),
                e.btn_dajiangsai.x = 700,
                e.btn_dajiangsai.y = 530,
                e.btn_dajiangsai.scaleX = .2,
                e.btn_dajiangsai.scaleY = .2,
                e.btn_dajiangsai.visible = !0,
                e.btn_dajiangsai.alpha = 0,
                Laya.Tween.to(e.btn_dajiangsai, {
                    x: 1110,
                    y: 547,
                    scaleX: 1.2,
                    scaleY: 1.2,
                    alpha: 1
                }, 233, function(t, e, i, n) {
                    return Laya.Ease.backOut(t, e, i, n, 1)
                })
            }),
            Laya.timer.once(t + 200, this, function() {
                view.AudioMgr.PlayAudio(104),
                e.btn_yourenfang.x = 700,
                e.btn_yourenfang.y = 634,
                e.btn_yourenfang.scaleX = .2,
                e.btn_yourenfang.scaleY = .2,
                e.btn_yourenfang.visible = !0,
                e.btn_yourenfang.alpha = 0,
                Laya.Tween.to(e.btn_yourenfang, {
                    x: 1123,
                    y: 736,
                    scaleX: 1.2,
                    scaleY: 1.2,
                    alpha: 1
                }, 233, function(t, e, i, n) {
                    return Laya.Ease.backOut(t, e, i, n, 1)
                })
            }),
            this.me.visible = !0
        }
        ,
        e.prototype.onDisable = function(e) {
            var i = this;
            t.UIBase.anim_alpha_out(this.btn_yibanchang, {
                x: -500,
                y: 450,
                scaleX: -1,
                scaleY: -1
            }, 200, e, null, Laya.Ease.backIn),
            t.UIBase.anim_alpha_out(this.btn_dajiangsai, {
                x: -500,
                y: 150,
                scaleX: -1,
                scaleY: -1
            }, 200, e, null, Laya.Ease.backIn),
            t.UIBase.anim_alpha_out(this.btn_yourenfang, {
                x: -500,
                y: -150,
                scaleX: -1,
                scaleY: -1
            }, 200, e, null, Laya.Ease.backIn),
            Laya.timer.once(200 + e, this, function() {
                i.me.visible = !1
            })
        }
        ,
        e
    }()
      , n = function() {
        function e(e) {
            var i = this;
            this.locking = !1,
            this.current_choose_room = -1,
            this.list_room = [],
            this.list_mode = [],
            this.in0 = !0,
            this._last_fetch_time = 0,
            this._last_fetch_success = !1,
            this.me = e,
            this.btn_back = e.getChildByName("container_title").getChildByName("btn_back"),
            this.btn_back.clickHandler = Laya.Handler.create(this, function() {
                i.locking || (i.in0 ? o.Inst.setPage(0) : i.toShow0())
            }, null, !1),
            this.p0 = e.getChildByName("p0"),
            this.p0.getChildByName("content").vScrollBar.visible = !1,
            this.content0 = this.p0.getChildByName("content");
            for (var n = GameMgr.Inst.account_data, a = function(e) {
                var a = r.p0.getChildByName("content").getChildByName("btn" + e)
                  , s = a.getChildByName("container")
                  , o = s.getChildByName("btn")
                  , l = a.getChildByName("stop")
                  , h = 0;
                h = e < 4 ? 1 + 3 * e : 15;
                var c = cfg.desktop.matchmode.find(h);
                c.is_open ? (o.mouseEnabled = !0,
                s.filters = [],
                l.visible = !1,
                o.clickHandler = Laya.Handler.create(r, function() {
                    if (!i.locking) {
                        var a = !0
                          , r = "";
                        a && !c.is_open && (a = !1,
                        r = game.Tools.strOfLocalization(1306)),
                        a && c.glimit_floor && n.gold < c.glimit_floor && (a = !1,
                        r = game.Tools.strOfLocalization(101)),
                        a && -1 !== c.glimit_ceil && n.gold > c.glimit_ceil && (a = !1,
                        r = game.Tools.strOfLocalization(102)),
                        a && c.level_limit && n.level.id < c.level_limit && (a = !1,
                        r = game.Tools.strOfLocalization(103)),
                        a && c.level_limit_ceil && n.level.id > c.level_limit_ceil && (a = !1,
                        r = game.Tools.strOfLocalization(103)),
                        a ? i.toShow1(e) : t.UIMgr.Inst.ShowErrorInfo(r)
                    }
                }, null, !1)) : (o.mouseEnabled = !1,
                s.filters = [new Laya.ColorFilter(t.GRAY_FILTER)],
                l.visible = !0),
                s.getChildByName("btn_tips").clickHandler = Laya.Handler.create(r, function() {
                    i.locking || t.UI_InfoLite.Inst.show(game.Tools.strOfLocalization(e < 4 ? 4 + e : 64))
                }, null, !1)
            }, r = this, s = 0; s < 5; s++)
                a(s);
            this.p1 = e.getChildByName("p1"),
            this.p1.getChildByName("content").vScrollBar.visible = !1,
            this.content1 = this.p1.getChildByName("content");
            for (var l = function(e) {
                h.p1.getChildByName("content").getChildByName("btn" + e).getChildByName("btn").clickHandler = Laya.Handler.create(h, function() {
                    if (!i.locking) {
                        var n = i.p1.getChildByName("content").getChildByName("btn" + e).getChildByName("flag_yuyue");
                        t.UI_PiPeiYuYue.Inst.matchYuYued(i.list_mode[e].id) ? t.UI_PiPeiYuYue.Inst.cancelPiPei(i.list_mode[e].id) : (t.UI_PiPeiYuYue.Inst.addMatch(i.list_mode[e].id),
                        n.visible = !0),
                        GameMgr.Inst.BehavioralStatistics(8 + e)
                    }
                }, null, !1),
                h.p1.getChildByName("content").getChildByName("btn" + e).getChildByName("btn_tips").clickHandler = Laya.Handler.create(h, function() {
                    i.locking || t.UI_InfoLite.Inst.show(game.Tools.strOfLocalization(2 + e))
                }, null, !1)
            }, h = this, s = 0; s < 2; s++)
                l(s);
            this.onShow0(),
            this.title = e.getChildByName("container_title").getChildAt(0),
            t.UI_PiPeiYuYue.Inst.me.on("cancelPiPei", this, function(t) {
                for (var e = 0; e < 2; e++)
                    i.list_mode[e].id == t && (i.p1.getChildByName("content").getChildByName("btn" + e).getChildByName("flag_yuyue").visible = !1)
            }),
            t.UI_PiPeiYuYue.Inst.me.on("pipeiover", this, function() {
                for (var t = 0; t < 2; t++)
                    i.p1.getChildByName("content").getChildByName("btn" + t).getChildByName("flag_yuyue").visible = !1
            })
        }
        return e.prototype.onEnable = function(t) {
            var e = this;
            this.content0.vScrollBar.value = 0,
            this.content1.vScrollBar.value = 0,
            view.AudioMgr.PlayAudio(102),
            Laya.timer.once(t, this, function() {
                e.me.visible = !0,
                e.p1.visible = !1,
                e.locking = !0,
                e.in0 = !0,
                e.title.text = game.Tools.strOfLocalization(2079),
                e.p0.alpha = 1,
                e.p1.alpha = 1,
                e.title.alpha = 1,
                game.Tools.labelLocalizationPosition(e.title, 345, e.title.width, !0),
                o.Inst.me.YBin.play(0, !1),
                e.p0.visible = !1,
                Laya.timer.once(100, e, function() {
                    e.p0.visible = !0,
                    o.Inst.me.YB2in.play(0, !1)
                }),
                Laya.timer.once(300, e, function() {
                    e.locking = !1,
                    e.reset()
                })
            });
            for (var i = 0; i < 2; i++)
                this.p1.getChildByName("content").getChildByName("btn" + i).getChildByName("count").text = "--";
            Laya.timer.loop(1e3, this, this._fetchPlayerCount)
        }
        ,
        e.prototype.reset = function() {
            for (t = 0; t < 4; t++)
                this.p0.getChildByName("content").getChildByName("btn" + t).alpha = 1;
            for (var t = 0; t < 2; t++)
                this.p1.getChildByName("content").getChildByName("btn" + t).alpha = 1
        }
        ,
        e.prototype.onDisable = function(t) {
            var e = this;
            this.locking = !0,
            Laya.timer.once(t, this, function() {
                o.Inst.me.YBout.play(0, !1),
                o.Inst.me.YB1out.play(0, !1),
                o.Inst.me.YB2out.play(0, !1)
            }),
            Laya.timer.once(t + 200, this, function() {
                e.me.visible = !1,
                e.locking = !1,
                e.reset(),
                Laya.timer.clearAll(e)
            })
        }
        ,
        e.prototype.onShow0 = function() {
            var t = [];
            cfg.desktop.matchmode.forEach(function(e, i) {
                if (e.can_sumup) {
                    for (var n = !1, a = 0; a < t.length; a++)
                        if (t[a].room == e.room) {
                            n = !0;
                            break
                        }
                    n || t.push({
                        room: e.room,
                        title: e["room_name_" + GameMgr.client_language]
                    })
                }
            }),
            this.list_room = t
        }
        ,
        e.prototype.onShow1 = function() {
            var e = this;
            this.content1.vScrollBar.value = 0;
            var i = [];
            cfg.desktop.matchmode.forEach(function(t, n) {
                0 != t.mode && e.current_choose_room == t.room && i.push({
                    mode: t.mode,
                    id: t.id
                })
            }),
            this.list_mode = i,
            this._last_fetch_time = 0,
            this._last_fetch_success = !0,
            this._fetchPlayerCount();
            for (var n = 0; n < i.length; n++)
                this.p1.getChildByName("content").getChildByName("btn" + n).getChildByName("flag_yuyue").visible = t.UI_PiPeiYuYue.Inst.matchYuYued(i[n].id)
        }
        ,
        e.prototype.toShow0 = function() {
            var t = this;
            this.locking = !0,
            this.title.text = game.Tools.strOfLocalization(2079),
            this.in0 = !0,
            game.Tools.labelLocalizationPosition(this.title, 345, this.title.width, !0),
            o.Inst.me.YB1out.play(0, !1),
            Laya.timer.once(100, this, function() {
                view.AudioMgr.PlayAudio(102),
                t.p0.visible = !0,
                t.p1.visible = !1,
                t.p1.alpha = 1,
                t.p0.alpha = 1,
                o.Inst.me.YB2in.play(0, !1),
                t.onShow0(),
                t.locking = !1,
                Laya.timer.once(200, t, function() {
                    t.reset()
                })
            })
        }
        ,
        e.prototype.toShow1 = function(t) {
            var e = this;
            this.locking = !0,
            this.current_choose_room = this.list_room[t].room,
            this.title.text = this.list_room[t].title,
            game.Tools.labelLocalizationPosition(this.title, 345, this.title.width, !0),
            this.in0 = !1,
            o.Inst.me.YB2out.play(0, !1),
            Laya.timer.once(100, this, function() {
                view.AudioMgr.PlayAudio(102),
                e.p1.visible = !0,
                e.p0.visible = !1,
                e.p1.alpha = 1,
                e.p0.alpha = 1,
                o.Inst.me.YB1in.play(0, !1),
                e.onShow1(),
                e.locking = !1,
                Laya.timer.once(200, e, function() {
                    e.reset()
                })
            })
        }
        ,
        e.prototype._fetchPlayerCount = function() {
            var e = this;
            if (game.LobbyNetMgr.Inst.isOK && !this.in0 && this._last_fetch_success && !(Laya.timer.currTimer < this._last_fetch_time + 7e3)) {
                this._last_fetch_time = Laya.timer.currTimer;
                for (var i = [], n = 0; n < this.list_mode.length; n++)
                    i.push(this.list_mode[n].id);
                this._last_fetch_success = !1,
                app.NetAgent.sendReq2Lobby("Lobby", "fetchCurrentMatchInfo", {
                    mode_list: i
                }, function(i, n) {
                    if (i || n.error) {
                        t.UIMgr.Inst.showNetReqError("fetchCurrentMatchInfo", i, n);
                        for (a = 0; a < 2; a++)
                            e.p1.getChildByName("content").getChildByName("btn" + a).getChildByName("count").text = "--";
                        e._last_fetch_success = !1
                    } else
                        try {
                            app.Log.log(JSON.stringify(n));
                            for (var a = 0; a < n.matches.length; a++) {
                                for (var r = n.matches[a].mode_id, s = n.matches[a].playing_count, o = -1, l = 0; l < e.list_mode.length; l++)
                                    if (e.list_mode[l].id == r) {
                                        o = l;
                                        break
                                    }
                                -1 != o && (e.p1.getChildByName("content").getChildByName("btn" + o).getChildByName("count").text = s.toString())
                            }
                            e._last_fetch_success = !0
                        } catch (i) {}
                })
            }
        }
        ,
        e
    }()
      , a = function() {
        function e(e) {
            var i = this;
            this.me = e,
            this.btn_back = e.getChildByName("title").getChildByName("btn_back"),
            this.btn_back.clickHandler = Laya.Handler.create(this, function() {
                o.Inst.setPage(0)
            }, null, !1),
            this.btn_create_room = e.getChildByName("content").getChildByName("btn0").getChildByName("btn"),
            e.getChildByName("content").getChildByName("btn0").getChildByName("btn_tips").clickHandler = Laya.Handler.create(this, function() {
                t.UI_InfoLite.Inst.show(game.Tools.strOfLocalization(8)),
                GameMgr.Inst.BehavioralStatistics(10)
            }, null, !1),
            this.btn_add_room = e.getChildByName("content").getChildByName("btn1").getChildByName("btn"),
            e.getChildByName("content").getChildByName("btn1").getChildByName("btn_tips").clickHandler = Laya.Handler.create(this, function() {
                t.UI_InfoLite.Inst.show(game.Tools.strOfLocalization(9))
            }, null, !1),
            this.btn_create_room.clickHandler = Laya.Handler.create(this, function() {
                o.Inst.locking || (t.UI_PiPeiYuYue.Inst.enable ? t.UI_Popout.PopOutNoTitle(game.Tools.strOfLocalization(204), null) : o.Inst.Hide(Laya.Handler.create(i, function() {
                    t.UI_Create_Room.Show()
                })))
            }, null, !1),
            this.btn_add_room.clickHandler = Laya.Handler.create(this, function() {
                t.UI_PiPeiYuYue.Inst.enable ? t.UI_Popout.PopOutNoTitle(game.Tools.strOfLocalization(204), null) : (t.UI_NumberInput.Inst.show(game.Tools.strOfLocalization(2080), Laya.Handler.create(i, function(e) {
                    app.NetAgent.sendReq2Lobby("Lobby", "joinRoom", {
                        room_id: e
                    }, function(e, i) {
                        e || i.error ? t.UIMgr.Inst.showNetReqError("joinRoom", e, i) : (o.Inst.enable = !1,
                        t.UI_WaitingRoom.Inst.updateData(i.room),
                        t.UIMgr.Inst.ShowWaitingRoom())
                    })
                }), null),
                GameMgr.Inst.BehavioralStatistics(11))
            }, null, !1);
            var n = e.getChildByName("title").getChildAt(0);
            game.Tools.labelLocalizationPosition(n, 345, n.width, !0),
            "chs" != GameMgr.client_language && (e.getChildByName("content").getChildByName("btn0").getChildByName("del").visible = !1,
            e.getChildByName("content").getChildByName("btn1").getChildByName("del").visible = !1)
        }
        return e.prototype.onEnable = function(t) {
            var e = this;
            Laya.timer.once(t, this, function() {
                view.AudioMgr.PlayAudio(102),
                e.me.visible = !0,
                o.Inst.me.YRin.play(0, !1),
                e.btn_create_room.visible = !1,
                e.btn_add_room.visible = !1,
                e.reset(),
                e.btn_create_room.visible = !0,
                e.btn_add_room.visible = !0,
                o.Inst.me.YR1in.play(0, !1)
            })
        }
        ,
        e.prototype.reset = function() {
            this.btn_add_room.alpha = 1,
            this.btn_create_room.alpha = 1,
            this.me.getChildByName("title").alpha = 1
        }
        ,
        e.prototype.onDisable = function(t) {
            var e = this;
            o.Inst.me.YRout.play(0, !1),
            o.Inst.me.YR1out.play(0, !1),
            Laya.timer.once(200, this, function() {
                e.me.visible = !1
            })
        }
        ,
        e
    }()
      , r = function() {
        function e(e) {
            var i = this;
            this.btns = [],
            this.me = e,
            this.btn_back = e.getChildByName("title").getChildByName("btn_back"),
            this.btn_back.clickHandler = Laya.Handler.create(this, function() {
                o.Inst.setPage(0)
            }, null, !1),
            this.content = e.getChildByName("content");
            for (var n = function(e) {
                var n = a.content.getChildByName("btn" + e);
                a.btns.push(n),
                n.getChildByName("container").getChildByName("btn").clickHandler = Laya.Handler.create(a, function() {
                    o.Inst.locking || (t.UI_PiPeiYuYue.Inst.enable ? t.UI_Popout.PopOutNoTitle(game.Tools.strOfLocalization(204), null) : 0 == e && ("chs" == GameMgr.client_language ? o.Inst.Hide(Laya.Handler.create(i, function() {
                        t.UI_Match_Lobby.Inst.show()
                    })) : t.UIMgr.Inst.ShowErrorInfo(game.Tools.strOfLocalization(2749))))
                }, null, !1),
                n.getChildByName("container").getChildByName("btn_tips").clickHandler = Laya.Handler.create(a, function() {
                    o.Inst.locking || t.UI_InfoLite.Inst.show(game.Tools.strOfLocalization(56))
                }, null, !1)
            }, a = this, r = 0; r < 1; r++)
                n(r);
            var s = e.getChildByName("title").getChildAt(0);
            game.Tools.labelLocalizationPosition(s, 345, s.width, !0)
        }
        return e.prototype.onEnable = function(t) {
            var e = this;
            Laya.timer.once(t, this, function() {
                view.AudioMgr.PlayAudio(102),
                e.me.visible = !0,
                e.reset(),
                o.Inst.me.BSin.play(0, !1),
                o.Inst.me.BS1in.play(0, !1)
            })
        }
        ,
        e.prototype.reset = function() {
            for (var t = 0; t < this.btns.length; t++)
                this.btns[t].visible = !0,
                this.btns[t].alpha = 1;
            this.me.getChildByName("title").alpha = 1
        }
        ,
        e.prototype.onDisable = function(t) {
            var e = this;
            o.Inst.me.BSout.play(0, !1),
            o.Inst.me.BS1out.play(0, !1),
            Laya.timer.once(200, this, function() {
                e.me.visible = !1
            })
        }
        ,
        e
    }()
      , s = function() {
        function e(e) {
            var i = this;
            this.me = e;
            for (var n = function(n) {
                e.getChildAt(n).clickHandler = Laya.Handler.create(a, function() {
                    o.Inst.locking || (0 == n ? o.Inst.Hide(Laya.Handler.create(i, function() {
                        t.UI_Sushe.Inst.show()
                    })) : 5 == n ? o.Inst.Hide(Laya.Handler.create(i, function() {
                        t.UI_Shop.Inst.show()
                    })) : 3 == n ? o.Inst.Hide(Laya.Handler.create(i, function() {
                        t.UI_PaiPu.Inst.show()
                    })) : 1 == n ? o.Inst.Hide(Laya.Handler.create(i, function() {
                        t.UI_Friend.Inst.show()
                    })) : 2 == n ? o.Inst.Hide(Laya.Handler.create(i, function() {
                        t.UI_Ob.Inst.show()
                    })) : 4 == n ? o.Inst.Hide(Laya.Handler.create(i, function() {
                        t.UI_Bag.Inst.show()
                    })) : 6 == n && o.Inst.Hide(Laya.Handler.create(i, function() {
                        t.UI_Treasure.Inst.show()
                    })))
                }, null, !1)
            }, a = this, r = 0; r < 7; r++)
                n(r)
        }
        return e.prototype.onEnable = function() {
            this.me.getChildAt(1).getChildByName("redpoint").visible = game.FriendMgr.friendapply_list && game.FriendMgr.friendapply_list.length > 0
        }
        ,
        e
    }()
      , o = function(o) {
        function l() {
            var t = o.call(this, new ui.lobby.lobbyUI) || this;
            return t.top = null,
            t.page0 = null,
            t.page1 = null,
            t.page2 = null,
            t.page3 = null,
            t.btns = null,
            t.chat_id = 0,
            t.container_chat = null,
            t.chat_block = null,
            t.character_skin = null,
            t.nowpage = 0,
            t.locking = !1,
            t.sound_channel = null,
            l.Inst = t,
            t
        }
        return __extends(l, o),
        l.prototype.onCreate = function() {
            var o = this;
            this.top = new e(this.me.getChildByName("container_top")),
            this.page0 = new i(this.me.getChildByName("page0")),
            this.page1 = new n(this.me.getChildByName("page1")),
            this.page2 = new a(this.me.getChildByName("page2")),
            this.page3 = new r(this.me.getChildByName("page3")),
            this.btns = new s(this.me.getChildByName("container_btns")),
            this.character_skin = new t.UI_Character_Skin(this.me.getChildByName("illust").getChildByName("illust")),
            this.container_chat = this.me.getChildByName("illust").getChildByName("chat"),
            this.container_chat.visible = !1,
            this.chat_block = new t.UI_Character_Chat(this.container_chat),
            this.me.getChildByName("illust").getChildByName("btn").clickHandler = Laya.Handler.create(this, function() {
                l.login_helloed && (o.sound_channel ? o.stopsay() : o.say("lobby_normal"))
            }, null, !1)
        }
        ,
        l.prototype.onEnable = function() {
            this.showEnter(),
            t.UI_TanfangRoot.Inst.beginload(),
            t.UI_Invite.Inst.enable = !0,
            0 == app.PlayerBehaviorStatistic.get_val(app.EBehaviorType.XinShouYinDao) && app.PlayerBehaviorStatistic.update_val(app.EBehaviorType.XinShouYinDao, 2),
            app.PlayerBehaviorStatistic.fb_trace_pending(app.EBehaviorType.Purchase, app.PlayerBehaviorStatistic.recharged_count)
        }
        ,
        l.prototype.onDisable = function() {
            this.page0.onDisable(0),
            this.page1.onDisable(0),
            this.page2.onDisable(0),
            this.page3.onDisable(0),
            this.character_skin.clear(),
            this.stopsay()
        }
        ,
        l.prototype.showEnter = function() {
            var t = this;
            this.refreshInfo(),
            this.page0.me.visible = !0,
            this.page1.me.visible = !1,
            this.page2.me.visible = !1,
            this.page3.me.visible = !1,
            this.nowpage = 0,
            this.locking = !0,
            this.me.in.play(0, !1),
            this.page0.onEnable(567),
            this.btns.onEnable(),
            Laya.timer.once(700, this, function() {
                t.locking = !1
            }),
            game.Scene_Lobby.Inst.change_bg("yard", !1),
            l.login_helloed || Laya.timer.once(500, this, function() {
                l.login_helloed = !0,
                t.say("lobby_playerlogin")
            })
        }
        ,
        l.prototype.refreshInfo = function() {
            GameMgr.Inst.account_data;
            this.top.refresh(),
            this.character_skin.setSkin(GameMgr.Inst.account_data.avatar_id, "full"),
            this.character_skin.me.visible = !0
        }
        ,
        l.prototype.getContainer = function(t) {
            switch (t) {
            case 0:
                return this.page0.me;
            case 1:
                return this.page1.me;
            case 2:
                return this.page2.me
            }
            return null
        }
        ,
        l.prototype.Hide = function(t) {
            var e = this;
            this.locking = !0;
            this.getContainer(this.nowpage);
            switch (this.nowpage) {
            case 0:
                this.page0.onDisable(0);
                break;
            case 1:
                this.page1.onDisable(0);
                break;
            case 2:
                this.page2.onDisable(0);
                break;
            case 3:
                this.page3.onDisable(0)
            }
            this.me.out.play(0, !1),
            Laya.timer.once(250, this, function() {
                e.locking = !1,
                e.enable = !1,
                t && t.run()
            })
        }
        ,
        l.prototype.setPage = function(t) {
            var e = this;
            if (!this.locking && this.nowpage != t) {
                switch (this.locking = !0,
                this.nowpage) {
                case 0:
                    this.page0.onDisable(0);
                    break;
                case 1:
                    this.page1.onDisable(0);
                    break;
                case 2:
                    this.page2.onDisable(0);
                    break;
                case 3:
                    this.page3.onDisable(0)
                }
                this.nowpage = t;
                var i = 750;
                switch (this.nowpage) {
                case 0:
                    this.page0.onEnable(200);
                    break;
                case 1:
                    this.page1.onEnable(200);
                    break;
                case 2:
                    this.page2.onEnable(200);
                    break;
                case 3:
                    this.page3.onEnable(200),
                    i = 500
                }
                Laya.timer.once(i, this, function() {
                    e.locking = !1
                })
            }
        }
        ,
        l.prototype.say = function(e) {
            var i = this
              , n = t.UI_Sushe.main_chara_info;
            this.chat_id++;
            var a = this.chat_id
              , r = view.AudioMgr.PlayCharactorSound(n, e, Laya.Handler.create(this, function() {
                Laya.timer.once(1e3, i, function() {
                    i.chat_id == a && i.stopsay()
                })
            }));
            r && (this.chat_block.show(r.words),
            this.sound_channel = r.sound)
        }
        ,
        l.prototype.stopsay = function() {
            this.chat_block.close(!1),
            this.sound_channel && (this.sound_channel.stop(),
            Laya.SoundManager.removeChannel(this.sound_channel),
            this.sound_channel = null)
        }
        ,
        l.Inst = null,
        l.login_helloed = !1,
        l
    }(t.UIBase);
    t.UI_Lobby = o
}(uiscript || (uiscript = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), uiscript;
!function(t) {
    var e;
    !function(t) {
        t[t.none = 0] = "none",
        t[t.channel = 1] = "channel",
        t[t.person = 2] = "person"
    }(e || (e = {}));
    var i = function(t) {
        function i() {
            var n = t.call(this, new ui.lobby.lobbychatUI) || this;
            return n.render_text = null,
            n.btn_switch = null,
            n.container_main = null,
            n.left_heads = null,
            n.chattype = e.none,
            n.chat_account_id = 0,
            i.Inst = n,
            n
        }
        return __extends(i, t),
        i.prototype.onCreate = function() {}
        ,
        i.prototype.onShow = function() {}
        ,
        i.prototype.onHide = function() {}
        ,
        i.prototype.onReceivePersonMsg = function(t) {}
        ,
        i.prototype.onReceiveWorldMsg = function() {}
        ,
        i.prototype.firstRefresh = function() {}
        ,
        i.Inst = null,
        i
    }(t.UIBase);
    t.UI_LobbyChat = i
}(uiscript || (uiscript = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), uiscript;
!function(t) {
    var e = function() {
        function e(t) {
            var e = this;
            this.locking = !1,
            this.match_id = 0,
            this.contest_id = 0,
            this.me = t,
            this.root = t.getChildByName("root"),
            this.label_name = this.root.getChildByName("name"),
            this.label_starttime = this.root.getChildByName("starttime");
            var i = this.root.getChildByName("infos");
            this.panel = i.getChildByName("content"),
            this.panel.vScrollBarSkin = "",
            this.label_info = this.panel.getChildByName("label_info"),
            this.scrollbar = i.getChildByName("scrollbar"),
            this.scrollpoint = this.scrollbar.getChildByName("scrollpoint"),
            this.panel.vScrollBar.on("change", this, function() {
                e.refresh_scrollbar()
            }),
            this.root.getChildByName("btn_close").clickHandler = Laya.Handler.create(this, function() {
                e.locking || e.close()
            }, null, !1),
            this.root.getChildByName("btn_close1").clickHandler = Laya.Handler.create(this, function() {
                e.locking || e.close()
            }, null, !1),
            this.root.getChildByName("btn_enter").clickHandler = Laya.Handler.create(this, function() {
                e.locking || (e.close(),
                n.Inst.enter_match(e.match_id, e.contest_id))
            }, null, !1)
        }
        return e.prototype.show = function(e) {
            var i = this;
            this.locking = !0,
            this.me.visible = !0,
            t.UIBase.anim_pop_out(this.root, Laya.Handler.create(this, function() {
                i.locking = !1
            })),
            this.label_name.text = e.contest_name,
            this.label_starttime.text = game.Tools.time2YearMounthDate(e.start_time) + " " + game.Tools.time2HourMinute(e.start_time, !0) + " " + game.Tools.strOfLocalization(2081) + " " + game.Tools.time2YearMounthDate(e.finish_time) + " " + game.Tools.time2HourMinute(e.finish_time, !0),
            this.match_id = e.unique_id,
            this.contest_id = e.contest_id,
            this.label_info.text = game.Tools.strWithoutForbidden(e.public_notice),
            this.label_info.height = this.label_info.textField.textHeight,
            this.panel.vScrollBar.value = 0,
            this.panel.refresh(),
            this.scrollbar.visible = this.label_info.height > this.panel.height,
            this.refresh_scrollbar()
        }
        ,
        e.prototype.close = function() {
            var e = this;
            this.locking = !0,
            t.UIBase.anim_pop_hide(this.root, Laya.Handler.create(this, function() {
                e.locking = !1,
                e.me.visible = !1
            }))
        }
        ,
        e.prototype.refresh_scrollbar = function() {
            if (this.label_info.height > this.panel.height) {
                var t = this.panel.vScrollBar.value / this.panel.vScrollBar.max;
                this.scrollpoint.height = this.scrollbar.height * this.panel.height / this.label_info.height,
                this.scrollpoint.y = t * this.scrollbar.height * (1 - this.panel.height / this.label_info.height),
                this.scrollbar.visible = !0
            } else
                this.scrollbar.visible = !1
        }
        ,
        e
    }()
      , i = function() {
        function e(e) {
            var i = this;
            this.have_data = !1,
            this.match_infos = {},
            this.match_ids = [],
            this.only_follow = !1,
            this.all_match_list = [],
            this.follow_changed = !1,
            this.me = e,
            e.getChildByName("btn_checkmatchID").clickHandler = Laya.Handler.create(this, function() {
                t.UI_NumberInput.Inst.show(game.Tools.strOfLocalization(2082), Laya.Handler.create(i, function(e) {
                    for (var a = -1, r = 0; r < i.all_match_list.length; r++)
                        if (i.match_infos[i.all_match_list[r]].contest_id == e) {
                            a = i.all_match_list[r];
                            break
                        }
                    -1 != a ? n.Inst.enter_match(a, e) : app.NetAgent.sendReq2Lobby("Lobby", "fetchCustomizedContestByContestId", {
                        contest_id: e
                    }, function(i, a) {
                        i || a.error ? t.UIMgr.Inst.showNetReqError("fetchCustomizedContestByContestId", i, a) : a.contest_info ? n.Inst.enter_match(a.contest_info.unique_id, e) : t.UIMgr.Inst.ShowErrorInfo(game.Tools.strOfLocalization(2083) + e)
                    })
                }))
            }, null, !1),
            this.input = e.getChildByName("input").getChildByName("txtinput"),
            e.getChildByName("input").getChildByName("btn_searchname").clickHandler = Laya.Handler.create(this, function() {
                i.refresh_match_list(-1, i.input.text)
            }, null, !1),
            this.input.on(laya.events.Event.KEY_DOWN, this, function(t) {
                t.keyCode == Laya.Keyboard.ENTER && i.refresh_match_list(-1, i.input.text)
            }),
            this.check_follow = e.getChildByName("check_follow").getChildByName("check"),
            e.getChildByName("check_follow").clickHandler = Laya.Handler.create(this, function() {
                i.check_follow.visible = !i.check_follow.visible,
                i.only_follow = i.check_follow.visible,
                i.refresh_match_list()
            }, null, !1),
            this.noinfo = this.me.getChildByName("noinfo"),
            this.nolimitlist = e.scriptMap["capsui.NoLimitList"],
            this.nolimitlist.init_nolimitlist(new Laya.Handler(this,this.load_info), new Laya.Handler(this,this.render_item)),
            this.clearData()
        }
        return e.prototype.onShow = function() {
            var e = this;
            this.have_data ? this.only_follow && this.follow_changed ? this.refresh_match_list() : this.nolimitlist.wantToRefreshAll() : app.NetAgent.sendReq2Lobby("Lobby", "fetchCustomizedContestList", {
                start: 0,
                count: 100
            }, function(i, n) {
                if (i || n.error)
                    t.UIMgr.Inst.showNetReqError("fetchCustomizedContestList", i, n);
                else {
                    if (app.Log.log(JSON.stringify(n)),
                    n = JSON.parse(JSON.stringify(n)),
                    e.have_data = !0,
                    n.contests)
                        for (a = 0; a < n.contests.length; a++) {
                            r = n.contests[a];
                            e.match_infos[r.unique_id] || (e.all_match_list.push(r.unique_id),
                            e.match_infos[r.unique_id] = r),
                            e.match_infos[r.unique_id].follow = !1
                        }
                    if (n.follow_contests)
                        for (var a = 0; a < n.follow_contests.length; a++) {
                            var r = n.follow_contests[a];
                            e.match_infos[r.unique_id] || (e.all_match_list.push(r.unique_id),
                            e.match_infos[r.unique_id] = r),
                            e.match_infos[r.unique_id].follow = !0
                        }
                    e.refresh_match_list()
                }
            }),
            this.follow_changed = !1
        }
        ,
        e.prototype.clearData = function() {
            this.have_data = !1,
            this.match_infos = {},
            this.all_match_list = [],
            this.match_ids = [],
            this.only_follow = !1,
            this.check_follow.visible = !1,
            this.follow_changed = !1,
            this.nolimitlist.reset()
        }
        ,
        e.prototype.load_info = function(e) {
            for (var i = this, n = [], a = 0, r = 0; r < 20 && r + e < this.match_ids.length; r++) {
                var s = this.match_ids[r + e];
                null == this.match_infos[s].public_notice && n.push(s),
                a++
            }
            0 == n.length ? this.nolimitlist.loadOver(!0, a) : app.NetAgent.sendReq2Lobby("Lobby", "fetchCustomizedContestExtendInfo", {
                uid_list: n
            }, function(e, a) {
                if (e || a.error)
                    t.UIMgr.Inst.showNetReqError("fetchCustomizedContestExtendInfo", e, a.error),
                    i.nolimitlist.loadOver(!1, 0);
                else {
                    app.Log.log(JSON.stringify(a));
                    var r = 0;
                    if (a.extend_list)
                        for (var s = 0; s < a.extend_list.length; s++) {
                            var o = a.extend_list[s];
                            i.match_infos[o.unique_id].public_notice = o.public_notice,
                            r++
                        }
                    r != n.length ? (i.nolimitlist.loadOver(!1, 0),
                    t.UIMgr.Inst.ShowErrorInfo(game.Tools.strOfLocalization(2084))) : i.nolimitlist.loadOver(!0, r)
                }
            })
        }
        ,
        e.prototype.refresh_match_list = function(t, e) {
            var i = this;
            if (void 0 === t && (t = -1),
            void 0 === e && (e = ""),
            this.match_ids = [],
            -1 != t)
                this.match_ids.push(t);
            else
                for (var n = 0; n < this.all_match_list.length; n++) {
                    var a = this.all_match_list[n]
                      , r = this.match_infos[a];
                    if (!this.only_follow || r.follow) {
                        var s = !0;
                        if ("" != e) {
                            var o = r.contest_name;
                            game.Tools.stringContainerSub(o, e) || (s = !1)
                        }
                        s && this.match_ids.push(a)
                    }
                }
            this.match_ids = this.match_ids.sort(function(t, e) {
                var n = i.match_infos[t]
                  , a = i.match_infos[e];
                if (n.state == a.state)
                    return 1 == n.state ? n.start_time - a.start_time : 2 == n.state ? n.finish_time - a.finish_time : a.finish_time - n.finish_time;
                return (2 == n.state ? -1 : n.state) - (2 == a.state ? -1 : a.state)
            }),
            this.nolimitlist.reset(),
            0 == this.match_ids.length ? -1 != t ? this.show_noinfo(game.Tools.strOfLocalization(2083) + t) : this.only_follow ? this.show_noinfo(game.Tools.strOfLocalization(2085)) : this.show_noinfo(game.Tools.strOfLocalization(2086)) : (this.nolimitlist.total_count = this.match_ids.length,
            this.noinfo.visible = !1)
        }
        ,
        e.prototype.render_item = function(t) {
            var e = t.index
              , i = t.container
              , a = this.match_ids[e]
              , r = this.match_infos[a];
            i.getChildByName("follow").visible = r.follow,
            i.getChildByName("name").text = game.Tools.strWithoutForbidden(r.contest_name);
            var s = i.getChildByName("content")
              , o = game.Tools.strWithoutForbidden(r.public_notice);
            if (o && o.length > 0) {
                if (s.text = o,
                s.textField.textHeight > 110) {
                    for (var l = 0, h = 200 < o.length ? 200 : o.length, c = 0; l < h; )
                        c = (l + h) / 2,
                        s.text = o.substring(0, c) + "...",
                        s.textField.textHeight <= 110 ? l = c + 1 : h = c;
                    s.text = o.substring(0, c - 1) + "..."
                }
            } else
                s.text = "";
            i.getChildByName("prepare").visible = !1,
            i.getChildByName("start").visible = !1,
            i.getChildByName("end").visible = !1,
            i.getChildByName("id").text = "ID:" + r.contest_id;
            var u, _ = 0;
            switch (r.state) {
            case 1:
                u = i.getChildByName("prepare"),
                _ = r.start_time;
                break;
            case 2:
                u = i.getChildByName("start"),
                _ = r.finish_time;
                break;
            case 3:
                u = i.getChildByName("end"),
                _ = r.finish_time
            }
            u && (u.visible = !0,
            u.getChildByName("time").text = game.Tools.time2YearMounthDate(_) + " " + game.Tools.time2HourMinute(_, !0)),
            i.getChildByName("check").clickHandler = Laya.Handler.create(this, function() {
                n.Inst.pop_out_notice(r)
            }, null, !1),
            i.getChildByName("btn_enter").clickHandler = Laya.Handler.create(this, function() {
                n.Inst.enter_match(a, r.contest_id)
            }, null, !1)
        }
        ,
        e.prototype.change_match_follow = function(t, e) {
            this.match_infos[t] && (this.match_infos[t].follow = e,
            this.follow_changed = !0)
        }
        ,
        e.prototype.show_noinfo = function(t) {
            this.noinfo.text = t,
            this.noinfo.visible = !0
        }
        ,
        e.prototype.get_match_data = function(t) {
            return this.match_infos[t]
        }
        ,
        e
    }()
      , n = function(n) {
        function a() {
            var t = n.call(this, new ui.lobby.match_lobbyUI) || this;
            return t.locking = !1,
            a.Inst = t,
            t
        }
        return __extends(a, n),
        a.prototype.onCreate = function() {
            var n = this;
            this.container_top = this.me.getChildByName("top"),
            this.container_top.getChildByName("btn_back").clickHandler = Laya.Handler.create(this, function() {
                n.locking || (n.content.clearData(),
                n.close(),
                Laya.timer.once(200, n, function() {
                    t.UI_Lobby.Inst.enable = !0
                }))
            }, null, !1),
            this.content = new i(this.me.getChildByName("root")),
            this.pop_info = new e(this.me.getChildByName("pop_info"))
        }
        ,
        a.prototype.show = function() {
            var e = this;
            game.Scene_Lobby.Inst.change_bg("indoor", !1),
            this.locking = !0,
            this.enable = !0,
            this.pop_info.me.visible = !1,
            this.content.onShow(),
            t.UIBase.anim_alpha_in(this.container_top, {
                y: -30
            }, 150),
            t.UIBase.anim_alpha_in(this.content.me, {
                y: 30
            }, 150),
            Laya.timer.once(200, this, function() {
                e.locking = !1
            })
        }
        ,
        a.prototype.close = function() {
            var e = this;
            this.locking = !0,
            t.UIBase.anim_alpha_out(this.container_top, {
                y: -30
            }, 150),
            t.UIBase.anim_alpha_out(this.content.me, {
                y: 30
            }, 150),
            Laya.timer.once(200, this, function() {
                e.locking = !1,
                e.enable = !1
            })
        }
        ,
        a.prototype.enter_match = function(e, i) {
            this.close(),
            Laya.timer.once(200, this, function() {
                t.UI_Match_Room.Inst.show(e)
            })
        }
        ,
        a.prototype.change_match_follow = function(t, e) {
            this.content.change_match_follow(t, e)
        }
        ,
        a.prototype.clear_data = function() {
            this.content.clearData()
        }
        ,
        a.prototype.pop_out_notice = function(t) {
            this.pop_info.show(t)
        }
        ,
        a
    }(t.UIBase);
    t.UI_Match_Lobby = n
}(uiscript || (uiscript = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), uiscript;
!function(t) {
    var e = function() {
        function e(t) {
            var e = this;
            this.locking = !1,
            this.datas = [],
            this.me = t,
            this.root = t.getChildByName("root"),
            this.scrollview = this.root.getChildByName("container_infos").scriptMap["capsui.CScrollView"],
            this.scrollview.init_scrollview(new Laya.Handler(this,this.render_item)),
            this.light_scrollbar = this.root.getChildByName("container_infos").getChildByName("light_scrollbar"),
            this.scrollpoint = this.light_scrollbar.getChildByName("scrollpoint"),
            this.scrollview.me.on("ratechange", this, function() {
                e.refresh_scorllbar()
            }),
            this.root.getChildByName("btn_close").clickHandler = Laya.Handler.create(this, function() {
                e.locking || e.close()
            }, null, !1),
            this.root.getChildByName("btn_close1").clickHandler = Laya.Handler.create(this, function() {
                e.locking || e.close()
            }, null, !1)
        }
        return e.prototype.show = function(e) {
            var i = this;
            e = JSON.parse(JSON.stringify(e)),
            this.locking = !0,
            this.me.visible = !0,
            t.UIBase.anim_pop_out(this.root, Laya.Handler.create(this, function() {
                i.locking = !1
            })),
            this.scrollview.reset(),
            this.datas = [],
            this.datas.push({
                name: game.Tools.strOfLocalization(2087),
                infos: [game.Tools.room_mode_desc(e.mode)],
                isdefault: [!0]
            });
            var n = e.detail_rule
              , a = null != n.time_fixed ? n.time_fixed : 5
              , r = null != n.time_add ? n.time_add : 20;
            this.datas.push({
                name: game.Tools.strOfLocalization(2088),
                infos: [a.toString() + "+" + r.toString() + game.Tools.strOfLocalization(2019)],
                isdefault: [!0]
            });
            var s = "3";
            if (null != n.dora_count)
                switch (n.dora_count) {
                case 0:
                    s = "0";
                    break;
                case 3:
                    s = "3";
                    break;
                case 4:
                    s = "4"
                }
            this.datas.push({
                name: game.Tools.strOfLocalization(2089),
                infos: [s],
                isdefault: ["3" === s]
            }),
            this.datas.push({
                name: game.Tools.strOfLocalization(2090),
                infos: [game.Tools.strOfLocalization(0 === n.shiduan ? 2091 : 2092)],
                isdefault: [0 !== n.shiduan]
            });
            var o = function(t, e, a, r, s) {
                var o = a;
                null != n[e] && (o = n[e]),
                i.datas.push({
                    name: t,
                    infos: [o ? r : s],
                    isdefault: [o === a]
                })
            }
              , l = function(t, e, a) {
                var r = a;
                null != n[e] && (r = n[e]),
                i.datas.push({
                    name: t,
                    infos: [r.toString()],
                    isdefault: [r === a]
                })
            };
            l(game.Tools.strOfLocalization(2093), "init_point", 25e3),
            l(game.Tools.strOfLocalization(2094), "fandian", 3e4),
            o(game.Tools.strOfLocalization(2095), "can_jifei", !0, game.Tools.strOfLocalization(2092), game.Tools.strOfLocalization(2091)),
            l(game.Tools.strOfLocalization(2096), "tianbian_value", 0),
            l(game.Tools.strOfLocalization(2097), "liqibang_value", 1e3),
            l(game.Tools.strOfLocalization(2098), "changbang_value", 300);
            var h = 1e3
              , c = 1500
              , u = 3e3;
            null != n.noting_fafu_1 && (h = n.noting_fafu_1),
            null != n.noting_fafu_2 && (c = n.noting_fafu_2),
            null != n.noting_fafu_3 && (u = n.noting_fafu_3),
            this.datas.push({
                name: game.Tools.strOfLocalization(2099),
                infos: [h.toString(), c.toString(), u.toString()],
                isdefault: [1e3 === h, 1500 === c, 3e3 === u]
            }),
            l(game.Tools.strOfLocalization(2100), "jingsuanyuandian", 25e3);
            var _ = null != n.shunweima_2 ? n.shunweima_2 : 5
              , d = null != n.shunweima_3 ? n.shunweima_3 : -5
              , f = null != n.shunweima_4 ? n.shunweima_4 : -15
              , p = -(_ + d + f);
            this.datas.push({
                name: game.Tools.strOfLocalization(2101),
                infos: [(p > 0 ? "+" : "") + p.toString(), (_ > 0 ? "+" : "") + _.toString(), (d > 0 ? "+" : "") + d.toString(), (f > 0 ? "+" : "") + f.toString()],
                isdefault: [15 === p, 5 === _, -5 === d, -15 === f]
            }),
            o(game.Tools.strOfLocalization(2102), "bianjietishi", !0, game.Tools.strOfLocalization(2103), game.Tools.strOfLocalization(2104)),
            o(game.Tools.strOfLocalization(2105), "have_liujumanguan", !0, game.Tools.strOfLocalization(2092), game.Tools.strOfLocalization(2091)),
            o(game.Tools.strOfLocalization(2106), "have_qieshangmanguan", !1, game.Tools.strOfLocalization(2092), game.Tools.strOfLocalization(2091)),
            o(game.Tools.strOfLocalization(2107), "have_biao_dora", !0, game.Tools.strOfLocalization(2092), game.Tools.strOfLocalization(2091)),
            o(game.Tools.strOfLocalization(2108), "have_gang_biao_dora", !0, game.Tools.strOfLocalization(2092), game.Tools.strOfLocalization(2091)),
            o(game.Tools.strOfLocalization(2109), "have_li_dora", !0, game.Tools.strOfLocalization(2092), game.Tools.strOfLocalization(2091)),
            o(game.Tools.strOfLocalization(2110), "have_gang_li_dora", !0, game.Tools.strOfLocalization(2092), game.Tools.strOfLocalization(2091)),
            o(game.Tools.strOfLocalization(2111), "ming_dora_immediately_open", !1, game.Tools.strOfLocalization(2103), game.Tools.strOfLocalization(2104)),
            o(game.Tools.strOfLocalization(2112), "have_sifenglianda", !0, game.Tools.strOfLocalization(2092), game.Tools.strOfLocalization(2091)),
            o(game.Tools.strOfLocalization(2113), "have_sigangsanle", !0, game.Tools.strOfLocalization(2092), game.Tools.strOfLocalization(2091)),
            o(game.Tools.strOfLocalization(2114), "have_sijializhi", !0, game.Tools.strOfLocalization(2092), game.Tools.strOfLocalization(2091)),
            o(game.Tools.strOfLocalization(2115), "have_jiuzhongjiupai", !0, game.Tools.strOfLocalization(2092), game.Tools.strOfLocalization(2091)),
            o(game.Tools.strOfLocalization(2116), "have_sanjiahele", !1, game.Tools.strOfLocalization(2092), game.Tools.strOfLocalization(2091)),
            o(game.Tools.strOfLocalization(2117), "have_toutiao", !1, game.Tools.strOfLocalization(2103), game.Tools.strOfLocalization(2104)),
            o(game.Tools.strOfLocalization(2118), "have_helelianzhuang", !0, game.Tools.strOfLocalization(2092), game.Tools.strOfLocalization(2091)),
            o(game.Tools.strOfLocalization(2119), "have_helezhongju", !0, game.Tools.strOfLocalization(2092), game.Tools.strOfLocalization(2091)),
            o(game.Tools.strOfLocalization(2120), "have_tingpailianzhuang", !0, game.Tools.strOfLocalization(2092), game.Tools.strOfLocalization(2091)),
            o(game.Tools.strOfLocalization(2121), "have_tingpaizhongju", !0, game.Tools.strOfLocalization(2092), game.Tools.strOfLocalization(2091)),
            o(game.Tools.strOfLocalization(2122), "have_yifa", !0, game.Tools.strOfLocalization(2092), game.Tools.strOfLocalization(2091)),
            o(game.Tools.strOfLocalization(2123), "have_nanruxiru", !0, game.Tools.strOfLocalization(2092), game.Tools.strOfLocalization(2091)),
            o(game.Tools.strOfLocalization(2210), "disable_multi_yukaman", !1, game.Tools.strOfLocalization(2103), game.Tools.strOfLocalization(2104)),
            this.scrollview.reset(),
            this.scrollview.addItem(this.datas.length)
        }
        ,
        e.prototype.close = function() {
            var e = this;
            this.locking = !0,
            t.UIBase.anim_pop_hide(this.root, Laya.Handler.create(this, function() {
                e.locking = !1,
                e.me.visible = !1
            }))
        }
        ,
        e.prototype.render_item = function(t) {
            var e = t.index
              , i = t.container;
            i.getChildByName("name").text = this.datas[e].name;
            for (var n = this.datas[e].infos, a = this.datas[e].isdefault, r = 0; r < n.length && r < 4; r++) {
                var s = i.getChildByName("item" + r);
                s.visible = !0,
                s.getChildByName("label_name").text = n[r],
                s.getChildByName("label_name").color = a[r] ? "#402031" : "#03751a"
            }
            for (r = n.length; r < 4; r++)
                i.getChildByName("item" + r).visible = !1
        }
        ,
        e.prototype.refresh_scorllbar = function() {
            this.scrollview.need_scroll ? (this.light_scrollbar.visible = !0,
            this.scrollpoint.height = this.light_scrollbar.height * this.scrollview.view_height / this.scrollview.total_height,
            this.scrollpoint.y = this.scrollview.rate * this.light_scrollbar.height * (1 - this.scrollview.view_height / this.scrollview.total_height)) : this.light_scrollbar.visible = !1
        }
        ,
        e
    }()
      , i = function() {
        function e(t) {
            var e = this;
            this.locking = !1,
            this.me = t,
            this.root = t.getChildByName("root"),
            this.root.getChildByName("btn_close").clickHandler = Laya.Handler.create(this, function() {
                e.locking || e.close()
            }, null, !1),
            this.root.getChildByName("btn_close1").clickHandler = Laya.Handler.create(this, function() {
                e.locking || e.close()
            }, null, !1),
            this.title = this.root.getChildByName("title"),
            this.info = this.root.getChildByName("info")
        }
        return e.prototype.show = function(e) {
            var i = this;
            this.locking = !0,
            this.me.visible = !0;
            var n = e.code;
            if (this.title.text = "",
            this.info.text = "",
            2511 == n)
                this.title.text = game.Tools.strOfLocalization(2205),
                this.info.text = game.Tools.strOfLocalization(2206);
            else if (2518 == n) {
                this.title.text = game.Tools.strOfLocalization(2207);
                var a = JSON.parse(e.json_param)
                  , r = cfg.level_definition.level_definition.find(a.required_level);
                this.info.text = game.Tools.strOfLocalization(2208, [r["full_name_" + GameMgr.client_language]])
            } else if (2519 == n) {
                this.title.text = game.Tools.strOfLocalization(2207);
                a = JSON.parse(e.json_param);
                this.info.text = game.Tools.strOfLocalization(2209, [a.max_game_count])
            }
            t.UIBase.anim_pop_out(this.root, Laya.Handler.create(this, function() {
                i.locking = !1
            }))
        }
        ,
        e.prototype.close = function() {
            var e = this;
            this.locking = !0,
            t.UIBase.anim_pop_hide(this.root, Laya.Handler.create(this, function() {
                e.locking = !1,
                e.me.visible = !1
            }))
        }
        ,
        e
    }()
      , n = function() {
        function e(t) {
            var e = this;
            this.me = t,
            this.root = this.me.getChildByName("root"),
            this.title = this.root.getChildByName("title"),
            this.input = this.root.getChildByName("input").getChildByName("txtinput"),
            this.btn_confirm = this.root.getChildByName("btn_confirm"),
            this.btn_cancel = this.root.getChildByName("btn_cancel"),
            this.me.visible = !1,
            this.btn_cancel.clickHandler = Laya.Handler.create(this, function() {
                e.hide(null)
            }, null, !1)
        }
        return e.prototype.show_share = function(e) {
            var i = this;
            this.title.text = game.Tools.strOfLocalization(2124),
            GameMgr.inConch ? (this.btn_confirm.visible = !0,
            this.btn_confirm.clickHandler = Laya.Handler.create(this, function() {
                Laya.PlatformClass.createClass("layaair.majsoul.mjmgr").call("setSysClipboardText", i.input.text),
                i.hide(null),
                t.UI_FlyTips.ShowTips(game.Tools.strOfLocalization(2125))
            }, null, !1)) : GameMgr.iniOSWebview ? (this.btn_confirm.visible = !0,
            this.btn_confirm.clickHandler = Laya.Handler.create(this, function() {
                Laya.Browser.window.wkbridge.callNative("copy2clip", i.input.text, function() {}),
                i.hide(null),
                t.UI_FlyTips.ShowTips(game.Tools.strOfLocalization(2125))
            }, null, !1)) : (this.btn_confirm.visible = !1,
            this.btn_confirm.clickHandler = Laya.Handler.create(this, function() {}, null, !1)),
            this.input.editable = !1;
            var n = game.Tools.encode_account_id(GameMgr.Inst.account_id);
            this.input.text = game.Tools.strOfLocalization(2126) + " : " + GameMgr.Inst.link_url + "?paipu=" + e + "_a" + n,
            this.me.visible = !0,
            this.locking = !0,
            this.btn_confirm.getChildAt(0).text = game.Tools.strOfLocalization(2127),
            t.UIBase.anim_pop_out(this.root, Laya.Handler.create(this, function() {
                i.locking = !1
            }))
        }
        ,
        e.prototype.show_check = function() {
            var e = this;
            this.title.text = game.Tools.strOfLocalization(2128),
            this.btn_confirm.visible = !0,
            this.btn_confirm.getChildAt(0).text = game.Tools.strOfLocalization(2129),
            this.btn_confirm.clickHandler = Laya.Handler.create(this, function() {
                e.hide(Laya.Handler.create(e, function() {
                    var t = e.input.text.split("=")
                      , i = t[t.length - 1].split("_")
                      , n = 0;
                    i.length > 1 && (n = "a" == i[1].charAt(0) ? game.Tools.decode_account_id(parseInt(i[1].substr(1))) : parseInt(i[1]));
                    var a = 0;
                    if (i.length > 2) {
                        var r = parseInt(i[2]);
                        r && (a = r)
                    }
                    GameMgr.Inst.checkPaiPu(i[0], n, a)
                }))
            }, null, !1),
            this.input.editable = !0,
            this.input.text = "",
            this.me.visible = !0,
            this.locking = !0,
            t.UIBase.anim_pop_out(this.root, Laya.Handler.create(this, function() {
                e.locking = !1
            }))
        }
        ,
        e.prototype.hide = function(e) {
            var i = this;
            this.locking = !0,
            t.UIBase.anim_pop_hide(this.root, Laya.Handler.create(this, function() {
                i.locking = !1,
                i.me.visible = !1,
                e && e.run()
            }))
        }
        ,
        e
    }()
      , a = function() {
        function t(t) {
            this.me = t
        }
        return t.prototype.onEnterRoom = function() {}
        ,
        t.prototype.show = function() {}
        ,
        t.prototype.close = function() {}
        ,
        t
    }()
      , r = function() {
        function e(e) {
            var i = this;
            this.match_id = -1,
            this.infos = [],
            this.show_index = [],
            this.me = e,
            this.scrollview = this.me.scriptMap["capsui.CScrollView"],
            this.scrollview.init_scrollview(new Laya.Handler(this,this.render_item));
            var n = this.me.getChildByName("only_system");
            this.only_system_flag = n.getChildByName("check"),
            n.clickHandler = new Laya.Handler(this,function() {
                i.only_system_flag.visible = !i.only_system_flag.visible,
                i.refresh_all_info()
            }
            ),
            this.txt_input = this.me.getChildByName("input").getChildByName("txtinput"),
            this.btn_send = this.me.getChildByName("send"),
            this.btn_send.clickHandler = Laya.Handler.create(this, function() {
                "" != i.txt_input.text && (game.Tools.setGrayDisable(i.btn_send, !0),
                Laya.timer.once(5e3, i, function() {
                    game.Tools.setGrayDisable(i.btn_send, !1)
                }),
                app.NetAgent.sendReq2Lobby("Lobby", "sayChatMessage", {
                    content: i.txt_input.text
                }, function(e, i) {
                    (e || i.error) && t.UIMgr.Inst.showNetReqError("sayChatMessage", e, i)
                }),
                i.txt_input.text = "")
            }, null, !1),
            this.txt_input.on(laya.events.Event.KEY_DOWN, this, function(e) {
                if (e.keyCode == Laya.Keyboard.ENTER) {
                    if (!i.btn_send.mouseEnabled)
                        return;
                    if ("" == i.txt_input.text)
                        return;
                    game.Tools.setGrayDisable(i.btn_send, !0),
                    Laya.timer.once(5e3, i, function() {
                        game.Tools.setGrayDisable(i.btn_send, !1)
                    }),
                    app.NetAgent.sendReq2Lobby("Lobby", "sayChatMessage", {
                        content: i.txt_input.text
                    }, function(e, i) {
                        (e || i.error) && t.UIMgr.Inst.showNetReqError("sayChatMessage", e, i)
                    }),
                    i.txt_input.text = ""
                }
            }),
            this.container_get_word_height = e.getChildByName("container_get_word_height"),
            this.test_height_div = new Laya.HTMLDivElement,
            this.container_get_word_height.addChild(this.test_height_div),
            this.test_height_div.pos(0, 0),
            this.test_height_div.width = this.container_get_word_height.width,
            this.test_height_div.style.lineHeight = 30,
            this.test_height_div.style.valign = "top",
            this.test_height_div.style.width = this.container_get_word_height.width,
            this.test_height_div.style.align = "left",
            app.NetAgent.AddListener2Lobby("NotifyCustomContestAccountMsg", Laya.Handler.create(this, function(t) {
                t.unique_id == i.match_id && i.addInfos(2, t)
            })),
            app.NetAgent.AddListener2Lobby("NotifyCustomContestSystemMsg", Laya.Handler.create(this, function(t) {
                t.unique_id == i.match_id && i.addInfos(1, t)
            })),
            this.scrollbar = this.me.getChildByName("scrollbar_light"),
            this.scrollpoint = this.scrollbar.getChildByName("scrollpoint"),
            this.scrollview.me.on("ratechange", this, function() {
                i.refresh_scrollbar()
            })
        }
        return e.prototype.on_enter_room = function() {
            var e = this;
            this.match_id = u.Inst.match_id,
            this.infos = [],
            this.show_index = [],
            this.scrollview.reset(),
            this.only_system_flag.visible = !1,
            this.txt_input.text = "",
            app.NetAgent.sendReq2Lobby("Lobby", "joinCustomizedContestChatRoom", {
                unique_id: this.match_id
            }, function(i, n) {
                if (i || n.error)
                    t.UIMgr.Inst.ShowErrorInfo(game.Tools.strOfLocalization(2130));
                else if (n.chat_history)
                    for (var a = n.chat_history.length - 1; a >= 0; a--) {
                        var r = n.chat_history[a]
                          , s = net.MessageWrapper.decodeMessage(r)
                          , o = s.$type.name;
                        "NotifyCustomContestSystemMsg" == o ? e.addInfos(1, s) : "NotifyCustomContestAccountMsg" == o && e.addInfos(2, s)
                    }
            })
        }
        ,
        e.prototype.on_leave_room = function() {
            this.match_id = -1,
            this.show_index = [],
            this.infos = [],
            this.scrollview.reset(),
            app.NetAgent.sendReq2Lobby("Lobby", "leaveCustomizedContestChatRoom", {}, function(t, e) {
                t || e.error
            })
        }
        ,
        e.prototype.addInfos = function(t, e) {
            this.infos.push({
                type: t,
                content: e,
                height: 0
            });
            var i = this.get_content_str(this.infos[this.infos.length - 1]);
            this.test_height_div.innerHTML = i;
            var n = this.scrollview.near_bottom
              , a = this.test_height_div.contextHeight + 10;
            this.infos[this.infos.length - 1].height = a,
            1 != t && 0 != this.only_system_flag.visible || (this.show_index.push(this.infos.length - 1),
            this.scrollview.addItem(1, a),
            n && (this.scrollview.rate = 1)),
            1 == t && (1 == e.type ? u.Inst.page_ob.setNeedFetch() : 2 == e.type && u.Inst.page_paipu.setNeedFetch())
        }
        ,
        e.prototype.refresh_all_info = function() {
            this.scrollview.reset(),
            this.show_index = [];
            for (var t = [], e = 0; e < this.infos.length; e++)
                1 != this.infos[e].type && 0 != this.only_system_flag.visible || (this.show_index.push(e),
                t.push(this.infos[e].height));
            this.scrollview.addItems(t),
            this.scrollview.rate = 1
        }
        ,
        e.prototype.get_content_str = function(t) {
            var e = "";
            if (1 == t.type) {
                if (e += "<span style='font:26px SimHei' color='#d4ac66'>",
                e += game.Tools.strOfLocalization(2131),
                1 == t.content.type) {
                    for (var i = t.content.game_start.players, n = 0; n < i.length; n++)
                        0 != n && (n == i.length - 1 ? e += game.Tools.strOfLocalization(2132) : e += "、"),
                        0 === i[n].account_id ? e += game.Tools.strOfLocalization(2133) : e += i[n].nickname;
                    e += game.Tools.strOfLocalization(2134)
                } else if (2 == t.content.type) {
                    e += game.Tools.strOfLocalization(2135);
                    for (var i = t.content.game_end.players, n = 0; n < i.length; n++)
                        0 != n && (e += ","),
                        e += "[" + (n + 1).toString() + "]",
                        0 === i[n].account_id ? e += game.Tools.strOfLocalization(2133) : e += i[n].nickname,
                        e += "(" + (i[n].total_point > 0 ? "+" : "") + i[n].total_point / 1e3 + game.Tools.strOfLocalization(2136) + ")"
                }
                e += "</span>"
            } else if (2 == t.type) {
                e += "<span style='font:26px SimHei' color='#8b8c98'>" + t.content.sender + ":</span>";
                var a = t.content.content;
                e += "<span style='font:26px SimHei' color='#70d6ed'>" + (a = game.Tools.strWithoutForbidden(a)) + "</span>"
            }
            return e
        }
        ,
        e.prototype.render_item = function(e) {
            var i = e.index
              , n = e.container
              , a = n.getChildByName("container_content").getChildByName("content");
            null == a && ((a = new Laya.HTMLDivElement).name = "content",
            n.getChildByName("container_content").addChild(a),
            a.pos(0, 0),
            a.width = this.test_height_div.width,
            a.style.lineHeight = this.test_height_div.style.lineHeight,
            a.style.valign = this.test_height_div.style.valign,
            a.style.width = a.width,
            a.style.align = this.test_height_div.style.align);
            var r = this.infos[this.show_index[i]];
            n.height = r.height,
            a.innerHTML = this.get_content_str(r);
            var s = n.getChildByName("btn_click");
            1 == r.type ? s.clickHandler = null : (s.clickHandler = Laya.Handler.create(this, function() {
                r.content.account_id && t.UI_OtherPlayerInfo.Inst.show(r.content.account_id)
            }, null, !1),
            s.width = n.width,
            s.height = n.height,
            s.pos(0, 0))
        }
        ,
        e.prototype.refresh_scrollbar = function() {
            if (this.scrollview.need_scroll) {
                var t = this.scrollview.rate;
                this.scrollpoint.height = this.scrollbar.height * this.scrollview.view_height / this.scrollview.total_height,
                this.scrollpoint.y = t * this.scrollbar.height * (1 - this.scrollview.view_height / this.scrollview.total_height),
                this.scrollbar.visible = !0
            } else
                this.scrollbar.visible = !1
        }
        ,
        e
    }()
      , s = function() {
        function t(t) {
            var e = this;
            this.tab_index = 0,
            this.me = t,
            this.chat = new r(t.getChildByName("chat")),
            this.btn_chat = t.getChildByName("btn_chat"),
            this.btn_chat.clickHandler = Laya.Handler.create(this, function() {
                1 != e.tab_index && e.change_tab(1)
            }, null, !1),
            this.btn_info = t.getChildByName("btn_info"),
            this.btn_info.clickHandler = Laya.Handler.create(this, function() {
                0 != e.tab_index && e.change_tab(0)
            }, null, !1),
            this.container_notice = t.getChildByName("notice"),
            this.panel = this.container_notice.getChildByName("panel"),
            this.panel.vScrollBarSkin = "",
            this.label_content = this.panel.getChildByName("content"),
            this.scrollbar = this.container_notice.getChildByName("scrollbar"),
            this.scrollpoint = this.scrollbar.getChildByName("scrollpoint"),
            this.panel.vScrollBar.on("change", this, function() {
                e.refresh_scrollbar()
            })
        }
        return t.prototype.on_enter_room = function() {
            this.chat.on_enter_room()
        }
        ,
        t.prototype.on_leave_room = function() {
            this.chat.on_leave_room()
        }
        ,
        t.prototype.set_notice = function(t) {
            this.label_content.text = game.Tools.strWithoutForbidden(t),
            this.label_content.height = this.label_content.textField.textHeight,
            this.panel.refresh(),
            this.scrollbar.visible = this.label_content.height > this.panel.height,
            this.panel.vScrollBar.value = 0,
            this.refresh_scrollbar()
        }
        ,
        t.prototype.refresh_scrollbar = function() {
            if (this.label_content.height > this.panel.height) {
                var t = this.panel.vScrollBar.value / this.panel.vScrollBar.max;
                this.scrollpoint.height = this.scrollbar.height * this.panel.height / this.label_content.height,
                this.scrollpoint.y = t * this.scrollbar.height * (1 - this.panel.height / this.label_content.height)
            }
        }
        ,
        t.prototype.change_tab = function(t) {
            this.tab_index = t,
            this.chat.me.visible = 1 == t,
            this.btn_chat.getChildByName("inchoose").visible = 1 == t,
            this.container_notice.visible = 0 == t,
            this.btn_info.getChildByName("inchoose").visible = 0 == t
        }
        ,
        t
    }()
      , o = function() {
        function e(e) {
            var i = this;
            this.player_count = 1,
            this.me = e,
            this.label_rank = e.getChildByName("rank"),
            this.label_my_near_point_word = e.getChildByName("my_near_point"),
            this.label_my_near_point_value = this.label_my_near_point_word.getChildByName("v"),
            this.label_my_near_rank_word = e.getChildByName("my_near_rank"),
            this.label_my_near_rank_value = this.label_my_near_rank_word.getChildByName("v"),
            this.label_my_match_count = e.getChildByName("my_match_count").getChildByName("v"),
            this.btn_start = e.getChildByName("btn_start"),
            this.label_btn = this.btn_start.getChildByName("label_name"),
            this.btn_start.clickHandler = Laya.Handler.create(this, function() {
                game.Tools.setGrayDisable(i.btn_start, !0),
                u.Inst.during_waiting_match ? app.NetAgent.sendReq2Lobby("Lobby", "stopCustomizedContest", {}, function(e, n) {
                    game.Tools.setGrayDisable(i.btn_start, !1),
                    e || n.error ? t.UIMgr.Inst.showNetReqError("stopCustomizedContest", e, n) : (u.Inst.during_waiting_match = !1,
                    i.refresh_start_btn())
                }) : app.NetAgent.sendReq2Lobby("Lobby", "startCustomizedContest", {
                    unique_id: u.Inst.match_id
                }, function(e, n) {
                    if (game.Tools.setGrayDisable(i.btn_start, !1),
                    e)
                        t.UIMgr.Inst.showNetReqError("startCustomizedContest", e, null);
                    else if (n.error) {
                        var a = n.error;
                        2511 == a.code || 2519 == a.code || 2518 == a.code ? u.Inst.showError(a) : t.UIMgr.Inst.showNetReqError("startCustomizedContest", "", n)
                    } else
                        u.Inst.during_waiting_match = !0,
                        i.refresh_start_btn()
                })
            }, null, !1),
            this.label_online = e.getChildByName("count_online"),
            app.NetAgent.AddListener2Lobby("NotifyCustomContestState", new Laya.Handler(this,function(t) {
                t.unique_id == u.Inst.match_id && (u.Inst.match_data.state = t.state,
                i.refresh_start_btn())
            }
            ))
        }
        return e.prototype.on_enter_room = function() {
            var t = this
              , e = u.Inst.match_data;
            u.Inst.player_report;
            this.me.getChildByName("starttime").getChildByName("date").text = game.Tools.time2YearMounthDate(e.start_time),
            this.me.getChildByName("starttime").getChildByName("time").text = game.Tools.time2HourMinute(e.start_time, !0),
            this.me.getChildByName("endtime").getChildByName("date").text = game.Tools.time2YearMounthDate(e.finish_time),
            this.me.getChildByName("endtime").getChildByName("time").text = game.Tools.time2HourMinute(e.finish_time, !0);
            var i = [];
            if (i.push(game.Tools.room_mode_desc(e.game_mode.mode)),
            e.game_mode.detail_rule) {
                var n = e.game_mode.detail_rule;
                0 === n.shiduan ? i.push(game.Tools.strOfLocalization(2137)) : i.push(game.Tools.strOfLocalization(2138));
                var a = null != n.time_fixed ? n.time_fixed : 5
                  , r = null != n.time_add ? n.time_add : 20;
                i.push(a.toString() + "+" + r.toString() + game.Tools.strOfLocalization(2019));
                switch (null != n.dora_count ? n.dora_count : 3) {
                case 0:
                    i.push(game.Tools.strOfLocalization(2044));
                    break;
                case 2:
                    i.push(game.Tools.strOfLocalization(2047));
                    break;
                case 3:
                    i.push(game.Tools.strOfLocalization(2045));
                    break;
                case 4:
                    i.push(game.Tools.strOfLocalization(2046))
                }
            } else
                i.push(game.Tools.strOfLocalization(2138)),
                i.push("5+20" + game.Tools.strOfLocalization(2019)),
                i.push(game.Tools.strOfLocalization(2045));
            for (var s = 0; s < 4; s++) {
                var o = this.me.getChildByName("rule" + s);
                s >= i.length ? o.visible = !1 : (o.visible = !0,
                o.getChildByName("label_name").text = i[s])
            }
            this.me.getChildByName("check_rule").clickHandler = new Laya.Handler(this,function() {
                u.Inst.show_rule()
            }
            ),
            this.refresh_my_rank(),
            this.refresh_start_btn(),
            this.player_count = 0,
            this.label_online.text = "1",
            this.nxt_refresh_count_time = 1,
            this.refresh_online(),
            Laya.timer.loop(3e3, this, function() {
                t.refresh_online()
            })
        }
        ,
        e.prototype.on_leave_room = function() {
            Laya.timer.clearAll(this)
        }
        ,
        e.prototype.refresh_my_rank = function() {
            var t = u.Inst.match_data
              , e = u.Inst.player_report
              , i = 0;
            if (t.rank_rule && (i = t.rank_rule),
            e) {
                this.label_rank.text = null == e.rank || 0 == e.rank ? "--" : e.rank.toString(),
                this.label_my_near_point_value.text = null == e.point ? "--" : (e.point / 1e3).toString();
                var n = ""
                  , a = !1;
                if (e.recent_game_ranks)
                    for (r = 0; r < 5; r++)
                        "" != n && (n += "/"),
                        r < e.recent_game_ranks.length ? (n += e.recent_game_ranks[r].toString(),
                        a = !0) : n += "-";
                else
                    for (r = 0; r < 5; r++)
                        "" != n && (n += "/"),
                        n += "-";
                a ? this.label_my_match_count.text = e.total_game_count.toString() : (this.label_my_near_point_value.text = "--",
                this.label_my_match_count.text = "--"),
                this.label_my_near_rank_value.text = n
            } else {
                this.label_rank.text = "--",
                this.label_my_near_point_value.text = "--",
                this.label_my_match_count.text = "--";
                for (var n = "", r = 0; r < 5; r++)
                    "" != n && (n += "/"),
                    n += "-";
                this.label_my_near_rank_value.text = n
            }
            this.label_my_near_point_word.visible = !0,
            this.label_my_near_rank_word.visible = !0,
            2 == i ? this.label_my_near_point_word.text = game.Tools.strOfLocalization(2139, ["5"]) : 1 == i ? this.label_my_near_point_word.text = game.Tools.strOfLocalization(2139, ["3"]) : 0 == i && (this.label_my_near_point_word.text = game.Tools.strOfLocalization(2139, ["-"]))
        }
        ,
        e.prototype.refresh_online = function() {
            var t = this
              , e = this.player_count;
            e <= 0 ? this.label_online.text = "--" : (e > 50 && e < 100 ? e += Math.floor(10 * Math.random() - 5) : e >= 100 && (e = Math.floor(e * (.12 * Math.random() + .94) + 7 * Math.random() - 3)),
            this.label_online.text = e.toString()),
            Laya.timer.currTimer >= this.nxt_refresh_count_time && (app.NetAgent.sendReq2Lobby("Lobby", "fetchCustomizedContestOnlineInfo", {
                unique_id: u.Inst.match_id
            }, function(e, i) {
                e || i.error ? t.player_count = 1 : t.player_count = i.online_player
            }),
            this.player_count < 100 ? this.nxt_refresh_count_time = Laya.timer.currTimer + 5e3 : this.player_count < 500 ? this.nxt_refresh_count_time = Laya.timer.currTimer + 24e3 * (this.player_count - 100) / 400 : this.nxt_refresh_count_time = Laya.timer.currTimer + 29e3)
        }
        ,
        e.prototype.refresh_start_btn = function() {
            var t = u.Inst.match_data;
            1 == t.state ? (game.Tools.setGrayDisable(this.btn_start, !0),
            this.label_btn.text = game.Tools.strOfLocalization(2140),
            this.btn_start.skin = game.Tools.localUISrc("myres/match_lobby/match_btn2.png")) : 2 == t.state ? (game.Tools.setGrayDisable(this.btn_start, !1),
            u.Inst.during_waiting_match ? (this.label_btn.text = game.Tools.strOfLocalization(2141),
            this.btn_start.skin = game.Tools.localUISrc("myres/match_lobby/match_btn3.png")) : (this.label_btn.text = game.Tools.strOfLocalization(2142),
            this.btn_start.skin = game.Tools.localUISrc("myres/match_lobby/match_btn2.png"))) : 3 == t.state && (game.Tools.setGrayDisable(this.btn_start, !0),
            this.label_btn.text = game.Tools.strOfLocalization(2143),
            this.btn_start.skin = game.Tools.localUISrc("myres/match_lobby/match_btn2.png"))
        }
        ,
        e
    }()
      , l = function(e) {
        function i(i) {
            var n = e.call(this, i) || this;
            return n.label_name = i.getChildByName("name"),
            n.check_follow = i.getChildByName("check_follow"),
            n.label_follow = n.check_follow.getChildByName("word"),
            n.check_flag = n.check_follow.getChildByName("check"),
            n.check_follow.clickHandler = Laya.Handler.create(n, function() {
                u.Inst.follow = !u.Inst.follow,
                n.check_flag.visible = u.Inst.follow,
                n.label_follow.text = game.Tools.strOfLocalization(n.check_flag.visible ? 2144 : 2145),
                t.UI_Match_Lobby.Inst.change_match_follow(u.Inst.match_id, u.Inst.follow);
                var e = n.check_flag.visible ? "followCustomizedContest" : "unfollowCustomizedContest";
                app.NetAgent.sendReq2Lobby("Lobby", e, {
                    unique_id: u.Inst.match_id
                }, function() {})
            }, null, !1),
            n.container_left = new s(i.getChildByName("container_left")),
            n.container_right = new o(i.getChildByName("container_right")),
            n
        }
        return __extends(i, e),
        i.prototype.onEnterRoom = function() {
            var t = u.Inst.match_data;
            u.Inst.player_report;
            this.label_name.text = game.Tools.strWithoutForbidden(t.contest_name),
            this.container_left.set_notice(t.private_notice),
            this.container_left.change_tab(0),
            this.container_left.on_enter_room(),
            this.container_right.on_enter_room(),
            this.check_flag.visible = u.Inst.follow,
            this.label_follow.text = game.Tools.strOfLocalization(this.check_flag.visible ? 2144 : 2145)
        }
        ,
        i.prototype.on_leave_room = function() {
            this.container_left.on_leave_room(),
            this.container_right.on_leave_room()
        }
        ,
        i.prototype.show = function() {
            this.me.visible = !0
        }
        ,
        i.prototype.close = function() {
            this.me.visible = !1
        }
        ,
        i
    }(a)
      , h = function(e) {
        function i(t) {
            var i = e.call(this, t) || this;
            return i.next_index = -1,
            i.record_list = [],
            i.last_fetch_time = -1e8,
            i.nolimitlst = t.scriptMap["capsui.NoLimitList"],
            i.nolimitlst.init_nolimitlist(Laya.Handler.create(i, i.load_next, null, !1), Laya.Handler.create(i, i.render_item, null, !1)),
            i.me.getChildByName("checkother").clickHandler = Laya.Handler.create(i, function() {
                u.Inst.pop_check_paipu.show_check()
            }, null, !1),
            i
        }
        return __extends(i, e),
        i.prototype.onEnterRoom = function() {
            this.last_fetch_time = -1e8,
            this.match_id = u.Inst.match_id,
            this.record_list = [],
            this.next_index = -1
        }
        ,
        i.prototype.show = function() {
            this.me.visible = !0,
            Laya.timer.currTimer > this.last_fetch_time + 6e4 && (this.next_index = -1,
            this.record_list = [],
            this.nolimitlst.reset(),
            this.nolimitlst.total_count = 1,
            this.last_fetch_time = Laya.timer.currTimer)
        }
        ,
        i.prototype.close = function() {
            this.me.visible = !1
        }
        ,
        i.prototype.setNeedFetch = function() {
            this.last_fetch_time = -1e8
        }
        ,
        i.prototype.load_next = function() {
            var e = this
              , i = {
                unique_id: this.match_id
            };
            this.next_index >= 0 && (i.last_index = this.next_index),
            app.NetAgent.sendReq2Lobby("Lobby", "fetchCustomizedContestGameRecords", i, function(i, n) {
                if (i || n.error)
                    t.UIMgr.Inst.showNetReqError("fetchCustomizedContestGameRecords", i, n),
                    e.nolimitlst.loadOver(!1, 0);
                else {
                    var a = 0;
                    if (n.record_list) {
                        a = n.record_list.length;
                        for (var r = 0; r < a; r++)
                            e.record_list.push(n.record_list[r])
                    }
                    null != n.next_index && n.next_index >= 0 ? (e.next_index = n.next_index,
                    a > 0 ? (e.nolimitlst.total_count = e.record_list.length + 1,
                    e.nolimitlst.loadOver(!0, a)) : (e.nolimitlst.total_count = e.record_list.length,
                    e.nolimitlst.loadOver(!0, a))) : (e.nolimitlst.total_count = e.record_list.length,
                    e.nolimitlst.loadOver(!0, a))
                }
            })
        }
        ,
        i.prototype.render_item = function(e) {
            for (var i = this, n = e.index, a = e.container, r = this.record_list[n], s = 0; s < 4; s++) {
                var o = a.getChildByName("p" + s.toString())
                  , l = o.getChildByName("chosen")
                  , h = o.getChildByName("rank")
                  , c = o.getChildByName("rank_word")
                  , _ = o.getChildByName("name")
                  , d = o.getChildByName("score")
                  , f = r.result.players[s];
                d.text = f.part_point_1;
                for (var p = game.Tools.strOfLocalization(2133), m = !1, g = 0; g < r.accounts.length; g++)
                    if (r.accounts[g].seat == f.seat) {
                        p = r.accounts[g].nickname,
                        m = r.accounts[g].account_id == GameMgr.Inst.account_id;
                        break
                    }
                _.text = p,
                l.visible = m,
                d.color = m ? "#ffc458" : "#b98930",
                _.color = m ? "#dfdfdf" : "#a0a0a0",
                c.color = h.color = m ? "#57bbdf" : "#489dbc";
                var y = o.getChildByName("rank_word");
                if ("en" == GameMgr.client_language)
                    switch (y.y = 51,
                    s) {
                    case 0:
                        y.text = "st";
                        break;
                    case 1:
                        y.text = "nd";
                        break;
                    case 2:
                        y.text = "rd";
                        break;
                    case 3:
                        y.text = "th"
                    }
                else
                    y.y = 46
            }
            var v = new Date(1e3 * r.end_time)
              , b = "";
            b += v.getFullYear() + "/",
            b += (v.getMonth() < 9 ? "0" : "") + (v.getMonth() + 1).toString() + "/",
            b += (v.getDate() < 10 ? "0" : "") + v.getDate() + " ",
            b += (v.getHours() < 10 ? "0" : "") + v.getHours() + ":",
            b += (v.getMinutes() < 10 ? "0" : "") + v.getMinutes(),
            a.getChildByName("date").text = b,
            a.getChildByName("check").clickHandler = Laya.Handler.create(this, function() {
                i.locking || (u.Inst.during_waiting_match ? t.UIMgr.Inst.ShowErrorInfo(game.Tools.strOfLocalization(2146)) : GameMgr.Inst.checkPaiPu(i.record_list[n].uuid, 0, 0))
            }, null, !1),
            a.getChildByName("share").clickHandler = Laya.Handler.create(this, function() {
                i.locking || u.Inst.pop_check_paipu.show_share(i.record_list[n].uuid)
            }, null, !1);
            var x = a.getChildByName("room")
              , w = game.Tools.get_room_desc(r.config);
            x.text = w.text
        }
        ,
        i
    }(a)
      , c = function(e) {
        function i(t) {
            var i = e.call(this, t) || this;
            return i.live_datas = [],
            i.last_fetch_time = -1e6,
            i.scrollview = i.me.getChildByName("scrollview").scriptMap["capsui.CScrollView"],
            i.scrollview.init_scrollview(Laya.Handler.create(i, i.render_scrollview, null, !1)),
            i
        }
        return __extends(i, e),
        i.prototype.onEnterRoom = function() {
            var t = u.Inst.match_data;
            this.match_id = t.unique_id,
            this.match_name = t.contest_name,
            this.last_fetch_time = -1e6
        }
        ,
        i.prototype.show = function() {
            var e = this;
            this.me.visible = !0,
            Laya.timer.currTimer > this.last_fetch_time + 1e4 && (this.scrollview.reset(),
            this.live_datas = [],
            app.NetAgent.sendReq2Lobby("Lobby", "fetchCustomizedContestGameLiveList", {
                unique_id: this.match_id
            }, function(i, n) {
                if (i || n.error)
                    t.UIMgr.Inst.showNetReqError("fetchCustomizedContestGameLiveList", i, n);
                else {
                    if (n.live_list)
                        for (var a = 0; a < n.live_list.length; a++)
                            e.live_datas.push(n.live_list[a]);
                    e.scrollview.addItem(e.live_datas.length),
                    e.last_fetch_time = Laya.timer.currTimer
                }
            }))
        }
        ,
        i.prototype.close = function() {
            this.me.visible = !1
        }
        ,
        i.prototype.setNeedFetch = function() {
            this.last_fetch_time = -1e6
        }
        ,
        i.prototype.render_scrollview = function(e) {
            var i = this
              , n = e.index
              , a = e.container
              , r = e.cache_data
              , s = this.live_datas[n];
            a.getChildByName("name").text = this.match_name;
            var o = new Date(1e3 * s.start_time)
              , l = o.getHours() + ":";
            o.getMinutes() < 10 && (l += "0"),
            l += o.getMinutes().toString(),
            a.getChildByName("time").text = l;
            for (var h = 0; h < 4; h++) {
                var c = "p" + h
                  , _ = a.getChildByName(c);
                if (!r[c]) {
                    var d = {};
                    d.level = new t.UI_Level(_.getChildByName("rank")),
                    d.title = new t.UI_PlayerTitle(_.getChildByName("title")),
                    d.name = _.getChildByName("name"),
                    r[c] = d
                }
                if (h < s.players.length) {
                    var f = s.players[h];
                    r[c].level.id = f.level.id,
                    r[c].title.id = game.Tools.titleLocalization(f.account_id, f.title),
                    r[c].name.text = f.nickname
                } else
                    r[c].level.id = 10101,
                    r[c].title.id = 0,
                    r[c].name.text = game.Tools.strOfLocalization(2133)
            }
            a.getChildByName("btn").clickHandler = Laya.Handler.create(this, function() {
                u.Inst.during_waiting_match ? t.UIMgr.Inst.ShowErrorInfo(game.Tools.strOfLocalization(2147)) : t.UI_Live_Broadcast.fetchInfo(s.uuid, Laya.Handler.create(i, function(e) {
                    e.success && t.UI_Live_Broadcast.goToWatch(s.uuid, e.data, s.players[0].account_id)
                }))
            }, null, !1)
        }
        ,
        i
    }(a)
      , u = function(a) {
        function r() {
            var t = a.call(this, new ui.lobby.match_roomUI) || this;
            return t.tabs = [],
            t.locking = !1,
            t.match_data = null,
            t.player_report = null,
            t.tab_index = -1,
            t.during_waiting_match = !1,
            r.Inst = t,
            game.LobbyNetMgr.Inst.add_connect_listener(new Laya.Handler(t,function(e) {
                t.enable && "reconnect_success" == e && t.refresh_data()
            }
            )),
            t
        }
        return __extends(r, a),
        r.prototype.onCreate = function() {
            var a = this;
            this.container_top = this.me.getChildByName("top"),
            this.label_match_id = this.container_top.getChildByName("id"),
            this.container_top.getChildByName("btn_back").clickHandler = Laya.Handler.create(this, function() {
                a.locking || (a.during_waiting_match ? app.NetAgent.sendReq2Lobby("Lobby", "stopCustomizedContest", {}, function(e, i) {
                    e || i.error ? t.UIMgr.Inst.showNetReqError("stopCustomizedContest", e, i) : (r.Inst.during_waiting_match = !1,
                    a.page_main.container_right.refresh_start_btn(),
                    a.close())
                }) : a.close())
            }, null, !1),
            this.container_main = this.me.getChildByName("main"),
            this.tabs = [];
            for (var s = function(t) {
                o.tabs.push(o.container_main.getChildByName("tabs").getChildAt(t)),
                o.tabs[t].clickHandler = Laya.Handler.create(o, function() {
                    a.locking || a.tab_index != t && null != a.match_data && a.change_tab(t)
                }, null, !1)
            }, o = this, u = 0; u < 3; u++)
                s(u);
            this.page_main = new l(this.container_main.getChildByName("page_main")),
            this.page_paipu = new h(this.container_main.getChildByName("page_paipu")),
            this.page_ob = new c(this.container_main.getChildByName("page_ob")),
            this.pop_rule = new e(this.me.getChildByName("pop_rule")),
            this.pop_check_paipu = new n(this.me.getChildByName("pop_check_paipu")),
            this.pop_no_access = new i(this.me.getChildByName("pop_no_access")),
            app.NetAgent.AddListener2Lobby("NotifyRoomGameStart", Laya.Handler.create(this, function(t) {
                a.enable && (app.Log.log("NotifyRoomGameStart:" + JSON.stringify(t)),
                a.onGameStart(t))
            }))
        }
        ,
        r.prototype.show = function(t) {
            this.match_id = t,
            GameMgr.Inst.custom_match_id = this.match_id,
            this.refresh_data()
        }
        ,
        r.prototype.refresh_data = function() {
            var e = this;
            this.page_main.me.visible = !1,
            this.page_paipu.me.visible = !1,
            this.page_ob.me.visible = !1,
            app.NetAgent.sendReq2Lobby("Lobby", "enterCustomizedContest", {
                unique_id: this.match_id
            }, function(i, n) {
                i || n.error ? t.UIMgr.Inst.showNetReqError("enterCustomizedContest", i, n) : (app.Log.log(JSON.stringify(n)),
                e.match_data = n.detail_info,
                e.player_report = n.player_report,
                e.label_match_id.text = "ID:" + e.match_data.contest_id,
                e.follow = n.is_followed,
                e.page_main.onEnterRoom(),
                e.page_ob.onEnterRoom(),
                e.page_paipu.onEnterRoom(),
                e.change_tab(0))
            }),
            this.change_tab(-1),
            this.pop_check_paipu.me.visible = !1,
            this.pop_no_access.me.visible = !1,
            this.pop_rule.me.visible = !1,
            this.enable = !0,
            this.locking = !0,
            t.UIBase.anim_alpha_in(this.container_top, {
                y: -30
            }, 200),
            t.UIBase.anim_alpha_in(this.container_main, {
                y: 30
            }, 200),
            this.label_match_id.text = "ID:--",
            Laya.timer.once(200, this, function() {
                e.locking = !1
            })
        }
        ,
        r.prototype.close = function() {
            var e = this;
            this.match_data = null,
            this.match_id = -1,
            GameMgr.Inst.custom_match_id = -1,
            this.locking = !0,
            t.UIBase.anim_alpha_out(this.container_top, {
                y: -30
            }, 200),
            t.UIBase.anim_alpha_out(this.container_main, {
                y: 30
            }, 200),
            Laya.timer.once(200, this, function() {
                e.enable = !1,
                e.locking = !1,
                e.change_tab(-1),
                t.UI_Match_Lobby.Inst.show()
            }),
            app.NetAgent.sendReq2Lobby("Lobby", "leaveCustomizedContest", {}, function() {}),
            this.page_main.on_leave_room()
        }
        ,
        r.prototype.change_tab = function(t) {
            switch (this.tab_index) {
            case 0:
                this.page_main.close();
                break;
            case 1:
                this.page_paipu.close();
                break;
            case 2:
                this.page_ob.close()
            }
            switch (this.tab_index = t,
            this.tab_index) {
            case 0:
                this.page_main.show();
                break;
            case 1:
                this.page_paipu.show();
                break;
            case 2:
                this.page_ob.show()
            }
            for (var e = 0; e < this.tabs.length; e++)
                this.tabs[e].skin = game.Tools.localUISrc(t == e ? "myres/shop/tab_choose.png" : "myres/shop/tab_unchoose.png"),
                this.tabs[e].getChildAt(0).color = t == e ? "#d9b263" : "#8cb65f"
        }
        ,
        r.prototype.show_rule = function() {
            this.pop_rule.show(this.match_data.game_mode)
        }
        ,
        r.prototype.onGameStart = function(e) {
            this.match_data = null,
            this.enable = !1,
            this.during_waiting_match = !1,
            this.page_main.on_leave_room(),
            t.UI_Lobby.Inst.enable = !1,
            t.UI_Match_Lobby.Inst.clear_data(),
            game.MJNetMgr.Inst.OpenConnect(e.connect_token, e.game_uuid, e.location, !1, null)
        }
        ,
        r.prototype.showError = function(t) {
            this.pop_no_access.show(t)
        }
        ,
        r
    }(t.UIBase);
    t.UI_Match_Room = u
}(uiscript || (uiscript = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), uiscript;
!function(t) {
    var e;
    !function() {
        function t(t) {
            this.cd = 300,
            this.pre_t = 0,
            this.items = [],
            this.me = t,
            this.templete = t.getChildByName("templete"),
            this.templete.visible = !1
        }
        t.prototype.reset = function() {
            Laya.timer.clearAll(this);
            for (var t = 0; t < this.items.length; t++)
                this.items[t].destroy(!0);
            this.items = [],
            this.pre_t = 0
        }
        ,
        t.prototype.fly = function(t) {
            var e = this
              , i = this.templete.scriptMap["capsui.UICopy"].getNodeClone()
              , n = i.getChildByName("icon")
              , a = i.getChildByName("count")
              , r = t.getChildByName("icon")
              , s = t.getChildByName("count");
            n.skin = game.Tools.localUISrc(r.skin),
            a.text = s.text,
            n.x = r.x,
            a.x = s.x,
            this.items.push(i);
            var o = this.pre_t + this.cd - Laya.timer.currTimer;
            o < 120 && (o = 120),
            i.visible = !1;
            var l = t.parent.localToGlobal(new Laya.Point(t.x,t.y));
            Laya.timer.once(o, this, function() {
                i.visible = !0,
                i.x = l.x,
                i.y = l.y,
                i.alpha = 10;
                var t = Laya.timer.currTimer
                  , n = e;
                Laya.timer.frameLoop(1, i, function() {
                    var e = Laya.timer.currTimer - t;
                    if (e >= 600) {
                        for (var a = 0; a < n.items.length; a++)
                            if (n.items[a] === i) {
                                for (var r = a; r < n.items.length - 1; r++)
                                    n.items[r] = n.items[r + 1];
                                break
                            }
                        i.destroy(!0),
                        Laya.timer.clearAll(i)
                    } else {
                        var s = e / 600;
                        i.y = l.y - 50 * s,
                        i.alpha = s < .7 ? 1 : (1 - s) / .3
                    }
                })
            }),
            this.pre_t = o + Laya.timer.currTimer
        }
    }();
    !function(t) {
        t[t.none = 0] = "none",
        t[t.small = 1] = "small",
        t[t.big = 2] = "big",
        t[t.passed = 3] = "passed"
    }(e || (e = {}));
    var i = function(i) {
        function n() {
            var e = i.call(this, new ui.lobby.match_shilianUI) || this;
            return e.container_top = null,
            e.money = null,
            e.root = null,
            e.container_step = null,
            e.steps = [],
            e.container_down = null,
            e.btn_start = null,
            e.btn_getreward = null,
            e.btn_rule = null,
            e.btn_quit = null,
            e.container_tips = null,
            e.rand_tips = [],
            e.container_result = null,
            e.shine = null,
            e._gray_filter = null,
            e.locking = !1,
            e.reward_fly = null,
            e._inmatch = !1,
            e._step_index = 0,
            e._can_reward = !1,
            e._fail = !1,
            e._gray_filter = new Laya.ColorFilter(t.GRAY_FILTER),
            n.Inst = e,
            e
        }
        return __extends(n, i),
        n.prototype.onCreate = function() {}
        ,
        n.prototype.setStepState = function(t, i) {
            var n = this.steps[t];
            i == e.none ? (n.root.scaleX = n.root.scaleY = 1,
            n.passed.visible = !1,
            n.container_info.y = 98,
            n.qidian.visible = !1,
            n.fandian.visible = !1,
            n.contianer_reward.visible = !0,
            n.contianer_reward.alpha = 1,
            n.star.visible = !1,
            n.container_main.filters = []) : i == e.big ? (n.root.scaleX = n.root.scaleY = 1.1,
            n.passed.visible = !1,
            n.container_info.y = 144,
            n.qidian.visible = !0,
            n.qidian.alpha = 1,
            n.fandian.visible = !0,
            n.qidian.alpha = 1,
            n.contianer_reward.visible = !0,
            n.contianer_reward.alpha = 1,
            n.star.visible = !1,
            n.container_main.filters = []) : i == e.small ? (n.root.scaleX = n.root.scaleY = .85,
            n.passed.visible = !1,
            n.container_info.y = 98,
            n.qidian.visible = !1,
            n.fandian.visible = !1,
            n.contianer_reward.visible = !1,
            n.star.visible = !0,
            n.star.alpha = 1,
            n.container_main.filters = []) : i == e.passed && (n.root.scaleX = n.root.scaleY = .85,
            n.passed.visible = !0,
            n.container_info.y = 98,
            n.qidian.visible = !1,
            n.fandian.visible = !1,
            n.contianer_reward.visible = !1,
            n.star.visible = !0,
            n.star.alpha = 1,
            n.container_main.filters = [this._gray_filter])
        }
        ,
        n.prototype.show_backin = function(t, i, n) {
            var a = this;
            this.enable = !0,
            this.locking = !0,
            this._inmatch = !0,
            this._fail = n,
            this._can_reward = i,
            this._step_index = t;
            for (var r = 0; r < this.steps.length; r++)
                r < t ? this.setStepState(r, e.passed) : r == t ? this.setStepState(r, e.big) : this.setStepState(r, e.small);
            this._show_init(),
            n ? (this.btn_start.visible = !1,
            this.btn_quit.visible = !1,
            this.btn_getreward.visible = !1,
            this.shine.visible = !1,
            this.btn_rule.visible = !0,
            Laya.timer.once(500, this, function() {
                a.locking = !1,
                a.showResult(!1)
            })) : (this.btn_start.visible = !i,
            this.btn_getreward.visible = i,
            this.btn_quit.visible = !0,
            this.container_result.visible = n,
            this.shine.visible = !1,
            this.btn_rule.visible = !0,
            Laya.timer.once(500, this, function() {
                a.locking = !1
            }))
        }
        ,
        n.prototype.show_newin = function(i, n, a, r) {
            var s = this;
            this.locking = !0,
            this.enable = !0,
            this._inmatch = i,
            this._step_index = n,
            this._can_reward = a,
            this._fail = r;
            for (var o = 0; o < this.steps.length; o++) {
                i ? o < n ? this.setStepState(o, e.passed) : o == n ? this.setStepState(o, e.big) : this.setStepState(o, e.small) : this.setStepState(o, e.none);
                var l = this.steps[o];
                l.root.alpha = 0,
                t.UIBase.anim_alpha_in(l.root, {
                    y: 150
                }, 200, 60 * o, null, Laya.Ease.strongOut)
            }
            this.btn_start.visible = i && !a,
            this.btn_quit.visible = i,
            this.btn_getreward.visible = i && a,
            this.container_result.visible = !1,
            this.btn_rule.visible = !0,
            this.shine.visible = !1,
            this._show_init(),
            this.container_top.alpha = 1,
            this.root.alpha = 1,
            this.container_down.alpha = 1,
            t.UIBase.anim_alpha_in(this.container_top, {
                y: -30
            }, 200),
            t.UIBase.anim_alpha_in(this.container_down, {
                y: 30
            }, 200),
            Laya.timer.once(800, this, function() {
                s.locking = !1,
                i || (i = !0,
                s.matchStart())
            })
        }
        ,
        n.prototype.matchStart = function() {
            this._inmatch = !0,
            this.btn_start.visible = !0,
            this.btn_start.alpha = 0,
            Laya.Tween.to(this.btn_start, {
                alpha: 1
            }, 200),
            this._step_index = 0,
            this._can_reward = !1,
            this.btn_quit.visible = !0,
            this.btn_quit.alpha = 0,
            Laya.Tween.to(this.btn_quit, {
                alpha: 1
            }, 200),
            this.steps[0].anim_small2big.play(0, !1);
            for (var t = 1; t < this.steps.length; t++)
                this.steps[t].anim_middle2small.play(0, !1)
        }
        ,
        n.prototype._show_init = function() {
            for (var t = this, e = 0, i = 0; i < this.rand_tips.length; i++)
                this.rand_tips[i].visible = i == e;
            Laya.timer.loop(8e3, this, function() {
                ++e >= t.rand_tips.length && (e = 0);
                for (var i = 0; i < t.rand_tips.length; i++)
                    t.rand_tips[i].visible = i == e
            }),
            this.money.onEnable()
        }
        ,
        n.prototype.close = function(e) {
            var i = this;
            this.locking = !0,
            this.reward_fly.reset(),
            t.UIBase.anim_alpha_out(this.container_top, {
                y: -30
            }, 200),
            t.UIBase.anim_alpha_out(this.root, {
                y: 100
            }, 200),
            Laya.timer.once(300, this, function() {
                Laya.timer.clearAll(i),
                i.enable = !1,
                i.locking = !1,
                e && e.run()
            })
        }
        ,
        n.prototype.showResult = function(e) {
            var i = this;
            this.container_result.visible = !0;
            (e ? this.me.success_in : this.me.fail_in).play(0, !1),
            this.container_result.getChildByName("success").visible = e,
            this.container_result.getChildByName("fail").visible = !e,
            this.container_result.getChildByName("btn").clickHandler = Laya.Handler.create(this, function() {
                var n = e ? i.me.success_out : i.me.fail_out;
                i.locking = !0,
                n.play(0, !1),
                Laya.timer.once(300, i, function() {
                    i.close(Laya.Handler.create(i, function() {
                        t.UI_Lobby.Inst.enable = !0
                    }))
                })
            }, null, !1)
        }
        ,
        n.prototype.getRewardSuccess = function(t) {
            var e = this
              , i = this.steps[t];
            this.locking = !0;
            for (var n = 0; n < i.rewards.length; n++)
                this.reward_fly.fly(i.rewards[n]);
            t + 1 < this.steps.length ? (this._step_index = t + 1,
            this._can_reward = !1,
            i.anim_big2small.play(0, !1),
            Laya.timer.once(500, this, function() {
                i.container_main.filters = [e._gray_filter]
            }),
            Laya.timer.once(700, this, function() {
                e.steps[t + 1].anim_small2big.play(0, !1),
                Laya.timer.once(500, e, function() {
                    e.locking = !1,
                    e.btn_start.visible = !0,
                    e.btn_start.alpha = 0,
                    Laya.Tween.to(e.btn_start, {
                        alpha: 1
                    }, 150)
                })
            })) : (this._can_reward = !1,
            Laya.timer.once(300 * i.rewards.length + 200, this, function() {
                e.showResult(!0)
            }))
        }
        ,
        n.Inst = null,
        n
    }(t.UIBase);
    t.UI_Match_Shilian = i
}(uiscript || (uiscript = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), uiscript;
!function(t) {
    var e = function() {
        function t(t) {
            this.me = t,
            this.title = t.getChildByName("title"),
            this.bar_v = t.getChildByName("bar").getChildByName("v").mask,
            this.label_add = t.getChildByName("bar").getChildByName("num"),
            this.icon = t.getChildByName("icon")
        }
        return t.prototype.show = function() {
            var t = view.DesktopMgr.Inst.rewardinfo.match_chest
              , e = cfg.desktop.chest.get(t.chest_id);
            this.bar_v.width = 384 * t.origin / e.exp_step,
            this.label_add.text = "",
            this.title.text = e["name_" + GameMgr.client_language],
            game.LoadMgr.setImgSkin(this.icon, e.icon),
            this.me.visible = !0
        }
        ,
        t.prototype.doanim = function(t) {
            var e = this
              , i = view.DesktopMgr.Inst.rewardinfo.match_chest
              , n = cfg.desktop.chest.get(i.chest_id)
              , a = i.final - i.origin + (i.is_graded ? n.exp_step : 0);
            this.label_add.text = "+" + a.toString(),
            this.label_add.scaleX = this.label_add.scaleY = 0,
            Laya.Tween.to(this.label_add, {
                scaleX: 1,
                scaleY: 1
            }, 200, Laya.Ease.backOut);
            var r = i.is_graded ? 1 : i.final / n.exp_step;
            Laya.timer.once(500, this, function() {
                var a = (r - i.origin / n.exp_step) / .001;
                Laya.Tween.to(e.bar_v, {
                    width: 384 * r
                }, a),
                Laya.timer.once(a + 500, e, function() {
                    i.is_graded ? game.Tools.showRewards(i, Laya.Handler.create(e, function() {
                        e.bar_v.width = 0;
                        var a = i.final / n.exp_step
                          , r = a / .001;
                        Laya.Tween.to(e.bar_v, {
                            width: 384 * a
                        }, r),
                        Laya.timer.once(r + 200, e, function() {
                            t.run()
                        })
                    })) : t.run()
                })
            })
        }
        ,
        t.prototype.close = function() {
            this.me.visible = !1,
            game.LoadMgr.clearImgSkin(this.icon)
        }
        ,
        t
    }()
      , i = function() {
        function e(e) {
            this.me = e,
            this.title = e.getChildByName("title"),
            this.bar_v = e.getChildByName("bar").getChildByName("v").mask,
            this.label_add = e.getChildByName("bar").getChildByName("num"),
            this.icon = e.getChildByName("icon"),
            this.container_gift = e.getChildByName("gift"),
            this.container_gift.visible = !1,
            this.container_item = this.container_gift.getChildByName("item"),
            this.icon_gift = this.container_item.getChildByName("icon"),
            this.gift_num = this.container_gift.getChildByName("num"),
            this.container_item.getChildByName("btn").clickHandler = new Laya.Handler(this,function() {
                t.UI_ItemDetail.Inst.show(cfg.desktop.settings.account_friendship_bar_reward_id.int_value)
            }
            )
        }
        return e.prototype.show = function() {
            var t = view.DesktopMgr.Inst.rewardinfo.character_gift;
            this.bar_v.width = 384 * t.origin / cfg.desktop.settings.account_friendship_bar_length.int_value,
            this.label_add.text = "";
            var e = cfg.desktop.settings.account_friendship_bar_reward_id.int_value
              , i = cfg.item_definition.item.find(e);
            game.LoadMgr.setImgSkin(this.icon, i.icon_transparent),
            game.LoadMgr.setImgSkin(this.icon_gift, i.icon),
            this.container_gift.visible = !1,
            this.me.visible = !0
        }
        ,
        e.prototype.doanim = function(e) {
            var i = this
              , n = view.DesktopMgr.Inst.rewardinfo.character_gift;
            this.label_add.text = "+" + n.add,
            this.label_add.scaleX = this.label_add.scaleY = 0,
            Laya.Tween.to(this.label_add, {
                scaleX: 1,
                scaleY: 1
            }, 200, Laya.Ease.backOut);
            var a = cfg.desktop.settings.account_friendship_bar_length.int_value
              , r = n.is_graded ? 1 : n.final / a;
            Laya.timer.once(500, this, function() {
                var s = (r - n.origin / a) / .001;
                Laya.Tween.to(i.bar_v, {
                    width: 384 * r
                }, s),
                Laya.timer.once(s + 500, i, function() {
                    n.is_graded ? (i.container_gift.x = i.icon.x,
                    i.container_gift.y = i.icon.y,
                    i.container_gift.alpha = 1,
                    i.container_gift.visible = !0,
                    i.container_item.scaleX = 1,
                    i.container_item.scaleY = 1,
                    i.container_item.alpha = 0,
                    i.gift_num.alpha = 0,
                    Laya.Tween.to(i.container_item, {
                        alpha: 1
                    }, 300, null, Laya.Handler.create(i, function() {
                        Laya.timer.once(300, i, function() {
                            Laya.Tween.to(i.container_gift, {
                                x: i.icon.x + 200
                            }, 200),
                            Laya.Tween.to(i.container_item, {
                                scaleX: .7,
                                scaleY: .7
                            }, 200, null, Laya.Handler.create(i, function() {
                                t.UIBase.anim_pop_out(i.gift_num, Laya.Handler.create(i, function() {
                                    Laya.timer.once(500, i, function() {
                                        i.bar_v.width = 0;
                                        var t = n.final / a
                                          , r = t / .001;
                                        Laya.Tween.to(i.bar_v, {
                                            width: 384 * t
                                        }, r),
                                        Laya.timer.once(r + 200, i, function() {
                                            e.run()
                                        })
                                    })
                                }))
                            }))
                        })
                    }))) : e.run()
                })
            })
        }
        ,
        e.prototype.close = function() {
            this.me.visible = !1,
            game.LoadMgr.clearImgSkin(this.icon)
        }
        ,
        e
    }()
      , n = function() {
        function e(t) {
            this.hearts = [],
            this.me = t,
            this.container_hearts = t.getChildByName("hearts");
            for (var e = 0; e < this.container_hearts.numChildren; e++) {
                var i = this.container_hearts.getChildAt(e);
                this.hearts.push({
                    me: i,
                    mask: i.getChildByName("v").mask
                })
            }
            this.label_num = t.getChildByName("num")
        }
        return e.prototype.show = function() {
            this.me.visible = !0;
            var e = view.DesktopMgr.Inst.rewardinfo;
            this.target_level = e.main_character.level,
            this.target_exp = e.main_character.exp;
            var i = t.UI_Sushe.main_chara_info;
            this.chara_info = i,
            this.current_exp = i.exp,
            this.current_level = i.level;
            for (var n = 0; n < this.hearts.length; n++)
                n < i.level ? this.hearts[n].mask.scaleY = 1 : n == i.level ? this.hearts[n].mask.scaleY = i.exp / cfg.level_definition.character.get(i.level + 1).exp * .82 + .1 : this.hearts[n].mask.scaleY = 0,
                this.chara_info.is_upgraded ? this.hearts[n].me.getChildByName("v").getChildByName("h").skin = game.Tools.localUISrc("myres/bothui/heart_gold.png") : this.hearts[n].me.getChildByName("v").getChildByName("h").skin = game.Tools.localUISrc("myres/bothui/bf_heart.png");
            game.Tools.child_align_center(this.container_hearts, [10, 10, 10, 10]),
            this.label_num.text = "",
            this.chara_info.level = this.target_level,
            this.chara_info.exp = this.target_exp
        }
        ,
        e.prototype.doanim = function(t) {
            var e = this
              , i = view.DesktopMgr.Inst.rewardinfo.main_character;
            i ? (this.current_level < 5 ? this.label_num.text = "+" + i.add.toString() : this.label_num.text = "",
            this.label_num.scaleX = this.label_num.scaleY = 0,
            Laya.Tween.to(this.label_num, {
                scaleX: 1,
                scaleY: 1
            }, 200, Laya.Ease.backOut),
            i.level < this.current_level ? t.run() : i.level == this.current_level && i.exp < this.current_exp ? t.run() : (this.anim_complete = t,
            this.current_level < 5 ? Laya.timer.once(300, this, function() {
                e._exp_up()
            }) : this.anim_complete && this.anim_complete.run())) : t.run()
        }
        ,
        e.prototype._exp_up = function() {
            var e = this
              , i = this.current_level
              , n = this.current_exp / cfg.level_definition.character.get(i + 1).exp
              , a = 0;
            a = i != this.target_level ? 1 : this.target_exp / cfg.level_definition.character.get(this.target_level + 1).exp;
            var r = this.hearts[i];
            r.mask.scaleY = n;
            var s = (a - n) / .0015;
            Laya.Tween.to(r.mask, {
                scaleY: .82 * a + .1
            }, s, null, Laya.Handler.create(this, function() {
                e.me.visible && (i != e.target_level ? Laya.timer.once(500, e, function() {
                    t.UI_Character_star_up.Inst.show(e.chara_info, null),
                    Laya.timer.once(500, e, function() {
                        for (var t = 0; t < e.hearts.length; t++)
                            t < e.target_level ? e.hearts[t].mask.scaleY = 1 : t == e.target_level ? e.hearts[t].mask.scaleY = e.target_exp / cfg.level_definition.character.get(e.target_level + 1).exp * .92 : e.hearts[t].mask.scaleY = 0;
                        e.anim_complete && e.anim_complete.run()
                    })
                }) : e.anim_complete && e.anim_complete.run())
            }))
        }
        ,
        e.prototype.close = function() {
            this.me.visible = !1
        }
        ,
        e
    }()
      , a = function(a) {
        function r() {
            var t = a.call(this, new ui.mj.rewardprogressUI) || this;
            return r.Inst = t,
            t
        }
        return __extends(r, a),
        r.prototype.onCreate = function() {
            this.page_box = new e(this.me.getChildByName("container_box")),
            this.page_jiban_gift = new i(this.me.getChildByName("container_jibanliwu")),
            this.page_jiban = new n(this.me.getChildByName("container_jiban"))
        }
        ,
        r.prototype.show = function(e) {
            var i = this
              , n = view.DesktopMgr.Inst.rewardinfo;
            this.page_jiban.me.visible = !1,
            this.page_jiban_gift.me.visible = !1,
            this.complete = e,
            this.page_box.show(),
            t.UIBase.anim_alpha_in(this.page_box.me, {
                x: -50
            }, 150),
            n.main_character ? (this.page_jiban.show(),
            t.UIBase.anim_alpha_in(this.page_jiban.me, {
                x: -50
            }, 150, 60)) : n.character_gift && (this.page_jiban_gift.show(),
            t.UIBase.anim_alpha_in(this.page_jiban_gift.me, {
                x: -50
            }, 150, 60)),
            Laya.timer.once(600, this, function() {
                i.page_box.doanim(Laya.Handler.create(i, function() {
                    Laya.timer.once(500, i, function() {
                        n.main_character ? i.page_jiban.doanim(Laya.Handler.create(i, function() {
                            e.run()
                        })) : n.character_gift ? i.page_jiban_gift.doanim(Laya.Handler.create(i, function() {
                            e.run()
                        })) : e.run()
                    })
                }))
            }),
            this.enable = !0
        }
        ,
        r.prototype.close = function() {
            this.page_box.close(),
            this.page_jiban_gift.close(),
            this.page_jiban.close(),
            this.enable = !1
        }
        ,
        r
    }(t.UIBase);
    t.UI_MJReward = a
}(uiscript || (uiscript = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), uiscript;
!function(t) {
    var e = function() {
        function e(t) {
            this.me = t,
            this.icon = this.me.getChildByName("item"),
            this.name = this.me.getChildByName("name"),
            this.count = this.me.getChildByName("count")
        }
        return e.prototype.show = function(e) {
            this.me.visible = !0,
            t.UIBase.anim_pop_out(this.me, null);
            var i = game.GameUtility.get_item_view(e.id);
            game.LoadMgr.setImgSkin(this.icon, i.icon),
            this.name.text = i.name,
            this.count.text = "+" + e.count,
            this.count.alpha = 0,
            t.UIBase.anim_alpha_in(this.count, {
                x: -60
            }, 150, 400)
        }
        ,
        e
    }()
      , i = function(t) {
        function i() {
            var e = t.call(this, new ui.mj.activity_taskUI) || this;
            return e.cells = [],
            e.locking = !1,
            e.complete = null,
            e.activity_reward = [],
            e.index = 0,
            i.Inst = e,
            e
        }
        return __extends(i, t),
        i.prototype.onCreate = function() {
            var t = this;
            this.root = this.me.getChildByName("root"),
            this.cells = [];
            for (var i = 0; i < 3; i++)
                this.cells.push(new e(this.root.getChildByName("task" + i)));
            this.btn = this.me.getChildByName("btn_close"),
            this.btn.clickHandler = new Laya.Handler(this,function() {
                t.locking || t.close_one()
            }
            )
        }
        ,
        i.prototype.show = function(t, e) {
            this.locking = !0,
            this.complete = e;
            for (var i = 0; i < this.cells.length; i++)
                this.cells[i].me.visible = !1;
            this.enable = !0,
            this.index = 0,
            this.activity_reward = t.activity_reward,
            this.show_one(this.activity_reward[0])
        }
        ,
        i.prototype.show_one = function(t) {
            var e = this;
            this.locking = !0,
            this.root.alpha = 1;
            for (r = 0; r < this.cells.length; r++)
                this.cells[r].me.visible = !1;
            for (var i = t.rewards, n = function(t) {
                t < a.cells.length && Laya.timer.once(600 * t, a, function() {
                    e.cells[t].show(i[t])
                })
            }, a = this, r = 0; r < i.length; r++)
                n(r);
            var s = 600 * ((i.length > this.cells.length ? this.cells.length : i.length) + 1);
            Laya.timer.once(s, this, function() {
                e.locking = !1
            })
        }
        ,
        i.prototype.close_one = function() {
            var t = this;
            this.locking = !0,
            Laya.Tween.to(this.root, {
                alpha: 0
            }, 150, null, Laya.Handler.create(this, function() {
                t.locking = !1,
                t.index++,
                t.index < t.activity_reward.length ? t.show_one(t.activity_reward[t.index]) : (t.enable = !1,
                t.complete && t.complete.run())
            }))
        }
        ,
        i
    }(t.UIBase);
    t.UI_MJReward_Activity = i
}(uiscript || (uiscript = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), uiscript;
!function(t) {
    var e = function(e) {
        function i() {
            var t = e.call(this, new ui.mj.task_progressUI) || this;
            return t.tasks = [],
            t.locking = !1,
            i.Inst = t,
            t
        }
        return __extends(i, e),
        i.record = function() {
            this.datas = [];
            for (var e = 0; e < t.UI_Activity_Xuanshang.datas.length; e++)
                this.datas.push({
                    id: t.UI_Activity_Xuanshang.datas[e].id,
                    counter: t.UI_Activity_Xuanshang.datas[e].counter,
                    achieved: t.UI_Activity_Xuanshang.datas[e].achieved
                })
        }
        ,
        i.needShow = function() {
            var e = [];
            if (view.DesktopMgr.Inst && view.DesktopMgr.Inst.mode == view.EMJMode.play)
                for (var i = t.UI_Activity_Xuanshang.datas, n = 0; n < this.datas.length; n++)
                    if (!this.datas[n].achieved)
                        for (var a = 0; a < i.length; a++)
                            if (i[a].id == this.datas[n].id) {
                                (i[a].achieved || i[a].counter != this.datas[n].counter) && e.push({
                                    id: this.datas[n].id,
                                    oc: this.datas[n].counter,
                                    nc: i[a].counter,
                                    achieved: i[a].achieved
                                });
                                break
                            }
            return e
        }
        ,
        i.prototype.onCreate = function() {
            var t = this;
            this.root = this.me.getChildByName("root"),
            this.tasks = [];
            for (var e = 0; e < 3; e++) {
                var i = this.root.getChildByName("task" + e);
                this.tasks.push({
                    container: i,
                    bg: i.getChildByName("bg"),
                    item_icon: i.getChildByName("item"),
                    item_name: i.getChildByName("item_name"),
                    item_count: i.getChildByName("item_count"),
                    desc: i.getChildByName("requirement"),
                    progress_bar: i.getChildByName("bar").getChildByName("val"),
                    progress_label: i.getChildByName("progress"),
                    img_finish: i.getChildByName("finished")
                })
            }
            this.btn_close = this.me.getChildByName("btn_close"),
            this.btn_close.clickHandler = Laya.Handler.create(this, function() {
                t.locking || t.hide()
            }, null, !1)
        }
        ,
        i.prototype.show = function(e, i) {
            var n = this;
            this.enable = !0,
            this.locking = !0,
            this.compelte = i,
            Laya.timer.clearAll(this),
            this.btn_close.visible = !1,
            t.UIBase.anim_alpha_in(this.root, {
                x: 0
            }, 200, 0, Laya.Handler.create(this, function() {}, null, !1));
            for (var a = 0, r = function() {
                ++a == e.length && (n.locking = !1,
                n.btn_close.visible = !0,
                Laya.timer.once(2e3, n, function() {
                    n.locking || (n.btn_close.visible = !1,
                    n.hide())
                }))
            }, s = function(t) {
                var i = o.tasks[t];
                if (t < e.length) {
                    i.container.visible = !0;
                    var a = cfg.events.dailyevent.get(e[t].id)
                      , s = cfg.item_definition.currency.get(a.reward_type);
                    s && (i.item_icon.skin = game.LoadMgr.getResImageSkin(s.icon),
                    i.item_name.text = s["name_" + GameMgr.client_language]);
                    var l = cfg.item_definition.item.get(a.reward_type);
                    l && (i.item_icon.skin = game.LoadMgr.getResImageSkin(l.icon),
                    i.item_name.text = l["name_" + GameMgr.client_language]),
                    i.desc.text = a["desc_" + GameMgr.client_language],
                    i.item_count.text = a.reward_num.toString(),
                    i.img_finish.visible = !1,
                    i.progress_bar.scaleX = e[t].oc / a.target,
                    i.progress_label.text = e[t].oc.toString() + "/" + a.target.toString();
                    var h = 0
                      , c = ((h = e[t].achieved ? 1 : e[t].nc / a.target) - e[t].oc / a.target) / 1 * 1e3;
                    Laya.timer.once(600, o, function() {
                        Laya.Tween.to(i.progress_bar, {
                            scaleX: h
                        }, c, Laya.Ease.strongOut, Laya.Handler.create(n, function() {
                            i.progress_label.text = e[t].nc.toString() + "/" + a.target.toString(),
                            e[t].achieved ? (i.img_finish.visible = !0,
                            i.img_finish.alpha = 0,
                            i.img_finish.scaleX = i.img_finish.scaleY = 2,
                            Laya.timer.once(200, n, function() {
                                Laya.Tween.to(i.img_finish, {
                                    alpha: 1,
                                    scaleX: 1,
                                    scaleY: 1
                                }, 120, Laya.Ease.strongIn, Laya.Handler.create(n, function() {
                                    r()
                                }))
                            })) : r()
                        }))
                    })
                } else
                    i.container.visible = !1
            }, o = this, l = 0; l < this.tasks.length; l++)
                s(l)
        }
        ,
        i.prototype.hide = function() {
            var e = this;
            this.locking = !0,
            t.UIBase.anim_alpha_out(this.root, {
                x: 0
            }, 200, 0, Laya.Handler.create(this, function() {
                e.enable = !1,
                Laya.timer.clearAll(e),
                e.compelte.run()
            }))
        }
        ,
        i.datas = [],
        i
    }(t.UIBase);
    t.UI_MJTask_Progress = e
}(uiscript || (uiscript = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), uiscript;
!function(t) {
    var e = function(e) {
        function i() {
            var t = e.call(this, new ui.lobby.nicknameUI) || this;
            return t.locking = !1,
            t.btn_cd = 0,
            t
        }
        return __extends(i, e),
        i.show = function() {
            var e = new i;
            t.UIMgr.Inst.AddLobbyUI(e),
            Laya.timer.frameOnce(5, this, function() {
                e.show()
            })
        }
        ,
        i.prototype.onCreate = function() {
            var e = this;
            this.root = this.me.getChildByName("root"),
            this.lb = this.root.getChildByName("lb"),
            this.input = this.root.getChildByName("txtinput"),
            this.yes = this.root.getChildByName("yes"),
            this.no = this.root.getChildByName("no"),
            this.btn_confirm = this.root.getChildByName("btn_confirm"),
            this.btn_confirm.clickHandler = Laya.Handler.create(this, this.onBtnConfrim, null, !1),
            this.input.on("focus", this, function() {
                e.lb.visible = !1,
                e.yes.visible = !1,
                e.no.visible = !1
            }),
            this.input.on("blur", this, function() {
                e.lb.visible = !e.input.text || "" == e.input.text
            }),
            this.input.on("input", this, function() {
                e.input.text && e.input.text
            }),
            this.root_xinshou = this.me.getChildByName("root_xinshou"),
            this.root_xinshou.getChildByName("btn_no").clickHandler = Laya.Handler.create(this, function() {
                e.locking || e.close_course()
            }, null, !1),
            this.root_xinshou.getChildByName("btn_yes").clickHandler = Laya.Handler.create(this, function() {
                e.locking || (e.enable = !1,
                t.UI_Rules.Inst.show(1, Laya.Handler.create(e, function() {
                    e.destroy(),
                    game.Scene_Lobby.Inst.pending_enter_event()
                })))
            }, null, !1),
            this.root.getChildByName("en_no_space").visible = "en" == GameMgr.client_language
        }
        ,
        i.prototype.show = function() {
            var e = this;
            this.enable = !0,
            this.locking = !0,
            this.yes.visible = !1,
            this.no.visible = !1,
            this.root_xinshou.visible = !1,
            t.UIBase.anim_pop_out(this.root, Laya.Handler.create(this, function() {
                e.locking = !1
            }))
        }
        ,
        i.prototype.close_nickname = function() {
            var e = this;
            this.locking = !0,
            t.UIBase.anim_pop_hide(this.root, Laya.Handler.create(this, function() {
                e.locking = !1,
                e.root.visible = !1,
                e.enable = !1,
                e.destroy(),
                t.UI_XinShouYinDao.Inst.show(0, Laya.Handler.create(e, function() {
                    game.Scene_Lobby.Inst.pending_enter_event()
                }))
            }))
        }
        ,
        i.prototype.show_course = function() {
            var e = this;
            this.root_xinshou.visible = !0,
            this.root_xinshou.getChildByName("name").text = this.input.text + " " + game.Tools.strOfLocalization(2150),
            this.locking = !0,
            t.UIBase.anim_pop_out(this.root_xinshou, Laya.Handler.create(this, function() {
                e.locking = !1
            }))
        }
        ,
        i.prototype.close_course = function() {
            var e = this;
            this.locking = !0,
            t.UIBase.anim_pop_hide(this.root_xinshou, Laya.Handler.create(this, function() {
                e.locking = !1,
                e.enable = !1,
                e.destroy(),
                game.Scene_Lobby.Inst.pending_enter_event()
            }))
        }
        ,
        i.prototype.have_invalid_char = function(t) {
            for (var e = 0; e < t.length; e++) {
                var i = t.charCodeAt(e);
                if (!(i >= "0".charCodeAt(0) && i <= "9".charCodeAt(0)) && !(i >= "a".charCodeAt(0) && i <= "z".charCodeAt(0) || i >= "A".charCodeAt(0) && i <= "Z".charCodeAt(0) || i >= 11904 && i <= 40959)) {
                    for (var n = !1, a = 0; a < "~@!#%&()_+={}:;<>".length; a++)
                        if ("~@!#%&()_+={}:;<>"[a] == t[e]) {
                            n = !0;
                            break
                        }
                    if (!n)
                        return !0
                }
            }
            return !1
        }
        ,
        i.prototype.onBtnConfrim = function() {
            var e = this;
            if (!this.locking && "" != this.input.text) {
                for (var i = this.input.text, n = 0, a = 0, r = 0; r < i.length; r++) {
                    if (i.charCodeAt(r) > 255) {
                        if (n + 2 > 14)
                            break;
                        n += 2
                    } else {
                        if (n + 1 > 14)
                            break;
                        n += 1
                    }
                    a++
                }
                if (a == i.length) {
                    var s = this.input.text;
                    if (this.have_invalid_char(s) || t.UI_Entrance.Accountforbidden(s))
                        this.no.visible = !0;
                    else if (!(Laya.timer.currTimer < this.btn_cd)) {
                        this.btn_cd = Laya.timer.currTimer + 700;
                        var o = {};
                        o.nickname = s,
                        GameMgr.Inst._ad_str && (o.advertise_str = GameMgr.Inst._ad_str),
                        app.NetAgent.sendReq2Lobby("Lobby", "createNickname", o, function(i, n) {
                            e.btn_cd = 0,
                            i || n.error ? t.UIMgr.Inst.showNetReqError("createNickname", i, n) : (app.PlayerBehaviorStatistic.fb_trace_force(app.EBehaviorType.Level_1),
                            GameMgr.Inst.account_data.nickname = s,
                            GameMgr.Inst.fetch_login_info(),
                            GameMgr.Inst.account_setting[game.EAccountSetKey.user_xieyi.toString()] = 1,
                            e.close_nickname())
                        }),
                        app.NetAgent.sendReq2Lobby("Lobby", "updateAccountSettings", {
                            setting: {
                                key: game.EAccountSetKey.user_xieyi,
                                value: 1
                            }
                        }, function(t, e) {});
                        var l = t.UI_Sushe.characters
                          , h = Math.floor(Math.random() * l.length);
                        t.UI_Sushe.main_character_id = t.UI_Sushe.characters[h].charid,
                        app.NetAgent.sendReq2Lobby("Lobby", "changeMainCharacter", {
                            character_id: t.UI_Sushe.main_character_id
                        }, function(t, e) {}),
                        GameMgr.Inst.account_data.avatar_id = t.UI_Sushe.characters[h].skin
                    }
                } else
                    t.UIMgr.Inst.ShowErrorInfo(game.Tools.strOfLocalization(2750))
            }
        }
        ,
        i
    }(t.UIBase);
    t.UI_Nickname = e
}(uiscript || (uiscript = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), uiscript;
!function(t) {
    var e = function(e) {
        function i() {
            var t = e.call(this, new ui.lobby.number_inputUI) || this;
            return t.title = null,
            t.txtinput = null,
            t.locking = !1,
            t.root = null,
            t._when_inputed = null,
            t._when_cancel = null,
            i.Inst = t,
            t
        }
        return __extends(i, e),
        i.prototype.onCreate = function() {
            var t = this;
            this.root = this.me.getChildByName("root"),
            this.root.getChildByName("btn_cancel").clickHandler = Laya.Handler.create(this, function() {
                t._btn_cancel()
            }, null, !1),
            this.root.getChildByName("btn_confirm").clickHandler = Laya.Handler.create(this, this._btn_confirm, null, !1),
            this.txtinput = this.root.getChildByName("input").getChildByName("txtinput"),
            this.title = this.root.getChildByName("title");
            for (var e = this.root.getChildByName("numpad"), i = function(i) {
                var a = e.getChildByName("n" + i)
                  , r = a.getChildByName("s");
                r.alpha = 0;
                var s = !1;
                a.on("mousedown", n, function() {
                    r.alpha = 0,
                    s = !0,
                    Laya.Tween.to(r, {
                        alpha: 1
                    }, 50, null, null, 0, !0, !0)
                }),
                a.on("mouseup", n, function() {
                    Laya.Tween.to(r, {
                        alpha: 0
                    }, 50, null, null, 0, !0, !0),
                    s && t.txtinput.text.length < t.txtinput.maxChars && (t.txtinput.text = t.txtinput.text + i.toString()),
                    s = !1
                }),
                a.on("mouseout", n, function() {
                    Laya.Tween.to(r, {
                        alpha: 0
                    }, 50, null, null, 0, !0, !0),
                    s = !1
                })
            }, n = this, a = 0; a < 10; a++)
                i(a);
            var r = (o = e.getChildByName("clear")).getChildByName("s");
            r.alpha = 0;
            var s = !1;
            o.on("mousedown", this, function() {
                r.alpha = 0,
                s = !0,
                Laya.Tween.to(r, {
                    alpha: 1
                }, 50, null, null, 0, !0, !0)
            }),
            o.on("mouseup", this, function() {
                Laya.Tween.to(r, {
                    alpha: 0
                }, 50, null, null, 0, !0, !0),
                s && (t.txtinput.text = ""),
                s = !1
            }),
            o.on("mouseout", this, function() {
                Laya.Tween.to(r, {
                    alpha: 0
                }, 50, null, null, 0, !0, !0),
                s = !1
            });
            var o = e.getChildByName("del")
              , l = o.getChildByName("s");
            l.alpha = 0;
            var h = !1;
            o.on("mousedown", this, function() {
                l.alpha = 0,
                h = !0,
                Laya.Tween.to(l, {
                    alpha: 1
                }, 50, null, null, 0, !0, !0)
            }),
            o.on("mouseup", this, function() {
                if (Laya.Tween.to(l, {
                    alpha: 0
                }, 50, null, null, 0, !0, !0),
                h) {
                    var e = t.txtinput.text;
                    e.length > 0 && (e = e.substr(0, e.length - 1)),
                    t.txtinput.text = e
                }
                h = !1
            }),
            o.on("mouseout", this, function() {
                Laya.Tween.to(l, {
                    alpha: 0
                }, 50, null, null, 0, !0, !0),
                h = !1
            })
        }
        ,
        i.prototype.show = function(e, i, n) {
            var a = this;
            void 0 === n && (n = null),
            this.enable = !0,
            this.txtinput.text = "",
            this.title.text = e,
            this._when_cancel = n,
            this._when_inputed = i,
            this.locking || (this.locking = !0,
            t.UIBase.anim_pop_out(this.root, Laya.Handler.create(this, function() {
                a.locking = !1
            })))
        }
        ,
        i.prototype._hide = function(e) {
            var i = this;
            this.locking = !0,
            t.UIBase.anim_pop_hide(this.root, Laya.Handler.create(this, function() {
                i.locking = !1,
                i.enable = !1,
                e.run()
            }))
        }
        ,
        i.prototype._btn_confirm = function() {
            var t = this;
            this.locking || this._hide(Laya.Handler.create(this, function() {
                var e = t._when_inputed;
                t._when_inputed = null,
                t._when_cancel = null;
                var i = 0;
                t.txtinput.text && "" != t.txtinput.text && (i = parseInt(t.txtinput.text)),
                i || (i = 0),
                e && e.runWith(i)
            }))
        }
        ,
        i.prototype._btn_cancel = function() {
            var t = this;
            this.locking || this._hide(Laya.Handler.create(this, function() {
                var e = t._when_cancel;
                t._when_inputed = null,
                t._when_cancel = null,
                e && e.run()
            }))
        }
        ,
        i.Inst = null,
        i
    }(t.UIBase);
    t.UI_NumberInput = e
}(uiscript || (uiscript = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), uiscript;
!function(t) {
    var e = function(e) {
        function i() {
            var t = e.call(this, new ui.lobby.obUI) || this;
            return t.modes = [],
            t.mode_index = 0,
            t.mode0_list = [],
            t.mode1_list = [],
            t.live_datas = [],
            t.live_show_datas = [],
            t.fetch_id = 0,
            i.Inst = t,
            t
        }
        return __extends(i, e),
        i.prototype.onCreate = function() {
            var e = this;
            this.container_top = this.me.getChildByName("top"),
            this.container_top.getChildByName("btn_back").clickHandler = Laya.Handler.create(this, function() {
                e._locking || e.hide(Laya.Handler.create(e, function() {
                    t.UIMgr.Inst.showLobby()
                }))
            }, null, !1),
            this.root = this.me.getChildByName("root"),
            this.scrollview = this.root.getChildByName("scrollview").scriptMap["capsui.CScrollView"],
            this.dropdown0 = this.root.getChildByName("dropdown0").scriptMap["capsui.CDropdown"],
            this.dropdown1 = this.root.getChildByName("dropdown1").scriptMap["capsui.CDropdown"],
            this.root.getChildByName("btn_dropdown0").clickHandler = Laya.Handler.create(this, function() {
                e._locking || e.dropdown0.locking || e.dropdown0.down()
            }, null, !1),
            this.root.getChildByName("btn_dropdown1").clickHandler = Laya.Handler.create(this, function() {
                e._locking || e.dropdown1.locking || e.dropdown1.down()
            }, null, !1),
            this.scrollview.init_scrollview(Laya.Handler.create(this, this.render_scrollview, null, !1)),
            this.dropdown0.init(Laya.Handler.create(this, this.render_dropdown0, null, !1), Laya.Handler.create(this, this.onDropdown0Change, null, !1)),
            this.dropdown1.init(Laya.Handler.create(this, this.render_dropdown1, null, !1), Laya.Handler.create(this, this.onDropdown1Change, null, !1)),
            this.modes = [],
            this.mode_index = 0,
            cfg.game_live.select_filters.forEach(function(t) {
                1 == t.open && (1 == t.initial && (e.mode_index = e.modes.length),
                e.modes.push({
                    id: t.id,
                    name0: t["name1_" + GameMgr.client_language],
                    name1: t["name2_" + GameMgr.client_language]
                }))
            }),
            this.btn_fresh = this.root.getChildByName("btn_refresh"),
            this.btn_fresh.clickHandler = Laya.Handler.create(this, function() {
                e._locking || (game.Tools.setGrayDisable(e.btn_fresh, !0),
                e.refresh_content(),
                Laya.timer.once(2e3, e, function() {
                    game.Tools.setGrayDisable(e.btn_fresh, !1)
                }))
            }, null, !1),
            this.check_friend = this.root.getChildByName("check_friend").getChildByName("checkbox"),
            this.check_friend.visible = !1,
            this.root.getChildByName("check_friend").clickHandler = Laya.Handler.create(this, function() {
                e._locking || (e.check_friend.visible = !e.check_friend.visible,
                e.onShowDataChange())
            }, null, !1),
            this.noinfo = this.root.getChildByName("noinfo"),
            this.noinfo.visible = !1
        }
        ,
        i.prototype.show = function() {
            var e = this;
            game.Scene_Lobby.Inst.change_bg("indoor", !1),
            this._locking = !0,
            this.enable = !0,
            game.Tools.setGrayDisable(this.btn_fresh, !1),
            t.UIBase.anim_alpha_in(this.container_top, {
                y: -30
            }, 150),
            t.UIBase.anim_alpha_in(this.root, {
                y: 30
            }, 150, 0),
            Laya.timer.once(150, this, function() {
                e._locking = !1
            }),
            -1 == this.mode_index && (this.mode_index = 0);
            var i = this.modes[this.mode_index].name0
              , n = this.modes[this.mode_index].name1;
            this.mode0_list = [],
            this.mode1_list = [];
            for (var a = 0, r = 0, s = 0; s < this.modes.length; s++) {
                for (var o = !1, l = 0; l < this.mode0_list.length; l++)
                    if (this.mode0_list[l] == this.modes[s].name0) {
                        o = !0;
                        break
                    }
                o || (this.modes[s].name0 == i && (a = this.mode0_list.length),
                this.mode0_list.push(this.modes[s].name0)),
                this.modes[s].name0 == i && (this.modes[s].name1 == n && (r = this.mode1_list.length),
                this.mode1_list.push(this.modes[s].name1))
            }
            this.dropdown0.reset_show(a, this.mode0_list.length),
            this.dropdown1.reset_show(r, this.mode1_list.length),
            this.refresh_content()
        }
        ,
        i.prototype.hide = function(e) {
            var i = this;
            this._locking = !0,
            t.UIBase.anim_alpha_out(this.container_top, {
                y: -30
            }, 150),
            t.UIBase.anim_alpha_out(this.root, {
                y: 30
            }, 150, 0),
            Laya.timer.clearAll(this),
            Laya.timer.once(150, this, function() {
                i._locking = !1,
                i.enable = !1,
                e && e.run()
            })
        }
        ,
        i.prototype.onDisable = function() {
            Laya.timer.clearAll(this)
        }
        ,
        i.prototype.render_dropdown0 = function(t) {
            var e = t.index;
            t.container.getChildAt(0).text = this.mode0_list[e]
        }
        ,
        i.prototype.onDropdown0Change = function(t) {
            for (var e = [], i = this.mode0_list[t], n = this.mode1_list[this.dropdown1.choosed_index], a = 0; a < this.modes.length; a++)
                this.modes[a].name0 == i && e.push(this.modes[a].name1);
            this.mode1_list = e;
            for (var r = -1, a = 0; a < e.length; a++)
                if (e[a] == n) {
                    r = a;
                    break
                }
            -1 == r && (r = 0),
            this.dropdown1.reset_show(r, this.mode1_list.length),
            this.refresh_content()
        }
        ,
        i.prototype.render_dropdown1 = function(t) {
            var e = t.index;
            t.container.getChildAt(0).text = this.mode1_list[e]
        }
        ,
        i.prototype.onDropdown1Change = function(t) {
            this.refresh_content()
        }
        ,
        i.prototype.render_scrollview = function(e) {
            var i = this
              , n = e.index
              , a = e.container
              , r = e.cache_data
              , s = this.live_show_datas[n];
            a.getChildByName("mode").text = this.modes[this.mode_index].name0 + "·" + this.modes[this.mode_index].name1;
            var o = new Date(1e3 * s.start_time)
              , l = o.getHours() + ":";
            o.getMinutes() < 10 && (l += "0"),
            l += o.getMinutes().toString(),
            a.getChildByName("time").text = l;
            for (var h = 0; h < 4; h++) {
                var c = "p" + h
                  , u = a.getChildByName(c);
                if (!r[c]) {
                    var _ = {};
                    _.level = new t.UI_Level(u.getChildByName("rank")),
                    _.title = new t.UI_PlayerTitle(u.getChildByName("title")),
                    _.name = u.getChildByName("name"),
                    r[c] = _
                }
                if (h < s.players.length) {
                    var d = s.players[h];
                    r[c].level.id = d.level.id,
                    r[c].title.id = game.Tools.titleLocalization(d.account_id, d.title),
                    r[c].name.text = d.nickname
                } else
                    r[c].level.id = 10101,
                    r[c].title.id = 0,
                    r[c].name.text = game.Tools.strOfLocalization(2133)
            }
            a.getChildByName("btn").clickHandler = Laya.Handler.create(this, function() {
                i._locking || (t.UI_PiPeiYuYue.Inst.enable ? t.UI_Popout.PopOutNoTitle(game.Tools.strOfLocalization(204), null) : t.UI_Live_Broadcast.fetchInfo(s.uuid, Laya.Handler.create(i, function(e) {
                    e.success && t.UI_Live_Broadcast.goToWatch(s.uuid, e.data, s.players[0].account_id)
                })))
            }, null, !1)
        }
        ,
        i.prototype.onShowDataChange = function() {
            this.scrollview.reset(),
            this.live_show_datas = [];
            for (var t = 0; t < this.live_datas.length; t++)
                if (this.check_friend.visible) {
                    for (var e = !1, i = 0; i < 4; i++)
                        if (!(i >= this.live_datas[t].players.length)) {
                            var n = this.live_datas[t].players[i].account_id;
                            if (game.FriendMgr.find(n)) {
                                e = !0;
                                break
                            }
                        }
                    e && this.live_show_datas.push(this.live_datas[t])
                } else
                    this.live_show_datas.push(this.live_datas[t]);
            0 == this.live_show_datas.length ? this.noinfo.visible = !0 : (this.noinfo.visible = !1,
            this.scrollview.addItem(this.live_show_datas.length))
        }
        ,
        i.prototype.refresh_content = function() {
            var e = this;
            this.scrollview.reset(),
            this.live_datas = [],
            this.mode_index = 0;
            for (var i = this.mode0_list[this.dropdown0.choosed_index], n = this.mode1_list[this.dropdown1.choosed_index], a = 0; a < this.modes.length; a++)
                this.modes[a].name0 == i && this.modes[a].name1 == n && (this.mode_index = a);
            var r = 1e5 * Math.random();
            this.fetch_id = r,
            app.NetAgent.sendReq2Lobby("Lobby", "fetchGameLiveList", {
                filter_id: this.modes[this.mode_index].id
            }, function(i, n) {
                if (i || n.error)
                    t.UIMgr.Inst.showNetReqError("fetchGameLiveList", i, n);
                else {
                    if (e.fetch_id != r)
                        return;
                    e.live_datas = [];
                    for (var a = 0; a < n.live_list.length; a++)
                        e.live_datas.push(n.live_list[a]);
                    e.onShowDataChange()
                }
            })
        }
        ,
        i
    }(t.UIBase);
    t.UI_Ob = e
}(uiscript || (uiscript = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), uiscript;
!function(t) {
    var e = function(e) {
        function i() {
            var t = e.call(this, "chs" == GameMgr.client_language ? new ui.both_ui.otherplayerinfoUI : new ui.both_ui.otherplayerinfo_enUI) || this;
            return t.account_id = 0,
            t.origin_x = 0,
            t.origin_y = 0,
            t.root = null,
            t.title = null,
            t.level = null,
            t.btn_addfriend = null,
            t.illust = null,
            t.label_name = null,
            t.detail_data = null,
            t.locking = !1,
            t.tab_info4 = null,
            t.tab_info3 = null,
            t.tab_note = null,
            t.tab_img_dark = "",
            t.tab_img_chosen = "",
            i.Inst = t,
            t
        }
        return __extends(i, e),
        i.prototype.onCreate = function() {
            var e = this;
            "chs" == GameMgr.client_language ? (this.tab_img_chosen = game.Tools.localUISrc("myres/bothui/info_tab_chosen.png"),
            this.tab_img_dark = game.Tools.localUISrc("myres/bothui/info_tab_dark.png")) : (this.tab_img_chosen = game.Tools.localUISrc("myres/bothui/info_tabheng_chosen.png"),
            this.tab_img_dark = game.Tools.localUISrc("myres/bothui/info_tabheng_dark.png")),
            this.root = this.me.getChildByName("root"),
            this.origin_x = this.root.x,
            this.origin_y = this.root.y,
            this.container_info = this.root.getChildByName("container_info"),
            this.title = new t.UI_PlayerTitle(this.container_info.getChildByName("title")),
            this.label_name = this.container_info.getChildByName("ID"),
            this.level = new t.UI_Level(this.container_info.getChildByName("rank")),
            this.detail_data = new t.UI_PlayerData(this.container_info.getChildByName("data")),
            this.illust = new t.UI_Character_Skin(this.root.getChildByName("illust").getChildByName("illust")),
            this.btn_addfriend = this.container_info.getChildByName("btn_add"),
            this.btn_addfriend.clickHandler = Laya.Handler.create(this, function() {
                e.btn_addfriend.visible = !1,
                app.NetAgent.sendReq2Lobby("Lobby", "applyFriend", {
                    target_id: e.account_id
                }, function(t, e) {})
            }, null, !1),
            this.root.getChildByName("btn_close").clickHandler = Laya.Handler.create(this, function() {
                e.close()
            }, null, !1),
            this.note = new t.UI_PlayerNote(this.root.getChildByName("container_note"),null),
            this.tab_info4 = this.root.getChildByName("tab_info4"),
            this.tab_info4.clickHandler = Laya.Handler.create(this, function() {
                e.locking || (e.container_info.visible = !0,
                e.tab_info4.skin = e.tab_img_chosen,
                e.tab_info3.skin = e.tab_img_dark,
                e.tab_note.skin = e.tab_img_dark,
                e.note.close(),
                e.detail_data.changeMJCategory(1))
            }, null, !1),
            this.tab_info3 = this.root.getChildByName("tab_info3"),
            this.tab_info3.clickHandler = Laya.Handler.create(this, function() {
                e.locking || (e.container_info.visible = !0,
                e.tab_info4.skin = e.tab_img_dark,
                e.tab_info3.skin = e.tab_img_chosen,
                e.tab_note.skin = e.tab_img_dark,
                e.note.close(),
                e.detail_data.changeMJCategory(2))
            }, null, !1),
            this.tab_note = this.root.getChildByName("tab_note"),
            this.tab_note.clickHandler = Laya.Handler.create(this, function() {
                e.locking || e.container_info.visible && (e.container_info.visible = !1,
                e.tab_info4.skin = e.tab_img_dark,
                e.tab_info3.skin = e.tab_img_dark,
                e.tab_note.skin = e.tab_img_chosen,
                e.note.show())
            }, null, !1),
            this.locking = !1
        }
        ,
        i.prototype.show = function(e) {
            var i = this;
            GameMgr.Inst.BehavioralStatistics(14),
            this.account_id = e,
            this.enable = !0,
            this.locking = !0,
            this.root.y = 560,
            t.UIBase.anim_pop_out(this.root, Laya.Handler.create(this, function() {
                i.locking = !1
            })),
            this.detail_data.reset(),
            app.NetAgent.sendReq2Lobby("Lobby", "fetchAccountStatisticInfo", {
                account_id: e
            }, function(e, n) {
                e || n.error ? t.UIMgr.Inst.showNetReqError("fetchAccountStatisticInfo", e, n) : (app.Log.log(JSON.stringify(n)),
                i.detail_data.setData(n))
            }),
            this.tab_info4.skin = this.tab_img_chosen,
            this.tab_info3.skin = this.tab_img_dark,
            this.tab_note.skin = this.tab_img_dark,
            this.container_info.visible = !0,
            this.note.close(),
            this.note.init_data(e),
            this.refreshBaseInfo()
        }
        ,
        i.prototype.refreshBaseInfo = function() {
            var e = this;
            this.level.id = 0,
            this.title.id = 0,
            this.illust.me.visible = !1,
            this.label_name.text = "",
            this.btn_addfriend.visible = !1,
            app.NetAgent.sendReq2Lobby("Lobby", "fetchAccountInfo", {
                account_id: this.account_id
            }, function(i, n) {
                if (i || n.error)
                    t.UIMgr.Inst.showNetReqError("fetchAccountInfo", i, n);
                else {
                    var a = n.account;
                    e.label_name.text = a.nickname,
                    e.title.id = game.Tools.titleLocalization(a.account_id, a.title),
                    e.level.id = a.level.id,
                    e.level.exp = a.level.score,
                    e.illust.me.visible = !0,
                    e.illust.setSkin(a.avatar_id, "waitingroom"),
                    e.account_id == GameMgr.Inst.account_id || null != game.FriendMgr.find(e.account_id) ? e.btn_addfriend.visible = !1 : e.btn_addfriend.visible = !0,
                    e.note.sign.setSign(a.signature)
                }
            })
        }
        ,
        i.prototype.close = function() {
            var e = this;
            this.enable && (this.locking || (this.locking = !0,
            this.detail_data.close(),
            t.UIBase.anim_pop_hide(this.root, Laya.Handler.create(this, function() {
                e.locking = !1,
                e.enable = !1
            }))))
        }
        ,
        i.prototype.onDisable = function() {
            this.detail_data.close(),
            this.illust.clear(),
            Laya.loader.clearTextureRes(this.level.icon.skin)
        }
        ,
        i.Inst = null,
        i
    }(t.UIBase);
    t.UI_OtherPlayerInfo = e
}(uiscript || (uiscript = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), uiscript;
!function(t) {
    var e = function() {
        function e(t) {
            var e = this;
            this.me = t,
            this.title = this.me.getChildByName("title"),
            this.input = this.me.getChildByName("input").getChildByName("txtinput"),
            this.btn_confirm = this.me.getChildByName("btn_confirm"),
            this.btn_cancel = this.me.getChildByName("btn_cancel"),
            this.me.visible = !1,
            this.btn_cancel.clickHandler = Laya.Handler.create(this, function() {
                e.hide(null)
            }, null, !1)
        }
        return e.prototype.show_share = function(e) {
            var i = this;
            this.title.text = game.Tools.strOfLocalization(2124),
            GameMgr.inConch ? (this.btn_confirm.visible = !0,
            this.btn_confirm.clickHandler = Laya.Handler.create(this, function() {
                Laya.PlatformClass.createClass("layaair.majsoul.mjmgr").call("setSysClipboardText", i.input.text),
                i.hide(null),
                t.UI_FlyTips.ShowTips(game.Tools.strOfLocalization(2125))
            }, null, !1)) : GameMgr.iniOSWebview ? (this.btn_confirm.visible = !0,
            this.btn_confirm.clickHandler = Laya.Handler.create(this, function() {
                Laya.Browser.window.wkbridge.callNative("copy2clip", i.input.text, function() {}),
                i.hide(null),
                t.UI_FlyTips.ShowTips(game.Tools.strOfLocalization(2125))
            }, null, !1)) : (this.btn_confirm.visible = !1,
            this.btn_confirm.clickHandler = Laya.Handler.create(this, function() {}, null, !1)),
            this.input.editable = !1;
            var n = game.Tools.encode_account_id(GameMgr.Inst.account_id);
            this.input.text = game.Tools.strOfLocalization(2126) + ": " + GameMgr.Inst.link_url + "?paipu=" + e + "_a" + n,
            this.me.visible = !0,
            this.locking = !0,
            this.btn_confirm.getChildAt(0).text = game.Tools.strOfLocalization(2127),
            t.UIBase.anim_pop_out(this.me, Laya.Handler.create(this, function() {
                i.locking = !1
            }))
        }
        ,
        e.prototype.show_check = function() {
            var e = this;
            t.UI_PiPeiYuYue.Inst.enable ? t.UI_Popout.PopOutNoTitle(game.Tools.strOfLocalization(204), null) : (this.title.text = game.Tools.strOfLocalization(2128),
            this.btn_confirm.visible = !0,
            this.btn_confirm.getChildAt(0).text = game.Tools.strOfLocalization(2129),
            this.btn_confirm.clickHandler = Laya.Handler.create(this, function() {
                e.hide(Laya.Handler.create(e, function() {
                    var t = e.input.text.split("=")
                      , i = t[t.length - 1].split("_")
                      , n = 0;
                    i.length > 1 && (n = "a" == i[1].charAt(0) ? game.Tools.decode_account_id(parseInt(i[1].substr(1))) : parseInt(i[1]));
                    var a = 0;
                    if (i.length > 2) {
                        var r = parseInt(i[2]);
                        r && (a = r)
                    }
                    GameMgr.Inst.checkPaiPu(i[0], n, a)
                }))
            }, null, !1),
            this.input.editable = !0,
            this.input.text = "",
            this.me.visible = !0,
            this.locking = !0,
            t.UIBase.anim_pop_out(this.me, Laya.Handler.create(this, function() {
                e.locking = !1
            })))
        }
        ,
        e.prototype.hide = function(e) {
            var i = this;
            this.locking = !0,
            t.UIBase.anim_pop_hide(this.me, Laya.Handler.create(this, function() {
                i.locking = !1,
                i.me.visible = !1,
                e && e.run()
            }))
        }
        ,
        e
    }()
      , i = function(i) {
        function n() {
            var t = i.call(this, new ui.lobby.paipuUI) || this;
            return t.top = null,
            t.container_scrollview = null,
            t.scrollview = null,
            t.loading = null,
            t.locking = !1,
            t._paipu_index = 0,
            t._have_more_paipu = !0,
            t._paipu_step = 10,
            t.record_list = [],
            t.pop = null,
            t.duringload = !1,
            n.Inst = t,
            t
        }
        return __extends(n, i),
        n.prototype.onCreate = function() {
            var i = this;
            this.top = this.me.getChildByName("top"),
            this.top.getChildByName("btn_back").clickHandler = Laya.Handler.create(this, function() {
                i.locking || i.close(Laya.Handler.create(i, function() {
                    t.UIMgr.Inst.showLobby()
                }))
            }, null, !1),
            this.container_scrollview = this.me.getChildByName("scrollview"),
            this.scrollview = this.container_scrollview.scriptMap["capsui.CScrollView"],
            this.scrollview.init_scrollview(Laya.Handler.create(this, function(t) {
                i.setItemValue(t.index, t.container)
            }, null, !1)),
            this.container_scrollview.on("ratechange", this, function() {
                i.loading.visible || i._have_more_paipu && (i.duringload || (1 - i.scrollview.rate) * i._paipu_index < 3 && i._loadList())
            }),
            this.loading = this.container_scrollview.getChildByName("loading"),
            this.loading.visible = !1,
            this.pop = new e(this.me.getChildByName("pop")),
            this.container_scrollview.getChildByName("checkother").clickHandler = Laya.Handler.create(this, function() {
                i.pop.me.visible || i.pop.show_check()
            }, null, !1)
        }
        ,
        n.prototype.show = function() {
            var e = this;
            GameMgr.Inst.BehavioralStatistics(20),
            game.Scene_Lobby.Inst.change_bg("indoor", !1),
            this.enable = !0,
            this.pop.me.visible = !1,
            t.UIBase.anim_alpha_in(this.top, {
                y: -30
            }, 200),
            t.UIBase.anim_alpha_in(this.container_scrollview, {
                y: 30
            }, 200),
            this.locking = !0,
            this.duringload = !1,
            this.loading.visible = !1,
            Laya.timer.once(200, this, function() {
                e.locking = !1
            }),
            this.record_list = [],
            this._paipu_index = 0,
            this._have_more_paipu = !0,
            this.scrollview.reset()
        }
        ,
        n.prototype.close = function(e) {
            var i = this;
            this.locking = !0,
            t.UIBase.anim_alpha_out(this.top, {
                y: -30
            }, 150),
            t.UIBase.anim_alpha_out(this.container_scrollview, {
                y: 30
            }, 150),
            Laya.timer.once(150, this, function() {
                i.locking = !1,
                i.enable = !1,
                e && e.run()
            })
        }
        ,
        n.prototype.setItemValue = function(e, i) {
            var n = this;
            if (this.enable && !(e >= this.record_list.length)) {
                for (var a = this.record_list[e], r = 0; r < 4; r++) {
                    var s = i.getChildByName("p" + r.toString());
                    if (r < a.result.players.length) {
                        s.visible = !0;
                        var o = s.getChildByName("chosen")
                          , l = s.getChildByName("rank")
                          , h = s.getChildByName("rank_word")
                          , c = s.getChildByName("name")
                          , u = s.getChildByName("score")
                          , _ = a.result.players[r];
                        u.text = _.part_point_1;
                        for (var d = game.Tools.strOfLocalization(2133), f = !1, p = 0; p < a.accounts.length; p++)
                            if (a.accounts[p].seat == _.seat) {
                                d = a.accounts[p].nickname,
                                f = a.accounts[p].account_id == GameMgr.Inst.account_id;
                                break
                            }
                        c.text = d,
                        o.visible = f,
                        u.color = f ? "#ffc458" : "#b98930",
                        c.color = f ? "#dfdfdf" : "#a0a0a0",
                        h.color = l.color = f ? "#57bbdf" : "#489dbc";
                        var m = s.getChildByName("rank_word");
                        if ("en" == GameMgr.client_language)
                            switch (m.y = 46,
                            r) {
                            case 0:
                                m.text = "st";
                                break;
                            case 1:
                                m.text = "nd";
                                break;
                            case 2:
                                m.text = "rd";
                                break;
                            case 3:
                                m.text = "th"
                            }
                        else
                            m.y = 46
                    } else
                        s.visible = !1
                }
                var g = new Date(1e3 * a.end_time)
                  , y = "";
                y += g.getFullYear() + "/",
                y += (g.getMonth() < 9 ? "0" : "") + (g.getMonth() + 1).toString() + "/",
                y += (g.getDate() < 10 ? "0" : "") + g.getDate() + " ",
                y += (g.getHours() < 10 ? "0" : "") + g.getHours() + ":",
                y += (g.getMinutes() < 10 ? "0" : "") + g.getMinutes(),
                i.getChildByName("date").text = y,
                i.getChildByName("check").clickHandler = Laya.Handler.create(this, function() {
                    n.locking || (t.UI_PiPeiYuYue.Inst.enable ? t.UI_Popout.PopOutNoTitle(game.Tools.strOfLocalization(204), null) : GameMgr.Inst.checkPaiPu(n.record_list[e].uuid, GameMgr.Inst.account_id, 0))
                }, null, !1),
                i.getChildByName("share").clickHandler = Laya.Handler.create(this, function() {
                    n.locking || n.pop.me.visible || (n.pop.show_share(n.record_list[e].uuid),
                    GameMgr.Inst.BehavioralStatistics(21))
                }, null, !1);
                var v = i.getChildByName("room")
                  , b = game.Tools.get_room_desc(a.config);
                v.text = b.text,
                "en" == GameMgr.client_language ? v.scaleX = v.scaleY = .8 : v.scaleY = v.scaleY = 1,
                "chs" != GameMgr.client_language ? v.width = 318 : v.width = 400
            }
        }
        ,
        n.prototype._loadList = function() {
            var e = this;
            if (!this.duringload && !this.loading.visible && this._have_more_paipu) {
                this.duringload = !0;
                var i = this;
                app.NetAgent.sendReq2Lobby("Lobby", "fetchGameRecordList", {
                    start: this._paipu_index,
                    count: this._paipu_step
                }, function(n, a) {
                    if (e.duringload = !1,
                    n || a.error)
                        t.UIMgr.Inst.showNetReqError("fetchGameRecordList", n, a),
                        i.loading.visible = !1;
                    else if (app.Log.log(JSON.stringify(a)),
                    a.record_list && a.record_list.length > 0) {
                        var r = a.record_list;
                        i._paipu_index += r.length;
                        for (var s = 0; s < r.length; s++)
                            i.record_list.push(r[s]);
                        i.scrollview.addItem(r.length),
                        e.loading.visible = !1,
                        e._have_more_paipu = !0
                    } else
                        e._have_more_paipu = !1,
                        e.loading.visible = !1
                }),
                Laya.timer.once(700, this, function() {
                    e.duringload && (e.loading.visible = !0)
                })
            }
        }
        ,
        n.Inst = null,
        n
    }(t.UIBase);
    t.UI_PaiPu = i
}(uiscript || (uiscript = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), uiscript;
!function(t) {
    var e;
    !function(t) {
        t[t.none = 0] = "none",
        t[t.during = 1] = "during",
        t[t.success = 2] = "success"
    }(e || (e = {}));
    var i = function(i) {
        function n() {
            var t = i.call(this, new ui.lobby.pipeiUI) || this;
            return t.state = e.none,
            n.Inst = t,
            app.NetAgent.AddListener2Lobby("NotifyRoomGameStart", Laya.Handler.create(t, function(e) {
                t.enable && (app.Log.log("NotifyRoomGameStart:" + JSON.stringify(e)),
                t.onGameStart(e))
            })),
            t
        }
        return __extends(n, i),
        n.prototype.onCreate = function() {
            var e = this;
            this.root = this.me.getChildByName("root"),
            this.info = this.root.getChildByName("text"),
            this.title = this.root.getChildByName("ttt"),
            this.btn = this.root.getChildByName("btn"),
            this.btn.clickHandler = Laya.Handler.create(this, function() {
                e.locking || (e.btn.disabled = !0,
                app.NetAgent.sendReq2Lobby("Lobby", "cancelMatch", {}, function(i, n) {
                    i || n.error ? t.UIMgr.Inst.showNetReqError("cancelMatch", i, n) : e.close()
                }))
            }, null, !1),
            this.btn.disabled = !1
        }
        ,
        n.prototype.tryToClose = function(i) {
            var n = this;
            this.state == e.none ? (this.enable = !1,
            i.runWith(!0)) : this.state == e.during ? app.NetAgent.sendReq2Lobby("Lobby", "cancelMatch", {}, function(e, a) {
                e || a.error ? (t.UIMgr.Inst.showNetReqError("cancelMatch", e, a),
                i.runWith(!1)) : (n.enable = !1,
                i.runWith(!0),
                n.close())
            }) : this.state == e.success && i.runWith(!1)
        }
        ,
        n.prototype.show = function(i) {
            var n = this;
            this.enable = !0,
            this.locking = !0,
            this.btn.disabled = !1,
            this.root.scaleX = this.root.scaleY = 1,
            t.UIBase.anim_pop_out(this.root, Laya.Handler.create(this, function() {
                n.locking = !1
            })),
            Laya.timer.clearAll(this);
            var a = 0;
            this.state = e.none,
            Laya.timer.loop(1e3, this, function() {
                var t = game.Tools.strOfLocalization(2151);
                a = (a + 1) % 4;
                for (var e = 0; e < a; e++)
                    t += ".";
                n.info.text = t
            }),
            Laya.timer.once(300, this, function() {
                n.state = e.during,
                n.enable && !n.locking && app.NetAgent.sendReq2Lobby("Lobby", "matchGame", {
                    match_mode: i
                }, function(i, a) {
                    (i || a.error) && (t.UIMgr.Inst.showNetReqError("matchGame", i, a),
                    n.close(),
                    n.state = e.none)
                })
            })
        }
        ,
        n.prototype.close = function() {
            var e = this;
            this.locking = !0,
            t.UIBase.anim_pop_hide(this.root, Laya.Handler.create(this, function() {
                e.locking = !1,
                e.enable = !1
            }))
        }
        ,
        n.prototype.onDisable = function() {
            Laya.timer.clearAll(this)
        }
        ,
        n.prototype.onGameStart = function(i) {
            this.state = e.success,
            this.enable = !1,
            t.UI_Lobby.Inst.enable = !1,
            game.MJNetMgr.Inst.OpenConnect(i.connect_token, i.game_uuid, i.location, !1, null)
        }
        ,
        n.prototype.onMatchTimeout = function(i) {
            this.close(),
            this.state = e.none,
            t.UI_Popout.PopOutNoTitle(game.Tools.strOfLocalization(2152), null)
        }
        ,
        n.Inst = null,
        n
    }(t.UIBase);
    t.UI_PiPei = i
}(uiscript || (uiscript = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), uiscript;
!function(t) {
    var e = function(e) {
        function i() {
            var t = e.call(this, new ui.lobby.pipeichenggongUI) || this;
            return t.blackbg = null,
            t.root = null,
            t.shine = null,
            t.img_duanwei = null,
            t.img_mode = null,
            t.label_time = null,
            i.Inst = t,
            t
        }
        return __extends(i, e),
        i.prototype.onCreate = function() {
            var t = this;
            this.blackbg = this.me.getChildByName("blackbg"),
            this.root = this.me.getChildByName("root"),
            this.shine = this.root.getChildByName("shine"),
            this.img_duanwei = this.root.getChildByName("duanwei"),
            this.img_mode = this.root.getChildByName("mode"),
            this.label_time = this.root.getChildByName("time"),
            app.NetAgent.AddListener2Lobby("NotifyMatchGameStart", Laya.Handler.create(this, function(e) {
                app.Log.log("NotifyMatchGameStart:" + JSON.stringify(e)),
                t.show(e)
            }))
        }
        ,
        i.prototype.show = function(e) {
            var i = this;
            this.enable = !0,
            view.AudioMgr.PlayAudio(115, 1, 1.4),
            t.UIMgr.Inst.closeUIWithTag_Lobby(),
            this.blackbg.alpha = 0,
            Laya.Tween.to(this.blackbg, {
                alpha: .7
            }, 150, null),
            this.shine.alpha = 0,
            t.UIBase.anim_pop_out(this.root, Laya.Handler.create(this, function() {
                Laya.Tween.to(i.shine, {
                    alpha: .5
                }, 500)
            }));
            var n = e.match_mode_id
              , a = cfg.desktop.matchmode.get(n);
            if (a) {
                switch (a.room) {
                case 1:
                    this.img_duanwei.skin = game.Tools.localUISrc("myres/lobby/w_tongzhijian.png");
                    break;
                case 2:
                    this.img_duanwei.skin = game.Tools.localUISrc("myres/lobby/w_yinzhijian.png");
                    break;
                case 3:
                    this.img_duanwei.skin = game.Tools.localUISrc("myres/lobby/w_jinzhijian.png");
                    break;
                case 4:
                    this.img_duanwei.skin = game.Tools.localUISrc("myres/lobby/w_yuzhijian.png");
                    break;
                case 5:
                    this.img_duanwei.skin = game.Tools.localUISrc("myres/lobby/w_luandou.png");
                    break;
                case 6:
                    this.img_duanwei.skin = game.Tools.localUISrc("myres/lobby/w_wangzuo.png");
                    break;
                default:
                    this.img_duanwei.skin = ""
                }
                switch (a.mode) {
                case 1:
                    this.img_mode.skin = game.Tools.localUISrc("myres/lobby/w_sirendong.png");
                    break;
                case 2:
                    this.img_mode.skin = game.Tools.localUISrc("myres/lobby/w_sirennan.png");
                    break;
                default:
                    this.img_mode.skin = ""
                }
                if (a.level_limit > GameMgr.Inst.account_data.level.id) {
                    var r = {};
                    r.type = "匹配成功显示问题",
                    r.account_data = GameMgr.Inst.account_data,
                    r.msg = e,
                    GameMgr.Inst.postInfo2Server(r)
                }
            } else
                this.img_duanwei.skin = "",
                this.img_mode.skin = "";
            this.label_time.text = game.Tools.strOfLocalization(2153) + "(3)",
            Laya.timer.once(1300, this, function() {
                i.label_time.text = game.Tools.strOfLocalization(2153) + "(2)"
            }),
            Laya.timer.once(2300, this, function() {
                i.label_time.text = game.Tools.strOfLocalization(2153) + "(1)"
            }),
            Laya.timer.once(3300, this, function() {
                i.label_time.text = "Go!!!"
            }),
            Laya.timer.once(4e3, this, function() {
                i.enable = !1,
                t.UI_PiPeiYuYue.Inst.onPiPeiOver(),
                game.MJNetMgr.Inst.OpenConnect(e.connect_token, e.game_uuid, e.location, !1, null)
            })
        }
        ,
        i
    }(t.UIBase);
    t.UI_PiPeiChengGong = e
}(uiscript || (uiscript = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), uiscript;
!function(t) {
    var e = function() {
        function e(t) {
            var e = this;
            this.me = t,
            this.bg = t.getChildByName("bg"),
            this.label_mode = this.bg.getChildByName("mode"),
            this.label_duanwei = this.bg.getChildByName("duanwei"),
            this.btn_close = this.bg.getChildByName("btn_close"),
            this.btn_close.clickHandler = Laya.Handler.create(this, function() {
                i.Inst.matchLocking(e.match_id) || e.close()
            }, null, !1),
            this.match_id = -1,
            this.me.visible = !1
        }
        return e.prototype.setData = function(e, n) {
            this.build_time = Laya.timer.currTimer,
            this.match_id = e,
            this.pos = n,
            this.me.visible = !0;
            var a = cfg.desktop.matchmode.get(e);
            if (a) {
                switch (this.label_duanwei.text = a["room_name_" + GameMgr.client_language],
                a.room) {
                case 1:
                    this.label_duanwei.color = "#d26f69";
                    break;
                case 2:
                    this.label_duanwei.color = "#cfcdd2";
                    break;
                case 3:
                    this.label_duanwei.color = "#dbb036";
                    break;
                case 4:
                    this.label_duanwei.color = "#3db98d";
                    break;
                case 6:
                    this.label_duanwei.color = "#ff2b72";
                    break;
                default:
                    this.label_duanwei.color = "#ffffff"
                }
                this.label_mode.text = game.Tools.room_mode_desc(a.mode)
            } else
                this.label_duanwei.text = "",
                this.label_mode.text = "";
            this.during_close = !1,
            this.me.x = 0,
            this.me.y = this.me.height * n,
            this.bg.x = 5,
            this.bg.alpha = 1;
            var r = this;
            Laya.timer.once(150, this, function() {
                app.NetAgent.sendReq2Lobby("Lobby", "matchGame", {
                    match_mode: e
                }, function(e, n) {
                    (e || n.error) && (t.UIMgr.Inst.showNetReqError("matchGame", e, n),
                    t.UIBase.anim_alpha_out(r.bg, {
                        x: 60,
                        alpha: 0
                    }, 150, 0, Laya.Handler.create(r, function() {
                        var t = r.match_id
                          , e = r.pos;
                        r.match_id = -1,
                        r.pos = -1,
                        r.me.visible = !1,
                        i.Inst.onCloseOver(t, e)
                    })))
                })
            })
        }
        ,
        e.prototype.changePos = function(t) {
            if (!this.during_close) {
                Laya.Tween.clearAll(this);
                var e = this.me.y
                  , i = t * this.me.height
                  , n = Math.abs(e - i) / 1;
                Laya.Tween.to(this.me, {
                    y: i
                }, n),
                this.pos = t
            }
        }
        ,
        e.prototype.close = function() {
            if (!this.during_close) {
                var e = this;
                this.during_close = !0,
                app.NetAgent.sendReq2Lobby("Lobby", "cancelMatch", {
                    match_mode: this.match_id
                }, function(n, a) {
                    n || a.error ? (t.UIMgr.Inst.showNetReqError("cancelMatch", n, a),
                    e.during_close = !1) : t.UIBase.anim_alpha_out(e.bg, {
                        x: 60,
                        alpha: 0
                    }, 150, 0, Laya.Handler.create(e, function() {
                        var t = e.match_id
                          , n = e.pos;
                        e.match_id = -1,
                        e.pos = -1,
                        e.me.visible = !1,
                        i.Inst.onCloseOver(t, n)
                    }))
                })
            }
        }
        ,
        e
    }()
      , i = function(i) {
        function n() {
            var t = i.call(this, new ui.lobby.pipeiyuyueUI) || this;
            return t.root = null,
            t.bg = null,
            t.label_time = null,
            t.img_arrow = null,
            t.panel_content = null,
            t.cell_templete = null,
            t.btn_open = null,
            t.cells = [],
            t.current_count = 0,
            t.inopen = !0,
            t.start_time = 0,
            t.bg_width0 = 337,
            t.bg_width1 = 515,
            n.Inst = t,
            t
        }
        return __extends(n, i),
        n.prototype.onCreate = function() {
            var i = this;
            this.root = this.me.getChildByName("root"),
            this.bg = this.root.getChildByName("bg"),
            this.label_time = this.root.getChildByName("time"),
            this.img_arrow = this.root.getChildByName("arrow"),
            this.panel_content = this.root.getChildByName("lst"),
            this.cell_templete = this.panel_content.getChildByName("templete"),
            this.cell_templete.visible = !1;
            for (var n = 0; n < 10; n++) {
                var a = this.cell_templete.scriptMap["capsui.UICopy"].getNodeClone();
                this.cells.push(new e(a))
            }
            this.btn_open = this.root.getChildByName("btn_open"),
            this.btn_open.clickHandler = Laya.Handler.create(this, function() {
                i.inopen = !i.inopen,
                i.refreshshow()
            }, null, !1),
            app.NetAgent.AddListener2Lobby("NotifyMatchTimeout", Laya.Handler.create(this, function(e) {
                app.Log.log("NotifyMatchTimeout:" + JSON.stringify(e)),
                t.UI_Popout.PopOutNoTitle(game.Tools.strOfLocalization(2152), null),
                i.onPiPeiOver()
            })),
            game.LobbyNetMgr.Inst.add_connect_listener(Laya.Handler.create(this, function(t) {
                i.enable && i.onPiPeiOver()
            }, null, !1))
        }
        ,
        n.prototype.addMatch = function(e) {
            var i = this;
            if (!this.matchYuYued(e)) {
                for (var n = -1, a = 0; a < this.cells.length; a++)
                    if (-1 == this.cells[a].match_id) {
                        n = a;
                        break
                    }
                if (n >= 0) {
                    0 == this.current_count && (this.inopen = !0,
                    this.enable = !0,
                    this.bg.width = this.bg_width1,
                    this.bg.height = 60,
                    this.start_time = Laya.timer.currTimer,
                    this.label_time.text = "00:00",
                    Laya.timer.loop(100, this, function() {
                        if (!t.UI_PiPeiChengGong.Inst.enable) {
                            var e = Laya.timer.currTimer - i.start_time;
                            e /= 1e3;
                            var n = ""
                              , a = Math.floor(e / 60);
                            a < 10 && (n += "0"),
                            n += a,
                            n += ":",
                            (a = Math.floor(e) % 60) < 10 && (n += "0"),
                            n += a,
                            i.label_time.text = n
                        }
                    }));
                    this.cells[n].setData(e, this.current_count),
                    this.current_count++,
                    this.refreshshow()
                }
            }
        }
        ,
        n.prototype.refreshshow = function() {
            var t = this;
            Laya.Tween.clearAll(this.bg),
            Laya.Tween.clearAll(this.panel_content);
            var e = this.cell_templete.height;
            if (this.img_arrow.rotation = this.inopen ? 0 : 180,
            this.inopen)
                if (this.bg.width < this.bg_width1 - .001)
                    if (this.panel_content.visible = !1,
                    0 == this.current_count)
                        this.enable = !1;
                    else {
                        o = (this.bg_width1 - this.bg.width) / 1;
                        Laya.Tween.to(this.bg, {
                            width: this.bg_width1
                        }, o, null, Laya.Handler.create(this, function() {
                            t.bg.width = t.bg_width1,
                            t.refreshshow()
                        }))
                    }
                else {
                    this.bg.width = this.bg_width1;
                    var i = this.bg.height
                      , n = 70 + this.current_count * e
                      , a = Math.abs(i - n);
                    if (a < 10)
                        this.bg.height = n,
                        this.panel_content.height = this.bg.height - 60,
                        this.panel_content.visible = !0,
                        0 == this.current_count && (this.enable = !1);
                    else {
                        o = a / 1;
                        Laya.Tween.to(this.bg, {
                            height: n
                        }, o, null, Laya.Handler.create(this, function() {
                            t.bg.height = n,
                            0 == t.current_count && (t.enable = !1)
                        })),
                        this.panel_content.height = i - 59,
                        this.panel_content.visible = !0,
                        Laya.Tween.to(this.panel_content, {
                            height: n - 60
                        }, o)
                    }
                }
            else if (0 == this.current_count)
                this.enable = !1;
            else if (this.bg.height > 60.001) {
                o = (this.bg.height - 60) / 1;
                Laya.Tween.to(this.bg, {
                    height: 60
                }, o, null, Laya.Handler.create(this, function() {
                    t.bg.height = 60,
                    t.refreshshow()
                })),
                this.panel_content.visible = !0,
                this.panel_content.height = this.bg.height - 60,
                Laya.Tween.to(this.panel_content, {
                    height: .1
                }, o, null, Laya.Handler.create(this, function() {
                    t.panel_content.visible = !1
                }))
            } else {
                this.panel_content.visible = !1,
                this.bg.height = 60;
                var r = this.bg.width
                  , s = this.bg_width0;
                if (this.bg.width < s + 10)
                    this.bg.width = s;
                else {
                    var o = Math.abs(r - s) / 1;
                    Laya.Tween.to(this.bg, {
                        width: s
                    }, o, null, Laya.Handler.create(this, function() {
                        t.bg.width = s
                    }))
                }
            }
        }
        ,
        n.prototype.matchYuYued = function(t) {
            return -1 != this.getMatchID(t)
        }
        ,
        n.prototype.getMatchID = function(t) {
            for (var e = 0; e < this.cells.length; e++)
                if (this.cells[e].match_id === t)
                    return e;
            return -1
        }
        ,
        n.prototype.matchLocking = function(t) {
            var e = this.getMatchID(t);
            return -1 != e && (Laya.timer.currTimer < this.cells[e].build_time + 200 || !!this.cells[e].during_close)
        }
        ,
        n.prototype.cancelPiPei = function(t) {
            if (!this.matchLocking(t)) {
                var e = this.getMatchID(t);
                -1 != e && this.cells[e].close()
            }
        }
        ,
        n.prototype.onCloseOver = function(t, e) {
            for (var i = 0; i < this.cells.length; i++)
                -1 != this.cells[i].match_id && this.cells[i].pos > e && this.cells[i].changePos(this.cells[i].pos - 1);
            this.current_count--,
            this.refreshshow(),
            this.me.event("cancelPiPei", t)
        }
        ,
        n.prototype.onDisable = function() {
            Laya.Tween.clearAll(this),
            Laya.timer.clearAll(this)
        }
        ,
        n.prototype.onPiPeiOver = function() {
            this.enable = !1;
            for (var t = 0; t < this.cells.length; t++)
                this.cells[t].me.visible = !1,
                this.cells[t].match_id = -1,
                this.cells[t].pos = -1;
            this.current_count = 0,
            this.me.event("pipeiover")
        }
        ,
        n
    }(t.UIBase);
    t.UI_PiPeiYuYue = i
}(uiscript || (uiscript = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), uiscript;
!function(t) {
    var e = function() {
        function t(e) {
            var n = this;
            this.change_cd = 0,
            t.Inst = this,
            this.me = e,
            this.input = e.getChildByName("input"),
            e.getChildByName("btn_confirm").clickHandler = Laya.Handler.create(this, function() {
                var t = n.input.text;
                t == GameMgr.Inst.account_data.signature || (GameMgr.Inst.account_data.signature = t,
                app.NetAgent.sendReq2Lobby("Lobby", "modifySignature", {
                    signature: t
                }, function(t, e) {}),
                n.change_cd = Laya.timer.currTimer + 3e4,
                i.Inst.note.sign.setSign(t)),
                n.me.visible = !1
            }, null, !1),
            this.input.on("input", this, function() {
                if (n.input.text && "" != n.input.text) {
                    for (var t = n.input.text, e = 0, i = 0, a = 0; a < t.length; a++) {
                        if (t.charCodeAt(a) > 255) {
                            if (e + 2 > 180)
                                break;
                            e += 2
                        } else {
                            if (e + 1 > 180)
                                break;
                            e += 1
                        }
                        i++
                    }
                    i != t.length && (n.input.text = t.substr(0, i))
                }
            })
        }
        return t.prototype.show = function() {
            this.me.visible = !0,
            this.input.text = GameMgr.Inst.account_data.signature
        }
        ,
        t.Inst = null,
        t
    }();
    t.Sign_Input = e;
    var i = function(i) {
        function n() {
            var t = i.call(this, "chs" == GameMgr.client_language ? new ui.lobby.playerinfoUI : new ui.lobby.playerinfo_enUI) || this;
            return t.origin_x = 0,
            t.origin_y = 0,
            t.root = null,
            t.title = null,
            t.level = null,
            t.input = null,
            t.label_name = null,
            t.detail_data = null,
            t.tab_info4 = null,
            t.tab_info3 = null,
            t.tab_note = null,
            t.note_readpoint = null,
            t.locking = !1,
            t.havenewcomment = !1,
            t.tab_img_dark = "",
            t.tab_img_chosen = "",
            n.Inst = t,
            t
        }
        return __extends(n, i),
        n.prototype.onCreate = function() {
            var i = this;
            "chs" == GameMgr.client_language ? (this.tab_img_chosen = game.Tools.localUISrc("myres/bothui/info_tab_chosen.png"),
            this.tab_img_dark = game.Tools.localUISrc("myres/bothui/info_tab_dark.png")) : (this.tab_img_chosen = game.Tools.localUISrc("myres/bothui/info_tabheng_chosen.png"),
            this.tab_img_dark = game.Tools.localUISrc("myres/bothui/info_tabheng_dark.png")),
            this.root = this.me.getChildByName("root"),
            this.origin_x = this.root.x,
            this.origin_y = this.root.y,
            this.container_info = this.root.getChildByName("container_info"),
            this.title = new t.UI_PlayerTitle(this.container_info.getChildByName("title")),
            this.label_name = this.container_info.getChildByName("ID"),
            this.level = new t.UI_Level(this.container_info.getChildByName("rank")),
            this.detail_data = new t.UI_PlayerData(this.container_info.getChildByName("data")),
            this.root.getChildByName("btn_close").clickHandler = Laya.Handler.create(this, function() {
                i.close()
            }, null, !1),
            this.container_info.getChildByName("btn_title").clickHandler = Laya.Handler.create(this, function() {
                t.UI_TitleBook.Inst.show()
            }, null, !1),
            this.container_info.getChildByName("btn_changenickname").clickHandler = Laya.Handler.create(this, function() {
                t.UI_Change_Nickname.Inst.show()
            }, null, !1),
            game.Tools.labelLocalizationSize(this.container_info.getChildByName("btn_changenickname").getChildAt(0), 180, .9),
            this.container_info.getChildByName("btn_rank").clickHandler = Laya.Handler.create(this, function() {
                t.UI_Introduce.Inst.show()
            }, null, !1),
            this.tab_info4 = this.root.getChildByName("tab_info4"),
            this.tab_info4.clickHandler = Laya.Handler.create(this, function() {
                i.locking || (i.container_info.visible = !0,
                i.detail_data.changeMJCategory(1),
                i.tab_info4.skin = i.tab_img_chosen,
                i.tab_info3.skin = i.tab_img_dark,
                i.tab_note.skin = i.tab_img_dark,
                i.note.close())
            }, null, !1),
            this.tab_info3 = this.root.getChildByName("tab_info3"),
            this.tab_info3.clickHandler = Laya.Handler.create(this, function() {
                i.locking || (i.container_info.visible = !0,
                i.detail_data.changeMJCategory(2),
                i.tab_info4.skin = i.tab_img_dark,
                i.tab_info3.skin = i.tab_img_chosen,
                i.tab_note.skin = i.tab_img_dark,
                i.note.close())
            }, null, !1),
            this.tab_note = this.root.getChildByName("tab_note"),
            this.tab_note.clickHandler = Laya.Handler.create(this, function() {
                i.locking || i.container_info.visible && (i.container_info.visible = !1,
                i.tab_info4.skin = i.tab_img_dark,
                i.tab_info3.skin = i.tab_img_dark,
                i.tab_note.skin = i.tab_img_chosen,
                i.note.show())
            }, null, !1),
            this.note_readpoint = this.tab_note.getChildByName("redpoint"),
            this.note_readpoint.visible = !1,
            this.note = new t.UI_PlayerNote(this.root.getChildByName("container_note"),this.note_readpoint),
            this.locking = !1,
            this.input = new e(this.me.getChildByName("container_sign_input")),
            this.input.me.visible = !1
        }
        ,
        n.prototype.show = function() {
            var e = this;
            this.locking || (this.enable = !0,
            this.root.alpha = 0,
            this.root.y = this.origin_y + 100,
            this.locking = !0,
            Laya.Tween.to(this.root, {
                alpha: 1,
                y: this.origin_y
            }, 200, null, Laya.Handler.create(this, function() {
                e.locking = !1
            })),
            this.detail_data.reset(),
            app.NetAgent.sendReq2Lobby("Lobby", "fetchAccountStatisticInfo", {
                account_id: GameMgr.Inst.account_id
            }, function(i, n) {
                i || n.error ? t.UIMgr.Inst.showNetReqError("fetchAccountStatisticInfo", i, n) : (app.Log.log(JSON.stringify(n)),
                e.detail_data.setData(n))
            }),
            this.tab_info4.skin = this.tab_img_chosen,
            this.tab_info3.skin = this.tab_img_dark,
            this.tab_note.skin = this.tab_img_dark,
            this.container_info.visible = !0,
            this.note.close(),
            this.note.init_data(GameMgr.Inst.account_id),
            this.refreshBaseInfo(),
            this.input.me.visible = !1)
        }
        ,
        n.prototype.refreshBaseInfo = function() {
            var t = GameMgr.Inst.account_data;
            this.label_name.text = t.nickname,
            this.title.id = t.title,
            this.level.id = t.level.id,
            this.level.exp = t.level.score,
            this.note.sign.setSign(t.signature)
        }
        ,
        n.prototype.close = function() {
            var t = this;
            this.locking || (this.locking = !0,
            Laya.Tween.to(this.root, {
                alpha: 0,
                y: this.origin_y + 100
            }, 200, null, Laya.Handler.create(this, function() {
                t.locking = !1,
                t.enable = !1
            })))
        }
        ,
        n.prototype.onDisable = function() {
            this.detail_data.close()
        }
        ,
        n.Inst = null,
        n
    }(t.UIBase);
    t.UI_PlayerInfo = i
}(uiscript || (uiscript = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), uiscript;
!function(t) {
    var e = function() {
        function e(t) {
            this.locking = !1,
            this.me = t,
            this.info = t.getChildByName("text"),
            t.getChildByName("btn").clickHandler = Laya.Handler.create(this, this.close, [1], !1),
            t.getChildByName("btn_cancel").clickHandler = Laya.Handler.create(this, this.close, [0], !1)
        }
        return e.prototype.show = function(e, i) {
            var n = this;
            this.func_confirm = i,
            this.info.text = e,
            this.me.visible = !0,
            this.locking = !0,
            t.UIBase.anim_pop_out(this.me, Laya.Handler.create(this, function() {
                n.locking = !1
            }))
        }
        ,
        e.prototype.close = function(e) {
            var i = this;
            this.locking || (this.locking = !0,
            t.UIBase.anim_pop_hide(this.me, Laya.Handler.create(this, function() {
                i.locking = !1,
                i.me.visible = !1,
                i.func_confirm && i.func_confirm.runWith(e),
                i.func_confirm = null
            })))
        }
        ,
        e
    }()
      , i = function() {
        function e(t) {
            this.locking = !1,
            this.me = t,
            this.info = t.getChildByName("text"),
            this.title = t.getChildByName("ttt"),
            t.getChildByName("btn").clickHandler = Laya.Handler.create(this, this.close, [1], !1),
            t.getChildByName("btn_cancel").clickHandler = Laya.Handler.create(this, this.close, [0], !1)
        }
        return e.prototype.show = function(e, i, n) {
            var a = this;
            this.title.text = e,
            this.func_confirm = n,
            this.info.text = i,
            this.me.visible = !0,
            this.locking = !0,
            t.UIBase.anim_pop_out(this.me, Laya.Handler.create(this, function() {
                a.locking = !1
            }))
        }
        ,
        e.prototype.close = function(e) {
            var i = this;
            this.locking || (this.locking = !0,
            t.UIBase.anim_pop_hide(this.me, Laya.Handler.create(this, function() {
                i.locking = !1,
                i.me.visible = !1,
                i.func_confirm && i.func_confirm.runWith(e),
                i.func_confirm = null
            })))
        }
        ,
        e
    }()
      , n = function(t) {
        function n() {
            var e = t.call(this, new ui.both_ui.popwindowUI) || this;
            return e.pop_notitle = null,
            e.pop_withtitle = null,
            n.Inst = e,
            e
        }
        return __extends(n, t),
        n.PopOutWithTitle = function(t, e, i) {
            var n = this;
            this.Inst.enable = !0,
            this.Inst.pop_withtitle.show(t, e, Laya.Handler.create(this, function(t) {
                n.Inst.enable = !1,
                i && i.runWith(t)
            }))
        }
        ,
        n.PopOutNoTitle = function(t, e) {
            var i = this;
            this.Inst.enable = !0,
            this.Inst.pop_notitle.show(t, Laya.Handler.create(this, function(t) {
                i.Inst.enable = !1,
                e && e.runWith(t)
            }))
        }
        ,
        n.prototype.onCreate = function() {
            this.pop_notitle = new e(this.me.getChildByName("notitle")),
            this.pop_withtitle = new i(this.me.getChildByName("title")),
            this.pop_notitle.me.visible = !1,
            this.pop_withtitle.me.visible = !1
        }
        ,
        n.Inst = null,
        n
    }(t.UIBase);
    t.UI_Popout = n
}(uiscript || (uiscript = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), uiscript;
!function(t) {
    var e = function(t) {
        function e() {
            var e = t.call(this, new ui.common.preventaddictionUI) || this;
            return e.container_tips = null,
            e.container_time = null,
            e.label_time = null,
            e.next_show_tip_time = 0,
            e.tips0 = null,
            e.tips1 = null,
            e.tips2 = null,
            e
        }
        return __extends(e, t),
        e.prototype.onCreate = function() {
            this.container_tips = this.me.getChildByName("container_tips"),
            this.container_time = this.me.getChildByName("container_time"),
            this.label_time = this.container_time.getChildByName("time"),
            this.tips0 = this.container_tips.getChildByName("l0"),
            this.tips1 = this.container_tips.getChildByName("l1"),
            this.tips2 = this.container_tips.getChildByName("l2"),
            Laya.timer.loop(1e3, this, this.timePass)
        }
        ,
        e.prototype.onEnable = function() {
            this.next_show_tip_time = 0;
            var t = Math.ceil(((Laya.timer.currTimer - GameMgr.Inst.account_refresh_time) / 1e3 + GameMgr.Inst.account_data.anti_addiction.online_duration) / 60);
            this.refreshTime(t),
            this.caluNextTipsTime(t),
            this.container_tips.visible = !1
        }
        ,
        e.prototype.timePass = function() {
            var t = Math.ceil(((Laya.timer.currTimer - GameMgr.Inst.account_refresh_time) / 1e3 + GameMgr.Inst.account_data.anti_addiction.online_duration) / 60);
            this.refreshTime(t),
            t >= this.next_show_tip_time && (this.tips0.visible = t < 180,
            this.tips1.visible = t >= 180 && t < 300,
            this.tips2.visible = t >= 300,
            t < 180 && (this.tips0.text = game.Tools.strOfLocalization(2157, [Math.floor(t / 60).toString()])),
            this.container_tips.visible = !0,
            this.caluNextTipsTime(t))
        }
        ,
        e.prototype.caluNextTipsTime = function(t) {
            this.next_show_tip_time = t < 180 ? 60 * Math.ceil((t + 1) / 60) : t < 300 ? 30 * Math.ceil((t - 180 + 1) / 30) + 180 : 15 * Math.ceil((t - 300 + 1) / 15) + 300
        }
        ,
        e.prototype.refreshTime = function(t) {
            var e = Math.floor(t / 60)
              , i = t % 60
              , n = "";
            e < 10 && (n += "0"),
            n += e.toString(),
            n += ":",
            i < 10 && (n += "0"),
            n += i,
            this.label_time.text = n
        }
        ,
        e
    }(t.UIBase);
    t.UI_PreventAddiction = e
}(uiscript || (uiscript = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), uiscript;
!function(t) {
    var e = function(e) {
        function i() {
            var t = e.call(this, new ui.lobby.rankUI) || this;
            return t.root = null,
            t.nolimitlist = null,
            t.player_infos = [],
            t.self_rank = -1,
            t.locking = !1,
            t.usedskin = [],
            t.container_self = null,
            t.self_head = null,
            t.self_level = null,
            t.self_title = null,
            t.self_name = null,
            i.Inst = t,
            t
        }
        return __extends(i, e),
        i.prototype.onCreate = function() {
            var e = this;
            this.root = this.me.getChildByName("root"),
            this.nolimitlist = this.root.getChildByName("content").scriptMap["capsui.NoLimitList"],
            this.nolimitlist.init_nolimitlist(Laya.Handler.create(this, this._loadInfo, null, !1), Laya.Handler.create(this, function(t) {
                e.setItemValue(t.index, t.container, t.cache_data)
            }, null, !1)),
            this.root.getChildByName("btn_close").clickHandler = Laya.Handler.create(this, function() {
                e.locking || e.close(null)
            }, null, !1),
            this.container_self = this.root.getChildByName("self"),
            this.self_head = new t.UI_Head(this.container_self.getChildByName("self").getChildByName("head")),
            this.self_level = new t.UI_Level(this.container_self.getChildByName("self").getChildByName("rank")),
            this.self_title = new t.UI_PlayerTitle(this.container_self.getChildByName("self").getChildByName("title")),
            this.self_name = this.container_self.getChildByName("self").getChildByName("name"),
            this.container_self.visible = !1
        }
        ,
        i.prototype.setItemValue = function(e, i, n) {
            if (this.enable) {
                var a = i.getChildByName("rank_img")
                  , r = i.getChildByName("rankno");
                e < 3 ? (r.visible = !1,
                a.visible = !0,
                a.skin = game.Tools.localUISrc("myres/lobby/rank_" + (e + 1).toString() + ".png")) : (r.visible = !0,
                a.visible = !1,
                r.text = (e + 1).toString());
                var s = this.player_infos[e];
                n.hasOwnProperty("head") || (n.head = new t.UI_Head(i.getChildByName("head"))),
                n.head.id = s.info.avatar_id,
                this._addusedskin(n.head.img_head.skin),
                n.hasOwnProperty("rank") || (n.level = new t.UI_Level(i.getChildByName("rank"))),
                n.level.id = s.level.id,
                this._addusedskin(n.level.icon.skin),
                n.hasOwnProperty("title") || (n.title = new t.UI_PlayerTitle(i.getChildByName("title"))),
                n.title.id = game.Tools.titleLocalization(s.info.account_id, s.info.title),
                this._addusedskin(n.title.img.skin);
                var o = i.getChildByName("rankscore");
                o.text = s.level.score.toString(),
                i.getChildByName("pt").x = o.x + o.scaleX * o.textField.textWidth + 10,
                i.getChildByName("name").text = s.info.nickname,
                i.getChildByName("btn_see").clickHandler = Laya.Handler.create(this, function() {
                    t.UI_OtherPlayerInfo.Inst.show(s.account_id)
                }, null, !1)
            }
        }
        ,
        i.prototype.show = function() {
            var e = this;
            this.nolimitlist.reset(),
            this.enable = !0,
            this.locking = !0,
            this.usedskin = [],
            t.UIBase.anim_pop_out(this.root, Laya.Handler.create(this, function() {
                e.locking = !1,
                e.loadData()
            }))
        }
        ,
        i.prototype.close = function(e) {
            var i = this;
            this.locking = !0,
            t.UIBase.anim_pop_hide(this.root, Laya.Handler.create(this, function() {
                i.locking = !1,
                i.enable = !1,
                e && e.run()
            }))
        }
        ,
        i.prototype.onDisable = function() {
            for (var t = 0; t < this.usedskin.length; t++)
                Laya.loader.clearTextureRes(this.usedskin[t]);
            this.usedskin = [],
            this.player_infos = []
        }
        ,
        i.prototype.loadData = function() {
            var e = this;
            Laya.timer.currTimer;
            this.player_infos = [],
            this.nolimitlist.reset(),
            this.self_rank = -1,
            app.NetAgent.sendReq2Lobby("Lobby", "fetchLevelLeaderboard", {}, function(i, n) {
                if (i || n.error)
                    t.UIMgr.Inst.showNetReqError("fetchLevelLeaderboard", i, n);
                else {
                    for (var a = n.items.length, r = 0; r < a; r++)
                        e.player_infos.push(n.items[r]);
                    e.nolimitlist.total_count = e.player_infos.length,
                    e.self_rank && (e.self_rank = n.self_rank),
                    e.setMeRank(),
                    e.container_self.visible = !0
                }
            })
        }
        ,
        i.prototype._loadInfo = function(e) {
            for (var i = this, n = [], a = 0; a < 20 && a + e < this.player_infos.length; a++)
                n.push(this.player_infos[e + a].account_id);
            0 == n.length ? (game.Tools.debugFetchMultiAccountBrief("rank", e, this.nolimitlist.total_count, this.nolimitlist.value_count),
            this.nolimitlist.loadOver(!1, 0)) : app.NetAgent.sendReq2Lobby("Lobby", "fetchMultiAccountBrief", {
                account_id_list: n
            }, function(n, a) {
                if (n || a.error)
                    t.UIMgr.Inst.showNetReqError("fetchMultiAccountBrief", n, a),
                    i.nolimitlist.loadOver(!1, 0);
                else {
                    for (var r = -1, s = 0; s < a.players.length; s++) {
                        if (i.player_infos[e + s].info = a.players[s],
                        i.player_infos[e + s].account_id != a.players[s].account_id) {
                            r = e + s;
                            break
                        }
                        i.player_infos[e + s].info = a.players[s]
                    }
                    -1 != r ? (t.UIMgr.Inst.ShowErrorInfo(game.Tools.strOfLocalization(2074, [(r + 1).toString()])),
                    i.nolimitlist.loadOver(!1, 0)) : i.nolimitlist.loadOver(!0, a.players.length)
                }
            })
        }
        ,
        i.prototype._addusedskin = function(t) {
            for (var e = !1, i = 0; i < this.usedskin.length; i++)
                if (t == this.usedskin[i]) {
                    e = !0;
                    break
                }
            e || this.usedskin.push(t)
        }
        ,
        i.prototype.setMeRank = function() {
            if (this.enable) {
                this.container_self.visible = !0;
                var t = this.container_self.getChildByName("self").getChildByName("rank_img")
                  , e = this.container_self.getChildByName("self").getChildByName("rankno");
                this.self_rank <= 0 ? (e.visible = !1,
                t.visible = !1) : this.self_rank <= 3 ? (e.visible = !1,
                t.visible = !0,
                t.skin = game.Tools.localUISrc("myres/lobby/rank_" + this.self_rank.toString() + ".png")) : this.self_rank <= 999 ? (e.visible = !0,
                t.visible = !1,
                e.text = this.self_rank.toString(),
                e.fontSize = 60) : (e.visible = !0,
                t.visible = !1,
                e.text = "999+",
                e.fontSize = 45),
                this.self_head.id = GameMgr.Inst.account_data.avatar_id,
                this.self_level.id = GameMgr.Inst.account_data.level.id,
                this.self_title.id = GameMgr.Inst.account_data.title,
                this.self_name.text = GameMgr.Inst.account_data.nickname;
                var i = this.container_self.getChildByName("self").getChildByName("rankscore");
                i.text = GameMgr.Inst.account_data.level.score.toString(),
                this.container_self.getChildByName("self").getChildByName("pt").x = i.x + i.scaleX * i.textField.textWidth + 10
            }
        }
        ,
        i.Inst = null,
        i
    }(t.UIBase);
    t.UI_Rank = e
}(uiscript || (uiscript = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), uiscript;
!function(t) {
    var e = function() {
        function t(t) {
            this.stars = [],
            this.me = t,
            this.container_rank = t.getChildByName("rank"),
            this.icon_new = this.container_rank.getChildByName("icon_new"),
            this.icon_old = this.container_rank.getChildByName("icon_old");
            for (var e = 1; e <= 3; e++)
                this.stars.push(this.container_rank.getChildByName("star" + e).getChildAt(0));
            this.container_bar = this.me.getChildByName("bar"),
            this.barshine = this.container_bar.getChildByName("fullshine"),
            this.barval = this.container_bar.getChildByName("container").mask,
            this.scores = this.me.getChildByName("score"),
            this.f_jinji = this.me.getChildByName("f_jinji"),
            this.f_jiangduan = this.me.getChildByName("f_jiangduan"),
            this.f_shengduan = this.me.getChildByName("f_shengduan"),
            this.continue_add = this.me.getChildByName("+"),
            this.label_add = this.continue_add.getChildByName("score"),
            this.continue_minus = this.me.getChildByName("-"),
            this.label_minus = this.continue_minus.getChildByName("score")
        }
        return t.prototype.reset = function() {
            this.icon_new.alpha = 1,
            this.icon_new.visible = !1,
            this.icon_old.alpha = 1,
            this.icon_old.visible = !1;
            for (var t = 0; t < this.stars.length; t++)
                this.stars[t].scaleX = this.stars[t].scaleY = 1,
                this.stars[t].alpha = 1,
                this.stars[t].visible = !1;
            this.barshine.visible = !1,
            this.barshine.alpha = 1,
            this.f_jinji.visible = !1,
            this.f_jiangduan.visible = !1,
            this.f_shengduan.visible = !1,
            this.scores.visible = !1
        }
        ,
        t.prototype.showInit = function() {
            this.reset(),
            this.me.visible = !0;
            var t = view.DesktopMgr.Inst.levelchangeinfo
              , e = t.origin.id
              , i = t.origin.score
              , a = t.final.id;
            t.final.score;
            this.container_bar.visible = 10601 != e;
            var r = cfg.level_definition.level_definition.find(e)
              , s = cfg.level_definition.level_definition.find(a)
              , o = i / r.end_point * .78;
            n.Inst.me,
            this.barval;
            if (this.barval.scaleY = o,
            this.icon_old.visible = !0,
            this.icon_old.skin = game.LoadMgr.getResImageSkin(r.primary_icon),
            10601 == e)
                for (l = 0; l < this.stars.length; l++)
                    this.stars[l].parent.visible = !1;
            else
                for (var l = 0; l < this.stars.length; l++)
                    this.stars[l].parent.visible = !0,
                    this.stars[l].visible = !0,
                    this.stars[l].alpha = l < r.secondary_level ? 1 : 0;
            this.icon_new.visible = !1,
            this.icon_new.skin = game.LoadMgr.getResImageSkin(s.primary_icon),
            this.icon_old.scaleX = this.icon_old.scaleY = 1,
            this.continue_add.visible = !1,
            this.continue_minus.visible = !1
        }
        ,
        t.prototype.showLevelChange = function() {
            var t = this
              , e = view.DesktopMgr.Inst.levelchangeinfo
              , i = e.origin.id
              , a = e.origin.score
              , r = e.final.id
              , s = e.final.score
              , o = cfg.level_definition.level_definition.find(i)
              , l = cfg.level_definition.level_definition.find(r)
              , h = a / o.end_point * .78
              , c = s / l.end_point * .78
              , u = n.Inst.me
              , _ = this.barval
              , d = 0;
            if (this.scores.text = 10601 == i ? s.toString() : s.toString() + "/" + l.end_point.toString(),
            this.scores.visible = !0,
            this.scores.alpha = 0,
            _.scaleY = h,
            i == r) {
                var f = Math.abs(h - c) / 3e-4;
                f > 50 && (Laya.timer.once(d, this, function() {
                    Laya.Tween.to(_, {
                        scaleY: c
                    }, f),
                    t.play_exp_audio(f)
                }),
                d += f),
                d += 100
            } else if (o.primary_level < l.primary_level) {
                var p = (.78 - h) / 3e-4;
                Laya.timer.once(d, this, function() {
                    Laya.Tween.to(_, {
                        scaleY: .78
                    }, p),
                    t.play_exp_audio(p)
                }),
                d += p,
                Laya.timer.once(d, this, function() {
                    t.barshine.visible = !0,
                    u.ani0.play(0, !1)
                }),
                d += u.ani0.count * u.ani0.interval,
                Laya.timer.once(d, this, function() {
                    n.Inst.ShengDuan()
                }),
                d = -1
            } else if (o.primary_level > l.primary_level) {
                this.icon_new.visible = !0,
                this.icon_new.alpha = 0,
                this.icon_new.skin = game.LoadMgr.getResImageSkin(l.primary_icon);
                var m = h / 3e-4;
                Laya.timer.once(d, this, function() {
                    Laya.Tween.to(_, {
                        scaleY: 0
                    }, m),
                    t.play_exp_audio(m)
                }),
                d += m,
                Laya.timer.once(d, this, function() {
                    var e = t.stars[0]
                      , i = game.FrontEffect.Inst.create_ui_effect(e.parent, "scene/effect_losestar.lh", new Laya.Point(0,0), 1);
                    Laya.timer.once(100, t, function() {
                        e.alpha = 0
                    }),
                    Laya.timer.once(2e3, t, function() {
                        i.destory()
                    })
                }),
                d += 1200,
                Laya.timer.once(d, this, function() {
                    t.f_jiangduan.visible = !0,
                    u.ani_jiangduan.play(0, !1)
                }),
                d += 2300;
                var g = (.78 - c) / 3e-4;
                Laya.timer.once(d, this, function() {
                    _.scaleY = .78,
                    Laya.Tween.to(_, {
                        scaleY: c
                    }, g),
                    t.play_exp_audio(g)
                }),
                d += g
            } else if (o.secondary_level < l.secondary_level) {
                var y = (.78 - h) / 3e-4;
                Laya.timer.once(d, this, function() {
                    Laya.Tween.to(_, {
                        scaleY: .78
                    }, y),
                    t.play_exp_audio(y)
                }),
                d += y,
                Laya.timer.once(d, this, function() {
                    t.barshine.visible = !0,
                    u.ani0.play(0, !1)
                }),
                d += u.ani0.interval * u.ani0.count,
                Laya.timer.once(d, this, function() {
                    t.f_jinji.visible = !0;
                    var e = 2 == l.secondary_level ? t.stars[1] : t.stars[2]
                      , i = game.FrontEffect.Inst.create_ui_effect(e.parent, "scene/effect_getstar.lh", new Laya.Point(0,0), 1);
                    view.AudioMgr.PlayAudio(218),
                    Laya.timer.once(100, t, function() {
                        e.alpha = 1
                    }),
                    Laya.timer.once(1e3, t, function() {
                        i.destory()
                    })
                }),
                d += 1200;
                var v = c / 3e-4;
                Laya.timer.once(d, this, function() {
                    t.barshine.visible = !1,
                    _.scaleY = 0,
                    Laya.Tween.to(_, {
                        scaleY: c
                    }, v),
                    t.play_exp_audio(v)
                }),
                d += v
            } else if (o.secondary_level > l.secondary_level) {
                var b = h / 3e-4;
                Laya.timer.once(d, this, function() {
                    Laya.Tween.to(_, {
                        scaleY: 0
                    }, b),
                    t.play_exp_audio(b)
                }),
                d += b,
                Laya.timer.once(d, this, function() {
                    t.f_shengduan.visible = !0;
                    var e = 2 == l.secondary_level ? t.stars[2] : t.stars[1]
                      , i = game.FrontEffect.Inst.create_ui_effect(e.parent, "scene/effect_losestar.lh", new Laya.Point(0,0), 1);
                    Laya.timer.once(100, t, function() {
                        e.alpha = 0
                    }),
                    Laya.timer.once(2e3, t, function() {
                        i.destory()
                    })
                }),
                d += 1800;
                var x = (.78 - c) / 3e-4;
                Laya.timer.once(d, this, function() {
                    _.scaleY = .78,
                    Laya.Tween.to(_, {
                        scaleY: c
                    }, x),
                    t.play_exp_audio(x)
                }),
                d += x
            }
            return d >= 0 && (Laya.timer.once(d, this, function() {
                Laya.Tween.to(t.scores, {
                    alpha: 1
                }, 150),
                view.DesktopMgr.Inst.ptchange > 0 && (t.label_add.text = view.DesktopMgr.Inst.ptchange.toString(),
                t.continue_add.visible = !0,
                t.continue_add.alpha = 0,
                Laya.Tween.to(t.continue_add, {
                    alpha: 1
                }, 150)),
                view.DesktopMgr.Inst.ptchange < 0 && (t.label_minus.text = view.DesktopMgr.Inst.ptchange.toString(),
                t.continue_minus.visible = !0,
                t.continue_minus.alpha = 0,
                Laya.Tween.to(t.continue_minus, {
                    alpha: 1
                }, 150))
            }),
            d += 150),
            d
        }
        ,
        t.prototype.shengduanOver = function() {
            var t = view.DesktopMgr.Inst.levelchangeinfo
              , e = t.origin.id
              , i = t.origin.score
              , a = t.final.id
              , r = t.final.score
              , s = cfg.level_definition.level_definition.find(e)
              , o = cfg.level_definition.level_definition.find(a)
              , l = (s.end_point,
            r / o.end_point * .78);
            n.Inst.me,
            this.barval;
            if (this.f_jinji.visible = !1,
            this.icon_old.visible = !0,
            this.barshine.visible = !1,
            this.icon_old.skin = game.LoadMgr.getResImageSkin(o.primary_icon),
            10601 == a)
                for (h = 0; h < this.stars.length; h++)
                    this.stars[h].parent.visible = !1;
            else
                for (var h = 0; h < this.stars.length; h++)
                    this.stars[h].parent.visible = !0,
                    this.stars[h].visible = !0,
                    this.stars[h].alpha = h < o.secondary_level ? 1 : 0;
            this.icon_new.visible = !1,
            this.barval.scaleY = l,
            this.scores.alpha = 1
        }
        ,
        t.prototype.play_exp_audio = function(t) {
            var e = this;
            t < 0 || (view.AudioMgr.PlayAudio(220),
            Laya.timer.once(150, this, function() {
                e.play_exp_audio(t - 150)
            }))
        }
        ,
        t
    }()
      , i = function() {
        function t(t) {
            this._effect_book = null,
            this.me = t,
            this._ui = n.Inst.me,
            this.black = this.me.getChildByName("black"),
            this.shine = this.me.getChildByName("shine"),
            this.book_shine = this.me.getChildByName("book_shine"),
            this.btn_open = this.me.getChildByName("btn_open"),
            this.container_main = this.me.getChildByName("main"),
            this.call = this.container_main.getChildByName("call"),
            this.contianer_name = this.container_main.getChildByName("name"),
            this.label_name = this.contianer_name.getChildByName("name"),
            this.label_time = this.container_main.getChildByName("time"),
            this.btn_close = this.container_main.getChildByName("btn_close"),
            this.rank = this.container_main.getChildByName("rankbg").getChildByName("rank")
        }
        return t.prototype.show = function() {
            var t = this;
            this.me.visible = !0,
            this.black.visible = !0,
            this.black.alpha = 0,
            this._ui.ani1.play(0, !1),
            this.btn_open.visible = !1,
            Laya.timer.once(500, this, function() {
                view.AudioMgr.PlayAudio(105)
            }),
            Laya.timer.once(625, this, function() {
                t.btn_open.visible = !0,
                t._effect_book = game.FrontEffect.Inst.create_ui_effect(t.book_shine, "scene/effect_juanzhou.lh", new Laya.Point(0,0), 1),
                Laya.timer.once(1e3, t, function() {
                    t.btn_open.clickHandler = Laya.Handler.create(t, t.openBook)
                })
            })
        }
        ,
        t.prototype.openBook = function() {
            var t = this;
            this._effect_book && this._effect_book.destory(),
            this.container_main.visible = !0;
            var e = view.DesktopMgr.Inst.levelchangeinfo
              , i = e.final.id
              , n = (e.final.score,
            new Date);
            this.label_time.text = n.getFullYear() + "." + (n.getMonth() + 1).toString() + "." + n.getDate();
            var a = cfg.level_definition.level_definition.find(i)
              , r = GameMgr.Inst.account_data.nickname;
            this.label_name.text = r,
            this.contianer_name.width = this.label_name.x + this.label_name.textWidth + 34,
            this.call.x = 30 + this.contianer_name.x + this.contianer_name.width,
            this.rank.skin = game.LoadMgr.getResImageSkin(a.primary_icon),
            this._ui.ani2.play(0, !1),
            this.btn_close.clickHandler = null,
            Laya.timer.once(8 / 24 * 1e3, this, function() {
                view.AudioMgr.PlayAudio(228)
            });
            for (var s = [29, 43, 56, 104], o = 0; o < s.length; o++)
                Laya.timer.once(s[o] / 24 * 1e3, this, function() {
                    view.AudioMgr.PlayAudio(104)
                });
            Laya.timer.once(88 / 24 * 1e3, this, function() {
                var e = game.FrontEffect.Inst.create_ui_effect(t.rank.parent, "scene/effect_queshi_bang.lh", new Laya.Point(0,0), 0);
                view.AudioMgr.PlayAudio(229),
                Laya.timer.once(1e3, t, function() {
                    e.destory()
                })
            }),
            Laya.timer.once(this._ui.ani2.interval * this._ui.ani2.count, this, function() {
                t.btn_close.clickHandler = Laya.Handler.create(t, t.closeBook, null, !0)
            })
        }
        ,
        t.prototype.closeBook = function() {
            var t = this;
            view.AudioMgr.PlayAudio(228),
            n.Inst.pagerank.shengduanOver(),
            this.btn_close.visible = !1,
            this._ui.ani3.play(0, !1),
            Laya.timer.once(this._ui.ani3.interval * this._ui.ani3.count, this, function() {
                t.me.visible = !1,
                n.Inst.AnimOver()
            })
        }
        ,
        t
    }()
      , n = function(n) {
        function a() {
            var t = n.call(this, new ui.mj.rankchangeUI) || this;
            return t.atlas = "res/atlas/myres/mjdesktop/shengduan.atlas",
            a.Inst = t,
            t
        }
        return __extends(a, n),
        a.prototype.onCreate = function() {
            this.pagerank = new e(this.me.getChildByName("rank_change")),
            this.pagerankup = new i(this.me.getChildByName("rankup")),
            this.pagerank.me.visible = !1,
            this.pagerankup.me.visible = !1,
            Laya.loader.clearTextureRes(this.atlas)
        }
        ,
        a.prototype.show = function(e) {
            var i = this;
            this.complete = e,
            this.enable = !0,
            this.pagerank.showInit(),
            this.pagerankup.me.visible = !1,
            Laya.timer.clearAll(this),
            t.UIBase.anim_alpha_in(this.pagerank.me, {
                x: 0
            }, 100, 0),
            Laya.timer.once(500, this, function() {
                var t = i.pagerank.showLevelChange();
                t > 0 && Laya.timer.once(t, i, function() {
                    i.AnimOver()
                })
            })
        }
        ,
        a.prototype.close = function() {
            this.enable = !1,
            Laya.loader.clearTextureRes(this.atlas)
        }
        ,
        a.prototype.ShengDuan = function() {
            this.pagerankup.show()
        }
        ,
        a.prototype.AnimOver = function() {
            Laya.loader.clearTextureRes(this.atlas),
            this.complete.run()
        }
        ,
        a.Inst = null,
        a
    }(t.UIBase);
    t.UI_RankChange = n
}(uiscript || (uiscript = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), uiscript;
!function(t) {
    var e = function() {
        function e(t) {
            var e = this;
            this.me = t,
            this.root = this.me.getChildByName("root"),
            this.name = this.root.getChildByName("label_name"),
            this.desc = this.root.getChildByName("desc"),
            this.root.getChildByName("btn_close").clickHandler = Laya.Handler.create(this, function() {
                e.close()
            }, null, !1),
            this.container_item = this.root.getChildByName("item"),
            this.buyed = this.container_item.getChildByName("buyed"),
            this.icon = this.container_item.getChildByName("icon"),
            this.container_price = this.root.getChildByName("price"),
            this.btn_buy = this.root.getChildByName("btn_buy")
        }
        return e.prototype.show_recharge = function(e, i) {
            var n = this;
            this.me.visible = !0,
            t.UIBase.anim_pop_out(this.root, null);
            var a;
            cfg.mall.goods_shelves.getGroup(e).forEach(function(t) {
                t.goods_id == i && (a = t)
            });
            var r = cfg.mall.goods.get(i);
            this.name.text = r.name,
            this.desc.text = r.desc,
            game.LoadMgr.setImgSkin(this.icon, r.icon),
            this.container_price.getChildByName("icon").visible = !1;
            var s = null;
            c.Inst.app_shop && (s = c.Inst.app_shop.getGoodsInfo(i)),
            this.container_price.getChildByName("count").text = s ? s.price : a.price,
            game.Tools.child_align_center(this.container_price, [20]),
            this.buyed.visible = !1,
            game.Tools.setGrayDisable(this.container_item, !1),
            game.Tools.setGrayDisable(this.btn_buy, !1),
            this.btn_buy.clickHandler = Laya.Handler.create(this, function() {
                n.close(),
                game.Tools.setGrayDisable(n.btn_buy, !0),
                c.Inst.want_to_recharge(i)
            }, null, !1)
        }
        ,
        e.prototype.show_exchange = function(e) {
            var i = this;
            this.me.visible = !0,
            t.UIBase.anim_pop_out(this.root, null);
            var n = cfg.exchange.exchange.get(e);
            this.name.text = n["name_" + GameMgr.client_language],
            this.desc.text = n["desc_" + GameMgr.client_language],
            game.LoadMgr.setImgSkin(this.icon, n.icon),
            this.container_price.getChildByName("icon").skin = game.LoadMgr.getResImageSkin(cfg.item_definition.currency.get(n.source_currency).icon),
            this.container_price.getChildByName("icon").visible = !0;
            var a = t.UI_Bag.get_item_count(n.source_currency);
            this.buyed.visible = !1,
            game.Tools.setGrayDisable(this.container_item, !1),
            game.Tools.setGrayDisable(this.btn_buy, a < n.source_value);
            var r = this.container_price.getChildByName("count");
            r.text = n.source_value.toString(),
            r.color = a < n.source_value ? "#ff0000" : "#00ff00",
            game.Tools.child_align_center(this.container_price),
            this.btn_buy.clickHandler = Laya.Handler.create(this, function() {
                i.close(),
                game.Tools.setGrayDisable(i.btn_buy, !0),
                c.Inst.want_to_exchange(e)
            }, null, !1)
        }
        ,
        e.prototype.show_searchexchange = function(e) {
            var i = this;
            this.me.visible = !0,
            t.UIBase.anim_pop_out(this.root, null);
            var n = cfg.exchange.searchexchange.get(e);
            this.name.text = n["name_" + GameMgr.client_language],
            this.desc.text = n["desc_" + GameMgr.client_language],
            game.LoadMgr.setImgSkin(this.icon, n.icon),
            this.container_price.getChildByName("icon").skin = game.LoadMgr.getResImageSkin(cfg.item_definition.currency.get(n.source_currency).icon),
            this.container_price.getChildByName("icon").visible = !0;
            var a = t.UI_Bag.get_item_count(n.source_currency);
            this.buyed.visible = !1,
            game.Tools.setGrayDisable(this.container_item, !1),
            game.Tools.setGrayDisable(this.btn_buy, a < n.source_value);
            var r = this.container_price.getChildByName("count");
            r.text = n.source_value.toString(),
            r.color = a < n.source_value ? "#ff0000" : "#00ff00",
            game.Tools.child_align_center(this.container_price),
            this.btn_buy.clickHandler = Laya.Handler.create(this, function() {
                i.close(),
                game.Tools.setGrayDisable(i.btn_buy, !0),
                c.Inst.want_to_searchexchange(e)
            }, null, !1)
        }
        ,
        e.prototype.close = function() {
            var e = this;
            t.UIBase.anim_pop_hide(this.root, Laya.Handler.create(this, function() {
                e.me.visible = !1
            }))
        }
        ,
        e
    }()
      , i = function() {
        function e(t) {
            var e = this;
            this.current_id = 0,
            this.my_vip_id = 0,
            this.me = t,
            this.container_title = t.getChildByName("container_title"),
            this.current_title_big = this.container_title.getChildByName("current_title_big"),
            this.current_title_small = t.getChildByName("container_next").getChildByName("current_title_small"),
            this.next_title = t.getChildByName("container_next").getChildByName("next_title"),
            this.next_info = t.getChildByName("container_next").getChildByName("next_info"),
            this.label_infos = [];
            for (var i = t.getChildByName("container_infos"), n = 0; n < i.numChildren; n++)
                this.label_infos.push(i.getChildAt(n));
            this.label_require = t.getChildByName("require"),
            this.label_value = t.getChildByName("value"),
            this.btn_left = t.getChildByName("btn_left"),
            this.btn_left.clickHandler = Laya.Handler.create(this, function() {
                e.current_id--,
                e.refresh()
            }, null, !1),
            this.btn_right = t.getChildByName("btn_right"),
            this.btn_right.clickHandler = Laya.Handler.create(this, function() {
                e.current_id++,
                e.refresh()
            }, null, !1),
            this.container_bar = t.getChildByName("bar").getChildByName("v"),
            this.bar_v = t.getChildByName("bar").getChildByName("v").mask,
            this.btn_get_reward = t.getChildByName("btn_get_reward"),
            this.container_reward = t.getChildByName("container_reward")
        }
        return e.prototype.show = function() {
            var t = this;
            this.me.visible = !0;
            var e = 0;
            GameMgr.Inst.account_data.vip && (e = GameMgr.Inst.account_data.vip),
            this.current_id = 1,
            cfg.vip.vip.forEach(function(i) {
                e >= i.charge && (t.current_id = i.id)
            }),
            this.my_vip_id = this.current_id;
            var i = cfg.vip.vip.get(this.current_id);
            if (i) {
                var n = cfg.vip.vip.get(this.current_id + 1);
                n ? (this.label_value.text = e.toString() + "/" + n.charge.toString(),
                this.bar_v.width = this.container_bar.width * e / n.charge,
                game.LoadMgr.setImgSkin(this.current_title_small, i.img),
                game.LoadMgr.setImgSkin(this.next_title, n.img),
                this.next_info.text = game.Tools.strOfLocalization(2158, [(n.charge - e).toString()]),
                this.next_info.visible = !0,
                this.next_title.visible = !0,
                game.Tools.child_align_center(this.me.getChildByName("container_next"), [0, 30, 0])) : (this.label_value.text = e.toString(),
                this.bar_v.width = this.container_bar.width,
                game.LoadMgr.setImgSkin(this.current_title_small, i.img),
                this.next_info.visible = !1,
                this.next_title.visible = !1,
                game.Tools.child_align_center(this.me.getChildByName("container_next"), [0, 30, 0]))
            } else
                this.me.getChildByName("container_next").visible = !1;
            this.refresh()
        }
        ,
        e.prototype.close = function() {
            this.me.visible = !1
        }
        ,
        e.prototype.refresh = function() {
            var e = this
              , i = cfg.vip.vip.get(this.current_id);
            if (i) {
                game.LoadMgr.setImgSkin(this.current_title_big, i.img),
                this.btn_left.visible = null != cfg.vip.vip.get(this.current_id - 1),
                this.btn_right.visible = null != cfg.vip.vip.get(this.current_id + 1),
                0 == i.charge ? this.label_require.text = "" : this.label_require.text = game.Tools.strOfLocalization(2159, [i.charge.toString()]);
                for (var n = [], a = 0; a < i.rewards.length; a++)
                    "" != i.rewards[a] && n.push(i.rewards[a]);
                if (0 == n.length)
                    this.container_reward.visible = !1,
                    this.btn_get_reward.visible = !1,
                    this.label_require.visible = !0,
                    this.container_title.y = 334;
                else {
                    this.container_reward.visible = !0,
                    this.container_title.y = 88;
                    for (var r = this.container_reward.getChildByName("container_item"), s = function(i) {
                        var a = r.getChildAt(i);
                        if (n.length > i) {
                            var s = a.width * n.length + (n.length < 1 ? 0 : 0 * (n.length - 1))
                              , l = r.width / 2 - s / 2 + (a.width + 0) * i;
                            a.x = l,
                            a.y = 0,
                            a.visible = !0;
                            var h = n[i]
                              , u = parseInt(h.split("-")[0])
                              , _ = parseInt(h.split("-")[1]);
                            a.getChildByName("btn").clickHandler = Laya.Handler.create(o, function() {
                                t.UI_ItemDetail.Inst.show(u)
                            }, null, !1);
                            var d = a.getChildByName("count");
                            _ > 1 ? (d.visible = !0,
                            d.text = _.toString()) : d.visible = !1;
                            var f = game.GameUtility.get_item_view(u);
                            game.LoadMgr.setImgSkin(a.getChildByName("btn").getChildByName("icon"), f.icon);
                            var p = a.getChildByName("btn").getChildByName("getted");
                            c.vip_reward_getted ? c.vip_reward_getted[o.current_id - 1] ? (p.visible = !0,
                            o.label_require.visible = !0,
                            o.btn_get_reward.visible = !1) : (p.visible = !1,
                            o.my_vip_id >= o.current_id ? (o.btn_get_reward.visible = !0,
                            o.label_require.visible = !1,
                            o.btn_get_reward.clickHandler = Laya.Handler.create(o, function() {
                                var i = e.current_id;
                                app.NetAgent.sendReq2Lobby("Lobby", "gainVipReward", {
                                    vip_level: i - 1
                                }, function(n, a) {
                                    n || a.error ? t.UIMgr.Inst.showNetReqError("gainVipReward", n, a) : (c.vip_reward_getted[i - 1] = 1,
                                    e.refresh(),
                                    t.UI_LightTips.Inst.show(game.Tools.strOfLocalization(2211)))
                                })
                            }, null, !1)) : (o.btn_get_reward.visible = !1,
                            o.label_require.visible = !0)) : (p.visible = !1,
                            o.label_require.visible = !0,
                            o.btn_get_reward.visible = !1)
                        } else
                            a.visible = !1
                    }, o = this, a = 0; a < r.numChildren; a++)
                        s(a)
                }
                for (var l = i["desc_" + GameMgr.client_language].split("\\n"), a = 0; a < this.label_infos.length; a++)
                    a < l.length ? (this.label_infos[a].text = l[a],
                    this.label_infos[a].visible = !0) : this.label_infos[a].visible = !1
            }
        }
        ,
        e
    }()
      , n = function() {
        function e(i) {
            var n = this;
            this.root = null,
            this.icon = null,
            this.label_title = null,
            this.label_price = null,
            this.label_method = null,
            this.loading = null,
            this.locking = !1,
            this.id = 0,
            e.Inst = this,
            this.me = i,
            this.root = i.getChildByName("root"),
            this.icon = this.root.getChildByName("icon"),
            this.icon.skin = "",
            this.root.getChildByName("btn_close").clickHandler = Laya.Handler.create(this, function() {
                n.locking || n.close()
            }, null, !1),
            this.root.getChildByName("btn_close2").clickHandler = Laya.Handler.create(this, function() {
                n.locking || n.close()
            }, null, !1),
            this.label_price = this.root.getChildByName("price").getChildByName("v"),
            this.label_title = this.root.getChildByName("title").getChildByName("v"),
            this.label_method = this.root.getChildByName("method"),
            this.loading = this.root.getChildByName("loading"),
            app.NetAgent.AddListener2Lobby("NotifyPayResult", Laya.Handler.create(this, function(e) {
                app.Log.log("NotifyPayResult msg:" + JSON.stringify(e) + " this.me.visible:" + n.me.visible + " this.order_id:" + n.order_id + " ==" + (n.order_id == e.order_id));
                var i = cfg.mall.goods.get(e.goods_id)
                  , a = "";
                0 === e.pay_result ? (a = game.Tools.strOfLocalization(2161, [i.name]),
                app.PlayerBehaviorStatistic.recharged_count++,
                app.PlayerBehaviorStatistic.fb_trace_pending(app.EBehaviorType.Purchase, app.PlayerBehaviorStatistic.recharged_count)) : a = game.Tools.strOfLocalization(2160, [i.name]),
                t.UI_LightTips.Inst.show(a),
                n.me.visible && n.order_id == e.order_id && n.close()
            }, null, !1))
        }
        return e.prototype.show = function(e, i) {
            var n = this;
            this.locking = !0,
            this.me.visible = !0,
            t.UIBase.anim_pop_out(this.root, Laya.Handler.create(this, function() {
                n.locking = !1
            })),
            this.loading.visible = !0,
            this.id++;
            var a = this.id
              , r = cfg.mall.goods.get(e);
            this.label_title.text = r.name,
            this.label_price.text = r.price;
            var s = "";
            i ? (this.label_method.text = game.Tools.strOfLocalization(2163),
            this.label_method.color = "#44b44c",
            s = "createWechatNativeOrder") : (this.label_method.text = game.Tools.strOfLocalization(2164),
            this.label_method.color = "#00a9ec",
            s = "createAlipayScanOrder"),
            app.NetAgent.sendReq2Lobby("Lobby", s, {
                goods_id: e,
                client_type: 0,
                account_id: GameMgr.Inst.account_id
            }, function(e, i) {
                if (n.me.visible && a == n.id)
                    if (e || i.error)
                        t.UIMgr.Inst.showNetReqError(s, e, i),
                        n.close();
                    else {
                        app.Log.log(s + " " + JSON.stringify(i)),
                        n.order_id = i.order_id;
                        var r = i.qrcode_buffer;
                        GameMgr.inConch,
                        Laya.loader.load(r, Laya.Handler.create(n, function() {
                            a == n.id && n.me.visible ? (n.icon.skin = r,
                            n.loading.visible = !1) : n.release_code(r)
                        }))
                    }
            })
        }
        ,
        e.prototype.release_code = function(t) {
            var e = Laya.loader.getRes(t);
            e && e.destroy()
        }
        ,
        e.prototype.close = function() {
            var e = this;
            app.Log.log("wxcode close"),
            this.locking = !0,
            this.order_id = "",
            t.UIBase.anim_pop_hide(this.root, Laya.Handler.create(this, function() {
                e.me.visible = !1,
                e.locking = !1,
                "" != e.icon.skin && (e.release_code(e.icon.skin),
                e.icon.skin = "")
            }))
        }
        ,
        e
    }()
      , a = function() {
        function e(e) {
            var i = this;
            this.me = e,
            this.root = e.getChildByName("root"),
            this.label_title = this.root.getChildByName("title"),
            this.label_price = this.root.getChildByName("price");
            var a = this.root.getChildByName("lst")
              , r = a.getChildByName("wx")
              , s = a.getChildByName("alipay")
              , o = a.getChildByName("alipay_code");
            r.clickHandler = Laya.Handler.create(this, function() {
                i.locking || (i.close(null),
                GameMgr.inChina && (GameMgr.inConch ? (c.Inst.container_loading.visible = !0,
                app.NetAgent.sendReq2Lobby("Lobby", "createWechatAppOrder", {
                    goods_id: i.goods_id,
                    client_type: 0,
                    account_id: GameMgr.Inst.account_id
                }, function(e, i) {
                    if (c.Inst.container_loading.visible = !1,
                    e || i.error)
                        t.UIMgr.Inst.showNetReqError("createWechatAppOrder", e, i);
                    else {
                        var n = i.call_wechat_app_param;
                        Laya.PlatformClass.createClass("layaair.majsoul.mjmgr").call("onWechatAppOrder", n.appid, n.partnerid, n.prepayid, n.package, n.noncestr, n.timestamp, n.sign)
                    }
                })) : GameMgr.iniOSWebview ? (c.Inst.container_loading.visible = !0,
                app.NetAgent.sendReq2Lobby("Lobby", "createWechatAppOrder", {
                    goods_id: i.goods_id,
                    client_type: 0,
                    account_id: GameMgr.Inst.account_id
                }, function(e, i) {
                    if (c.Inst.container_loading.visible = !1,
                    e || i.error)
                        t.UIMgr.Inst.showNetReqError("createWechatAppOrder", e, i);
                    else {
                        var n = i.call_wechat_app_param
                          , a = n.partnerid + "," + n.prepayid + "," + n.package + "," + n.noncestr + "," + n.timestamp + "," + n.sign;
                        Laya.Browser.window.wkbridge.callNative("wxpay", a, function() {})
                    }
                })) : n.Inst.show(i.goods_id, !0)))
            }, null, !1),
            s.clickHandler = Laya.Handler.create(this, function() {
                if (!i.locking && (i.close(null),
                GameMgr.inChina))
                    if (c.Inst.container_loading.visible = !0,
                    1 == c.alipay_type)
                        app.NetAgent.sendReq2Lobby("Lobby", "createAlipayScanOrder", {
                            goods_id: i.goods_id,
                            client_type: 0,
                            account_id: GameMgr.Inst.account_id
                        }, function(e, i) {
                            if (c.Inst.container_loading.visible = !1,
                            e || i.error)
                                t.UIMgr.Inst.showNetReqError("createAlipayScanOrder", e, i);
                            else {
                                var n = i.qr_code;
                                if (GameMgr.inConch) {
                                    Laya.PlatformClass.createClass("layaair.majsoul.mjmgr").call("onAlipay_Brower", n)
                                } else
                                    GameMgr.iniOSWebview ? Laya.Browser.window.wkbridge.callNative("alipay_brower", n, function() {}) : Laya.Browser.window.location.href = n
                            }
                        });
                    else {
                        var e = "";
                        e = GameMgr.inConch || GameMgr.iniOSWebview ? "APP" : Laya.Browser.onPC ? "PC_WEB" : "MOBILE_WEB",
                        app.NetAgent.sendReq2Lobby("Lobby", "createAlipayOrder", {
                            goods_id: i.goods_id,
                            client_type: 0,
                            account_id: GameMgr.Inst.account_id,
                            alipay_trade_type: e,
                            return_url: "Yo://CloseWindow"
                        }, function(e, i) {
                            if (c.Inst.container_loading.visible = !1,
                            e || i.error)
                                t.UIMgr.Inst.showNetReqError("createAlipayOrder", e, i);
                            else {
                                var n = i.alipay_url;
                                if (GameMgr.inConch) {
                                    a = n.split("?");
                                    Laya.PlatformClass.createClass("layaair.majsoul.mjmgr").call("onAlipay", a[a.length - 1])
                                } else if (GameMgr.iniOSWebview) {
                                    var a = n.split("?");
                                    Laya.Browser.window.wkbridge.callNative("alipay", a[a.length - 1], function() {})
                                } else
                                    Laya.Browser.window.location.href = n
                            }
                        })
                    }
            }, null, !1),
            o.clickHandler = Laya.Handler.create(this, function() {
                i.locking || (i.close(null),
                GameMgr.inChina && n.Inst.show(i.goods_id, !1))
            }, null, !1),
            this.root.getChildByName("btn_close").clickHandler = Laya.Handler.create(this, function() {
                i.locking || i.close(null)
            }, null, !1)
        }
        return e.prototype.show = function(e, i) {
            var n = this;
            this.goods_id = e;
            var a = cfg.mall.goods.get(e);
            this.label_title.text = a.name,
            this.label_price.text = a.price,
            i || (i = ""),
            this.root.getChildByName("extendinfo").text = i,
            this.locking = !0,
            this.me.visible = !0,
            t.UIBase.anim_pop_out(this.root, Laya.Handler.create(this, function() {
                n.locking = !1
            }));
            var r = this.root.getChildByName("lst")
              , s = r.getChildByName("wx")
              , o = r.getChildByName("alipay")
              , l = r.getChildByName("alipay_code")
              , h = [];
            if (c.open_wx && (GameMgr.inConch || GameMgr.iniOSWebview || Laya.Browser.onPC) ? (s.visible = !0,
            h.push(s)) : s.visible = !1,
            c.open_alipay ? (1 == c.alipay_type ? GameMgr.inConch || GameMgr.iniOSWebview || !Laya.Browser.onPC ? (o.visible = !0,
            h.push(o)) : o.visible = !1 : (o.visible = !0,
            h.push(o)),
            1 == c.alipay_type ? (l.visible = !0,
            h.push(l)) : l.visible = !1) : (o.visible = !1,
            l.visible = !1),
            r.vScrollBarSkin = "",
            h.length <= 2)
                for (u = 0; u < h.length; u++)
                    h[u].y = 50 + 144 * u;
            else
                for (var u = 0; u < h.length; u++)
                    h[u].y = 144 * u;
            r.vScrollBar.value = 0,
            r.refresh()
        }
        ,
        e.prototype.close = function(e) {
            var i = this;
            this.locking = !0,
            t.UIBase.anim_pop_hide(this.root, Laya.Handler.create(this, function() {
                i.locking = !1,
                i.me.visible = !1,
                e && e.run()
            }))
        }
        ,
        e
    }()
      , r = function() {
        function e(t) {
            var e = this;
            this.pay_types = [],
            this.current_goods_id = 0,
            this._en_card_ = null,
            this._adyen_date = {},
            this._adyen_btn_confirm = null,
            this._adyen_btn_cancel = null,
            this.me = t,
            this.me.visible = !1,
            this.root = t.getChildByName("root"),
            this.root.getChildByName("btn_close").clickHandler = new Laya.Handler(this,function() {
                e.locking || e.close()
            }
            ),
            this.label_item_name = this.root.getChildByName("item_name"),
            this.label_price = this.root.getChildByName("price"),
            this.label_vip = this.root.getChildByName("vip"),
            this.label_extendinfo = this.root.getChildByName("extendinfo"),
            this.scroll_view = this.root.scriptMap["capsui.CScrollView"],
            this.scroll_view.init_scrollview(new Laya.Handler(this,this.render_item)),
            this.pay_types = [],
            "jp" == GameMgr.client_language ? this.pay_types = ["CreditCard", "Paypal", "Au", "Docomo", "Softbank"] : "en" == GameMgr.client_language && (this.pay_types = ["Paypal", "MasterCard", "Visa", "JCB", "Alipay"])
        }
        return e.prototype.show = function(e, i) {
            var n = this;
            this.current_goods_id = e;
            var a = cfg.mall.goods.get(e);
            a && (this.label_item_name.text = a.name,
            this.label_price.text = a.price,
            this.label_vip.text = a.vip_exp.toString(),
            i || (i = ""),
            this.label_extendinfo.text = i,
            this.scroll_view.reset(),
            this.scroll_view.addItem(this.pay_types.length),
            this.locking = !0,
            this.me.visible = !0,
            t.UIBase.anim_pop_out(this.root, Laya.Handler.create(this, function() {
                n.locking = !1
            })))
        }
        ,
        e.prototype.render_item = function(t) {
            var e = this
              , i = t.index
              , n = t.container;
            n.getChildByName("btn").clickHandler = Laya.Handler.create(this, function() {
                e.onClickAtPay(e.pay_types[i])
            }, null, !1);
            var a = this.pay_types[i];
            if ("jp" == GameMgr.client_language)
                switch (a) {
                case "CreditCard":
                    a = "クレジットカード";
                    break;
                case "Paypal":
                    a = "Paypal(ペイパル）";
                    break;
                case "Au":
                    a = "auかんたん決済";
                    break;
                case "Docomo":
                    a = "ドコモ払い";
                    break;
                case "Softbank":
                    a = "ソフトバンクまとめて支払い"
                }
            n.getChildByName("btn").getChildByName("name").text = a
        }
        ,
        e.prototype.onClickAtPay = function(e) {
            var i = this;
            if ("jp" == GameMgr.client_language)
                "CreditCard" == e ? (this.close(),
                c.Inst.page_creditcard.show(this.current_goods_id)) : "Paypal" != e && "Au" != e && "Docomo" != e && "Softbank" != e || (c.Inst.container_loading.visible = !0,
                app.NetAgent.sendReq2Lobby("Lobby", "createJP" + e + "Order", {
                    goods_id: this.current_goods_id,
                    client_type: 0,
                    account_id: GameMgr.Inst.account_id,
                    return_url: "Yo://CloseWindow",
                    access_token: GameMgr.Inst.yostar_accessToken
                }, function(n, a) {
                    if (app.PlayerBehaviorStatistic.fb_trace_force(app.EBehaviorType.Purchase_Click),
                    n || a.error) {
                        if (n)
                            t.UIMgr.Inst.showNetReqError("createJP" + e + "Order", n, a);
                        else if (1991 == a.error.code)
                            t.UI_Agepending.Inst.show();
                        else if (1992 == a.error.code) {
                            var r = JSON.parse(a.error.json_param);
                            t.UI_Agexiane.Inst.show(r.recharged, r.age)
                        } else
                            t.UIMgr.Inst.showNetReqError("createJP" + e + "Order", n, a);
                        c.Inst.container_loading.visible = !1
                    } else {
                        var s = {};
                        s.type = e,
                        s.lang = "ja",
                        s.accessToken = GameMgr.Inst.yostar_accessToken,
                        s.orderId = a.order_id,
                        "Paypal" == e ? s.itemName = cfg.mall.goods.get(i.current_goods_id).name : "Au" == e && (s.itemName = game.Tools.ToDBC(cfg.mall.goods.get(i.current_goods_id).name)),
                        s.openNewWindow = !0,
                        Yo.execOrder(s),
                        c.Inst.container_loading.visible = !1
                    }
                }));
            else if ("Paypal" == e)
                c.Inst.container_loading.visible = !0,
                app.NetAgent.sendReq2Lobby("Lobby", "createENPaypalOrder", {
                    goods_id: this.current_goods_id,
                    client_type: 0,
                    account_id: GameMgr.Inst.account_id,
                    return_url: "Yo://CloseWindow",
                    access_token: GameMgr.Inst.yostar_accessToken
                }, function(i, n) {
                    if (app.PlayerBehaviorStatistic.fb_trace_force(app.EBehaviorType.Purchase_Click),
                    i || n.error)
                        t.UIMgr.Inst.showNetReqError("createENPaypalOrder", i, n),
                        c.Inst.container_loading.visible = !1;
                    else {
                        var a = {};
                        a.type = e,
                        a.lang = "en",
                        a.accessToken = GameMgr.Inst.yostar_accessToken,
                        a.orderId = n.order_id,
                        a.openNewWindow = !0,
                        Yo.execOrder(a),
                        c.Inst.container_loading.visible = !1
                    }
                });
            else if ("Alipay" == e)
                c.Inst.container_loading.visible = !0,
                app.NetAgent.sendReq2Lobby("Lobby", "createENAlipayOrder", {
                    goods_id: this.current_goods_id,
                    client_type: 0,
                    account_id: GameMgr.Inst.account_id,
                    return_url: "Yo://CloseWindow",
                    access_token: GameMgr.Inst.yostar_accessToken
                }, function(e, i) {
                    if (app.PlayerBehaviorStatistic.fb_trace_force(app.EBehaviorType.Purchase_Click),
                    e || i.error)
                        t.UIMgr.Inst.showNetReqError("createENAlipayOrder", e, i),
                        c.Inst.container_loading.visible = !1;
                    else {
                        var n = {};
                        n.type = "Adyen.Alipay",
                        n.lang = "en",
                        n.accessToken = GameMgr.Inst.yostar_accessToken,
                        n.orderId = i.order_id,
                        n.openNewWindow = !0,
                        Yo.execOrder(n),
                        c.Inst.container_loading.visible = !1
                    }
                });
            else if ("MasterCard" == e || "Visa" == e || "JCB" == e) {
                if (c.Inst.container_loading.visible = !0,
                null == this._en_card_) {
                    var n = GameMgr.Inst.link_url;
                    "/" == n[n.length - 1] && (n = n.substr(0, n.length - 1));
                    Yo.generateOriginKey({
                        originDomain: n
                    }, function(t, e) {
                        if (t)
                            console.error(t);
                        else {
                            var a = {
                                locale: "en_US",
                                originKey: e.originKeys[n],
                                loadingContext: "https://checkoutshopper-live.adyen.com/checkoutshopper/"
                            }
                              , r = new AdyenCheckout(a)
                              , s = i;
                            s._en_card_ = r.create("card", {
                                onChange: function(t, e) {
                                    if (t.isValid) {
                                        var i = t.data
                                          , n = i.encryptedCardNumber
                                          , a = i.encryptedExpiryMonth
                                          , r = i.encryptedExpiryYear
                                          , o = i.encryptedSecurityCode;
                                        s._adyen_date.encryptedCardNumber = n,
                                        s._adyen_date.encryptedExpiryMonth = a,
                                        s._adyen_date.encryptedExpiryYear = r,
                                        s._adyen_date.encryptedSecurityCode = o,
                                        s._adyen_date.isValid = !0,
                                        s._adyen_btn_confirm.hidden = !1
                                    } else
                                        s._adyen_date.encryptedCardNumber = "",
                                        s._adyen_date.encryptedExpiryMonth = "",
                                        s._adyen_date.encryptedExpiryYear = "",
                                        s._adyen_date.encryptedSecurityCode = "",
                                        s._adyen_date.isValid = !1,
                                        s._adyen_btn_confirm.hidden = !0
                                }
                            }).mount("#card"),
                            document.getElementById("container_card").hidden = !1
                        }
                    })
                } else
                    document.getElementById("container_card").hidden = !1;
                if (null == this._adyen_btn_confirm) {
                    this._adyen_btn_confirm = document.getElementById("card_confirm"),
                    this._adyen_btn_cancel = document.getElementById("card_cancel");
                    var a = this;
                    this._adyen_btn_cancel.innerText = "Cancel",
                    this._adyen_btn_cancel.onclick = function() {
                        document.getElementById("container_card").hidden = !0,
                        c.Inst.container_loading.visible = !1
                    }
                    ,
                    this._adyen_btn_confirm.innerText = "Ok",
                    this._adyen_btn_confirm.onclick = function() {
                        document.getElementById("container_card").hidden = !0,
                        console.log(JSON.stringify(a._adyen_date)),
                        a._adyen_date.isValid ? app.NetAgent.sendReq2Lobby("Lobby", "createEN" + e + "Order", {
                            goods_id: i.current_goods_id,
                            client_type: 0,
                            account_id: GameMgr.Inst.account_id,
                            return_url: "Yo://CloseWindow",
                            access_token: GameMgr.Inst.yostar_accessToken
                        }, function(i, n) {
                            if (app.PlayerBehaviorStatistic.fb_trace_force(app.EBehaviorType.Purchase_Click),
                            i || n.error)
                                t.UIMgr.Inst.showNetReqError("createEN" + e + "Order", i, n),
                                c.Inst.container_loading.visible = !1;
                            else {
                                var r = {};
                                r.type = "Adyen.CreditCard",
                                r.lang = "en",
                                r.accessToken = GameMgr.Inst.yostar_accessToken,
                                r.orderId = n.order_id,
                                r.encryptedCardNumber = a._adyen_date.encryptedCardNumber,
                                r.encryptedExpiryMonth = a._adyen_date.encryptedExpiryMonth,
                                r.encryptedExpiryYear = a._adyen_date.encryptedExpiryYear,
                                r.encryptedSecurityCode = a._adyen_date.encryptedSecurityCode,
                                r.openNewWindow = !0,
                                Yo.execOrder(r),
                                c.Inst.container_loading.visible = !1
                            }
                        }) : c.Inst.container_loading.visible = !1
                    }
                    ,
                    this._adyen_btn_confirm.hidden = !0
                }
            }
        }
        ,
        e.prototype.close = function() {
            var e = this;
            this.locking = !0,
            t.UIBase.anim_pop_hide(this.root, Laya.Handler.create(this, function() {
                e.locking = !1,
                e.me.visible = !1
            }))
        }
        ,
        e
    }()
      , s = function() {
        function t(t, e, i, n, a) {
            var r = this;
            this.isopen = !1,
            this.locking = !1,
            this.showed = !1,
            this.when_close = null,
            this.when_choose = null,
            this.datas = [],
            this.start_rate = 0,
            this.me = t,
            t.visible = !1,
            this.isopen = !1,
            this.locking = !1,
            this.when_close = e,
            this.when_choose = i,
            this.datas = n,
            this.start_rate = a,
            this.scrollview = this.me.scriptMap["capsui.CScrollView"],
            this.scrollview.init_scrollview(new Laya.Handler(this,this.refresh_item)),
            this.bg = this.me.getChildByName("bg"),
            this.content = this.me.getChildByName("content"),
            t.getChildByName("btn_open").clickHandler = new Laya.Handler(this,function() {
                r.locking || (r.isopen ? r.close() : r.show())
            }
            )
        }
        return t.prototype.reset = function() {
            this.isopen = !1,
            this.locking = !1,
            this.me.visible = !0,
            this.bg.visible = !1,
            this.content.visible = !1
        }
        ,
        t.prototype.show = function() {
            var t = this;
            this.locking = !0,
            this.isopen = !0,
            this.bg.visible = !0,
            this.bg.height = 10,
            Laya.Tween.to(this.bg, {
                height: 385
            }, 150, Laya.Ease.linearNone),
            this.content.visible = !0,
            this.content.alpha = 0,
            Laya.Tween.to(this.content, {
                alpha: 1
            }, 150, Laya.Ease.linearNone),
            Laya.timer.once(150, this, function() {
                t.locking = !1
            }),
            this.showed || (this.scrollview.reset(),
            this.scrollview.addItem(this.datas.length),
            this.showed = !0,
            this.scrollview.rate = this.start_rate)
        }
        ,
        t.prototype.refresh_item = function(t) {
            var e = this
              , i = t.index
              , n = t.container;
            n.getChildByName("btn").clickHandler = Laya.Handler.create(this, function() {
                e.locking || (e.close(),
                e.when_choose && e.when_choose.runWith(e.datas[i]))
            }, null, !1),
            n.getChildByName("btn").getChildByName("txt").text = this.datas[i]
        }
        ,
        t.prototype.close = function() {
            var t = this;
            this.locking = !0,
            Laya.Tween.to(this.content, {
                alpha: 0
            }, 150, Laya.Ease.linearNone),
            Laya.Tween.to(this.bg, {
                height: 10
            }, 150, Laya.Ease.linearNone),
            Laya.timer.once(150, this, function() {
                t.locking = !1,
                t.bg.visible = !1,
                t.content.visible = !1,
                t.isopen = !1,
                t.when_close && t.when_close.run()
            })
        }
        ,
        t
    }()
      , o = function() {
        function t(t, e, i) {
            var n = this;
            this.locking = !1,
            this.me = t,
            t.visible = !1,
            this.me.getChildByName("btn_close").clickHandler = new Laya.Handler(this,function() {
                n.dropdown_mouth.locking || n.dropdown_year.locking || (n.dropdown_mouth.isopen && n.dropdown_mouth.close(),
                n.dropdown_year.isopen && n.dropdown_year.close())
            }
            );
            this.dropdown_mouth = new s(this.me.getChildByName("container_month"),new Laya.Handler(this,function() {
                n._OnStateChange(),
                e.runWith("")
            }
            ),new Laya.Handler(this,function(t) {
                return e.runWith(t)
            }
            ),["01", "02", "03", "04", "05", "06", "07", "08", "09", "10", "11", "12"],0);
            for (var a = new Date(Date.now()), r = [], o = 0; o < 120; o++)
                r.push((a.getFullYear() + o - 30).toString());
            this.dropdown_year = new s(this.me.getChildByName("container_year"),new Laya.Handler(this,function() {
                n._OnStateChange(),
                i.runWith("")
            }
            ),new Laya.Handler(this,function(t) {
                return i.runWith(t)
            }
            ),r,.262)
        }
        return t.prototype.show = function(t) {
            this.dropdown_mouth.reset(),
            this.dropdown_year.reset(),
            this.me.visible = !0,
            t ? this.dropdown_mouth.show() : this.dropdown_year.show()
        }
        ,
        t.prototype._OnStateChange = function() {
            this.dropdown_year.isopen || this.dropdown_mouth.isopen || (this.me.visible = !1)
        }
        ,
        t
    }()
      , l = function() {
        function e(t) {
            var e = this;
            this.locking = !1,
            this.me = t,
            t.visible = !1,
            this.root = this.me.getChildByName("root"),
            this.root.getChildByName("btn_close").clickHandler = new Laya.Handler(this,function() {
                e.locking || e.close()
            }
            ),
            this.root.getChildByName("confirm").clickHandler = new Laya.Handler(this,function() {
                e.locking || e.close()
            }
            )
        }
        return e.prototype.show = function() {
            var e = this;
            this.locking = !0,
            this.me.visible = !0,
            t.UIBase.anim_pop_out(this.root, Laya.Handler.create(this, function() {
                e.locking = !1
            }))
        }
        ,
        e.prototype.close = function() {
            var e = this;
            this.locking = !0,
            t.UIBase.anim_pop_hide(this.root, Laya.Handler.create(this, function() {
                e.locking = !1,
                e.me.visible = !1
            }))
        }
        ,
        e
    }()
      , h = function() {
        function e(t) {
            var e = this;
            this.color_wrong = "#FF3030",
            this.color_hint = "#5A82C8",
            this.locking = !1,
            this.current_goodsID = 0,
            this.me = t,
            this.me.visible = !1,
            this.root_adyen = this.me.getChildByName("root_adyen");
            var i = this.root_adyen.getChildByName("card");
            this.input_cardno = i.getChildByName("input").getChildByName("txtinput"),
            this.cardno_wrong = i.getChildByName("input").getChildByName("wrong"),
            this.cardno_ac = i.getChildByName("input").getChildByName("ac"),
            this.notice_cardno = i.getChildByName("notice"),
            this.card_imgs = i.getChildByName("card_img"),
            this.input_cardno.on("blur", this, function() {
                e.pending_cardno()
            }),
            this.input_cardno.on("input", this, function() {
                e.cardno_wrong.visible && (e.cardno_wrong.visible = !1),
                e.code_ac.visible && (e.code_ac.visible = !1)
            });
            var n = this.root_adyen.getChildByName("date");
            this.btn_month = n.getChildByName("month"),
            this.btn_month.clickHandler = new Laya.Handler(this,function() {
                e.locking || e.date_dropdown.show(!0)
            }
            ),
            this.txt_month = this.btn_month.getChildByName("txt"),
            this.notice_month = n.getChildByName("notice_month"),
            this.btn_year = n.getChildByName("year"),
            this.btn_year.clickHandler = new Laya.Handler(this,function() {
                e.locking || e.date_dropdown.show(!1)
            }
            ),
            this.txt_year = this.btn_year.getChildByName("txt"),
            this.notice_year = n.getChildByName("notice_year");
            var a = this.root_adyen.getChildByName("code");
            this.input_code = a.getChildByName("input").getChildByName("txtinput"),
            this.code_wrong = a.getChildByName("input").getChildByName("wrong"),
            this.code_ac = a.getChildByName("input").getChildByName("ac"),
            this.notice_code = a.getChildByName("notice"),
            this.input_code.on("blur", this, function() {
                e.pending_code()
            }),
            this.input_code.on("input", this, function() {
                e.code_wrong.visible && (e.code_wrong.visible = !1),
                e.code_ac.visible && (e.code_ac.visible = !1)
            }),
            a.getChildByName("btn_what").clickHandler = new Laya.Handler(this,function() {
                e.locking || e.contianer_cardnumber_hint.show()
            }
            ),
            this.root_adyen.getChildByName("paybutton").clickHandler = new Laya.Handler(this,function() {
                e.locking || e.onClickConfirm()
            }
            ),
            this.root_adyen.getChildByName("btn_close").clickHandler = new Laya.Handler(this,function() {
                e.locking || e.close()
            }
            ),
            this.contianer_cardnumber_hint = new l(this.me.getChildByName("container_cardnumber")),
            this.date_dropdown = new o(this.me.getChildByName("container_dropdown"),new Laya.Handler(this,function(t) {
                "" != t && (e.txt_month.text = t),
                e.pending_month()
            }
            ),new Laya.Handler(this,function(t) {
                "" != t && (e.txt_year.text = t),
                e.pending_year()
            }
            ))
        }
        return e.prototype.show = function(e) {
            var i = this;
            this.me.visible = !0,
            this.locking = !0,
            this.current_goodsID = e,
            this.date_dropdown.me.visible = !1,
            this.contianer_cardnumber_hint.me.visible = !1,
            t.UIBase.anim_pop_out(this.root_adyen, Laya.Handler.create(this, function() {
                i.locking = !1
            })),
            this.txt_month.text = game.Tools.strOfLocalization(2729),
            this.txt_year.text = game.Tools.strOfLocalization(2730),
            this.input_cardno.text = "",
            this.input_code.text = "",
            this.notice_cardno.text = game.Tools.strOfLocalization(2726),
            this.notice_cardno.color = this.color_hint,
            this.notice_month.text = game.Tools.strOfLocalization(2731),
            this.notice_month.color = this.color_hint,
            this.notice_year.text = game.Tools.strOfLocalization(2732),
            this.notice_year.color = this.color_hint,
            this.notice_code.text = game.Tools.strOfLocalization(2736),
            this.notice_code.color = this.color_hint,
            this.cardno_wrong.visible = !1,
            this.card_imgs.visible = !1,
            this.cardno_ac.visible = !1,
            this.code_wrong.visible = !1,
            this.code_ac.visible = !1
        }
        ,
        e.prototype.pending_Luhn = function(t) {
            for (var e = 0, i = "0".charCodeAt(0), n = 0; n < t.length; n += 2)
                e += t.charCodeAt(t.length - n - 1) - i;
            for (n = 1; n < t.length; n += 2) {
                var a = 2 * (t.charCodeAt(t.length - n - 1) - i);
                e += a <= 9 ? a : a - 9
            }
            return e % 10 == 0
        }
        ,
        e.prototype.isValidCreditCard = function(t) {
            var e = this.pending_Luhn(t)
              , i = parseInt(t.substr(0, 2))
              , n = (parseInt(t.substr(0, 3)),
            parseInt(t.substr(0, 4)))
              , a = (parseInt(t.substr(0, 5)),
            parseInt(t.substr(0, 6)));
            if (15 == t.length && (34 == i || 37 == i) && e)
                return "amex";
            if (16 == t.length && n >= 3528 && n <= 3589 && e)
                return "jcb";
            if (16 == t.length) {
                if (a >= 51e4 && a <= 559999 && e)
                    return "mastercard";
                if (n >= 2221 && n <= 2720 && e)
                    return "mastercard"
            }
            if (14 == t.length) {
                if (a >= 3e5 && a <= 303574 && e)
                    return "diner";
                if (3095 == n)
                    return "diner";
                if (36 == i)
                    return "diner";
                if (i >= 38 && i <= 39)
                    return "diner"
            }
            return "4" != t.charAt(0) || 13 != t.length && 16 != t.length || !e ? "" : "visa"
        }
        ,
        e.prototype.pending_cardno = function() {
            if (this.input_cardno.text.length >= 13 && this.input_cardno.text.length <= 19) {
                var t = this.isValidCreditCard(this.input_cardno.text);
                if ("" != t) {
                    this.cardno_wrong.visible = !1,
                    this.notice_cardno.text = "",
                    this.cardno_ac.visible = !0,
                    this.card_imgs.visible = !0;
                    for (var e = 0; e < this.card_imgs.numChildren; e++) {
                        var i = this.card_imgs.getChildAt(e);
                        i.visible = i.name == t
                    }
                    return !0
                }
                return this.cardno_wrong.visible = !0,
                this.cardno_ac.visible = !1,
                this.notice_cardno.text = "",
                this.notice_cardno.color = this.color_wrong,
                this.card_imgs.visible = !1,
                !1
            }
            return this.cardno_wrong.visible = !0,
            this.cardno_ac.visible = !1,
            this.notice_cardno.text = game.Tools.strOfLocalization(2727),
            this.notice_cardno.color = this.color_wrong,
            this.card_imgs.visible = !1,
            !1
        }
        ,
        e.prototype.pending_month = function() {
            return this.txt_month.text != game.Tools.strOfLocalization(2729) ? (this.notice_month.text = "",
            !0) : (this.notice_month.text = game.Tools.strOfLocalization(2733),
            this.notice_month.color = this.color_wrong,
            !1)
        }
        ,
        e.prototype.pending_year = function() {
            return this.txt_year.text != game.Tools.strOfLocalization(2730) ? (this.notice_year.text = "",
            !0) : (this.notice_year.text = game.Tools.strOfLocalization(2734),
            this.notice_year.color = this.color_wrong,
            !1)
        }
        ,
        e.prototype.pending_code = function() {
            return this.input_code.text.length >= 3 && this.input_code.text.length <= 4 ? (this.notice_code.text = "",
            this.code_wrong.visible = !1,
            this.code_ac.visible = !0,
            !0) : (this.code_wrong.visible = !0,
            this.code_ac.visible = !1,
            this.notice_code.text = game.Tools.strOfLocalization(2737),
            this.notice_code.color = this.color_wrong,
            !1)
        }
        ,
        e.prototype.onClickConfirm = function() {
            var e = !0;
            if (this.pending_cardno() || (e = !1),
            this.pending_month() || (e = !1),
            this.pending_year() || (e = !1),
            this.pending_code() || (e = !1),
            e) {
                this.close(),
                c.Inst.container_loading.visible = !0;
                var i = this.input_cardno.text
                  , n = this.current_goodsID;
                window.Multipayment.init("9200000213740"),
                Multipayment.getToken({
                    cardno: this.input_cardno.text,
                    expire: this.txt_year.text + this.txt_month.text,
                    securitycode: this.input_code.text
                }, function(e) {
                    if ("000" != e.resultCode)
                        !function(e) {
                            t.UIMgr.Inst.ShowErrorInfo(game.Tools.strOfLocalization(e)),
                            c.Inst.container_loading.visible = !1
                        }(2742);
                    else {
                        var a = e.tokenObject;
                        app.NetAgent.sendReq2Lobby("Lobby", "createJPCreditCardOrder", {
                            goods_id: n,
                            client_type: 0,
                            account_id: GameMgr.Inst.account_id,
                            return_url: "Yo://CloseWindow",
                            access_token: GameMgr.Inst.yostar_accessToken
                        }, function(e, n) {
                            if (app.PlayerBehaviorStatistic.fb_trace_force(app.EBehaviorType.Purchase_Click),
                            e || n.error)
                                if (e)
                                    t.UIMgr.Inst.showNetReqError("createJPCreditCardOrder", e, n);
                                else if (1991 == n.error.code)
                                    t.UI_Agepending.Inst.show();
                                else if (1992 == n.error.code) {
                                    var r = JSON.parse(n.error.json_param);
                                    t.UI_Agexiane.Inst.show(r.recharged, r.age)
                                } else
                                    t.UIMgr.Inst.showNetReqError("createJPCreditCardOrder", e, n);
                            else {
                                var s = {};
                                s.type = "CreditCard",
                                s.lang = "ja",
                                s.accessToken = GameMgr.Inst.yostar_accessToken,
                                s.token = a.token,
                                s.orderId = n.order_id,
                                s.cardNo = i,
                                s.openNewWindow = !0,
                                Yo.execOrder(s),
                                c.Inst.container_loading.visible = !1
                            }
                        })
                    }
                })
            }
        }
        ,
        e.prototype.close = function() {
            var e = this;
            this.locking = !0,
            t.UIBase.anim_pop_hide(this.root_adyen, Laya.Handler.create(this, function() {
                e.locking = !1,
                e.me.visible = !1
            }))
        }
        ,
        e
    }()
      , c = function(s) {
        function o() {
            var t = s.call(this, new ui.lobby.rechargeUI) || this;
            return t.money = null,
            t.tabs = [],
            t.locking = !1,
            t.goods_sheleve_id = "",
            t.tab_index = -1,
            t.items = [],
            t.app_shop = null,
            t.tab_infos = [],
            o.Inst = t,
            t
        }
        return __extends(o, s),
        o.init = function() {
            var t = this;
            if (this.vip_reward_getted = null,
            app.NetAgent.sendReq2Lobby("Lobby", "fetchVipReward", {}, function(e, i) {
                if (e || i.error)
                    ;
                else if (t.vip_reward_getted = {},
                i.gained_vip_levels)
                    for (var n = 0; n < i.gained_vip_levels.length; n++)
                        t.vip_reward_getted[i.gained_vip_levels[n]] = 1
            }),
            "en" == GameMgr.client_language) {
                (e = document.createElement("link")).rel = "stylesheet",
                e.href = "https://checkoutshopper-live.adyen.com/checkoutshopper/sdk/2.1.0/adyen.css";
                (i = document.getElementsByTagName("head")[0]).appendChild(e);
                (e = document.createElement("link")).rel = "stylesheet",
                e.href = game.ResourceVersion.formatURL("css/adyen_custom.css");
                (i = document.getElementsByTagName("head")[0]).appendChild(e);
                (e = document.createElement("script")).src = "https://checkoutshopper-live.adyen.com/checkoutshopper/sdk/2.1.0/adyen.js";
                (i = document.getElementsByTagName("script")[0]).parentNode.insertBefore(e, i)
            } else if ("jp" == GameMgr.client_language) {
                var e = document.createElement("script");
                e.src = "https://p01.mul-pay.jp/ext/js/token.js";
                var i = document.getElementsByTagName("script")[0];
                i.parentNode.insertBefore(e, i)
            }
        }
        ,
        o.on_new_recharge_refresh = function(e) {
            if (e.new_recharged_list) {
                for (var i = 0; i < e.new_recharged_list.length; i++)
                    t.UI_Recharge.new_recharge_list[e.new_recharged_list[i]] = 1;
                this.Inst && this.Inst.enable && this.Inst.scrollview.wantToRefreshAll()
            }
        }
        ,
        o.prototype.onCreate = function() {
            var s = this;
            this.container_top = this.me.getChildByName("top"),
            this.container_top.getChildByName("btn_back").clickHandler = Laya.Handler.create(this, function() {
                s.locking || s.close(Laya.Handler.create(s, function() {
                    t.UI_Lobby.Inst.enable = !0
                }))
            }, null, !1),
            this.money = new t.UI_Money(this.container_top,null,Laya.Handler.create(this, function() {
                return s.locking
            }, null, !1)),
            this.container_content = this.me.getChildByName("content"),
            this.container_tab = this.container_content.getChildByName("tabs"),
            this.tabs = [];
            for (var o = function(t) {
                var e = l.container_tab.getChildAt(t);
                l.tabs.push(e),
                e.clickHandler = Laya.Handler.create(l, function() {
                    s.tab_index != t && s.change_tab(t)
                }, null, !1)
            }, l = this, c = 0; c < this.container_tab.numChildren; c++)
                o(c);
            var u = this.container_content.getChildByName("right");
            this.container_right = u,
            this.scrollview = u.scriptMap["capsui.CScrollView"],
            this.scrollview.init_scrollview(Laya.Handler.create(this, this.render_good_shelves, null, !1), -1, 4),
            this.page_vip = new i(this.container_content.getChildByName("page_vip")),
            this.buy_single = new e(this.me.getChildByName("pop_buy_single")),
            this.container_loading = this.me.getChildByName("container_loading"),
            this.container_loading.visible = !1,
            GameMgr.inConch && GameMgr.inGooglePlay && (this.app_shop = new game.GooglePlayShop,
            this.app_shop.onGameStart()),
            this.page_wxcode = new n(this.me.getChildByName("wxcode")),
            this.page_wxcode.me.visible = !1,
            this.page_choose = new a(this.me.getChildByName("choose_method")),
            this.page_choose.me.visible = !1,
            this.page_choose_en = new r(this.me.getChildByName("choose_method_en")),
            this.page_choose_en.me.visible = !1,
            this.page_creditcard = new h(this.me.getChildByName("container_creditcard"))
        }
        ,
        o.prototype.show = function(e) {
            var i = this;
            this.enable = !0,
            this.locking = !0,
            game.Scene_Lobby.Inst.change_bg("indoor", !1),
            t.UIBase.anim_alpha_in(this.container_top, {
                y: -30
            }, 150),
            t.UIBase.anim_alpha_in(this.container_content, {
                y: 30
            }, 150),
            this.money.onEnable(),
            Laya.timer.once(150, this, function() {
                i.locking = !1
            }),
            this.tab_infos = [],
            GameMgr.config_data.goods_sheleve_id && "" != GameMgr.config_data.goods_sheleve_id && o.open_payment && ("chs" == GameMgr.client_language ? this.goods_sheleve_id = "shelves_001" : "jp" == GameMgr.client_language ? this.goods_sheleve_id = "shelves_002" : "en" == GameMgr.client_language && (this.goods_sheleve_id = "shelves_003"),
            this.tab_infos.push("huiyu")),
            this.tab_infos.push("tongbi"),
            "chs" == GameMgr.client_language && this.tab_infos.push("huishi"),
            this.tab_infos.push("vip");
            for (var n = 0; n < this.tabs.length; n++)
                if (n < this.tab_infos.length)
                    switch (this.tabs[n].visible = !0,
                    this.tab_infos[n]) {
                    case "huiyu":
                        this.tabs[n].getChildByName("label_name").text = game.Tools.strOfLocalization(2165);
                        break;
                    case "tongbi":
                        this.tabs[n].getChildByName("label_name").text = game.Tools.strOfLocalization(2166);
                        break;
                    case "huishi":
                        this.tabs[n].getChildByName("label_name").text = game.Tools.strOfLocalization(2201);
                        break;
                    case "vip":
                        this.tabs[n].getChildByName("label_name").text = game.Tools.strOfLocalization(2167)
                    }
                else
                    this.tabs[n].visible = !1;
            this.refresh_info(e)
        }
        ,
        o.prototype.close = function(e) {
            var i = this;
            this.locking = !0,
            t.UIBase.anim_alpha_out(this.container_top, {
                y: -30
            }, 150),
            t.UIBase.anim_alpha_out(this.container_content, {
                y: 30
            }, 150),
            Laya.timer.once(150, this, function() {
                i.locking = !1,
                i.enable = !1,
                i.tab_index = -1,
                e.run()
            })
        }
        ,
        o.prototype.refresh_info = function(t) {
            this.buy_single.me.visible = !1;
            for (var e = 0, i = 0; i < this.tab_infos.length; i++)
                if (this.tab_infos[i] == t) {
                    e = i;
                    break
                }
            this.change_tab(e)
        }
        ,
        o.prototype.change_tab = function(t) {
            var e = this;
            this.tab_index = t;
            for (var i = 0; i < this.tabs.length; i++)
                this.tabs[i].skin = game.Tools.localUISrc(t == i ? "myres/shop/tab_choose.png" : "myres/shop/tab_unchoose.png"),
                this.tabs[i].getChildAt(0).color = t == i ? "#d9b263" : "#8cb65f";
            this.container_right.visible = !1,
            this.page_vip.close(),
            this.items = [],
            this.scrollview.reset(),
            "huiyu" == this.tab_infos[t] ? (this.container_right.visible = !0,
            this.scrollview.change_render_handler(Laya.Handler.create(this, this.render_good_shelves, null, !1)),
            cfg.mall.goods_shelves.getGroup(this.goods_sheleve_id).forEach(function(t) {
                e.items.push(t.goods_id)
            }),
            this.scrollview.addItem(this.items.length)) : "tongbi" == this.tab_infos[t] ? (this.container_right.visible = !0,
            this.scrollview.change_render_handler(Laya.Handler.create(this, this.render_recharge, null, !1)),
            cfg.exchange.exchange.forEach(function(t) {
                e.items.push(t.id)
            }),
            this.scrollview.addItem(this.items.length)) : "huishi" == this.tab_infos[t] ? (this.container_right.visible = !0,
            this.scrollview.change_render_handler(Laya.Handler.create(this, this.render_searchexchange, null, !1)),
            cfg.exchange.searchexchange.forEach(function(t) {
                e.items.push(t.id)
            }),
            this.scrollview.addItem(this.items.length)) : "vip" == this.tab_infos[t] && this.page_vip.show()
        }
        ,
        o.prototype.render_recharge = function(t) {
            var e = this
              , i = t.index
              , n = t.container
              , a = cfg.exchange.exchange.get(this.items[i])
              , r = n.getChildByName("btn");
            r.clickHandler = Laya.Handler.create(this, function() {
                e.buy_single.show_exchange(e.items[i])
            }, null, !1),
            r.getChildByName("label_name").text = a["name_" + GameMgr.client_language],
            game.LoadMgr.setImgSkin(r.getChildByName("icon"), a.icon),
            r.filters = [],
            r.getChildByName("buyed").visible = !1,
            r.getChildByName("count").visible = !1;
            var s = r.getChildByName("btn_buy").getChildByName("currency");
            s.visible = !0,
            game.LoadMgr.setImgSkin(s, cfg.item_definition.currency.get(a.source_currency).icon),
            r.getChildByName("btn_buy").getChildByName("label_gold").text = a.source_value.toString(),
            game.Tools.child_align_center(r.getChildByName("btn_buy")),
            r.getChildByName("shouchong").visible = !1,
            r.getChildByName("desc").text = ""
        }
        ,
        o.prototype.render_searchexchange = function(t) {
            var e = this
              , i = t.index
              , n = t.container
              , a = cfg.exchange.searchexchange.get(this.items[i])
              , r = n.getChildByName("btn");
            r.clickHandler = Laya.Handler.create(this, function() {
                e.buy_single.show_searchexchange(e.items[i])
            }, null, !1),
            r.getChildByName("label_name").text = a["name_" + GameMgr.client_language],
            game.LoadMgr.setImgSkin(r.getChildByName("icon"), a.icon),
            r.filters = [],
            r.getChildByName("buyed").visible = !1,
            r.getChildByName("count").visible = !1;
            var s = r.getChildByName("btn_buy").getChildByName("currency");
            s.visible = !0,
            game.LoadMgr.setImgSkin(s, cfg.item_definition.currency.get(a.source_currency).icon),
            r.getChildByName("btn_buy").getChildByName("label_gold").text = a.source_value.toString(),
            game.Tools.child_align_center(r.getChildByName("btn_buy")),
            r.getChildByName("shouchong").visible = !1,
            r.getChildByName("desc").text = ""
        }
        ,
        o.prototype.render_good_shelves = function(e) {
            var i, n = this, a = e.index, r = e.container.getChildByName("btn");
            cfg.mall.goods_shelves.getGroup(this.goods_sheleve_id).forEach(function(t) {
                t.goods_id == n.items[a] && (i = t)
            }),
            r.clickHandler = Laya.Handler.create(this, function() {
                if (n.app_shop && (n.app_shop.recover_pre_order(n.items[a]) ? t.UI_LightTips.Inst.show(game.Tools.strOfLocalization(2168)) : n.buy_single.show_recharge(n.goods_sheleve_id, n.items[a])),
                GameMgr.iniOSWebview)
                    t.UI_Popout.PopOutNoTitle(game.Tools.strOfLocalization(2169), null);
                else if ("chs" == GameMgr.client_language)
                    if (t.UI_ShiMingRenZheng.renzhenged || GameMgr.Inst.player_in_haiwai) {
                        var e = ""
                          , i = "";
                        o.payment_info && "" != o.payment_info && (0 == o.payment_info_show_type && (e = o.payment_info),
                        1 == o.payment_info_show_type && (i = o.payment_info)),
                        e && "" != e ? t.UI_Popout.PopOutNoTitle(e, null) : n.page_choose.show(n.items[a], i)
                    } else
                        t.UI_ShiMingRenZheng.Inst.show();
                else
                    "jp" == GameMgr.client_language ? GameMgr.Inst.account_data.birthday ? n.page_choose_en.show(n.items[a], "") : t.UI_Agepending.Inst.show() : "en" == GameMgr.client_language && n.page_choose_en.show(n.items[a], "")
            }, null, !1);
            var s = cfg.mall.goods.get(this.items[a]);
            r.getChildByName("label_name").text = s.name,
            game.LoadMgr.setImgSkin(r.getChildByName("icon"), s.icon),
            r.filters = [],
            r.getChildByName("buyed").visible = !1,
            r.getChildByName("count").visible = !1,
            r.getChildByName("btn_buy").getChildByName("currency").visible = !1;
            var l = null;
            this.app_shop && (l = this.app_shop.getGoodsInfo(this.items[a])),
            r.getChildByName("btn_buy").getChildByName("label_gold").text = l ? l.price : i.price,
            game.Tools.child_align_center(r.getChildByName("btn_buy")),
            o.new_recharge_list[s.cny] ? (r.getChildByName("shouchong").visible = !1,
            r.getChildByName("desc").text = s.normal_desc,
            r.getChildByName("desc").color = "#f17828") : (r.getChildByName("shouchong").visible = !0,
            r.getChildByName("desc").text = s.first_desc,
            r.getChildByName("desc").color = "#f56aff")
        }
        ,
        o.prototype.want_to_exchange = function(e) {
            app.NetAgent.sendReq2Lobby("Lobby", "exchangeCurrency", {
                id: e
            }, function(e, i) {
                e || i.error ? t.UIMgr.Inst.showNetReqError("exchangeCurrency", e, i) : t.UI_LightTips.Inst.show(game.Tools.strOfLocalization(2191))
            })
        }
        ,
        o.prototype.want_to_searchexchange = function(e) {
            app.NetAgent.sendReq2Lobby("Lobby", "exchangeChestStone", {
                id: e,
                count: 1
            }, function(e, i) {
                e || i.error ? t.UIMgr.Inst.showNetReqError("exchangeChestStone", e, i) : t.UI_LightTips.Inst.show(game.Tools.strOfLocalization(2191))
            })
        }
        ,
        o.prototype.want_to_recharge = function(t) {
            var e = this;
            this.app_shop && (this.container_loading.visible = !0,
            this.app_shop.want2BuyItem(t, Laya.Handler.create(this, function() {
                e.container_loading.visible = !1
            })))
        }
        ,
        o.open_payment = !1,
        o.payment_info_show_type = 1,
        o.payment_info = "",
        o.open_wx = !0,
        o.wx_type = 0,
        o.open_alipay = !0,
        o.alipay_type = 0,
        o.new_recharge_list = {},
        o.vip_reward_getted = null,
        o
    }(t.UIBase);
    t.UI_Recharge = c
}(uiscript || (uiscript = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), uiscript;
!function(t) {
    var e = function(t) {
        function e() {
            var i = t.call(this, new ui.common.reconnectUI) || this;
            return e.Inst = i,
            i
        }
        return __extends(e, t),
        e.prototype.onCreate = function() {
            var t = this;
            this.me.getChildByName("btn_ok").clickHandler = Laya.Handler.create(this, function() {
                t.enable = !1,
                game.MJNetMgr.Inst.OpenConnect(GameMgr.Inst.mj_game_token, GameMgr.Inst.mj_game_uuid, GameMgr.Inst.mj_server_location, !0, null)
            }, null, !1)
        }
        ,
        e.Inst = null,
        e
    }(t.UIBase);
    t.UI_Reconnect = e
}(uiscript || (uiscript = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), uiscript;
!function(t) {
    var e = function(t) {
        function e() {
            var i = t.call(this, new ui.entrance.remind_newUI) || this;
            return i.process = null,
            i._created = !1,
            i._v = 0,
            e.Inst = i,
            i
        }
        return __extends(e, t),
        e.prototype.onCreate = function() {
            this.process = this.me.getChildByName("process"),
            this.process.text = this._v.toString() + "/10",
            this._created = !0
        }
        ,
        e.prototype.setprocess = function(t) {
            this._v = t,
            this._created && (this.process.text = t.toString() + "/10")
        }
        ,
        e.Inst = null,
        e
    }(t.UIBase);
    t.UI_Remind = e
}(uiscript || (uiscript = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), uiscript;
!function(t) {
    var e = function() {
        function e(t) {
            var e = this;
            this.rounds = [],
            this.locking = !1,
            this.enable = !1,
            this.me = t,
            this.me.visible = !1,
            this.scrollview = this.me.scriptMap["capsui.CScrollView"],
            this.scrollview.init_scrollview(Laya.Handler.create(this, this.renderInfo, null, !1)),
            this.btn_up = this.me.getChildByName("up"),
            this.btn_down = this.me.getChildByName("down"),
            this.btn_up.clickHandler = Laya.Handler.create(this, function() {
                e.locking || e.scrollview.scrollDelta(-100)
            }, null, !1),
            this.btn_down.clickHandler = Laya.Handler.create(this, function() {
                e.locking || e.scrollview.scrollDelta(100)
            }, null, !1),
            this.scrollview.me.on("ratechange", this, function() {
                e.btn_up.visible = e.scrollview.rate > 0,
                e.btn_down.visible = e.scrollview.need_scroll && e.scrollview.rate < 1
            }),
            this.enable = !1
        }
        return e.prototype.show = function(e) {
            var i = this;
            this.enable = !0,
            this.locking = !0,
            this.me.visible = !0,
            this.scrollview.reset(),
            this.rounds = e;
            for (var n = 0; n < e.length; n++) {
                var a = this.caluH(e[n]);
                a,
                this.scrollview.addItem(1, a)
            }
            t.UIBase.anim_alpha_in(this.me, {
                y: 30
            }, 120, 0, Laya.Handler.create(this, function() {
                i.locking = !1
            })),
            this.btn_up.visible = !1,
            this.btn_down.visible = this.scrollview.need_scroll
        }
        ,
        e.prototype.close = function() {
            var e = this;
            this.enable = !1,
            this.locking = !0,
            t.UIBase.anim_alpha_out(this.me, {
                y: 30
            }, 120, 0, Laya.Handler.create(this, function() {
                e.locking = !1,
                e.me.visible = !1
            }))
        }
        ,
        e.prototype.caluH = function(t) {
            var e = t.actions[t.actions.length - 1];
            if ("RecordNoTile" == e.name) {
                for (var i = e.data, n = [], a = 0; a < view.DesktopMgr.Inst.player_count; a++)
                    n.push({
                        old_score: i.scores[0].old_scores[a],
                        delta: 0
                    });
                for (a = 0; a < i.scores.length; a++)
                    for (var r = 0; r < view.DesktopMgr.Inst.player_count; r++)
                        n[r].delta += i.scores[a].delta_scores[r];
                for (var s = [], a = 0; a < n.length; a++)
                    n[a].delta > 0 && s.push(a);
                return 120 + (0 == s.length ? 0 : 40 * (s.length - 1))
            }
            return "RecordLiuJu" == e.name ? 120 : e.data.hules[0].zimo ? 120 : 180 + 40 * (e.data.hules.length - 1)
        }
        ,
        e.prototype.renderInfo = function(t) {
            for (var e = this, i = t.index, n = t.container, a = this.rounds[i], s = 0; s < a.actions.length; s++)
                if ("RecordNewRound" == a.actions[s].name) {
                    var o = void 0;
                    o = "chs" == GameMgr.client_language ? ["东", "南", "西", "北"] : "jp" == GameMgr.client_language ? ["東", "南", "西", "北"] : ["East", "South", "West", "North"],
                    n.getChildByName("container_title").getChildByName("chang").text = o[a.actions[s].data.chang % 4],
                    n.getChildByName("container_title").getChildByName("ju").text = (a.actions[s].data.ju + 1).toString(),
                    n.getChildByName("container_title").getChildByName("ben").text = a.actions[s].data.ben.toString();
                    for (var l = 0, h = n.getChildByName("container_title"), c = [3, 3, 50, 3, 0], u = 0; u < h.numChildren; u++) {
                        l += (f = h.getChildAt(u)).textField.textWidth * f.scaleX,
                        l += c[u]
                    }
                    for (var _ = h.width / 2 - l / 2, d = 0; d < h.numChildren; d++) {
                        var f = h.getChildAt(d);
                        f.x = _,
                        _ += f.textField.textWidth * f.scaleX + c[d],
                        "haolong" == f.font ? f.y = 34 : f.y = 31
                    }
                    break
                }
            var p = a.actions[a.actions.length - 1]
              , m = p.data
              , g = n
              , y = n.getChildByName("line")
              , v = n.getChildByName("liuju")
              , b = n.getChildByName("win")
              , x = n.getChildByName("lose");
            if (y.visible = !1,
            v.visible = !1,
            b.visible = !1,
            x.visible = !1,
            "RecordNoTile" == p.name) {
                for (var w = [], s = 0; s < view.DesktopMgr.Inst.player_count; s++)
                    w.push({
                        old_score: m.scores[0].old_scores[s],
                        delta: 0
                    });
                for (s = 0; s < m.scores.length; s++)
                    for (L = 0; L < view.DesktopMgr.Inst.player_count; L++)
                        w[L].delta += m.scores[s].delta_scores[L];
                for (var C = [], s = 0; s < w.length; s++)
                    w[s].delta > 0 && C.push(s);
                if (g.height = 120 + (0 == C.length ? 0 : 40 * (C.length - 1)),
                m.liujumanguan) {
                    b.visible = !0;
                    (T = b.getChildByName("info")).text = game.Tools.strOfLocalization(2170),
                    T.color = "#8d8fac";
                    for (var I = b.getChildByName("player"), s = 0; s < I.numChildren; s++) {
                        M = I.getChildAt(s);
                        s < C.length ? (M.visible = !0,
                        M.getChildByName("name").text = view.DesktopMgr.Inst.getPlayerName(C[s]),
                        M.getChildByName("point").text = "+" + w[C[s]].delta.toString()) : M.visible = !1
                    }
                } else if (b.visible = !0,
                b.getChildByName("info").text = "",
                v.visible = !0,
                v.text = game.Tools.strOfLocalization(2171),
                m.scores)
                    for (var I = b.getChildByName("player"), s = 0; s < I.numChildren; s++) {
                        M = I.getChildAt(s);
                        s < C.length ? (M.visible = !0,
                        M.getChildByName("name").text = view.DesktopMgr.Inst.getPlayerName(C[s]),
                        M.getChildByName("point").text = "+" + w[C[s]].delta.toString()) : M.visible = !1
                    }
            } else if ("RecordLiuJu" == p.name) {
                var S = ["", game.Tools.strOfLocalization(2172), game.Tools.strOfLocalization(2173), game.Tools.strOfLocalization(2174), game.Tools.strOfLocalization(2175), game.Tools.strOfLocalization(2176)];
                v.visible = !0,
                v.text = S[m.type],
                g.height = 120
            } else if (p.data.hules[0].zimo) {
                b.visible = !0;
                (T = b.getChildByName("info")).text = game.Tools.strOfLocalization(2177),
                T.color = "#ea3694";
                for (var I = b.getChildByName("player"), s = 0; s < I.numChildren; s++) {
                    M = I.getChildAt(s);
                    if (0 == s) {
                        M.visible = !0;
                        E = m.hules[0].seat;
                        M.getChildByName("name").text = view.DesktopMgr.Inst.getPlayerName(E);
                        D = m.delta_scores[E];
                        M.getChildByName("point").text = "+" + D.toString()
                    } else
                        M.visible = !1
                }
                g.height = 120
            } else {
                b.visible = !0;
                (T = b.getChildByName("info")).text = game.Tools.strOfLocalization(2178),
                T.color = "#ef3538";
                for (var I = b.getChildByName("player"), s = 0; s < I.numChildren; s++) {
                    M = I.getChildAt(s);
                    if (s < m.hules.length) {
                        M.visible = !0;
                        E = m.hules[s].seat;
                        M.getChildByName("name").text = view.DesktopMgr.Inst.getPlayerName(E);
                        D = m.delta_scores[E];
                        M.getChildByName("point").text = "+" + D.toString()
                    } else
                        M.visible = !1
                }
                y.visible = !0,
                y.y = 80 + 40 * m.hules.length,
                x.visible = !0,
                x.y = 83 + 40 * m.hules.length;
                for (var T = x.getChildByName("info"), I = x.getChildByName("player"), s = 0; s < I.numChildren; s++) {
                    var M = I.getChildAt(s);
                    if (0 == s) {
                        M.visible = !0;
                        for (var E = 0, L = 0; L < m.delta_scores.length; L++)
                            m.delta_scores[L] < m.delta_scores[E] && (E = L);
                        M.getChildByName("name").text = view.DesktopMgr.Inst.getPlayerName(E);
                        var D = m.delta_scores[E];
                        M.getChildByName("point").text = D.toString()
                    } else
                        M.visible = !1
                }
                g.height = 180 + 40 * (p.data.hules.length - 1)
            }
            g.clickHandler = Laya.Handler.create(this, function() {
                e.locking || (r.Inst.jumpRound(i),
                e.close())
            }, null, !1),
            n.getChildByName("bg").height = n.height - 4
        }
        ,
        e
    }()
      , i = function() {
        function e(t) {
            var e = this;
            this.locking = !1,
            this.enable = !1,
            this.have0 = !1,
            this.me = t,
            this.me.visible = !1,
            this.scrollview = this.me.scriptMap["capsui.CScrollView"],
            this.scrollview.init_scrollview(Laya.Handler.create(this, this.renderInfo, null, !1)),
            this.btn_up = this.me.getChildByName("up"),
            this.btn_down = this.me.getChildByName("down"),
            this.btn_up.clickHandler = Laya.Handler.create(this, function() {
                e.locking || e.scrollview.scrollDelta(-100)
            }, null, !1),
            this.btn_down.clickHandler = Laya.Handler.create(this, function() {
                e.locking || e.scrollview.scrollDelta(100)
            }, null, !1),
            this.scrollview.me.on("ratechange", this, function() {
                e.btn_up.visible = e.scrollview.rate > 0,
                e.btn_down.visible = e.scrollview.need_scroll && e.scrollview.rate < 1
            }),
            this.enable = !1
        }
        return e.prototype.show = function(e, i) {
            var n = this;
            this.enable = !0,
            this.locking = !0,
            this.have0 = i,
            this.me.visible = !0,
            this.scrollview.reset(),
            this.scrollview.addItem(e + (i ? 1 : 0)),
            t.UIBase.anim_alpha_in(this.me, {
                y: 30
            }, 100, 0, Laya.Handler.create(this, function() {
                n.locking = !1
            })),
            this.btn_up.visible = !1,
            this.btn_down.visible = this.scrollview.need_scroll
        }
        ,
        e.prototype.close = function() {
            var e = this;
            this.enable = !1,
            this.locking = !0,
            t.UIBase.anim_alpha_out(this.me, {
                y: 30
            }, 100, 0, Laya.Handler.create(this, function() {
                e.locking = !1,
                e.me.visible = !1
            }))
        }
        ,
        e.prototype.renderInfo = function(t) {
            var e = this
              , i = t.index
              , n = t.container;
            n.getChildByName("num").text = (i + (this.have0 ? 0 : 1)).toString(),
            n.clickHandler = Laya.Handler.create(this, function() {
                e.locking || (r.Inst.jumpXun(i + (e.have0 ? 0 : 1)),
                e.close())
            }, null, !1);
            var a = n
              , s = [];
            "en" == GameMgr.client_language ? (s.push(a.getChildByName("xun")),
            s.push(a.getChildByName("num"))) : (s.push(a.getChildByName("num")),
            s.push(a.getChildByName("xun"))),
            game.Tools.sprite_align_center(s, 115, [10]);
            for (var o = 1; o < a.numChildren; o++) {
                var l = a.getChildAt(o);
                "haolong" == l.font ? l.y = 42 : l.y = 39
            }
        }
        ,
        e
    }()
      , n = function() {
        function t(t) {
            var e = this;
            this._show_hand = !1,
            this._show_paopai = !1,
            this.me = t,
            this._btn_out = this.me.getChildByName("btn_out"),
            this._btn_out.clickHandler = Laya.Handler.create(this, function() {
                e.switch()
            }, null, !1),
            this.me.getChildByName("btn_shoupai").clickHandler = Laya.Handler.create(this, function() {
                e._show_hand = !e._show_hand,
                e._choosed_show_hand.visible = e._show_hand,
                view.DesktopMgr.Inst.onShowHandChange(e._show_hand)
            }, null, !1),
            this._choosed_show_paopai = this.me.getChildByName("btn_paopai").getChildByName("choosed"),
            this.me.getChildByName("btn_paopai").clickHandler = Laya.Handler.create(this, function() {
                e._show_paopai = !e._show_paopai,
                e._choosed_show_paopai.visible = e._show_paopai,
                view.DesktopMgr.Inst.onShowPaopaiChange(e._show_paopai)
            }, null, !1),
            this._choosed_show_hand = this.me.getChildByName("btn_shoupai").getChildByName("choosed"),
            this._choosed_show_paopai = this.me.getChildByName("btn_paopai").getChildByName("choosed"),
            this.me.getChildByName("label_word").visible = "chs" == GameMgr.client_language,
            this.me.getChildByName("img_set").visible = "chs" != GameMgr.client_language
        }
        return t.prototype.reset = function() {
            Laya.Tween.clearAll(this),
            this._show_hand = !0,
            this.me.x = -258,
            this._btn_out.disabled = !1,
            this._choosed_show_hand.visible = this._show_hand,
            this._show_paopai = !0,
            this._choosed_show_paopai.visible = this._show_paopai
        }
        ,
        t.prototype.switch = function() {
            var t = this
              , e = -258;
            this.me.x < -100 && (e = -5),
            this._btn_out.disabled = !0,
            Laya.Tween.to(this.me, {
                x: e
            }, 200, Laya.Ease.strongOut, Laya.Handler.create(this, function() {
                t._btn_out.disabled = !1
            }), 0, !0, !0)
        }
        ,
        t
    }()
      , a = function() {
        function e(e) {
            var i = this;
            this.tiles = [],
            this.container_input = null,
            this.tile_count = 0,
            this.gray_filter = null,
            this.dora_filter = null,
            this.lidora_filter = null,
            this.noinfo = !0,
            this.locking = !1,
            this.enable = !1,
            this.me = e,
            this.root = e.getChildByName("root"),
            this.content = this.root.getChildByName("content"),
            this.content.vScrollBarSkin = "";
            var n = this.content.getChildByName("tile_templete");
            n.visible = !1;
            for (var a = 0; a < 100; a++) {
                var r = n.scriptMap["capsui.UICopy"].getNodeClone();
                r.visible = !1,
                this.tiles.push(r)
            }
            this.container_input = this.content.getChildByName("input"),
            this.gray_filter = new Laya.ColorFilter([.6, 0, 0, 0, 0, 0, .6, 0, 0, 0, 0, 0, .6, 0, 0, 0, 0, 0, 1, 0]),
            this.dora_filter = new Laya.ColorFilter([.35, 0, 0, 0, 0, 0, .77, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0]),
            this.lidora_filter = new Laya.ColorFilter([1, 0, 0, 0, 0, 0, .64, 0, 0, 0, 0, 0, .44, 0, 0, 0, 0, 0, 1, 0]),
            this.container_input.getChildByName("btn_what").clickHandler = Laya.Handler.create(this, function() {
                i.locking || t.UI_Info_MD5.Inst.show()
            }, null, !1)
        }
        return e.prototype.setTiles = function(t) {
            this.tile_count = Math.floor(t.length / 2);
            for (var e = "myres2/mjp/" + GameMgr.Inst.mjp_view + "/ui/", i = 0; 2 * i + 1 < t.length; i++)
                this.tiles[i].skin = game.Tools.localUISrc(e + t.charAt(2 * i) + t.charAt(2 * i + 1) + ".png"),
                this.tiles[i].visible = !0;
            for (i = this.tile_count; i < this.tiles.length; i++)
                this.tiles[i].visible = !1;
            this.noinfo = !1,
            this.container_input.getChildByName("txtinput").text = t
        }
        ,
        e.prototype.refresh = function() {
            this.me.visible && (this.noinfo || this.setInfo())
        }
        ,
        e.prototype.setInfo = function() {
            if (!this.noinfo) {
                var t = view.DesktopMgr.Inst.left_tile_count
                  , e = view.DesktopMgr.Inst.dora.length
                  , i = view.DesktopMgr.Inst.get_gang_count() + view.DesktopMgr.Inst.get_babei_count();
                i > 0 && view.DesktopMgr.Inst.waiting_lingshang_deal_tile && i--;
                var n = this.tile_count - i - 14;
                n < 0 && (n = 0);
                for (var a = this.tiles[0].width, r = this.tiles[0].height + 10, s = 0; s < n; s++) {
                    var o = 0;
                    view.DesktopMgr.Inst.rule_mode == view.ERuleMode.Liqi3 ? o = s % 12 * a + 5 * Math.floor(s % 12 / 3) : o += 2 + s % 12 * a + 5 * Math.floor(s % 12 / 4),
                    this.tiles[s].x = o,
                    this.tiles[s].y = Math.floor(s / 12) * r,
                    this.tiles[s].filters = n - s <= t ? [] : [this.gray_filter]
                }
                for (var l = Math.ceil(n / 12) * r + 20, s = n; s < this.tile_count; s++) {
                    var h = this.tiles[s];
                    h.x = (s - n) % 12 * a,
                    h.y = Math.floor((s - n) / 12) * r + l,
                    h.filters = []
                }
                for (var c = view.DesktopMgr.Inst.rule_mode == view.ERuleMode.Liqi3 ? 8 : 4, s = 0; s < e; s++)
                    this.tiles[this.tile_count - c - 1 - 2 * s].filters = [this.dora_filter],
                    this.tiles[this.tile_count - c - 2 - 2 * s].filters = [this.lidora_filter];
                for (s = 0; s < i; s++)
                    this.tiles[this.tile_count - 1 - s].filters = [this.gray_filter];
                l += Math.ceil((this.tile_count - n) / 12) * r,
                this.container_input.y = l + 80,
                this.content.refresh()
            }
        }
        ,
        e.prototype.setNoInfo = function() {
            this.noinfo = !0
        }
        ,
        e.prototype.show = function() {
            var e = this;
            this.locking || (this.noinfo ? t.UIMgr.Inst.ShowErrorInfo(game.Tools.strOfLocalization(2179)) : (this.locking = !0,
            this.me.visible = !0,
            this.refresh(),
            t.UIBase.anim_alpha_in(this.me, {
                y: 30
            }, 120, 0, Laya.Handler.create(this, function() {
                e.locking = !1
            }))))
        }
        ,
        e.prototype.close = function() {
            var e = this;
            this.locking || (this.locking = !0,
            t.UIBase.anim_alpha_out(this.me, {
                y: 30
            }, 120, 0, Laya.Handler.create(this, function() {
                e.locking = !1,
                e.me.visible = !1
            })))
        }
        ,
        e
    }()
      , r = function(r) {
        function s() {
            var t = r.call(this, new ui.mj.replayUI) || this;
            return t.label_chang = null,
            t.label_ju = null,
            t.label_xun = null,
            t.img_play = null,
            t.img_stop = null,
            t.btn_preround = null,
            t.btn_nextround = null,
            t.page_chang = null,
            t.page_xun = null,
            t.btn_change_score = null,
            t.paipuconfig = null,
            t.page_paishan = null,
            t.data = null,
            t.gameResult = null,
            t.rounds = [],
            t.round_index = 0,
            t.action_index = 0,
            t.locking_time = 0,
            t._auto_play = !1,
            s.Inst = t,
            t
        }
        return __extends(s, r),
        Object.defineProperty(s.prototype, "auto_play", {
            get: function() {
                return this._auto_play
            },
            set: function(t) {
                this._auto_play = t,
                this.img_play.visible = !t,
                this.img_stop.visible = t
            },
            enumerable: !0,
            configurable: !0
        }),
        s.prototype.onCreate = function() {
            var r = this
              , s = this.me.getChildByName("root").getChildByName("round");
            s.clickHandler = Laya.Handler.create(this, function() {
                r.page_chang.locking || (r.auto_play && (r.auto_play = !1),
                r.page_xun.enable && r.page_xun.close(),
                r.page_paishan.me.visible && r.page_paishan.close(),
                r.page_chang.enable ? r.page_chang.close() : r.page_chang.show(r.rounds))
            }, null, !1),
            this.label_chang = s.getChildByName("chang"),
            this.label_ju = s.getChildByName("ju");
            var o = this.me.getChildByName("root").getChildByName("turn");
            this.label_xun = o.getChildByName("xun"),
            o.clickHandler = Laya.Handler.create(this, function() {
                r.page_xun.locking || (r.auto_play && (r.auto_play = !1),
                r.page_chang.enable && r.page_chang.close(),
                r.page_paishan.me.visible && r.page_paishan.close(),
                r.page_xun.enable ? r.page_xun.close() : r.page_xun.show(r.rounds[r.round_index].xun.length, 0 != r.rounds[r.round_index].xun[0]))
            }, null, !1),
            this.me.getChildByName("root").getChildByName("paishan").clickHandler = Laya.Handler.create(this, function() {
                r.page_paishan.locking || (r.auto_play && (r.auto_play = !1),
                r.page_chang.enable && r.page_chang.close(),
                r.page_xun.enable && r.page_xun.close(),
                r.page_paishan.me.visible ? r.page_paishan.close() : r.page_paishan.show())
            }, null, !1),
            this.page_chang = new e(this.me.getChildByName("info_chang")),
            this.page_xun = new i(this.me.getChildByName("info_xun")),
            this.page_paishan = new a(this.me.getChildByName("info_paishan")),
            this.me.getChildByName("root").getChildByName("play").clickHandler = Laya.Handler.create(this, function() {
                r.auto_play = !r.auto_play
            }, null, !1),
            this.me.getChildByName("root").getChildByName("nextstep").clickHandler = Laya.Handler.create(this, function() {
                r.locking_time > Laya.timer.currTimer ? r.auto_play && (r.auto_play = !1) : r.nextStep()
            }, null, !1),
            this.me.getChildByName("root").getChildByName("prestep").clickHandler = Laya.Handler.create(this, function() {
                r.preStep()
            }, null, !1),
            this.me.getChildByName("root").getChildByName("nextturn").clickHandler = Laya.Handler.create(this, function() {
                r.nextXun()
            }, null, !1),
            this.me.getChildByName("root").getChildByName("preturn").clickHandler = Laya.Handler.create(this, function() {
                r.preXun()
            }, null, !1),
            this.btn_preround = this.me.getChildByName("root").getChildByName("preround"),
            this.btn_preround.clickHandler = Laya.Handler.create(this, function() {
                r.preRound()
            }, null, !1),
            this.btn_nextround = this.me.getChildByName("root").getChildByName("nextround"),
            this.btn_nextround.clickHandler = Laya.Handler.create(this, function() {
                r.nextRound()
            }, null, !1),
            this.img_play = this.me.getChildByName("root").getChildByName("play").getChildByName("play"),
            this.img_stop = this.me.getChildByName("root").getChildByName("play").getChildByName("pause"),
            this.btn_change_score = this.me.getChildByName("btn_change_score"),
            this.btn_change_score.clickHandler = Laya.Handler.create(this, function() {
                t.UI_DesktopInfo.Inst.onBtnShowScoreDelta()
            }, null, !1),
            this.paipuconfig = new n(this.me.getChildByName("config"))
        }
        ,
        s.prototype.onEnable = function() {
            this.paipuconfig.reset(),
            t.UI_ReplayWheel.Inst.enable = !0
        }
        ,
        s.prototype.onDisable = function() {
            t.UI_ReplayWheel.Inst.enable = !1
        }
        ,
        s.prototype._isRoundEnd = function(t) {
            return "RecordNoTile" == t || "RecordLiuJu" == t || "RecordHule" == t
        }
        ,
        s.prototype.initData = function(t) {
            this.data = t;
            var e = t.game
              , i = t.record
              , n = null
              , a = 0;
            this.rounds = [];
            for (var r = 0; r < e.records.length; r++) {
                a += e.records[r].length;
                var s = net.MessageWrapper.decodeMessage(e.records[r])
                  , o = s.$type.name
                  , l = {
                    name: o,
                    data: s
                };
                null == n && (n = {
                    xun: [],
                    actions: []
                }),
                n.actions.push(l),
                this._isRoundEnd(o) && (this.pengding_xun(n),
                this.rounds.push(n),
                n = null)
            }
            null != n && app.Log.Error("最后一份牌谱没有结束"),
            this.gameResult = i,
            this.action_index = -1,
            this.round_index = -1,
            this.label_chang.text = "东",
            this.label_ju.text = "1",
            this.label_xun.text = "0",
            this.auto_play = !1,
            app.Log.log("牌谱大小：" + a + "B")
        }
        ,
        s.prototype.reset = function() {
            this.auto_play = !1,
            this.page_chang.enable && this.page_chang.close(),
            this.page_xun.enable && this.page_xun.close(),
            this.page_paishan.me.visible && (this.page_paishan.me.visible = !1)
        }
        ,
        s.prototype.pengding_xun = function(t) {
            t.xun = [];
            for (var e = view.DesktopMgr.Inst.seat, i = !1, n = 0; n < t.actions.length; n++) {
                var a = t.actions[n];
                "RecordNewRound" == a.name ? a.data.ju == e && (i = !0,
                t.xun.push(n)) : "RecordDealTile" == a.name || "RecordChiPengGang" == a.name ? a.data.seat == e && (i || (i = !0,
                t.xun.push(n))) : "RecordDiscardTile" != a.name && "RecordAnGangAddGang" != a.name && "RecordBaBei" != a.name || (i = !1)
            }
        }
        ,
        s.prototype.get_currentxun = function() {
            var t = this.rounds[this.round_index];
            if (0 == t.xun.length)
                return 1;
            for (var e = t.xun.length, i = 0; i < t.xun.length; i++)
                if (this.action_index < t.xun[i]) {
                    e = i;
                    break
                }
            return e < 0 && (e = 0),
            e
        }
        ,
        s.prototype.nextStep = function(e) {
            if (void 0 === e && (e = !1),
            (e || !(this.locking_time > Laya.timer.currTimer)) && !(this.round_index >= this.rounds.length)) {
                if (this.round_index < 0 || this.rounds[this.round_index].actions.length <= this.action_index + 1) {
                    if (this.round_index++,
                    this.action_index = 0,
                    this.round_index == this.rounds.length)
                        return view.DesktopMgr.Inst.gameEndResult = this.gameResult.result,
                        this.enable = !1,
                        void t.UIMgr.Inst.ShowGameEnd()
                } else
                    this.action_index++;
                this.btn_nextround.visible = this.rounds.length > 1,
                this.btn_preround.visible = this.rounds.length > 1,
                this.locking_time = Laya.timer.currTimer + this.doRecord(this.rounds[this.round_index].actions[this.action_index]),
                this._refreshBarshow()
            }
        }
        ,
        s.prototype._refreshBarshow = function() {
            var t = "";
            if ("chs" == GameMgr.client_language)
                switch (view.DesktopMgr.Inst.index_change % 4) {
                case 0:
                    t += "东";
                    break;
                case 1:
                    t += "南";
                    break;
                case 2:
                    t += "西";
                    break;
                case 3:
                    t += "北"
                }
            else if ("jp" == GameMgr.client_language)
                switch (view.DesktopMgr.Inst.index_change % 4) {
                case 0:
                    t += "東";
                    break;
                case 1:
                    t += "南";
                    break;
                case 2:
                    t += "西";
                    break;
                case 3:
                    t += "北"
                }
            else
                switch (view.DesktopMgr.Inst.index_change % 4) {
                case 0:
                    t += "East";
                    break;
                case 1:
                    t += "South";
                    break;
                case 2:
                    t += "West";
                    break;
                case 3:
                    t += "North"
                }
            this.label_chang.text = t,
            this.label_ju.text = (view.DesktopMgr.Inst.index_ju + 1).toString();
            var e = function(t, e) {
                for (var i = 0, n = 1; n < t.numChildren; n++) {
                    1 != n && (i += 3);
                    i += (r = t.getChildAt(n)).textField.textWidth * r.scaleX
                }
                for (var a = t.width / 2 - i / 2, n = 1; n < t.numChildren; n++) {
                    var r = t.getChildAt(n);
                    r.x = a,
                    a += r.textField.textWidth * r.scaleX + 3,
                    "haolong" == r.font ? r.y = e + 3 : r.y = e
                }
            };
            this.label_xun.text = this.get_currentxun().toString(),
            e(this.label_chang.parent, 40),
            e(this.label_xun.parent, 50)
        }
        ,
        s.prototype.doRecord = function(t) {
            try {
                var e = 0;
                switch (t.name) {
                case "RecordNewRound":
                    e = view.ActionNewRound.record(t.data) + (this._auto_play,
                    0);
                    break;
                case "RecordDiscardTile":
                    e = view.ActionDiscardTile.record(t.data) + (this._auto_play ? 500 : 0);
                    break;
                case "RecordDealTile":
                    e = view.ActionDealTile.record(t.data) + (this._auto_play ? 500 : 0);
                    break;
                case "RecordChiPengGang":
                    e = view.ActionChiPengGang.record(t.data) + (this._auto_play ? 500 : 0);
                    break;
                case "RecordAnGangAddGang":
                    e = view.ActionAnGangAddGang.record(t.data) + (this._auto_play ? 200 : 0);
                    break;
                case "RecordBaBei":
                    e = view.ActionBabei.record(t.data) + (this._auto_play ? 200 : 0);
                    break;
                case "RecordHule":
                    e = view.ActionHule.record(t.data);
                    break;
                case "RecordLiuJu":
                    e = view.ActionLiuJu.record(t.data);
                    break;
                case "RecordNoTile":
                    e = view.ActionNoTile.record(t.data)
                }
                return "RecordNewRound" != t.name && "RecordDealTile" != t.name || this.page_paishan.refresh(),
                e
            } catch (e) {
                var i = {};
                return i.error = e.message,
                i.stack = e.stack,
                i.method = "ui_replay doRecord",
                i.name = t.name,
                i.data = t.data,
                GameMgr.Inst.onFatalError(i),
                1e6
            }
        }
        ,
        s.prototype.doFastRecord = function(t) {
            try {
                switch (t.name) {
                case "RecordNewRound":
                    view.ActionNewRound.fastrecord(t.data);
                    break;
                case "RecordDiscardTile":
                    view.ActionDiscardTile.fastrecord(t.data);
                    break;
                case "RecordDealTile":
                    view.ActionDealTile.fastrecord(t.data);
                    break;
                case "RecordChiPengGang":
                    view.ActionChiPengGang.fastrecord(t.data);
                    break;
                case "RecordAnGangAddGang":
                    view.ActionAnGangAddGang.fastrecord(t.data);
                    break;
                case "RecordHule":
                    view.ActionHule.fastrecord(t.data);
                    break;
                case "RecordLiuJu":
                    view.ActionLiuJu.fastrecord(t.data);
                    break;
                case "RecordNoTile":
                    view.ActionNoTile.fastrecord(t.data);
                    break;
                case "RecordBaBei":
                    view.ActionBabei.fastrecord(t.data)
                }
                "RecordNewRound" != t.name && "RecordDealTile" != t.name || this.page_paishan.refresh()
            } catch (i) {
                var e = {};
                return e.error = i.message,
                e.stack = i.stack,
                e.method = "ui_replay doRecord",
                e.name = t.name,
                e.data = t.data,
                GameMgr.Inst.onFatalError(e),
                1e6
            }
            return 0
        }
        ,
        s.prototype.update = function() {
            !this.auto_play || this.locking_time > Laya.timer.currTimer || this.round_index >= 0 && this.round_index < this.rounds.length && this.action_index + 1 < this.rounds[this.round_index].actions.length && this.nextStep()
        }
        ,
        s.prototype.jumpToLastRoundXun = function() {
            if (this.locking_time > Laya.timer.currTimer)
                this.auto_play && (this.auto_play = !1);
            else {
                this.round_index = (this.round_index - 1 + this.rounds.length) % this.rounds.length;
                var t = this.rounds[this.round_index]
                  , e = t.actions.length - 3;
                e < 1 && (e = 1);
                for (var i = 0; i < e; i++)
                    this.doFastRecord(t.actions[i]);
                this.action_index = e - 1,
                this.nextStep()
            }
        }
        ,
        s.prototype.nextXun = function() {
            if (this.locking_time > Laya.timer.currTimer)
                this.auto_play && (this.auto_play = !1);
            else if (!(this.round_index >= this.rounds.length || this.round_index < 0)) {
                var t = this.rounds[this.round_index];
                if (this.action_index != t.actions.length - 1) {
                    var e = 0;
                    if (0 == t.xun.length)
                        e = t.actions.length - 1;
                    else if (t.xun[0] > this.action_index)
                        e = t.xun[0];
                    else {
                        var i = this.get_currentxun();
                        e = i == t.xun.length ? t.actions.length - 1 : t.xun[i]
                    }
                    for (var n = this.action_index + 1; n < e; n++)
                        this.doFastRecord(t.actions[n]);
                    this.action_index = e - 1,
                    this.nextStep()
                }
            }
        }
        ,
        s.prototype.preXun = function() {
            if (this.locking_time > Laya.timer.currTimer)
                this.auto_play && (this.auto_play = !1);
            else if (!(this.round_index >= this.rounds.length || this.round_index < 0)) {
                var t = this.rounds[this.round_index];
                if (0 != this.action_index) {
                    var e = 0;
                    if (0 == t.xun.length)
                        e = 0;
                    else if (t.xun[0] > this.action_index)
                        e = 0;
                    else {
                        var i = this.get_currentxun() - 1;
                        e = 0 == i ? 0 : t.xun[i - 1]
                    }
                    for (var n = 0; n < e; n++)
                        this.doFastRecord(t.actions[n]);
                    this.action_index = e - 1,
                    this.nextStep()
                } else
                    this.jumpToLastRoundXun()
            }
        }
        ,
        s.prototype.preStep = function() {
            if (this.locking_time > Laya.timer.currTimer)
                this.auto_play && (this.auto_play = !1);
            else if (!(this.round_index >= this.rounds.length || this.round_index < 0)) {
                var t = this.rounds[this.round_index];
                if (0 != this.action_index) {
                    for (var e = this.action_index - 1, i = 0; i < e; i++)
                        this.doFastRecord(t.actions[i]);
                    this.action_index = e - 1,
                    this.nextStep()
                } else
                    this.jumpToLastRoundXun()
            }
        }
        ,
        s.prototype.nextRound = function() {
            this.page_xun.enable && this.page_xun.close(),
            this.locking_time > Laya.timer.currTimer ? this.auto_play && (this.auto_play = !1) : (this.round_index = (this.round_index + 1) % this.rounds.length,
            this.action_index = -1,
            this.nextStep())
        }
        ,
        s.prototype.preRound = function() {
            this.page_xun.enable && this.page_xun.close(),
            this.locking_time > Laya.timer.currTimer ? this.auto_play && (this.auto_play = !1) : (this.round_index = (this.round_index - 1 + this.rounds.length) % this.rounds.length,
            this.action_index = -1,
            this.nextStep())
        }
        ,
        s.prototype.jumpRound = function(t) {
            this.page_xun.enable && this.page_xun.close(),
            this.locking_time > Laya.timer.currTimer ? this.auto_play && (this.auto_play = !1) : t < 0 || t >= this.rounds.length || (this.round_index = t,
            this.action_index = -1,
            this.nextStep())
        }
        ,
        s.prototype.jumpXun = function(t) {
            if (this.locking_time > Laya.timer.currTimer)
                this.auto_play && (this.auto_play = !1);
            else if (!(this.round_index >= this.rounds.length || this.round_index < 0)) {
                var e = this.rounds[this.round_index]
                  , i = 0;
                i = 0 == e.xun.length ? 0 : 0 == t ? 0 : e.xun[t - 1];
                for (var n = 0; n < i; n++)
                    this.doFastRecord(e.actions[n]);
                this.action_index = i - 1,
                this.nextStep()
            }
        }
        ,
        s.prototype.onWheelClick = function() {
            if (!this.page_chang.locking && !this.page_xun.locking)
                return this.page_chang.enable || this.page_xun.enable ? (this.page_chang.enable && this.page_chang.close(),
                void (this.page_xun.enable && this.page_xun.close())) : void this.nextStep()
        }
        ,
        s.prototype.onChangeMainBody = function() {
            var t = this.round_index
              , e = this.action_index;
            if (this.initData(this.data),
            this.reset(),
            !(t >= this.rounds.length || t < 0)) {
                for (var i = this.rounds[t], n = e, a = 0; a <= n; a++)
                    this.doFastRecord(i.actions[a]);
                this.round_index = t,
                this.action_index = n,
                this._refreshBarshow()
            }
        }
        ,
        s.Inst = null,
        s
    }(t.UIBase);
    t.UI_Replay = r
}(uiscript || (uiscript = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), uiscript;
!function(t) {
    var e = function(e) {
        function i() {
            var t = e.call(this, new ui.mj.replay_whellUI) || this;
            return i.Inst = t,
            t
        }
        return __extends(i, e),
        i.prototype.onCreate = function() {
            var e = 0;
            this.me.getChildByName("wheel").on(Laya.Event.MOUSE_WHEEL, this, function(i) {
                !function(i) {
                    if (!(Laya.timer.currTimer < e)) {
                        e = Laya.timer.currTimer + 50;
                        var n = i.delta;
                        n > 0 ? t.UI_Replay.Inst.preXun() : n < 0 && t.UI_Replay.Inst.nextXun()
                    }
                }(i)
            }),
            this.me.getChildByName("wheel").on(Laya.Event.MOUSE_DOWN, this, function(e) {
                t.UI_Replay.Inst.onWheelClick()
            })
        }
        ,
        i
    }(t.UIBase);
    t.UI_ReplayWheel = e
}(uiscript || (uiscript = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), uiscript;
!function(t) {
    var e = function(t) {
        function e() {
            var i = t.call(this, new ui.common.rollnoticeUI) || this;
            return i.speed = .18,
            e.Inst = i,
            i
        }
        return __extends(e, t),
        e.init = function() {
            var t = this;
            app.NetAgent.sendReq2Lobby("Lobby", "fetchRollingNotice", {}, function(e, i) {
                e || i.error || t.receiveInfo(i.notice)
            }),
            app.NetAgent.AddListener2Lobby("NotifyRollingNotice", Laya.Handler.create(this, function(e) {
                t.receiveInfo(e.notice)
            }, null, !1))
        }
        ,
        e.receiveInfo = function(t) {
            this.current_notice = t,
            this.try2Show()
        }
        ,
        e.try2Show = function() {
            var t = this;
            null != this.current_notice && (1e3 * this.current_notice.end_time < Laya.timer.currTimer + GameMgr.Inst.server_time_delta ? this.current_notice = null : this.Inst.enable || this.Inst.show(this.current_notice.content, Laya.Handler.create(this, function() {
                t.current_notice && Laya.timer.once(1e3 * t.current_notice.repeat_interval, t, t.try2Show)
            })))
        }
        ,
        e.prototype.onCreate = function() {
            this.root = this.me.getChildByName("root"),
            this.panel = this.root.getChildByName("content"),
            this.label = this.panel.getChildByName("label"),
            Laya.timer.once(3e3, this, function() {
                e.init()
            })
        }
        ,
        e.prototype.show = function(t, e) {
            this.label.text = t,
            this.complete = e,
            Laya.timer.clearAll(this),
            this.root.visible = !0,
            this.origin_x = this.panel.width + 500 * this.speed,
            this.target_x = -(500 * this.speed + this.label.textField.textWidth),
            this.start_time = Laya.timer.currTimer,
            Laya.timer.frameLoop(1, this, this.__update, null, !0),
            this.enable = !0
        }
        ,
        e.prototype.close = function() {
            this.complete && this.complete.run(),
            Laya.timer.clearAll(this),
            this.enable = !1
        }
        ,
        e.prototype.__update = function() {
            var t = Laya.timer.currTimer - this.start_time;
            t >= (this.origin_x - this.target_x) / this.speed ? (this.root.visible = !1,
            this.close()) : this.label.x = this.origin_x - this.speed * t
        }
        ,
        e.Inst = null,
        e.current_notice = null,
        e
    }(t.UIBase);
    t.UI_RollNotice = e
}(uiscript || (uiscript = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), uiscript;
!function(t) {
    var e = function() {
        function t(t) {
            var e = this;
            this.tabs = [],
            this.scrollview = null,
            this.tab_index = -1,
            this.me = t;
            for (var i = this.me.getChildByName("tabs"), n = this.me.getChildByName("fans").getChildByName("content").getChildByName("templete").getChildByName("decs"), a = 1; a <= 8; a++) {
                var r = i.getChildByName("tab_" + a);
                this.tabs.push({
                    choosed: r.getChildByName("unchoose"),
                    unchoosed: r.getChildByName("choosed"),
                    ids: [],
                    heights: []
                }),
                r.clickHandler = Laya.Handler.create(this, this._changeTab, [a - 1], !1)
            }
            cfg.fandesc.fandesc.forEach(function(t) {
                var i = t.tag - 1;
                i >= 0 && i < e.tabs.length && (e.tabs[i].ids.push(t.id),
                "chs" != GameMgr.client_language && (n.text = t["desc_" + GameMgr.client_language],
                e.tabs[i].heights.push(n.textField.textHeight + 240)))
            }),
            this.scrollview = this.me.getChildByName("fans").scriptMap["capsui.CScrollView"],
            this.scrollview.init_scrollview(Laya.Handler.create(this, function(t) {
                e._showItem(t.index, t.container)
            }, null, !1))
        }
        return t.prototype.onEnter = function() {
            this.tab_index = -1,
            this._changeTab(0)
        }
        ,
        t.prototype.show = function() {
            this.me.visible = !0
        }
        ,
        t.prototype.close = function() {
            this.me.visible = !1
        }
        ,
        t.prototype._changeTab = function(t) {
            if (t != this.tab_index) {
                this.tab_index = t;
                for (var e = 0; e < this.tabs.length; e++)
                    this.tabs[e].choosed.visible = e == t,
                    this.tabs[e].unchoosed.visible = e != t;
                this.scrollview.reset(),
                "chs" == GameMgr.client_language ? this.scrollview.addItem(this.tabs[t].ids.length) : this.scrollview.addItems(this.tabs[t].heights)
            }
        }
        ,
        t.prototype._showItem = function(t, e) {
            var i = cfg.fandesc.fandesc.get(this.tabs[this.tab_index].ids[t]);
            e.getChildByName("name").text = i["name_" + GameMgr.client_language],
            e.getChildByName("decs").text = i["desc_" + GameMgr.client_language],
            e.getChildByName("limit").text = i["desc2_" + GameMgr.client_language];
            var n = e.getChildByName("tiles");
            "chs" != GameMgr.client_language && (n.y = 100 + e.getChildByName("decs").textField.textHeight,
            e.height = this.tabs[this.tab_index].heights[t]);
            for (var a = i.case, r = 0, s = 0, o = "myres2/mjp/" + game.GameUtility.get_common_view_res_name(game.ECommonView.mjp) + "/ui/", l = 0; l < n.numChildren; l++) {
                var h = n.getChildAt(l);
                if (r >= a.length)
                    h.visible = !1;
                else {
                    var c = "";
                    "b" == a[r] ? (c = "back",
                    r++) : (c = a[r] + a[r + 1],
                    r += 2),
                    h.skin = game.Tools.localUISrc(o + c + ".png"),
                    h.visible = !0,
                    h.x = s,
                    h.y = 0,
                    s += h.width
                }
                for (; r < a.length && "|" == a[r]; )
                    s += 20,
                    r++
            }
        }
        ,
        t
    }()
      , i = function() {
        function t(t) {
            var e = this;
            this.locking = !1,
            this.loadover = [],
            this.urls = [game.Tools.localUISrc("course/course0.png"), game.Tools.localUISrc("course/course1.png"), game.Tools.localUISrc("course/course2.png"), game.Tools.localUISrc("course/course3.png"), game.Tools.localUISrc("course/course4.png"), game.Tools.localUISrc("course/course5.png"), game.Tools.localUISrc("course/course6.png"), game.Tools.localUISrc("course/course7.png"), game.Tools.localUISrc("course/course8.png")],
            this.pageindex = 0,
            this.me = t,
            this.page = this.me.getChildByName("page"),
            this.btn_pre = this.me.getChildByName("pre"),
            this.btn_next = this.me.getChildByName("next"),
            this.btn_close = this.me.getChildByName("btn_close"),
            this.loading = this.me.getChildByName("loading"),
            this.btn_pre.clickHandler = Laya.Handler.create(this, function() {
                e.locking || 0 != e.pageindex && e.showPage(e.pageindex - 1)
            }, null, !1),
            this.btn_next.clickHandler = Laya.Handler.create(this, function() {
                e.locking || e.pageindex != e.urls.length - 1 && e.showPage(e.pageindex + 1)
            }, null, !1);
            for (var i = 0; i < this.urls.length; i++)
                this.loadover.push(!1);
            this.label_count = this.me.getChildByName("count")
        }
        return t.prototype.onEnter = function() {
            this.pageindex = 0
        }
        ,
        t.prototype.show = function() {
            var t = this;
            this.showPage(this.pageindex),
            this.me.visible = !0;
            for (var e = function(e) {
                i.loadover.push(!1),
                Laya.loader.load(i.urls[e], Laya.Handler.create(i, function() {
                    Laya.timer.frameOnce(3, t, function() {
                        t.loadover[e] = !0,
                        t.me.visible && t.pageindex == e && (t.loading.visible = !1,
                        t.page.source = Laya.loader.getRes(t.urls[e]),
                        t.page.visible = !0),
                        t.me.visible || Laya.loader.clearTextureRes(t.urls[e])
                    })
                }))
            }, i = this, n = 0; n < this.urls.length; n++)
                e(n)
        }
        ,
        t.prototype.close = function() {
            this.me.visible = !1;
            for (var t = 0; t < this.urls.length; t++)
                this.loadover[t] && Laya.loader.clearTextureRes(this.urls[t])
        }
        ,
        t.prototype.showPage = function(t) {
            this.pageindex = t,
            this.btn_pre.visible = 0 != t,
            this.btn_next.visible = t != this.urls.length - 1,
            this.loadover[t] ? (this.page.visible = !0,
            this.page.source = Laya.loader.getRes(this.urls[t]),
            this.loading.visible = !1) : (this.page.visible = !1,
            this.loading.visible = !0),
            this.label_count.text = (this.pageindex + 1).toString() + "/" + this.urls.length.toString()
        }
        ,
        t
    }()
      , n = function(n) {
        function a() {
            var t = n.call(this, "chs" == GameMgr.client_language ? new ui.both_ui.rulesUI : new ui.both_ui.rules_enUI) || this;
            return t.root = null,
            t.blackmask = null,
            t.page_rule = null,
            t.page_course = null,
            t.locking = !1,
            t.tab_index = 0,
            t.func_close = null,
            t.tab_fan = null,
            t.tab_course = null,
            t.tab_img_dark = "",
            t.tab_img_chosen = "",
            a.Inst = t,
            t
        }
        return __extends(a, n),
        a.prototype.onCreate = function() {
            var t = this;
            "chs" == GameMgr.client_language ? (this.tab_img_chosen = game.Tools.localUISrc("myres/bothui/info_tab_chosen.png"),
            this.tab_img_dark = game.Tools.localUISrc("myres/bothui/info_tab_dark.png")) : (this.tab_img_chosen = game.Tools.localUISrc("myres/bothui/info_tabheng_chosen.png"),
            this.tab_img_dark = game.Tools.localUISrc("myres/bothui/info_tabheng_dark.png")),
            this.root = this.me.getChildByName("root"),
            this.blackmask = this.me.getChildByName("bmask"),
            this.page_rule = new e(this.root.getChildByName("page_fan")),
            this.page_course = new i(this.root.getChildByName("page_course")),
            this.tab_fan = this.root.getChildByName("tab_fan"),
            this.root.getChildByName("tab_fan").clickHandler = Laya.Handler.create(this, function() {
                t.changeTab(0)
            }, null, !1),
            this.tab_course = this.root.getChildByName("tab_course"),
            this.root.getChildByName("tab_course").clickHandler = Laya.Handler.create(this, function() {
                t.changeTab(1)
            }, null, !1),
            this.root.getChildByName("btn_close").clickHandler = Laya.Handler.create(this, function() {
                t.close()
            }, null, !1)
        }
        ,
        a.prototype.show = function(e, i) {
            var n = this;
            void 0 === e && (e = 0),
            void 0 === i && (i = null),
            this.locking = !0,
            this.enable = !0,
            this.page_course.onEnter(),
            this.page_rule.onEnter(),
            t.UIBase.anim_pop_out(this.root, Laya.Handler.create(this, function() {
                n.locking = !1
            })),
            this.blackmask.alpha = 0,
            Laya.Tween.to(this.blackmask, {
                alpha: .3
            }, 150),
            this.tab_index = -1,
            this.changeTab(e),
            this.func_close = i
        }
        ,
        a.prototype.changeTab = function(t) {
            t != this.tab_index && (this.tab_index = t,
            0 == this.tab_index ? (this.page_course.close(),
            this.page_rule.show(),
            this.tab_course.skin = this.tab_img_dark,
            this.tab_fan.skin = this.tab_img_chosen) : (this.page_course.show(),
            this.page_rule.close(),
            this.tab_course.skin = this.tab_img_chosen,
            this.tab_fan.skin = this.tab_img_dark))
        }
        ,
        a.prototype.onDisable = function() {
            this.page_course.close(),
            this.page_course.close()
        }
        ,
        a.prototype.close = function() {
            var e = this;
            this.locking = !0,
            Laya.Tween.to(this.blackmask, {
                alpha: 0
            }, 150),
            t.UIBase.anim_pop_hide(this.root, Laya.Handler.create(this, function() {
                e.locking = !1,
                e.enable = !1,
                e.func_close && e.func_close.run()
            }))
        }
        ,
        a.Inst = null,
        a
    }(t.UIBase);
    t.UI_Rules = n
}(uiscript || (uiscript = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), uiscript;
!function(t) {
    var e = function(e) {
        function i() {
            var t = e.call(this, new ui.mj.scorechangeUI) || this;
            return t.black_mask = null,
            t.viewplayers = [],
            t.container_arrow = null,
            t.btn_confirm = null,
            t.count_down = null,
            t.label_waitingother = null,
            t.change_num = [],
            i.Inst = t,
            t
        }
        return __extends(i, e),
        i.prototype.onCreate = function() {
            this.black_mask = this.me.getChildByName("black_mask");
            for (var e = 0; e < 4; e++) {
                for (var i = this.me.getChildByName("player_" + e), n = [], a = 0; a < 7; a++)
                    n.push(i.getChildByName("container_score").getChildByName(a.toString()));
                var r = {
                    txt_name: i.getChildByName("label_name"),
                    txt_delta: i.getChildByName("label_delta"),
                    container_head: i.getChildByName("head"),
                    container: i,
                    x: i.x,
                    y: i.y,
                    rank_x: i.getChildByName("rank").x,
                    rank_y: i.getChildByName("rank").y,
                    head: new t.UI_Head(i.getChildByName("head")),
                    container_rank0: i.getChildByName("rank"),
                    rank0: i.getChildByName("rank").getChildByName("val"),
                    rank0_wei: i.getChildByName("rank").getChildAt(1),
                    container_rank1: i.getChildByName("rank1"),
                    rank1: i.getChildByName("rank1").getChildByName("val"),
                    rank1_wei: i.getChildByName("rank").getChildAt(1),
                    img_scores: n
                };
                this.viewplayers.push(r)
            }
            this.container_arrow = this.me.getChildByName("container_arrow"),
            this.btn_confirm = this.me.getChildByName("btn_confirm"),
            this.count_down = this.btn_confirm.getChildByName("countdown"),
            this.btn_confirm.clickHandler = Laya.Handler.create(this, this.onBtnConfirm, null, !1);
            this.container_arrow.getChildByName("nums");
            this.label_waitingother = this.me.getChildByName("waitingother")
        }
        ,
        i.prototype.show = function(t) {
            var e = this;
            if (view.DesktopMgr.Inst.mode != view.EMJMode.paipu) {
                this.enable = !0,
                this.black_mask.alpha = 0,
                Laya.Tween.to(this.black_mask, {
                    alpha: .5
                }, 120);
                for (var i = [], n = [], a = 0; a < t.length; a++)
                    i.push(a),
                    n.push(a);
                i = i.sort(function(e, i) {
                    return 100 * (t[i].old_score - t[e].old_score) + e - i
                }),
                n = n.sort(function(e, i) {
                    return 100 * (t[i].old_score + t[i].delta - t[e].old_score - t[e].delta) + e - i
                });
                for (var r = !1, a = 0; a < this.viewplayers.length; a++) {
                    this.viewplayers[a].container.visible = !1
                }
                for (var s = function(a) {
                    var s = view.DesktopMgr.Inst.seat2LocalPosition(a)
                      , l = o.viewplayers[s];
                    l.container.visible = !0;
                    var h = 0
                      , c = 0;
                    switch (s) {
                    case 0:
                        c = -80;
                        break;
                    case 1:
                        h = -80;
                        break;
                    case 2:
                        c = 80;
                        break;
                    case 3:
                        h = 80
                    }
                    l.container.x = l.x + h,
                    l.container.y = l.y + c,
                    l.container.alpha = 0,
                    Laya.Tween.to(l.container, {
                        alpha: 1,
                        x: l.x,
                        y: l.y
                    }, 100, null, null, 120);
                    var u = view.DesktopMgr.Inst.player_datas[a]
                      , _ = t[a];
                    l.txt_name.text = u.nickname,
                    l.head.id = u.avatar_id,
                    o.setScore(l.img_scores, _.old_score);
                    for (var d = 0, f = 0; f < i.length; f++)
                        if (i[f] == a) {
                            d = f + 1;
                            break
                        }
                    for (var p = 0, f = 0; f < n.length; f++)
                        if (n[f] == a) {
                            p = f + 1;
                            break
                        }
                    l.container_rank0.visible = !0,
                    l.container_rank0.x = l.rank_x,
                    l.container_rank0.y = l.rank_y,
                    l.rank0.skin = game.Tools.localUISrc("myres/mjdesktop/s_" + d.toString() + ".png"),
                    l.rank0_wei.skin = game.Tools.localUISrc("myres/mjdesktop/s_" + d.toString() + "_" + d.toString() + ".png"),
                    l.container_rank0.alpha = 1,
                    l.txt_delta.visible = !1,
                    0 != _.delta && (r = !0,
                    _.delta > 0 ? (l.txt_delta.text = "+" + _.delta,
                    l.txt_delta.color = "#64cf42") : (l.txt_delta.text = _.delta.toString(),
                    l.txt_delta.color = "#d61111"),
                    l.txt_delta.visible = !0,
                    l.txt_delta.alpha = 0,
                    Laya.Tween.to(l.txt_delta, {
                        alpha: 1
                    }, 100, null, null, 250)),
                    l.container_rank1.visible = !1,
                    Laya.timer.once(2500, o, function() {
                        r && (Laya.Tween.to(l.container_rank0, {
                            x: l.rank_x - 50,
                            alpha: 0
                        }, 70, Laya.Ease.strongIn),
                        Laya.timer.once(300 + 300 * (4 - p), e, function() {
                            l.rank0.skin = game.Tools.localUISrc("myres/mjdesktop/s_" + p.toString() + ".png"),
                            l.rank0_wei.skin = game.Tools.localUISrc("myres/mjdesktop/s_" + p.toString() + "_" + p.toString() + ".png"),
                            Laya.Tween.to(l.container_rank0, {
                                x: l.rank_x,
                                alpha: 1
                            }, 70, Laya.Ease.strongIn),
                            1 == p ? (view.AudioMgr.PlayAudio(218),
                            Laya.timer.once(70, e, function() {
                                l.container_rank1.visible = !0,
                                l.rank1.skin = game.Tools.localUISrc("myres/mjdesktop/s_1.png"),
                                l.rank1_wei.skin = game.Tools.localUISrc("myres/mjdesktop/s_1_1.png"),
                                l.container_rank1.x = l.rank_x,
                                l.container_rank1.y = l.rank_y,
                                l.container_rank1.scaleX = l.container_rank1.scaleY = l.container_rank0.scaleX,
                                l.container_rank1.alpha = 1,
                                Laya.Tween.to(l.container_rank1, {
                                    scaleX: 1.7,
                                    scaleY: 1.7,
                                    alpha: 0
                                }, 500, Laya.Ease.strongOut)
                            })) : view.AudioMgr.PlayAudio(219)
                        }))
                    })
                }, o = this, a = 0; a < t.length; a++)
                    s(a);
                this.container_arrow.visible = !0;
                for (a = 0; a < 4; a++)
                    for (var l = a + 1; l < 4; l++)
                        this.container_arrow.getChildByName(a.toString() + l.toString()).visible = !1,
                        this.container_arrow.getChildByName(l.toString() + a.toString()).visible = !1;
                if (Laya.timer.once(250, this, function() {
                    e.change_num = [];
                    for (var i = e.calu_line(t), n = 0; n < i.length; n++) {
                        var a = view.DesktopMgr.Inst.seat2LocalPosition(i[n].b)
                          , r = view.DesktopMgr.Inst.seat2LocalPosition(i[n].a)
                          , s = a.toString() + r.toString()
                          , o = e.container_arrow.getChildByName(s);
                        o.alpha = 0,
                        o.visible = !0,
                        Laya.Tween.to(o, {
                            alpha: 1
                        }, 100)
                    }
                }),
                r)
                    for (var h = 0, a = 0; a < 33; a++)
                        Laya.timer.once(1200 + 30 * a, this, function() {
                            h % 5 == 0 && view.AudioMgr.PlayAudio(222);
                            for (var i = ++h / 33, n = 0; n < t.length; n++)
                                if (0 != t[n].delta) {
                                    var a = view.DesktopMgr.Inst.seat2LocalPosition(n)
                                      , r = Math.ceil(t[n].delta * i);
                                    if (33 != h) {
                                        var s = t[n].delta - r;
                                        e.viewplayers[a].txt_delta.text = s > 0 ? "+" + s : s.toString()
                                    } else
                                        e.viewplayers[a].txt_delta.visible = !1;
                                    e.setScore(e.viewplayers[a].img_scores, t[n].old_score + r)
                                }
                        });
                this.btn_confirm.visible = !1,
                this.label_waitingother.visible = !1;
                var c = r ? 4500 : 1200;
                Laya.timer.once(c, this, function() {
                    e.btn_confirm.visible = !0,
                    e.btn_confirm.alpha = 0,
                    Laya.Tween.to(e.btn_confirm, {
                        alpha: 1
                    }, 100);
                    for (var i = [], n = 0; n < t.length; n++)
                        i.push(t[n].delta + t[n].old_score);
                    if (view.DesktopMgr.Inst.setScores(i),
                    view.DesktopMgr.Inst.mode == view.EMJMode.play) {
                        e.count_down.text = "(3)";
                        for (var a = function(t) {
                            Laya.timer.once(1e3 * t, e, function() {
                                e.btn_confirm.visible && (e.count_down.text = "(" + (3 - t).toString() + ")")
                            })
                        }, n = 0; n < 3; n++)
                            a(n);
                        Laya.timer.once(3e3, e, function() {
                            e.btn_confirm.visible && e.onBtnConfirm()
                        })
                    }
                })
            } else
                this.onBtnConfirm()
        }
        ,
        i.prototype.setScore = function(t, e) {
            for (var i = e.toString(), n = 0; n < t.length; n++)
                t[n].visible = !1;
            for (n = 0; n < i.length && n < t.length; n++) {
                var a = t[n];
                a.visible = !0;
                var r = i.charAt(i.length - 1 - n);
                a.skin = "-" == r ? game.Tools.localUISrc("myres/mjdesktop/ww_minus.png") : game.Tools.localUISrc("myres/mjdesktop/ww_" + r + ".png")
            }
        }
        ,
        i.prototype.calu_line = function(t) {
            for (var e = [], i = [], n = 0; n < t.length; n++)
                i.push(t[n].delta);
            for (; ; ) {
                for (var a = -1, r = -1, s = -1, n = 0; n < i.length; n++) {
                    var o = -1
                      , l = -1;
                    i[h = n] > 0 && (i[o = (h - 1 + i.length) % i.length] < 0 && (l = Math.min(i[h], -i[o])) > s && (s = l,
                    a = h,
                    r = o),
                    i[o = (h + 1) % i.length] < 0 && (l = Math.min(i[h], -i[o])) > s && (s = l,
                    a = h,
                    r = o))
                }
                if (!(s > 0))
                    break;
                e.push({
                    a: a,
                    b: r,
                    score: s
                }),
                i[a] -= s,
                i[r] += s
            }
            for (; ; ) {
                for (var a = -1, r = -1, s = -1, n = 0; n < i.length; n++) {
                    var h = n
                      , o = -1
                      , l = -1;
                    i[h] > 0 && i[o = (h + 2) % i.length] < 0 && (l = Math.min(i[h], -i[o])) > s && (s = l,
                    a = h,
                    r = o)
                }
                if (!(s > 0))
                    break;
                e.push({
                    a: a,
                    b: r,
                    score: s
                }),
                i[a] -= s,
                i[r] += s
            }
            return e
        }
        ,
        i.prototype.onBtnConfirm = function() {
            var e = this;
            if (this.btn_confirm.visible = !1,
            view.DesktopMgr.Inst.mode == view.EMJMode.play)
                if (null != view.DesktopMgr.Inst.gameEndResult)
                    t.UIMgr.Inst.ShowGameEnd(),
                    this.enable = !1;
                else {
                    view.DesktopMgr.Inst.Reset(),
                    Laya.timer.once(200, this, function() {
                        view.DesktopMgr.Inst.timestoped ? view.DesktopMgr.Inst.handles_after_timerun.push(Laya.Handler.create(e, function() {
                            app.NetAgent.sendReq2MJ("FastTest", "confirmNewRound", {}, function(t, e) {})
                        })) : app.NetAgent.sendReq2MJ("FastTest", "confirmNewRound", {}, function(t, e) {})
                    }),
                    this.label_waitingother.visible = !0;
                    var i = 0;
                    Laya.timer.loop(500, this, function() {
                        for (var t = game.Tools.strOfLocalization(2180), n = 0; n < i; n++)
                            t += ".";
                        i = (i + 1) % 4,
                        e.label_waitingother.text = t
                    })
                }
            else if (view.DesktopMgr.Inst.mode == view.EMJMode.paipu)
                t.UI_Replay.Inst.nextStep(!0),
                this.enable = !1;
            else if (view.DesktopMgr.Inst.mode == view.EMJMode.live_broadcast) {
                t.UI_Live_Broadcast.Inst.onScoreChangeConfirm(),
                this.label_waitingother.visible = !0;
                var n = 0;
                Laya.timer.loop(500, this, function() {
                    for (var t = game.Tools.strOfLocalization(2180), i = 0; i < n; i++)
                        t += ".";
                    n = (n + 1) % 4,
                    e.label_waitingother.text = t
                })
            }
        }
        ,
        i.prototype.onDisable = function() {
            Laya.timer.clearAll(this)
        }
        ,
        i.Inst = null,
        i
    }(t.UIBase);
    t.UI_ScoreChange = e
}(uiscript || (uiscript = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), uiscript;
!function(t) {
    var e = function(e) {
        function i() {
            var t = e.call(this, new ui.both_ui.secondconfirmUI) || this;
            return t.func_cancel = null,
            t.func_confirm = null,
            t.locking = !1,
            i.Inst = t,
            t
        }
        return __extends(i, e),
        i.prototype.onCreate = function() {
            var t = this;
            this.root = this.me.getChildByName("root"),
            this.root.getChildByName("btn_confirm").clickHandler = Laya.Handler.create(this, function() {
                t.locking || (t.close(),
                t.func_confirm && t.func_confirm.run(),
                t.func_cancel = null,
                t.func_confirm = null)
            }, null, !1),
            this.root.getChildByName("btn_cancel").clickHandler = Laya.Handler.create(this, function() {
                t.locking || (t.close(),
                t.func_cancel && t.func_cancel.run(),
                t.func_cancel = null,
                t.func_confirm = null)
            }, null, !1),
            this.root.getChildByName("btn_cancel").filters = [new Laya.ColorFilter([.3086, .6094, .082, 0, 0, .3086, .6094, .082, 0, 0, .3086, .6094, .082, 0, 0, 0, 0, 0, 1, 0])],
            this.desc = this.root.getChildByName("desc"),
            this.locking = !1
        }
        ,
        i.prototype.show = function(e, i, n, a, r) {
            var s = this;
            void 0 === i && (i = null),
            void 0 === n && (n = null),
            void 0 === a && (a = 960),
            void 0 === r && (r = 560),
            this.func_cancel = n,
            this.func_confirm = i,
            this.desc.text = e,
            this.root.x = a,
            this.root.y = r,
            this.root.getChildByName("btn_confirm").x = 114,
            this.root.getChildByName("btn_cancel").x = 339,
            this.root.getChildByName("btn_cancel").visible = !0,
            this.locking = !0,
            this.enable = !0,
            t.UIBase.anim_pop_out(this.root, Laya.Handler.create(this, function() {
                s.locking = !1
            }))
        }
        ,
        i.prototype.show_only_confirm = function(e, i, n, a) {
            var r = this;
            void 0 === i && (i = null),
            void 0 === n && (n = 960),
            void 0 === a && (a = 560),
            this.func_confirm = i,
            this.desc.text = e,
            this.root.x = n,
            this.root.y = a,
            this.root.getChildByName("btn_confirm").x = 226,
            this.root.getChildByName("btn_cancel").visible = !1,
            this.locking = !0,
            this.enable = !0,
            t.UIBase.anim_pop_out(this.root, Laya.Handler.create(this, function() {
                r.locking = !1
            }))
        }
        ,
        i.prototype.close = function() {
            var e = this;
            this.locking = !0,
            t.UIBase.anim_pop_hide(this.root, Laya.Handler.create(this, function() {
                e.locking = !1,
                e.enable = !1
            }))
        }
        ,
        i.Inst = null,
        i
    }(t.UIBase);
    t.UI_SecondConfirm = e
}(uiscript || (uiscript = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), uiscript;
!function(t) {
    var e = function(e) {
        function i() {
            var t = e.call(this, new ui.common.shimingrenzhengUI) || this;
            return i.Inst = t,
            t
        }
        return __extends(i, e),
        i.prototype.onCreate = function() {
            var t = this;
            this.root = this.me.getChildByName("root"),
            this.input_name = this.root.getChildByName("input_name").getChildByName("txtinput"),
            this.input_id = this.root.getChildByName("input_id").getChildByName("txtinput"),
            this.root.getChildByName("btn").clickHandler = Laya.Handler.create(this, function() {
                t.locking || t.renzheng()
            }, null, !1),
            this.root.getChildByName("btn_close").clickHandler = Laya.Handler.create(this, function() {
                t.locking || t.close()
            }, null, !1)
        }
        ,
        i.prototype.show = function() {
            var e = this;
            this.locking = !0,
            this.enable = !0,
            t.UIBase.anim_pop_out(this.root, Laya.Handler.create(this, function() {
                e.locking = !1
            }))
        }
        ,
        i.prototype.close = function() {
            var e = this;
            this.locking = !0,
            t.UIBase.anim_pop_hide(this.root, Laya.Handler.create(this, function() {
                e.locking = !1,
                e.enable = !1
            }))
        }
        ,
        i.prototype.test_dalu_id = function(t) {
            if (!/^(([1][1-5])|([2][1-3])|([3][1-7])|([4][1-6])|([5][0-4])|([6][1-5])|([7][1])|([8][1-2]))\d{4}(([1][9]\d{2})|([2]\d{3}))(([0][1-9])|([1][0-2]))(([0][1-9])|([1-2][0-9])|([3][0-1]))\d{3}[0-9xX]$/.test(t))
                return !1;
            var e = t.substr(6, 4)
              , i = t.substr(10, 2)
              , n = t.substr(12, 2)
              , a = Date.parse(i + "-" + n + "-" + e)
              , r = Date.now()
              , s = new Date(e,i,0).getDate();
            if (a > r || n > s)
                return !1;
            for (var o = new Array(7,9,10,5,8,4,2,1,6,3,7,9,10,5,8,4,2), l = new Array("1","0","X","9","8","7","6","5","4","3","2"), h = t.split(""), c = 0, u = 0; u < 17; u++)
                c += parseInt(h[u]) * o[u];
            return h[17].toUpperCase() == l[c % 11].toUpperCase()
        }
        ,
        i.prototype.test_hk_id = function(t) {
            if (10 != t.length)
                return !1;
            if ("(" != t.charAt(7) && "（" != t.charAt(7))
                return !1;
            if (")" != t.charAt(9) && "）" != t.charAt(9))
                return !1;
            var e = 0;
            t = t.toUpperCase();
            var i = "A".charCodeAt(0)
              , n = "Z".charCodeAt(0)
              , a = "0".charCodeAt(0)
              , r = t.charCodeAt(0);
            if (r < i || r > n)
                return !1;
            e += 8 * (r - i + 1);
            for (var s = 1; s <= 6; s++) {
                var o = t.charCodeAt(s) - a;
                if (o < 0 || o > 9)
                    return !1;
                e += o * (8 - s)
            }
            return 0 == (e %= 11) ? "0" == t.charAt(8) : 1 == e ? "A" == t.charAt(8) : 11 - e == t.charCodeAt(8) - a
        }
        ,
        i.prototype.test_tw_id = function(t) {
            if (10 != t.length)
                return !1;
            t = t.toUpperCase();
            for (var e = "ABCDEFGHJKLMNPQRSTUVXYWZIO", i = -1, n = 0; n < e.length; n++)
                if (e.charAt(n) === t.charAt(0)) {
                    i = n;
                    break
                }
            if (-1 == i)
                return !1;
            for (var a = i + 10, r = Math.floor(a / 10), s = a % 10, o = "0".charCodeAt(0), l = r + 9 * s, n = 1; n <= 8; n++) {
                var h = t.charCodeAt(n) - o;
                if (h < 0 || h > 9)
                    return !1;
                l += h * (9 - n)
            }
            var c = t.charCodeAt(9) - o;
            return !(c < 0 || c > 9) && l % 10 == (10 - c) % 10
        }
        ,
        i.prototype.test_aomen_id = function(t) {
            return /^[1|5|7][0-9]{6}\([0-9Aa]\)/.test(t)
        }
        ,
        i.prototype.test_id = function(t) {
            return !!this.test_dalu_id(t) || (!!this.test_hk_id(t) || (!!this.test_tw_id(t) || !!this.test_aomen_id(t)))
        }
        ,
        i.prototype.renzheng = function() {
            var e = this.input_name.text;
            if (e = e.replace("·", ""),
            /^([\u4e00-\u9fa5]){2,10}$/.test(e)) {
                this.test_id(this.input_id.text) ? (app.NetAgent.sendReq2Lobby("Lobby", "updateIDCardInfo", {
                    fullname: this.input_name.text,
                    card_no: this.input_id.text
                }, function(e, n) {
                    e || n.error ? t.UIMgr.Inst.showNetReqError("updateIDCardInfo", e, n) : (i.renzhenged = !0,
                    t.UI_LightTips.Inst.show(game.Tools.strOfLocalization(2182)))
                }),
                this.close()) : t.UIMgr.Inst.ShowErrorInfo(game.Tools.strOfLocalization(2183))
            } else
                t.UIMgr.Inst.ShowErrorInfo(game.Tools.strOfLocalization(2181))
        }
        ,
        i.renzhenged = !1,
        i
    }(t.UIBase);
    t.UI_ShiMingRenZheng = e
}(uiscript || (uiscript = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), uiscript;
!function(t) {
    var e = function() {
        function e(e) {
            var i = this;
            this.me = e,
            this.root = this.me.getChildByName("root"),
            this.name = this.root.getChildByName("label_name"),
            this.desc = this.root.getChildByName("desc"),
            this.root.getChildByName("btn_close").clickHandler = Laya.Handler.create(this, function() {
                i.close()
            }, null, !1),
            this.container_item = this.root.getChildByName("item"),
            this.buyed = this.container_item.getChildByName("buyed"),
            this.icon = new t.UI_Item_Skin(this.container_item.getChildByName("icon")),
            this.container_price = this.root.getChildByName("price"),
            this.btn_buy = this.root.getChildByName("btn_buy"),
            this.btn_buy.clickHandler = Laya.Handler.create(this, this.on_buy, null, !1),
            this.owned_count = this.root.getChildByName("owned_count")
        }
        return e.prototype.show = function(e, i, n) {
            this.me.visible = !0,
            this.inzhp = e,
            t.UIBase.anim_pop_out(this.root, null),
            this.shop_item_id = i,
            this.buyed_count = n;
            var a;
            if (e)
                this.currency_icon = cfg.item_definition.currency.get(100002).icon,
                this.my_currency_num = GameMgr.Inst.account_data.gold,
                a = cfg.shops.zhp_goods.get(i);
            else {
                var r = (a = cfg.shops.goods.get(i)).currency;
                10 == Math.floor(r / 1e4) ? this.currency_icon = cfg.item_definition.currency.get(r).icon : this.currency_icon = cfg.item_definition.item.get(r).icon_transparent,
                this.my_currency_num = t.UI_Bag.get_item_count(r)
            }
            a.show_has ? (this.owned_count.visible = !0,
            this.owned_count.text = game.Tools.strOfLocalization(2212, [t.UI_Bag.get_item_count(a.item_id).toString()])) : this.owned_count.visible = !1;
            var s = cfg.item_definition.item.get(a.item_id);
            this.name.text = s["name_" + GameMgr.client_language],
            this.desc.text = s["desc_" + GameMgr.client_language],
            this.icon.setSkin(a.icon),
            this.single_price = a.price,
            this.container_price.getChildByName("icon").skin = game.LoadMgr.getResImageSkin(this.currency_icon),
            this.refresh_cost(this.single_price);
            var o = a.buy_limit;
            null != o && o < 0 ? (this.buyed.visible = !1,
            this.icon.me.filters = [],
            game.Tools.setGrayDisable(this.btn_buy, this.single_price > this.my_currency_num)) : a.buy_limit <= n ? (this.buyed.visible = !0,
            this.icon.me.filters = [new Laya.ColorFilter(t.DARK_FILTER)],
            game.Tools.setGrayDisable(this.btn_buy, !0)) : (this.buyed.visible = !1,
            this.icon.me.filters = [],
            game.Tools.setGrayDisable(this.btn_buy, this.single_price > this.my_currency_num))
        }
        ,
        e.prototype.close = function() {
            var e = this;
            t.UIBase.anim_pop_hide(this.root, Laya.Handler.create(this, function() {
                e.me.visible = !1
            }))
        }
        ,
        e.prototype.refresh_cost = function(t) {
            this.container_price.getChildByName("label0"),
            this.container_price.getChildByName("icon");
            var e = this.container_price.getChildByName("count");
            e.text = t.toString(),
            e.color = t <= this.my_currency_num ? "#00ff00" : "#ff0000",
            game.Tools.child_align_center(this.container_price, [10, 5])
        }
        ,
        e.prototype.on_buy = function() {
            this.close(),
            game.Tools.setGrayDisable(this.btn_buy, !0),
            this.inzhp ? n.Inst.want_to_buy_zhp(this.shop_item_id, 1) : n.Inst.want_to_buy_othershop(this.shop_item_id, 1)
        }
        ,
        e
    }()
      , i = function() {
        function e(e) {
            var i = this;
            this.mounthly = !1,
            this.me = e,
            this.root = this.me.getChildByName("root"),
            this.name = this.root.getChildByName("label_name"),
            this.desc = this.root.getChildByName("desc"),
            this.root.getChildByName("btn_close").clickHandler = Laya.Handler.create(this, function() {
                i.close()
            }, null, !1),
            this.container_item = this.root.getChildByName("item"),
            this.buyed = this.container_item.getChildByName("buyed"),
            this.icon = new t.UI_Item_Skin(this.container_item.getChildByName("icon")),
            this.label_count = this.root.getChildByName("count"),
            this.container_danjia = this.root.getChildByName("danjia"),
            this.container_left_count = this.root.getChildByName("left"),
            this.label_refresh_info = this.root.getChildByName("refresh_info"),
            this.container_price = this.root.getChildByName("price"),
            this.btn_buy = this.root.getChildByName("btn_buy"),
            this.btn_buy.clickHandler = Laya.Handler.create(this, this.on_buy, null, !1);
            for (var n = ["-10", "-1", "+1", "+10"], a = function(t) {
                var e = r.root.getChildByName(n[t])
                  , a = e.getChildByName("s");
                a.alpha = 0;
                var s = !1;
                e.on("mousedown", r, function() {
                    a.alpha = 0,
                    s = !0,
                    Laya.Tween.to(a, {
                        alpha: 1
                    }, 50, null, null, 0, !0, !0)
                }),
                e.on("mouseup", r, function() {
                    if (Laya.Tween.to(a, {
                        alpha: 0
                    }, 50, null, null, 0, !0, !0),
                    s)
                        switch (t) {
                        case 0:
                            i.on_num_change(-10);
                            break;
                        case 1:
                            i.on_num_change(-1);
                            break;
                        case 2:
                            i.on_num_change(1);
                            break;
                        case 3:
                            i.on_num_change(10)
                        }
                    s = !1
                }),
                e.on("mouseout", r, function() {
                    Laya.Tween.to(a, {
                        alpha: 0
                    }, 50, null, null, 0, !0, !0),
                    s = !1
                })
            }, r = this, s = 0; s < n.length; s++)
                a(s);
            this.owned_count = this.root.getChildByName("owned_count")
        }
        return e.prototype.show = function(e, i, n) {
            this.me.visible = !0,
            this.inzhp = e,
            this.buyed_count = n,
            this.shop_item_id = i,
            t.UIBase.anim_pop_out(this.root, null);
            var a;
            if (e)
                this.currency_icon = cfg.item_definition.currency.get(100002).icon,
                this.my_currency_num = GameMgr.Inst.account_data.gold,
                a = cfg.shops.zhp_goods.get(i),
                this.mounthly = !1;
            else {
                var r = (a = cfg.shops.goods.get(i)).currency;
                10 == Math.floor(r / 1e4) ? this.currency_icon = cfg.item_definition.currency.get(r).icon : this.currency_icon = cfg.item_definition.item.get(r).icon_transparent,
                this.my_currency_num = t.UI_Bag.get_item_count(r),
                this.mounthly = 4 == a.category
            }
            this.shop_table = a,
            this.single_price = a.price,
            this.container_price.getChildByName("icon").skin = game.LoadMgr.getResImageSkin(this.currency_icon),
            a.show_has ? (this.owned_count.visible = !0,
            this.owned_count.text = game.Tools.strOfLocalization(2212, [t.UI_Bag.get_item_count(a.item_id).toString()])) : this.owned_count.visible = !1;
            var s = cfg.item_definition.item.get(a.item_id);
            this.name.text = s["name_" + GameMgr.client_language],
            this.desc.text = s["desc_" + GameMgr.client_language],
            this.icon.setSkin(a.icon),
            this.count = 1,
            this.refresh(),
            this.label_refresh_info.visible = this.mounthly,
            null != a.buy_limit && a.buy_limit < 0 ? (this.container_left_count.visible = !1,
            this.container_danjia.x = 393) : (this.container_left_count.visible = !0,
            this.container_danjia.x = 300,
            this.container_left_count.getChildByName("count").text = (this.mounthly ? game.Tools.strOfLocalization(2184) : "") + (a.buy_limit - n).toString()),
            this.container_danjia.getChildByName("icon").skin = game.LoadMgr.getResImageSkin(this.currency_icon),
            this.container_danjia.getChildByName("price").text = this.single_price.toString()
        }
        ,
        e.prototype.close = function() {
            var e = this;
            t.UIBase.anim_pop_hide(this.root, Laya.Handler.create(this, function() {
                e.me.visible = !1
            }))
        }
        ,
        e.prototype.on_buy = function() {
            this.close(),
            game.Tools.setGrayDisable(this.btn_buy, !0),
            this.inzhp ? n.Inst.want_to_buy_zhp(this.shop_item_id, this.count) : n.Inst.want_to_buy_othershop(this.shop_item_id, this.count)
        }
        ,
        e.prototype.on_num_change = function(t) {
            this.count += t,
            this.shop_table.buy_limit && this.shop_table.buy_limit >= 0 && this.count + this.buyed_count > this.shop_table.buy_limit && (this.count = this.shop_table.buy_limit - this.buyed_count),
            this.count >= 999 && (this.count = 999),
            this.count < 1 && (this.count = 1),
            this.refresh()
        }
        ,
        e.prototype.refresh = function() {
            this.label_count.text = this.count.toString();
            var e = this.shop_table.buy_limit;
            null != e && e < 0 ? (this.buyed.visible = !1,
            this.icon.me.filters = [],
            game.Tools.setGrayDisable(this.btn_buy, this.single_price * this.count > this.my_currency_num)) : this.shop_table.buy_limit <= this.buyed_count ? (this.buyed.visible = !0,
            this.icon.me.filters = [new Laya.ColorFilter(t.DARK_FILTER)],
            game.Tools.setGrayDisable(this.btn_buy, !0)) : (this.buyed.visible = !1,
            this.icon.me.filters = [],
            game.Tools.setGrayDisable(this.btn_buy, this.single_price * this.count > this.my_currency_num)),
            this.refresh_cost(this.count * this.single_price)
        }
        ,
        e.prototype.refresh_cost = function(t) {
            this.container_price.getChildByName("label0"),
            this.container_price.getChildByName("icon");
            var e = this.container_price.getChildByName("count");
            e.text = t.toString(),
            e.color = t <= this.my_currency_num ? "#00ff00" : "#ff0000",
            game.Tools.child_align_center(this.container_price, [10, 5])
        }
        ,
        e
    }()
      , n = function(n) {
        function a() {
            var t = n.call(this, new ui.lobby.shopUI) || this;
            return t.money = null,
            t.tabs = [],
            t.heads = [],
            t.currencys = {},
            t.locking = !1,
            t.shop_index = -1,
            t.items = [],
            a.Inst = t,
            t
        }
        return __extends(a, n),
        a.init = function() {
            var e = this;
            app.NetAgent.sendReq2Lobby("Lobby", "fetchShopInfo", {}, function(i, n) {
                i || n.error ? t.UIMgr.Inst.showNetReqError("fetchShopInfo", i, n) : e.shopinfo = JSON.parse(JSON.stringify(n)).shop_info
            }),
            app.NetAgent.AddListener2Lobby("NotifyShopUpdate", Laya.Handler.create(this, function(t) {
                e.shopinfo = t.shop_info,
                e.Inst && e.Inst.enable && e.Inst.refresh_info()
            }, null, !1))
        }
        ,
        a.prototype.onCreate = function() {
            var n = this;
            this.container_top = this.me.getChildByName("top"),
            this.container_top.getChildByName("btn_back").clickHandler = Laya.Handler.create(this, function() {
                n.locking || n.close(Laya.Handler.create(n, function() {
                    t.UI_Lobby.Inst.enable = !0
                }))
            }, null, !1),
            this.money = new t.UI_Money(this.container_top,Laya.Handler.create(this, function(t) {
                n.close(t)
            }, null, !1),Laya.Handler.create(this, function() {
                return n.locking
            }, null, !1)),
            this.container_content = this.me.getChildByName("content"),
            this.container_tab = this.container_content.getChildByName("tabs"),
            this.tabs = [];
            for (var a = function(t) {
                var e = r.container_tab.getChildAt(t);
                r.tabs.push(e),
                e.clickHandler = Laya.Handler.create(r, function() {
                    n.shop_index != t && n.change_tab(t)
                }, null, !1)
            }, r = this, s = 0; s < this.container_tab.numChildren; s++)
                a(s);
            var o = this.container_content.getChildByName("right");
            this.timerefresh = o.getChildByName("head0").getChildByName("time"),
            this.scrollview = o.scriptMap["capsui.CScrollView"],
            this.scrollview.init_scrollview(Laya.Handler.create(this, this.render_item, null, !1), -1, 4),
            this.buy_single = new e(this.me.getChildByName("pop_buy_single")),
            this.buy_multi = new i(this.me.getChildByName("pop_buy_multi")),
            this.heads = [];
            for (s = 0; s < 4; s++)
                this.heads.push(this.container_content.getChildByName("right").getChildByName("head" + s));
            this.btn_refreshZHP = this.heads[0].getChildByName("refresh"),
            this.heads[0].getChildByName("refresh").clickHandler = Laya.Handler.create(this, function() {
                n.locking || t.UI_SecondConfirm.Inst.show(game.Tools.strOfLocalization(2204), Laya.Handler.create(n, function() {
                    n.refresh_zhp()
                }), null)
            }, null, !1),
            t.UI_Bag.add_item_listener(302002, Laya.Handler.create(this, function() {
                1 == n.shop_index && n.refresh_head_show()
            }, null, !1)),
            t.UI_Bag.add_item_listener(302003, Laya.Handler.create(this, function() {
                2 == n.shop_index && n.refresh_head_show()
            }, null, !1)),
            t.UI_Bag.add_item_listener(302004, Laya.Handler.create(this, function() {
                3 == n.shop_index && n.refresh_head_show()
            }, null, !1))
        }
        ,
        a.prototype.getLocalTime = function() {
            var t, e, i, n = new Date, a = n.getTime() + 6e4 * n.getTimezoneOffset();
            new Date(a + 288e5).getHours(),
            n.getHours();
            return n.getUTCHours() + 8 < 4 ? (t = 5 - (n.getUTCHours() + 8),
            i = game.Tools.strOfLocalization(2674, [t.toString()]) + game.Tools.strOfLocalization(2747)) : n.getUTCHours() + 8 >= 5 && (t = 24 - (n.getUTCHours() + 8) + 5,
            i = game.Tools.strOfLocalization(2674, [t.toString()]) + game.Tools.strOfLocalization(2747)),
            n.getUTCHours() + 8 == 4 && (e = 60 - n.getMinutes(),
            i = game.Tools.strOfLocalization(2674, [e.toString()]) + game.Tools.strOfLocalization(2748)),
            i
        }
        ,
        a.prototype.show = function() {
            var e = this;
            this.enable = !0,
            this.locking = !0,
            game.Scene_Lobby.Inst.change_bg("indoor", !1),
            t.UIBase.anim_alpha_in(this.container_top, {
                y: -30
            }, 150),
            t.UIBase.anim_alpha_in(this.container_content, {
                y: 30
            }, 150),
            this.refresh_info(),
            this.money.onEnable(),
            this.timerefresh.text = this.getLocalTime(),
            Laya.timer.once(150, this, function() {
                e.locking = !1
            })
        }
        ,
        a.prototype.close = function(e) {
            var i = this;
            this.locking = !0,
            t.UIBase.anim_alpha_out(this.container_top, {
                y: -30
            }, 150),
            t.UIBase.anim_alpha_out(this.container_content, {
                y: 30
            }, 150),
            Laya.timer.once(150, this, function() {
                i.locking = !1,
                i.enable = !1,
                e && e.run()
            })
        }
        ,
        a.prototype.onDisable = function() {
            this.shop_index = -1
        }
        ,
        a.prototype.refresh_info = function() {
            this.buy_single.me.visible = !1,
            this.buy_multi.me.visible = !1,
            a.shopinfo ? this.change_tab(0) : this.change_tab(-1)
        }
        ,
        a.prototype.change_tab = function(t) {
            var e = this;
            a.shopinfo || (t = -1),
            this.shop_index = t;
            for (l = 0; l < this.tabs.length; l++)
                this.tabs[l].skin = game.Tools.localUISrc(t == l ? "myres/shop/tab_choose.png" : "myres/shop/tab_unchoose.png"),
                this.tabs[l].getChildAt(0).color = t == l ? "#d9b263" : "#8cb65f";
            if (this.refresh_head_show(),
            this.items = [],
            this.scrollview.reset(),
            0 == this.shop_index) {
                var i = a.shopinfo.zhp;
                if (i) {
                    if (i.goods)
                        for (l = 0; l < i.goods.length; l++)
                            this.items.push({
                                shop_item_id: i.goods[l],
                                buyed_count: 0,
                                sort: l
                            });
                    if (i.buy_records)
                        for (l = 0; l < i.buy_records.length; l++)
                            for (var n = i.buy_records[l], r = 0; r < this.items.length; r++)
                                this.items[r].shop_item_id == n.id && (this.items[r].buyed_count = n.count)
                }
            } else if (1 == this.shop_index || 2 == this.shop_index) {
                cfg.shops.goods.forEach(function(t) {
                    t.category == e.shop_index && e.items.push({
                        shop_item_id: t.id,
                        buyed_count: 0,
                        sort: t.sort
                    })
                }),
                this.items = this.items.sort(function(t, e) {
                    return t.sort - e.sort
                });
                if ((o = a.shopinfo).buy_records)
                    for (l = 0; l < o.buy_records.length; l++)
                        for (var n = o.buy_records[l], s = 0; s < this.items.length; s++)
                            this.items[s].shop_item_id == n.id && (this.items[s].buyed_count = n.count)
            } else if (3 == this.shop_index) {
                cfg.shops.goods.forEach(function(t) {
                    4 == t.category && e.items.push({
                        shop_item_id: t.id,
                        buyed_count: 0,
                        sort: t.sort
                    })
                }),
                cfg.shops.goods.forEach(function(t) {
                    3 == t.category && e.items.push({
                        shop_item_id: t.id,
                        buyed_count: 0,
                        sort: t.sort + 1e5
                    })
                }),
                this.items = this.items.sort(function(t, e) {
                    return t.sort - e.sort
                });
                var o = a.shopinfo;
                if (o.buy_records)
                    for (var l = 0; l < o.buy_records.length; l++)
                        for (var n = o.buy_records[l], h = 0; h < this.items.length; h++)
                            this.items[h].shop_item_id == n.id && (this.items[h].buyed_count = n.count)
            }
            this.scrollview.addItem(this.items.length)
        }
        ,
        a.prototype.refresh_head_show = function() {
            for (var e = 0; e < this.heads.length; e++)
                this.heads[e].visible = this.shop_index == e;
            if (0 == this.shop_index) {
                var i = a.shopinfo.zhp;
                if (i) {
                    var n = this.heads[0].getChildByName("refresh")
                      , r = this.heads[0].getChildByName("noinfo")
                      , s = this.heads[0].getChildByName("count");
                    if (n.visible = !1,
                    r.visible = !1,
                    s.text = "",
                    i.free_refresh && i.free_refresh.count < i.free_refresh.limit)
                        n.visible = !0,
                        n.getChildByName("pay").visible = !1,
                        n.getChildByName("free").visible = !0,
                        n.getChildByName("free").text = game.Tools.strOfLocalization(2185),
                        s.text = game.Tools.strOfLocalization(2186) + (i.free_refresh.limit - i.free_refresh.count);
                    else if (i.cost_refresh && i.cost_refresh.count < i.cost_refresh.limit) {
                        var o = cfg.shops.zhp_refresh_price.get(i.cost_refresh.count + 1);
                        if (o) {
                            n.visible = !0,
                            n.getChildByName("free").visible = !1;
                            var l = n.getChildByName("pay");
                            l.visible = !0;
                            var h = l.getChildByName("count")
                              , c = l.getChildByName("icon")
                              , u = l.getChildByName("money");
                            h.text = game.Tools.strOfLocalization(2187),
                            s.text = game.Tools.strOfLocalization(2188) + (i.cost_refresh.limit - i.cost_refresh.count),
                            c.skin = game.LoadMgr.getResImageSkin(cfg.item_definition.currency.get(100001).icon),
                            u.text = "×" + o.refresh_price.toString(),
                            game.Tools.child_align_center(n.getChildByName("pay"), [30])
                        } else
                            r.visible = !0
                    } else
                        r.visible = !0
                } else
                    this.heads[0].visible = !1
            } else if (this.shop_index >= 1 && this.shop_index <= 3) {
                var _ = void 0;
                switch (this.shop_index) {
                case 1:
                    _ = 302002;
                    break;
                case 2:
                    _ = 302003;
                    break;
                case 3:
                    _ = 302004
                }
                var d = this.heads[this.shop_index];
                this.currencys[this.shop_index] || (this.currencys[this.shop_index] = new t.UI_Item_Skin(d.getChildByName("icon"))),
                this.currencys[this.shop_index].setSkin(cfg.item_definition.item.get(_).icon_transparent),
                d.getChildByName("count").text = "×" + t.UI_Bag.get_item_count(_).toString()
            }
        }
        ,
        a.prototype.render_item = function(e) {
            var i = this
              , n = e.index
              , a = e.container
              , r = e.cache_data;
            r.skin || (r.skin = new t.UI_Item_Skin(a.getChildByName("btn").getChildByName("icon")));
            var s, o, l = this.items[n];
            if (0 == this.shop_index)
                o = cfg.item_definition.currency.get(100002).icon,
                s = cfg.shops.zhp_goods.get(l.shop_item_id);
            else {
                var h = (s = cfg.shops.goods.get(l.shop_item_id)).currency;
                o = 10 == Math.floor(h / 1e4) ? cfg.item_definition.currency.get(h).icon : cfg.item_definition.item.get(h).icon_transparent
            }
            var c = a.getChildByName("btn");
            if (c.clickHandler = Laya.Handler.create(this, function() {
                t.UI_PiPeiYuYue.Inst.enable ? t.UI_Popout.PopOutNoTitle(game.Tools.strOfLocalization(204), null) : s.need_amount ? i.buy_multi.show(0 == i.shop_index, l.shop_item_id, l.buyed_count) : i.buy_single.show(0 == i.shop_index, l.shop_item_id, l.buyed_count)
            }, null, !1),
            c.getChildByName("label_name").text = s["name_" + GameMgr.client_language],
            r.skin.setSkin(s.icon),
            s.buy_limit >= 0)
                if (4 == s.category)
                    if (l.buyed_count >= s.buy_limit)
                        c.getChildByName("buyed").visible = !0,
                        c.getChildByName("icon").filters = [new Laya.ColorFilter(t.DARK_FILTER)],
                        c.getChildByName("btn_buy").filters = [new Laya.ColorFilter(t.GRAY_FILTER)],
                        c.getChildByName("count").visible = !0,
                        c.getChildByName("count").text = game.Tools.strOfLocalization(2189) + "0";
                    else {
                        c.getChildByName("icon").filters = [],
                        c.getChildByName("btn_buy").filters = [],
                        c.getChildByName("buyed").visible = !1,
                        c.getChildByName("count").visible = !0;
                        u = s.buy_limit - l.buyed_count;
                        c.getChildByName("count").text = game.Tools.strOfLocalization(2189) + u
                    }
                else if (l.buyed_count >= s.buy_limit)
                    c.getChildByName("icon").filters = [new Laya.ColorFilter(t.DARK_FILTER)],
                    c.getChildByName("btn_buy").filters = [new Laya.ColorFilter(t.GRAY_FILTER)],
                    c.getChildByName("buyed").visible = !0,
                    c.getChildByName("count").visible = !1;
                else {
                    c.getChildByName("icon").filters = [],
                    c.getChildByName("btn_buy").filters = [],
                    c.getChildByName("buyed").visible = !1,
                    c.getChildByName("count").visible = !0;
                    var u = s.buy_limit - l.buyed_count;
                    c.getChildByName("count").text = u > 1 ? game.Tools.strOfLocalization(2190) + u.toString() : ""
                }
            else
                c.getChildByName("icon").filters = [],
                c.getChildByName("btn_buy").filters = [],
                c.getChildByName("buyed").visible = !1,
                c.getChildByName("count").visible = !1;
            c.getChildByName("btn_buy").getChildByName("currency").skin = game.LoadMgr.getResImageSkin(o),
            c.getChildByName("btn_buy").getChildByName("label_gold").text = s.price,
            game.Tools.child_align_center(c.getChildByName("btn_buy"))
        }
        ,
        a.prototype.want_to_buy_zhp = function(e, i) {
            var n = this;
            app.NetAgent.sendReq2Lobby("Lobby", "buyFromZHP", {
                goods_id: e,
                count: i
            }, function(r, s) {
                if (r || s.error)
                    t.UIMgr.Inst.showNetReqError("buyFromZHP", r, s);
                else {
                    if (t.UI_LightTips.Inst.show(game.Tools.strOfLocalization(2191)),
                    view.AudioMgr.PlayAudio(106),
                    0 == n.shop_index)
                        for (h = 0; h < n.items.length; h++)
                            if (n.items[h].shop_item_id == e) {
                                n.items[h].buyed_count += i,
                                n.scrollview.wantToRefreshItem(h);
                                break
                            }
                    var o = a.shopinfo.zhp;
                    if (o) {
                        o.buy_records || (o.buy_records = []);
                        for (var l = !1, h = 0; h < o.buy_records.length; h++)
                            if (o.buy_records[h].id == e) {
                                o.buy_records[h].count += i,
                                l = !0;
                                break
                            }
                        l || o.buy_records.push({
                            id: e,
                            count: i
                        })
                    }
                }
            })
        }
        ,
        a.prototype.want_to_buy_othershop = function(e, i) {
            var n = this;
            app.NetAgent.sendReq2Lobby("Lobby", "buyFromShop", {
                goods_id: e,
                count: i
            }, function(r, s) {
                if (r || s.error)
                    t.UIMgr.Inst.showNetReqError("buyFromShop", r, s);
                else {
                    if (view.AudioMgr.PlayAudio(106),
                    0 != n.shop_index)
                        for (h = 0; h < n.items.length; h++)
                            if (n.items[h].shop_item_id == e) {
                                n.items[h].buyed_count += i,
                                n.scrollview.wantToRefreshItem(h);
                                break
                            }
                    a.shopinfo.buy_records || (a.shopinfo.buy_records = []);
                    for (var o = a.shopinfo.buy_records, l = !1, h = 0; h < o.length; h++)
                        if (o[h].id == e) {
                            o[h].count += i,
                            l = !0;
                            break
                        }
                    l || o.push({
                        id: e,
                        count: i
                    }),
                    s.rewards && s.rewards.length > 0 ? game.Tools.showRewards(s, null) : t.UI_LightTips.Inst.show(game.Tools.strOfLocalization(2191))
                }
            })
        }
        ,
        a.prototype.refresh_zhp = function() {
            var e = this;
            game.Tools.setGrayDisable(this.btn_refreshZHP, !0),
            app.NetAgent.sendReq2Lobby("Lobby", "refreshZHPShop", {}, function(i, n) {
                if (game.Tools.setGrayDisable(e.btn_refreshZHP, !1),
                i || n.error)
                    t.UIMgr.Inst.showNetReqError("refreshZHPShop", i, n);
                else {
                    a.shopinfo.zhp = JSON.parse(JSON.stringify(n.zhp));
                    a.shopinfo.zhp;
                    0 == e.shop_index && e.change_tab(0)
                }
            })
        }
        ,
        a.Inst = null,
        a.shopinfo = null,
        a
    }(t.UIBase);
    t.UI_Shop = n
}(uiscript || (uiscript = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), uiscript;
!function(t) {
    var e = function() {
        function e(t, e) {
            var i = this;
            this.scale = 1,
            this.during_move = !1,
            this.mouse_start_x = 0,
            this.mouse_start_y = 0,
            this.me = t,
            this.container_illust = e,
            this.illust = this.container_illust.getChildByName("illust"),
            this.container_move = t.getChildByName("move"),
            this.container_move.on("mousedown", this, function() {
                i.during_move = !0,
                i.mouse_start_x = i.container_move.mouseX,
                i.mouse_start_y = i.container_move.mouseY
            }),
            this.container_move.on("mousemove", this, function() {
                i.during_move && (i.move(i.container_move.mouseX - i.mouse_start_x, i.container_move.mouseY - i.mouse_start_y),
                i.mouse_start_x = i.container_move.mouseX,
                i.mouse_start_y = i.container_move.mouseY)
            }),
            this.container_move.on("mouseup", this, function() {
                i.during_move = !1
            }),
            this.container_move.on("mouseout", this, function() {
                i.during_move = !1
            }),
            this.btn_big = t.getChildByName("btn_big"),
            this.btn_big.clickHandler = Laya.Handler.create(this, function() {
                i.locking || i.bigger()
            }, null, !1),
            this.btn_small = t.getChildByName("btn_small"),
            this.btn_small.clickHandler = Laya.Handler.create(this, function() {
                i.locking || i.smaller()
            }, null, !1),
            this.btn_close = t.getChildByName("btn_close"),
            this.btn_close.clickHandler = Laya.Handler.create(this, function() {
                i.locking || i.close()
            }, null, !1)
        }
        return e.prototype.show = function(e) {
            var n = this;
            this.locking = !0,
            this.when_close = e,
            this.illust_start_x = this.illust.x,
            this.illust_start_y = this.illust.y,
            this.illust_center_x = this.illust.x + 984 - 446,
            this.illust_center_y = this.illust.y + 11 - 84,
            this.container_illust.getChildByName("container_name").visible = !1,
            this.container_illust.getChildByName("container_name_en").visible = !1,
            this.container_illust.getChildByName("btn").visible = !1,
            i.Inst.stopsay(),
            this.scale = 1,
            Laya.Tween.to(this.illust, {
                x: this.illust_center_x,
                y: this.illust_center_y
            }, 200),
            t.UIBase.anim_pop_out(this.btn_big, null),
            t.UIBase.anim_pop_out(this.btn_small, null),
            t.UIBase.anim_pop_out(this.btn_close, null),
            this.during_move = !1,
            Laya.timer.once(250, this, function() {
                n.locking = !1
            }),
            this.me.visible = !0
        }
        ,
        e.prototype.close = function() {
            var e = this;
            this.locking = !0,
            "chs" == GameMgr.client_language ? this.container_illust.getChildByName("container_name").visible = !0 : this.container_illust.getChildByName("container_name_en").visible = !0,
            this.container_illust.getChildByName("btn").visible = !0,
            Laya.Tween.to(this.illust, {
                x: this.illust_start_x,
                y: this.illust_start_y,
                scaleX: 1,
                scaleY: 1
            }, 200),
            t.UIBase.anim_pop_hide(this.btn_big, null),
            t.UIBase.anim_pop_hide(this.btn_small, null),
            t.UIBase.anim_pop_hide(this.btn_close, null),
            Laya.timer.once(250, this, function() {
                e.locking = !1,
                e.me.visible = !1,
                e.when_close.run()
            })
        }
        ,
        e.prototype.bigger = function() {
            1.1 * this.scale > 1.5 || (this.scale *= 1.1,
            Laya.Tween.to(this.illust, {
                scaleX: this.scale,
                scaleY: this.scale
            }, 100, null, null, 0, !0, !0))
        }
        ,
        e.prototype.smaller = function() {
            this.scale / 1.1 < .5 || (this.scale /= 1.1,
            Laya.Tween.to(this.illust, {
                scaleX: this.scale,
                scaleY: this.scale
            }, 100, null, null, 0, !0, !0))
        }
        ,
        e.prototype.move = function(t, e) {
            var i = this.illust.x + t
              , n = this.illust.y + e;
            i < this.illust_center_x - 600 ? i = this.illust_center_x - 600 : i > this.illust_center_x + 600 && (i = this.illust_center_x + 600),
            n < this.illust_center_y - 1200 ? n = this.illust_center_y - 1200 : n > this.illust_center_y + 800 && (n = this.illust_center_y + 800),
            this.illust.x = i,
            this.illust.y = n
        }
        ,
        e
    }()
      , i = function(i) {
        function n() {
            var t = i.call(this, new ui.lobby.susheUI) || this;
            return t.contianer_illust = null,
            t.illust = null,
            t.container_name = null,
            t.label_name = null,
            t.label_cv = null,
            t.container_page = null,
            t.container_look_illust = null,
            t.page_select_character = null,
            t.page_visit_character = null,
            t.origin_illust_x = 0,
            t.chat_id = 0,
            t.select_index = 0,
            t.container_chat = null,
            t.sound_channel = null,
            t.chat_block = null,
            n.Inst = t,
            t
        }
        return __extends(n, i),
        n.init = function(e) {
            var i = this;
            app.NetAgent.sendReq2Lobby("Lobby", "fetchCharacterInfo", {}, function(n, a) {
                if (n || a.error)
                    t.UIMgr.Inst.showNetReqError("fetchCharacterInfo", n, a);
                else {
                    if (app.Log.log("fetchCharacterInfo: " + JSON.stringify(a)),
                    (a = JSON.parse(JSON.stringify(a))).main_character_id && a.characters) {
                        if (i.characters = [],
                        a.characters)
                            for (r = 0; r < a.characters.length; r++)
                                i.characters.push(a.characters[r]);
                        if (i.skin_map = {},
                        a.skins)
                            for (var r = 0; r < a.skins.length; r++)
                                i.skin_map[a.skins[r]] = 1;
                        i.main_character_id = a.main_character_id
                    } else
                        i.characters = [],
                        i.characters.push({
                            charid: 200001,
                            level: 0,
                            exp: 0,
                            views: [],
                            skin: 400101,
                            is_upgraded: !1,
                            extra_emoji: []
                        }),
                        i.characters.push({
                            charid: 200002,
                            level: 0,
                            exp: 0,
                            views: [],
                            skin: 400201,
                            is_upgraded: !1,
                            extra_emoji: []
                        }),
                        i.skin_map[400101] = 1,
                        i.skin_map[400201] = 1,
                        i.main_character_id = 200001;
                    i.send_gift_count = 0,
                    i.send_gift_limit = 0,
                    a.send_gift_count && (i.send_gift_count = a.send_gift_count),
                    a.send_gift_limit && (i.send_gift_limit = a.send_gift_limit),
                    e.run()
                }
            })
        }
        ,
        n.on_data_updata = function(e) {
            if (e.character) {
                var i = JSON.parse(JSON.stringify(e.character));
                if (i.characters)
                    for (var n = i.characters, a = 0; a < n.length; a++) {
                        for (var r = !1, s = 0; s < this.characters.length; s++)
                            if (this.characters[s].charid == n[a].charid) {
                                this.characters[s] = n[a],
                                t.UI_Sushe_Visit.Inst && t.UI_Sushe_Visit.Inst.chara_info && t.UI_Sushe_Visit.Inst.chara_info.charid == this.characters[s].charid && (t.UI_Sushe_Visit.Inst.chara_info = this.characters[s]),
                                r = !0;
                                break
                            }
                        r || this.characters.push(n[a])
                    }
                if (i.skins)
                    for (var o = i.skins, a = 0; a < o.length; a++)
                        this.skin_map[o[a]] = 1
            }
        }
        ,
        n.chara_owned = function(t) {
            for (var e = 0; e < this.characters.length; e++)
                if (this.characters[e].charid == t)
                    return !0;
            return !1
        }
        ,
        n.skin_owned = function(t) {
            return this.skin_map.hasOwnProperty(t.toString())
        }
        ,
        Object.defineProperty(n, "main_chara_info", {
            get: function() {
                for (var t = 0; t < this.characters.length; t++)
                    if (this.characters[t].charid == this.main_character_id)
                        return this.characters[t];
                return null
            },
            enumerable: !0,
            configurable: !0
        }),
        n.prototype.onCreate = function() {
            var i = this;
            this.contianer_illust = this.me.getChildByName("illust"),
            this.illust = new t.UI_Character_Skin(this.contianer_illust.getChildByName("illust").getChildByName("illust")),
            this.container_chat = this.contianer_illust.getChildByName("chat"),
            this.chat_block = new t.UI_Character_Chat(this.container_chat),
            this.contianer_illust.getChildByName("btn").clickHandler = Laya.Handler.create(this, function() {
                i.page_visit_character.me.visible && i.page_visit_character.cannot_click_say || (i.sound_channel ? i.stopsay() : i.say("lobby_normal"))
            }, null, !1),
            this.container_name = null,
            "chs" == GameMgr.client_language ? (this.container_name = this.contianer_illust.getChildByName("container_name"),
            this.contianer_illust.getChildByName("container_name_en").visible = !1) : (this.container_name = this.contianer_illust.getChildByName("container_name_en"),
            this.contianer_illust.getChildByName("container_name").visible = !1),
            this.label_name = this.container_name.getChildByName("label_name"),
            this.label_cv = this.container_name.getChildByName("label_CV"),
            this.origin_illust_x = this.contianer_illust.x,
            this.container_page = this.me.getChildByName("container_page"),
            this.page_select_character = new t.UI_Sushe_Select,
            this.container_page.addChild(this.page_select_character.me),
            this.page_visit_character = new t.UI_Sushe_Visit,
            this.container_page.addChild(this.page_visit_character.me),
            this.container_look_illust = new e(this.me.getChildByName("look_illust"),this.contianer_illust)
        }
        ,
        n.prototype.show = function() {
            GameMgr.Inst.BehavioralStatistics(15),
            game.Scene_Lobby.Inst.change_bg("indoor", !1),
            this.enable = !0,
            this.page_visit_character.me.visible = !1;
            for (var t = 0, e = 0; e < n.characters.length; e++)
                if (n.characters[e].charid == n.main_character_id) {
                    t = e;
                    break
                }
            this.change_select(t),
            this.show_page_select(),
            this.container_look_illust.me.visible = !1
        }
        ,
        n.prototype.starup_back = function() {
            this.enable = !0,
            this.change_select(this.select_index),
            this.show_page_visit(!0)
        }
        ,
        n.prototype.go2Lobby = function() {
            this.close(Laya.Handler.create(this, function() {
                t.UIMgr.Inst.showLobby()
            }))
        }
        ,
        n.prototype.close = function(e) {
            var i = this;
            t.UIBase.anim_alpha_out(this.contianer_illust, {
                x: -30
            }, 150, 0),
            Laya.timer.once(150, this, function() {
                i.enable = !1,
                e.run()
            })
        }
        ,
        n.prototype.onDisable = function() {
            this.illust.clear(),
            this.stopsay(),
            this.container_look_illust.me.visible && this.container_look_illust.close()
        }
        ,
        n.prototype.show_page_select = function() {
            this.page_select_character.show(this.select_index)
        }
        ,
        n.prototype.show_page_visit = function(t) {
            this.page_visit_character.show(n.characters[this.select_index], t)
        }
        ,
        n.prototype.change_select = function(e) {
            this.select_index = e,
            this.illust.clear();
            var i = n.characters[e];
            this.label_name.text = cfg.item_definition.character.get(i.charid)["name_" + GameMgr.client_language],
            "chs" == GameMgr.client_language ? this.label_cv.text = "CV" + cfg.item_definition.character.get(i.charid)["desc_cv_" + GameMgr.client_language] : this.label_cv.text = "CV:" + cfg.item_definition.character.get(i.charid)["desc_cv_" + GameMgr.client_language],
            this.illust.setSkin(i.skin, "full"),
            Laya.Tween.clearAll(this.contianer_illust),
            this.contianer_illust.x = this.origin_illust_x,
            this.contianer_illust.alpha = 1,
            t.UIBase.anim_alpha_in(this.contianer_illust, {
                x: -30
            }, 230),
            this.stopsay()
        }
        ,
        n.prototype.onChangeSkin = function(t) {
            n.characters[this.select_index].skin = t,
            this.change_select(this.select_index),
            n.characters[this.select_index].charid == n.main_character_id && (GameMgr.Inst.account_data.avatar_id = t),
            app.NetAgent.sendReq2Lobby("Lobby", "changeCharacterSkin", {
                character_id: n.characters[this.select_index].charid,
                skin: t
            }, function(t, e) {})
        }
        ,
        n.prototype.say = function(t) {
            var e = this
              , i = n.characters[this.select_index];
            this.chat_id++;
            var a = this.chat_id
              , r = view.AudioMgr.PlayCharactorSound(i, t, Laya.Handler.create(this, function() {
                Laya.timer.once(1e3, e, function() {
                    a == e.chat_id && e.stopsay()
                })
            }));
            r && (this.chat_block.show(r.words),
            this.sound_channel = r.sound)
        }
        ,
        n.prototype.stopsay = function() {
            this.chat_block.close(!1),
            this.sound_channel && (this.sound_channel.stop(),
            Laya.SoundManager.removeChannel(this.sound_channel),
            this.sound_channel = null)
        }
        ,
        n.prototype.to_look_illust = function() {
            var t = this;
            this.container_look_illust.show(Laya.Handler.create(this, function() {
                t.page_select_character.show(t.select_index)
            }))
        }
        ,
        n.characters = [],
        n.skin_map = {},
        n.main_character_id = 0,
        n.send_gift_count = 0,
        n.send_gift_limit = 0,
        n.Inst = null,
        n
    }(t.UIBase);
    t.UI_Sushe = i
}(uiscript || (uiscript = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), uiscript;
!function(t) {
    var e = function(e) {
        function i() {
            var t = e.call(this, "chs" == GameMgr.client_language ? new ui.lobby.sushe_selectUI : new ui.lobby.sushe_select_enUI) || this;
            return t.container_top = null,
            t.container_heads = null,
            t.scrollview = null,
            t.btn_visit = null,
            t.btn_look = null,
            t.select_index = 0,
            t.locking = !1,
            t
        }
        return __extends(i, e),
        i.prototype.onCreate = function() {
            var e = this;
            this.container_top = this.me.getChildByName("top"),
            this.container_heads = this.me.getChildByName("heads"),
            this.scrollview = this.container_heads.scriptMap["capsui.CScrollView"],
            this.scrollview.init_scrollview(new Laya.Handler(this,this.render_character_cell), -1, 3),
            this.btn_visit = this.me.getChildByName("heads").getChildByName("btn_visit"),
            this.btn_visit.clickHandler = Laya.Handler.create(this, function() {
                e.locking || (e.close(),
                Laya.timer.once(150, e, function() {
                    t.UI_Sushe.Inst.show_page_visit(!1)
                }))
            }, null, !1),
            this.btn_look = this.me.getChildByName("btn_look"),
            this.btn_look.clickHandler = Laya.Handler.create(this, function() {
                e.locking || (e.close(),
                Laya.timer.once(150, e, function() {
                    t.UI_Sushe.Inst.to_look_illust()
                }))
            }, null, !1),
            this.container_top.getChildByName("btn_back").clickHandler = Laya.Handler.create(this, function() {
                e.locking || (e.close(),
                t.UI_Sushe.Inst.go2Lobby())
            }, null, !1)
        }
        ,
        i.prototype.show = function(e) {
            var i = this;
            this.enable = !0,
            this.locking = !0,
            t.UIBase.anim_alpha_in(this.container_top, {
                y: -30
            }, 200),
            t.UIBase.anim_alpha_in(this.container_heads, {
                x: 30
            }, 200),
            t.UIBase.anim_alpha_in(this.btn_look, {
                x: 30
            }, 200),
            Laya.timer.once(200, this, function() {
                i.locking = !1
            }),
            this.select_index = e,
            this.scrollview.reset(),
            this.scrollview.addItem(t.UI_Sushe.characters.length)
        }
        ,
        i.prototype.close = function() {
            var e = this;
            this.locking = !0,
            t.UIBase.anim_alpha_out(this.container_top, {
                y: -30
            }, 150),
            t.UIBase.anim_alpha_out(this.container_heads, {
                x: 30
            }, 150, 0),
            t.UIBase.anim_alpha_out(this.btn_look, {
                x: 30
            }, 150),
            Laya.timer.once(150, this, function() {
                e.locking = !1,
                e.enable = !1
            })
        }
        ,
        i.prototype.onDisable = function() {
            for (var e = 0; e < t.UI_Sushe.characters.length; e++)
                Laya.loader.clearTextureRes(cfg.item_definition.skin.get(t.UI_Sushe.characters[e].skin) + "/bighead.png")
        }
        ,
        i.prototype.render_character_cell = function(e) {
            var i = this
              , n = e.index
              , a = e.container
              , r = e.cache_data;
            r.index = n,
            r.inited || (r.inited = !0,
            a.getChildByName("btn").clickHandler = new Laya.Handler(this,function() {
                i.onClickAtHead(r.index)
            }
            ),
            r.skin = new t.UI_Character_Skin(a.getChildByName("btn").getChildByName("head")));
            var s = a.getChildByName("btn");
            s.getChildByName("choose").visible = n == this.select_index,
            r.skin.setSkin(t.UI_Sushe.characters[n].skin, "bighead"),
            s.getChildByName("using").visible = t.UI_Sushe.characters[n].charid == t.UI_Sushe.main_character_id,
            s.getChildByName("label_name").text = cfg.item_definition.character.find(t.UI_Sushe.characters[n].charid)["name_" + GameMgr.client_language]
        }
        ,
        i.prototype.onClickAtHead = function(e) {
            if (this.select_index == e) {
                if (t.UI_Sushe.characters[e].charid != t.UI_Sushe.main_character_id) {
                    var i = t.UI_Sushe.main_character_id;
                    t.UI_Sushe.main_character_id = t.UI_Sushe.characters[e].charid,
                    app.NetAgent.sendReq2Lobby("Lobby", "changeMainCharacter", {
                        character_id: t.UI_Sushe.main_character_id
                    }, function(t, e) {}),
                    GameMgr.Inst.account_data.avatar_id = t.UI_Sushe.characters[e].skin;
                    for (var n = 0; n < t.UI_Sushe.characters.length; n++)
                        t.UI_Sushe.characters[n].charid == i && this.scrollview.wantToRefreshItem(n);
                    this.scrollview.wantToRefreshItem(e)
                }
            } else {
                var a = this.select_index;
                this.select_index = e,
                this.scrollview.wantToRefreshItem(a),
                this.scrollview.wantToRefreshItem(e),
                t.UI_Sushe.Inst.change_select(e)
            }
        }
        ,
        i
    }(t.UIBase);
    t.UI_Sushe_Select = e
}(uiscript || (uiscript = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), uiscript;
!function(t) {
    var e = function() {
        function t(t) {
            var e = this;
            this.speed = .001,
            this.hearts = [],
            this.heart_masks = [],
            this.exp_limits = [],
            this.preframe_time = 0,
            this.heart_count = 5,
            this.during_change = !1,
            this.btn_heart = null,
            this.label_val = null,
            this.is_upgraded = !1,
            this.val_show_starttime = -1,
            this.me = t,
            this.container_hearts = this.me.getChildByName("hearts");
            for (n = 0; n < 5; n++) {
                var i = this.container_hearts.getChildByName("h" + n);
                this.hearts.push(i),
                this.heart_masks.push(i.getChildByName("v").mask)
            }
            this.bg_hearts = this.me.getChildByName("bg_hearts"),
            this.exp_limits = [];
            for (var n = 0; n < 5; n++)
                this.exp_limits.push(cfg.level_definition.character.find(n + 1).exp);
            this.btn_heart = this.me.getChildByName("btn_heart"),
            this.label_val = this.container_hearts.getChildByName("heartval"),
            this.btn_heart.clickHandler = Laya.Handler.create(this, function() {
                e.is_upgraded || (e.label_val.visible ? e.label_val.visible = !1 : (e.label_val.visible = !0,
                e.val_show_starttime = Laya.timer.currTimer))
            }, null, !1)
        }
        return t.prototype.show = function(t) {
            Laya.timer.clearAll(this),
            t.is_upgraded ? this.bg_hearts.skin = game.Tools.localUISrc("myres/sushe/heart_full.png") : this.bg_hearts.skin = game.Tools.localUISrc("myres/sushe/heart_normal.png"),
            this.current_level = t.level,
            this.current_exp_rate = t.exp / this.exp_limits[this.current_level],
            this.isupgrad = t.is_upgraded,
            this.label_val.visible = !1,
            this.refresh_heart(this.current_level, this.current_exp_rate, t.is_upgraded),
            this.during_change = !1,
            this.preframe_time = Laya.timer.currTimer,
            Laya.timer.frameLoop(1, this, this.update)
        }
        ,
        t.prototype.update = function() {
            if (this.label_val.visible) {
                Laya.timer.currTimer - this.val_show_starttime >= 5e3 && (this.label_val.visible = !1)
            }
            var t = Laya.timer.currTimer - this.preframe_time;
            this.preframe_time = Laya.timer.currTimer,
            this.during_change && (this.target_level != this.current_level ? (this.during_change = !1,
            this.current_level = this.target_level,
            this.current_exp_rate = this.target_exp_rate,
            this.refresh_heart(this.target_level, this.target_exp_rate, this.isupgrad)) : (this.current_exp_rate += t * this.speed,
            this.target_exp_rate < this.current_exp_rate ? (this.during_change = !1,
            this.current_level = this.target_level,
            this.current_exp_rate = this.target_exp_rate,
            this.refresh_heart(this.target_level, this.target_exp_rate, this.isupgrad)) : this.refresh_heart(this.target_level, this.current_exp_rate, this.isupgrad)))
        }
        ,
        t.prototype.refresh_heart = function(t, e, i) {
            this.is_upgraded = i;
            for (var n = 0; n < this.heart_count; n++) {
                var a = this.heart_masks[n];
                this.current_level > n ? a.scaleY = 1 : this.current_level == n ? (a.scaleY = .82 * e + .1,
                this.label_val.x = this.hearts[n].x,
                this.label_val.text = Math.ceil(e * this.exp_limits[n]).toString() + "/" + this.exp_limits[n].toString()) : a.scaleY = 0,
                this.hearts[n].getChildByName("v").getChildByName("h").skin = i ? game.Tools.localUISrc("myres/bothui/heart_gold.png") : game.Tools.localUISrc("myres/bothui/bf_heart.png")
            }
        }
        ,
        t.prototype.close = function() {
            Laya.timer.clearAll(this)
        }
        ,
        t.prototype.after_give = function(t, e) {
            var i = this
              , n = t.exp / this.exp_limits[t.level]
              , a = game.FrontEffect.Inst.create_ui_effect(this.hearts[this.current_level], e ? "scene/effect_heartup_favor.lh" : "scene/effect_heartup.lh", new Laya.Point(0,0), 1);
            if (Laya.timer.once(2e3, null, function() {
                a.destory()
            }),
            t.level > this.current_level) {
                this.target_level = this.current_level,
                this.target_exp_rate = 1,
                this.during_change = !0;
                var r = (1 - this.current_exp_rate) / this.speed;
                Laya.timer.once(r + 200, this, function() {
                    var t = game.FrontEffect.Inst.create_ui_effect(i.hearts[i.current_level], "scene/effect_heartlevelup.lh", new Laya.Point(0,0), 1);
                    Laya.timer.once(2e3, null, function() {
                        t.destory()
                    }),
                    view.AudioMgr.PlayAudio(111)
                })
            } else
                t.level == this.current_level && n > this.current_exp_rate ? (this.target_level = t.level,
                this.target_exp_rate = n,
                this.during_change = !0) : Laya.timer.once(500, this, function() {
                    i.target_level = t.level,
                    i.target_exp_rate = n,
                    i.during_change = !0
                })
        }
        ,
        t
    }()
      , i = function() {
        function e(t, e, i) {
            var n = this;
            this.items = [],
            this.tab_index = 0,
            this.gift_choose_index = -1,
            this.content_inshow = !1,
            this.give_cd = 0,
            this.sound_channel = null,
            this.content = t,
            this.block_exp = i,
            this.container_tabs = e,
            this.btn_gift = this.container_tabs.getChildByName("send"),
            this.btn_gift.clickHandler = Laya.Handler.create(this, function() {
                2 != n.tab_index && n.change_tab(2)
            }, null, !1),
            this.btn_qiyue = this.container_tabs.getChildByName("sign"),
            this.btn_qiyue.clickHandler = Laya.Handler.create(this, function() {
                1 != n.tab_index && n.change_tab(1)
            }, null, !1),
            this.scrollview = this.content.scriptMap["capsui.CScrollView"],
            this.scrollview.init_scrollview(Laya.Handler.create(this, this.render_item, null, !1), -1, 4),
            this.container_qiyue = this.content.getChildByName("page_qiyue"),
            this.container_gift = this.content.getChildByName("page_gift"),
            this.content.getChildByName("btn_close").clickHandler = Laya.Handler.create(this, function() {
                n.change_tab(0)
            }, null, !1)
        }
        return e.prototype.reset = function() {
            this.content.visible = !1,
            this.content_inshow = !1,
            this.tab_index = 0,
            this.gift_choose_index = -1
        }
        ,
        e.prototype.show = function(t) {
            this.reset(),
            this.chara_info = t,
            this.btn_gift.visible = t.level < 5;
            var e = cfg.item_definition.character.get(t.charid);
            this.btn_qiyue.visible = !t.is_upgraded && e.can_marry > 0,
            game.Tools.child_align_center(this.container_tabs, [7]),
            this.change_tab(0)
        }
        ,
        e.prototype.change_tab = function(e) {
            var i = this;
            if (this.items = [],
            this.scrollview.reset(),
            this.container_gift.visible = !1,
            this.container_qiyue.visible = !1,
            this.tab_index = e,
            1 == e) {
                this.btn_qiyue.getChildByName("chosen").visible = !0,
                this.btn_qiyue.getChildByName("label").color = "#000000";
                for (var n = cfg.item_definition.character.get(this.chara_info.charid).star_5_material.split(","), a = !0, r = 0; r < n.length; r++) {
                    var s = n[r].split("-")
                      , o = parseInt(s[0])
                      , l = parseInt(s[1])
                      , h = t.UI_Bag.get_item_count(o);
                    l > h && (a = !1),
                    this.items.push({
                        id: o,
                        need: l,
                        count: h
                    })
                }
                if (this.container_qiyue.visible = !0,
                this.chara_info.level >= 5) {
                    this.container_qiyue.getChildByName("nomet").visible = !1;
                    var u = this.container_qiyue.getChildByName("container_tupo_btn")
                      , _ = u.getChildByName("send");
                    _.clickHandler = Laya.Handler.create(this, this._tupo, null, !1),
                    a ? game.Tools.setGrayDisable(_, !1) : game.Tools.setGrayDisable(_, !0),
                    u.visible = !0
                } else
                    this.container_qiyue.getChildByName("container_tupo_btn").visible = !1,
                    this.container_qiyue.getChildByName("nomet").visible = !0
            } else
                this.btn_qiyue.getChildByName("chosen").visible = !1,
                this.btn_qiyue.getChildByName("label").color = "#cfcdcc";
            if (2 == e) {
                this.btn_gift.getChildByName("chosen").visible = !0,
                this.btn_gift.getChildByName("label").color = "#000000",
                this.items = t.UI_Bag.find_items_by_category(t.EItemCategory.gift),
                this.container_gift.visible = !0;
                this.container_gift.getChildByName("send").clickHandler = Laya.Handler.create(this, this._send_gift, null, !1),
                this.gift_choose_index = -1,
                this.refresh_gift_bottom_btns()
            } else
                this.btn_gift.getChildByName("chosen").visible = !1,
                this.btn_gift.getChildByName("label").color = "#cfcdcc",
                this.sound_channel && (this.sound_channel.stop(),
                Laya.SoundManager.removeChannel(this.sound_channel),
                this.sound_channel = null,
                c.Inst.closechat(!1));
            this.scrollview.addItem(this.items.length),
            1 == e || 2 == e ? this.content_inshow || (this.content_inshow = !0,
            this.content.visible = !0,
            Laya.Tween.clearAll(this.content),
            t.UIBase.anim_alpha_in(this.content, {
                y: -50
            }, 150, 0, null, Laya.Ease.strongIn)) : this.content_inshow && (this.content_inshow = !1,
            Laya.Tween.clearAll(this.content),
            t.UIBase.anim_alpha_out(this.content, {
                y: -50
            }, 150, 0, Laya.Handler.create(this, function() {
                i.content.visible = !1
            }), Laya.Ease.strongIn))
        }
        ,
        e.prototype.render_item = function(t) {
            var e = t.index
              , i = t.container;
            2 == this.tab_index ? this.render_item_gift(e, i) : 1 == this.tab_index && this.render_item_qiyue(e, i)
        }
        ,
        e.prototype.render_item_qiyue = function(e, i) {
            var n = this.items[e]
              , a = cfg.item_definition.item.get(n.id);
            i.getChildByName("name").visible = !1;
            var r = i.getChildByName("counts");
            r.visible = !0,
            r.getChildByName("count_need").text = "/" + n.need.toString();
            var s = r.getChildByName("count_have");
            s.text = n.count.toString(),
            s.color = n.count >= n.need ? "#00ff00" : "#ff0000",
            game.Tools.child_align_center(r);
            var o = i.getChildByName("btn");
            o.clickHandler = Laya.Handler.create(this, function() {
                t.UI_ItemDetail.Inst.show(n.id)
            }, null, !1),
            o.getChildByName("choosed").visible = !1,
            game.LoadMgr.setImgSkin(o.getChildByName("icon"), a.icon),
            o.getChildByName("num").visible = !1
        }
        ,
        e.prototype.render_item_gift = function(e, i) {
            var n = this
              , a = this.items[e].item_id
              , r = cfg.item_definition.item.get(a)
              , s = i.getChildByName("name");
            s.text = r["name_" + GameMgr.client_language],
            s.visible = !0,
            i.getChildByName("counts").visible = !1;
            var o = i.getChildByName("btn")
              , l = o.getChildByName("choosed");
            l.visible = this.gift_choose_index == e,
            o.clickHandler = Laya.Handler.create(this, function() {
                if (n.gift_choose_index != e) {
                    var i = n.gift_choose_index;
                    n.gift_choose_index = e,
                    l.visible = !0,
                    i >= 0 && i < n.items.length && n.scrollview.wantToRefreshItem(i),
                    n.refresh_gift_bottom_btns()
                } else
                    t.UI_ItemDetail.Inst.show(a)
            }, null, !1),
            game.LoadMgr.setImgSkin(o.getChildByName("icon"), r.icon);
            var h = o.getChildByName("num");
            this.items[e].count > 1 ? (h.text = this.items[e].count.toString(),
            h.visible = !0) : h.visible = !1
        }
        ,
        e.prototype.refresh_gift_bottom_btns = function() {
            var e = t.UI_Sushe.send_gift_limit - t.UI_Sushe.send_gift_count;
            e < 0 && (e = 0),
            this.container_gift.getChildByName("count").text = e.toString();
            var i = this.container_gift.getChildByName("send");
            game.Tools.setGrayDisable(i, !1),
            game.Tools.sprite_align_center([this.container_gift.getChildByName("label_send"), this.container_gift.getChildByName("count")], 450, [10])
        }
        ,
        e.prototype._tupo = function() {
            var e = this;
            if (t.UI_PiPeiYuYue.Inst.enable)
                t.UI_Popout.PopOutNoTitle(game.Tools.strOfLocalization(204), null);
            else {
                var i = this.container_qiyue.getChildByName("container_tupo_btn").getChildByName("send");
                game.Tools.setGrayDisable(i, !0),
                app.NetAgent.sendReq2Lobby("Lobby", "upgradeCharacter", {
                    character_id: this.chara_info.charid
                }, function(n, a) {
                    n || a.error ? (t.UIMgr.Inst.showNetReqError("upgradeCharacter", n, a),
                    game.Tools.setGrayDisable(i, !1)) : (c.Inst.close(),
                    Laya.timer.once(150, e, function() {
                        if (e.chara_info.is_upgraded = !0,
                        t.UI_Character_star_up.Inst.show(e.chara_info, Laya.Handler.create(e, function() {
                            t.UI_Sushe.Inst.starup_back()
                        })),
                        a.character) {
                            var i = a.character;
                            if (i.extra_emoji) {
                                e.chara_info.extra_emoji = [];
                                for (var n = 0; n < i.extra_emoji.length; n++)
                                    e.chara_info.extra_emoji.push(i.extra_emoji[n])
                            }
                        }
                    }))
                })
            }
        }
        ,
        e.prototype.close_audio = function() {
            this.sound_channel && (this.sound_channel.stop(),
            Laya.SoundManager.removeChannel(this.sound_channel),
            this.sound_channel = null,
            c.Inst.closechat(!1))
        }
        ,
        e.prototype._send_gift = function() {
            var e = this;
            if (t.UI_PiPeiYuYue.Inst.enable)
                t.UI_Popout.PopOutNoTitle(game.Tools.strOfLocalization(204), null);
            else if (!(this.gift_choose_index < 0 || this.gift_choose_index >= this.items.length || Laya.timer.currTimer < this.give_cd)) {
                var i = this.chara_info.charid
                  , n = this.items[this.gift_choose_index].item_id;
                if (99 != cfg.item_definition.item.get(n).type && t.UI_Sushe.send_gift_limit - t.UI_Sushe.send_gift_count <= 0)
                    t.UI_Popout.PopOutNoTitle(game.Tools.strOfLocalization(2213), null);
                else {
                    this.give_cd = Laya.timer.currTimer + 1e4;
                    var a = this.container_gift.getChildByName("send");
                    game.Tools.setGrayDisable(a, !0),
                    app.NetAgent.sendReq2Lobby("Lobby", "sendGiftToCharacter", {
                        character_id: i,
                        gifts: [{
                            item_id: n,
                            count: 1
                        }]
                    }, function(r, s) {
                        if (r || s.error)
                            game.Tools.setGrayDisable(a, !1),
                            e.give_cd = 0,
                            t.UIMgr.Inst.showNetReqError("sendGiftToCharacter", r, s);
                        else {
                            if (app.Log.log("sendGiftToCharacter: " + JSON.stringify(s)),
                            e.chara_info.charid == i) {
                                if (2 == e.tab_index)
                                    for (f = 0; f < e.items.length; f++)
                                        if (e.items[f].item_id == n) {
                                            if (e.items[f].count <= 1) {
                                                for (var o = f; o < e.items.length - 1; o++)
                                                    e.items[o] = e.items[o + 1];
                                                e.items.pop(),
                                                e.gift_choose_index = -1,
                                                e.scrollview.reset(),
                                                e.scrollview.addItem(e.items.length)
                                            } else
                                                e.items[f].count--,
                                                e.scrollview.wantToRefreshItem(f);
                                            break
                                        }
                                var l = cfg.item_definition.item.get(n).type == cfg.item_definition.character.get(i).favorite;
                                if (s.level > e.block_exp.current_level) {
                                    c.Inst.locking = !0;
                                    var h = (1 - e.block_exp.current_exp_rate) / e.block_exp.speed;
                                    e.block_exp.after_give(s, l),
                                    Laya.timer.once(h + 600, e, function() {
                                        e.chara_info.level = s.level,
                                        e.chara_info.exp = s.exp,
                                        t.UI_Character_star_up.Inst.show(e.chara_info, Laya.Handler.create(e, function() {
                                            t.UI_Sushe.Inst.starup_back()
                                        })),
                                        Laya.timer.once(600, e, function() {
                                            c.Inst.close()
                                        }),
                                        e.give_cd = 0
                                    });
                                    for (f = 0; f < 4; f++) {
                                        var u = 50 * (f + 1);
                                        Laya.timer.once(u + h + 600, e, function() {
                                            e.sound_channel && (e.sound_channel.volume *= .5)
                                        })
                                    }
                                } else {
                                    if (e.block_exp.after_give(s, l),
                                    e.give_cd = 0,
                                    game.Tools.setGrayDisable(a, !1),
                                    !e.sound_channel) {
                                        var _ = "";
                                        _ = cfg.item_definition.character.get(i).favorite == cfg.item_definition.item.get(n).type ? "lobby_gift_favor" : "lobby_gift";
                                        var d = view.AudioMgr.PlayCharactorSound(e.chara_info, _, Laya.Handler.create(e, function() {
                                            e.sound_channel = null,
                                            c.Inst.closechat(!1)
                                        }));
                                        c.Inst.chat(d.words),
                                        e.sound_channel = d.sound,
                                        t.UI_Sushe.Inst.stopsay()
                                    }
                                    e.chara_info.exp = s.exp
                                }
                            } else {
                                for (var f = 0; f < t.UI_Sushe.characters.length; f++)
                                    if (t.UI_Sushe.characters[f].charid == i) {
                                        t.UI_Sushe.characters[f].level = s.level,
                                        t.UI_Sushe.characters[f].exp = s.exp;
                                        break
                                    }
                                e.give_cd = 0
                            }
                            99 != cfg.item_definition.item.get(n).type && t.UI_Sushe.send_gift_count++,
                            e.refresh_gift_bottom_btns()
                        }
                    })
                }
            }
        }
        ,
        e
    }()
      , n = function() {
        function n(n) {
            var a = this;
            this.head = null,
            this.emos = [],
            this._scrollbar = null,
            this._scrollpoint = null,
            this._drag_scroll = !1,
            this.me = n,
            this.me.visible = !1,
            this.block_exp = new e(n.getChildByName("container_heart")),
            this.block_gift = new i(n.getChildByName("container_gift"),n.getChildByName("tabs"),this.block_exp),
            this.container_intro = n.getChildByName("intro"),
            this.content = this.container_intro.getChildByName("content"),
            this.content.vScrollBarSkin = "",
            this.head = new t.UI_Character_Skin(this.container_intro.getChildByName("content").getChildByName("container_head").getChildByName("head"));
            var r = this.content.getChildByName("container_emj").getChildByName("container").getChildByName("emo_templete");
            r.visible = !1;
            for (var s = 0; s < 20; s++)
                this.emos.push(new t.UI_Character_Emo(r.scriptMap["capsui.UICopy"].getNodeClone())),
                this.emos[s].me.x = s % 4 * 184,
                this.emos[s].me.y = 184 * Math.floor(s / 4);
            this.content.getChildByName("container_emj").height = 652,
            this.content.getChildByName("container_head").getChildByName("btn_skin").clickHandler = Laya.Handler.create(this, function() {
                c.Inst.open_skin(new Laya.Handler(a,a.change_skin))
            }, null, !1),
            this._scrollbar = this.container_intro.getChildByName("scrollbar"),
            this._scrollpoint = this._scrollbar.getChildByName("scrollpoint"),
            this._scrollbar && (this._scrollbar.on("mousedown", this, function() {
                a._drag_scroll = !0;
                var t = a._scrollbar.mouseY / a._scrollbar.height;
                a.content.vScrollBar.value = a.content.vScrollBar.max * t
            }),
            this._scrollbar.on("mousemove", this, function() {
                if (a._drag_scroll) {
                    var t = a._scrollbar.mouseY / a._scrollbar.height;
                    a.content.vScrollBar.value = a.content.vScrollBar.max * t
                }
            }),
            this._scrollbar.on("mouseup", this, function() {
                a._drag_scroll = !1
            }),
            this._scrollbar.on("mouseout", this, function() {
                a._drag_scroll = !1
            }),
            this.content.vScrollBar.on("change", this, function() {
                var t = a.content.vScrollBar.value / a.content.vScrollBar.max;
                a._scrollpoint.y = a._scrollbar.height * t
            }))
        }
        return n.prototype.show = function(t) {
            var e = this.content.getChildByName("container_text")
              , i = cfg.item_definition.character.get(t.charid);
            if (e.getChildByName("height").text = i["desc_stature_" + GameMgr.client_language],
            e.getChildByName("birth").text = i["desc_birth_" + GameMgr.client_language],
            e.getChildByName("age").text = i["desc_age_" + GameMgr.client_language],
            e.getChildByName("bloodtype").text = i.desc_bloodtype,
            e.getChildByName("cv").text = i["desc_cv_" + GameMgr.client_language],
            e.getChildByName("hobby").text = i["desc_hobby_" + GameMgr.client_language],
            e.getChildByName("desc").text = i["desc_" + GameMgr.client_language],
            "en" == GameMgr.client_language) {
                var n = [new Laya.ColorFilter([.7, 0, 0, 0, 0, 0, .7, 0, 0, 0, 0, 0, .7, 0, 0, 0, 0, 0, 1, 0])];
                e.getChildByName("height").font = "en_shuhun",
                e.getChildByName("height").filters = n,
                e.getChildByName("birth").font = "en_shuhun",
                e.getChildByName("birth").filters = n,
                e.getChildByName("age").font = "en_shuhun",
                e.getChildByName("age").filters = n,
                e.getChildByName("bloodtype").font = "en_shuhun",
                e.getChildByName("bloodtype").filters = n,
                e.getChildByName("cv").font = "en_shuhun",
                e.getChildByName("cv").filters = n,
                e.getChildByName("hobby").font = "en_shuhun",
                e.getChildByName("hobby").filters = n,
                e.getChildByName("desc").font = "en_shuhun",
                e.getChildByName("desc").filters = n
            }
            for (o = 0; o < 12; o += 2) {
                var a = e.getChildAt(o);
                e.getChildAt(o + 1).x = a.textField.textWidth * a.scaleX + a.x + 10
            }
            this.head.setSkin(t.skin, "smallhead");
            this.content.getChildByName("container_emj").y = e.getChildByName("desc").textField.textHeight * e.getChildByName("desc").scaleY + 561 - 194;
            for (var r = [], s = {}, o = 0; o < 9; o++)
                r.push({
                    sub_id: o,
                    unlock_desc: "",
                    time_limit: !1,
                    after_unlock_desc: ""
                }),
                s[o] = 1;
            if (t.extra_emoji && t.extra_emoji.length > 0)
                for (o = 0; o < t.extra_emoji.length; o++)
                    s[t.extra_emoji[o]] = 1;
            var l = cfg.character.emoji.getGroup(t.charid);
            if (l)
                for (o = 0; o < l.length; o++) {
                    var h = l[o];
                    1 == h.unlock_type ? r.push({
                        sub_id: h.sub_id,
                        unlock_desc: h["unlock_desc_" + GameMgr.client_language],
                        time_limit: !1,
                        after_unlock_desc: ""
                    }) : 2 == h.unlock_type && s[h.sub_id] && r.push({
                        sub_id: h.sub_id,
                        unlock_desc: h["unlock_desc_" + GameMgr.client_language],
                        time_limit: !0,
                        after_unlock_desc: h.after_unlock_desc
                    })
                }
            this.content.getChildByName("container_emj").height = 100 + 184 * Math.ceil(r.length / 4);
            for (o = 0; o < this.emos.length; o++)
                if (o >= r.length)
                    this.emos[o].me.visible = !1;
                else {
                    var c = r[o]
                      , u = c.sub_id;
                    this.emos[o].me.visible = !0,
                    this.emos[o].setSkin(t.charid, u),
                    s.hasOwnProperty(u.toString()) ? (this.emos[o].me.getChildByName("lock").visible = !1,
                    this.emos[o].me.getChildByName("time_limit").visible = c.time_limit,
                    c.after_unlock_desc ? (this.emos[o].me.getChildByName("info").visible = !0,
                    this.emos[o].me.getChildByName("info").getChildByName("info").text = c.after_unlock_desc) : this.emos[o].me.getChildByName("info").visible = !1) : (this.emos[o].me.getChildByName("lock").visible = !0,
                    this.emos[o].me.getChildByName("info").visible = !0,
                    this.emos[o].me.getChildByName("info").getChildByName("info").text = c.unlock_desc,
                    this.emos[o].me.getChildByName("time_limit").visible = c.time_limit)
                }
            this.content.refresh(),
            this._drag_scroll = !1,
            this.block_exp.show(t),
            this.block_gift.show(t),
            this.me.visible = !0
        }
        ,
        n.prototype.change_skin = function(e) {
            t.UI_Sushe.Inst.onChangeSkin(e),
            this.head.setSkin(e, "smallhead")
        }
        ,
        n.prototype.close = function() {
            this.me.visible = !1
        }
        ,
        n
    }()
      , a = function() {
        function t(t) {
            var e = this;
            this.solts = [1, 2, 3, 4, 5],
            this.slot_bg = ["myres/sushe/slot_liqibang.jpg", "myres/sushe/slot_hule.jpg", "myres/sushe/slot_liqi.jpg", "myres/sushe/slot_hand.jpg", "myres/sushe/slot_bgm.jpg"],
            this.solt_btns = [],
            this.chara_info = null,
            this.me = t,
            this.me.visible = !1;
            for (var i = function(t) {
                var i = n.me.getChildByName("slot" + t);
                n.solt_btns.push(i),
                i.clickHandler = Laya.Handler.create(n, function() {
                    t < 4 ? c.Inst.pop_effect_choose(1 + t, Laya.Handler.create(e, function(i) {
                        e.on_change_view(1 + t, i)
                    })) : c.Inst.show_pop_bgm(Laya.Handler.create(e, function(t) {
                        e.on_change_view(5, t)
                    }))
                }, null, !1)
            }, n = this, a = 0; a < 5; a++)
                i(a)
        }
        return t.prototype.render_item = function(t) {
            var e = this.solts[t]
              , i = -1;
            if (this.chara_info.views)
                for (var n = 0; n < this.chara_info.views.length; n++)
                    if (this.chara_info.views[n].slot == e) {
                        i = this.chara_info.views[n].item_id;
                        break
                    }
            var a = this.solt_btns[t];
            -1 == i || 0 == i ? (a.getChildByName("icon").skin = game.Tools.localUISrc(this.slot_bg[t]),
            a.getChildByName("desc").text = game.Tools.strOfLocalization(411 + t)) : (game.LoadMgr.setImgSkin(a.getChildByName("icon"), cfg.item_definition.item.get(i).icon),
            a.getChildByName("desc").text = cfg.item_definition.item.get(i)["name_" + GameMgr.client_language])
        }
        ,
        t.prototype.on_change_view = function(t, e) {
            var i = !1;
            if (this.chara_info.views)
                for (n = 0; n < this.chara_info.views.length; n++)
                    if (this.chara_info.views[n].slot == t) {
                        i = !0,
                        this.chara_info.views[n].item_id == e ? (this.chara_info.views[n].item_id = 0,
                        e = 0) : this.chara_info.views[n].item_id = e;
                        break
                    }
            i || (this.chara_info.views || (this.chara_info.views = []),
            this.chara_info.views.push({
                slot: t,
                item_id: e
            })),
            app.NetAgent.sendReq2Lobby("Lobby", "changeCharacterView", {
                character_id: this.chara_info.charid,
                slot: t,
                item_id: e
            }, function(t, e) {});
            for (var n = 0; n < this.solts.length; n++)
                this.render_item(n)
        }
        ,
        t.prototype.show = function(t) {
            this.chara_info = t;
            for (var e = 0; e < 5; e++)
                this.render_item(e);
            this.me.visible = !0
        }
        ,
        t.prototype.close = function() {
            this.me.visible = !1
        }
        ,
        t
    }()
      , r = function() {
        function e(t) {
            this.sounds = [],
            this.chara_info = null,
            this.current_play_index = -1,
            this.current_soundchannel = null,
            this.volume_fixed = 0,
            this.me = t,
            this.me.visible = !1,
            this.scrollview = this.me.scriptMap["capsui.CScrollView"],
            this.scrollview.init_scrollview(Laya.Handler.create(this, this.render_item, null, !1))
        }
        return e.prototype.show = function(e) {
            this.chara_info = e,
            this.sounds = [];
            for (var i = cfg.voice.sound.getGroup(cfg.item_definition.character.get(e.charid).sound), n = 0; n < i.length; n++)
                this.sounds.push(i[n]);
            this.volume_fixed = cfg.item_definition.character.get(e.charid).sound_volume,
            this.scrollview.reset(),
            this.scrollview.addItem(this.sounds.length),
            this.me.visible = !0,
            view.AudioMgr.refresh_music_volume(!0),
            this.current_play_index = -1,
            t.UI_Sushe.Inst.stopsay()
        }
        ,
        e.prototype.close = function() {
            this.me.visible && (this.me.visible = !1,
            view.AudioMgr.refresh_music_volume(!1),
            this.current_soundchannel && (this.current_soundchannel.stop(),
            Laya.SoundManager.removeChannel(this.current_soundchannel),
            this.current_soundchannel = null,
            this.current_play_index = -1,
            c.Inst.closechat(!1)))
        }
        ,
        e.prototype.render_item = function(t) {
            var e = this
              , i = t.index
              , n = t.container
              , a = this.sounds[i];
            n.getChildByName("desc").text = a["name_" + GameMgr.client_language];
            var r = n.getChildByName("btn_play")
              , s = r.getChildByName("img");
            s.skin = game.Tools.localUISrc(this.current_play_index == i ? "myres/sushe/bf_pause.png" : "myres/sushe/bf_play.png"),
            r.clickHandler = Laya.Handler.create(this, function() {
                if (e.current_play_index == i)
                    e.current_soundchannel && (e.current_soundchannel.stop(),
                    Laya.SoundManager.removeChannel(e.current_soundchannel),
                    e.current_soundchannel = null),
                    c.Inst.closechat(!1),
                    s.skin = game.Tools.localUISrc("myres/sushe/bf_play.png"),
                    e.current_play_index = -1;
                else {
                    var t = e.current_play_index;
                    e.current_play_index = i,
                    t >= 0 && t < e.sounds.length && e.scrollview.wantToRefreshItem(t),
                    e.current_soundchannel && (Laya.SoundManager.removeChannel(e.current_soundchannel),
                    e.current_soundchannel.stop(),
                    e.current_soundchannel = null),
                    s.skin = game.Tools.localUISrc("myres/sushe/bf_pause.png"),
                    e.current_soundchannel = Laya.SoundManager.playSound(a.path + view.AudioMgr.suffix, 1, new Laya.Handler(e,function() {
                        if (e.current_soundchannel) {
                            e.current_soundchannel = null;
                            var t = e.current_play_index;
                            e.current_play_index = -1,
                            t >= 0 && t < e.sounds.length && e.scrollview.wantToRefreshItem(t),
                            c.Inst.closechat(!1)
                        }
                    }
                    )),
                    view.AudioMgr.getCVmute(e.chara_info.charid) ? e.current_soundchannel.volume = 0 : e.current_soundchannel.volume = e.volume_fixed * view.AudioMgr.getCVvolume(e.chara_info.charid),
                    c.Inst.chat(a["words_" + GameMgr.client_language])
                }
            }, null, !1);
            var o = n.getChildByName("lock");
            this.chara_info.level >= a.level_limit ? (o.visible = !1,
            r.visible = !0) : (o.visible = !0,
            r.visible = !1,
            o.getChildByName("info").text = game.Tools.strOfLocalization(2192, [a.level_limit.toString()]))
        }
        ,
        e
    }()
      , s = function() {
        function e(t) {
            var e = this;
            this.items = [],
            this.current_using_item_id = -1,
            this.me = t,
            this.root = t.getChildByName("root"),
            this.title = this.root.getChildByName("title"),
            this.root.getChildByName("btn_close").clickHandler = Laya.Handler.create(this, function() {
                e.close()
            }, null, !1),
            this.scrollview = this.root.scriptMap["capsui.CScrollView"],
            this.scrollview.init_scrollview(Laya.Handler.create(this, this.render_item, null, !1), -1, 3)
        }
        return e.prototype.show = function(e, i, n) {
            this.me.visible = !0,
            this.root.scaleX = this.root.scaleY = 1,
            t.UIBase.anim_pop_out(this.root, null),
            this.chara_info = e,
            this.slot_id = i,
            this.when_change = n,
            this.items = [];
            for (var a = t.UI_Bag.find_items_by_category(t.EItemCategory.character_view), r = 0; r < a.length; r++) {
                cfg.item_definition.item.get(a[r].item_id).type == i && this.items.push(a[r].item_id)
            }
            if (this.current_using_item_id = -1,
            e.views)
                for (r = 0; r < e.views.length; r++)
                    if (e.views[r].slot == this.slot_id) {
                        this.current_using_item_id = e.views[r].item_id;
                        break
                    }
            switch (this.title.text = "",
            i) {
            case 1:
                this.title.text = game.Tools.strOfLocalization(2193);
                break;
            case 2:
                this.title.text = game.Tools.strOfLocalization(2194);
                break;
            case 3:
                this.title.text = game.Tools.strOfLocalization(2195);
                break;
            case 4:
                this.title.text = game.Tools.strOfLocalization(2214)
            }
            this.root.getChildByName("no_info").visible = 0 == this.items.length,
            this.scrollview.reset(),
            this.scrollview.addItem(this.items.length)
        }
        ,
        e.prototype.close = function() {
            var e = this;
            this.when_change = null,
            t.UIBase.anim_pop_hide(this.root, Laya.Handler.create(this, function() {
                e.me.visible = !1
            }))
        }
        ,
        e.prototype.render_item = function(e) {
            var i = this
              , n = e.index
              , a = e.container
              , r = e.cache_data
              , s = a.getChildByName("btn");
            s.clickHandler = Laya.Handler.create(this, function() {
                i.when_change && i.when_change.runWith(i.items[n]),
                i.close()
            }, null, !1),
            r.icon || (r.icon = new t.UI_Item_Skin(s.getChildByName("icon"))),
            r.icon.setSkin(cfg.item_definition.item.get(this.items[n]).icon);
            a.getChildByName("using").visible = this.current_using_item_id == this.items[n]
        }
        ,
        e
    }()
      , o = function() {
        function e(t) {
            var e = this;
            this.items = [],
            this.current_using_item_id = -1,
            this.current_listening = -1,
            this.me = t,
            this.root = t.getChildByName("root"),
            this.title = this.root.getChildByName("title"),
            this.root.getChildByName("btn_close").clickHandler = Laya.Handler.create(this, function() {
                e.close()
            }, null, !1),
            this.scrollview = this.root.scriptMap["capsui.CScrollView"],
            this.scrollview.init_scrollview(Laya.Handler.create(this, this.render_item, null, !1), -1, 3)
        }
        return e.prototype.show = function(e, i) {
            this.me.visible = !0,
            this.root.scaleX = this.root.scaleY = 1,
            t.UIBase.anim_pop_out(this.root, null),
            this.chara_info = e,
            this.when_change = i,
            this.items = [];
            for (var n = t.UI_Bag.find_items_by_category(t.EItemCategory.character_view), a = 0; a < n.length; a++) {
                cfg.item_definition.item.get(n[a].item_id).type == game.EPlayerView.liqi_bgm && this.items.push(n[a].item_id)
            }
            if (this.current_using_item_id = -1,
            e.views)
                for (a = 0; a < e.views.length; a++)
                    if (e.views[a].slot == game.EPlayerView.liqi_bgm) {
                        this.current_using_item_id = e.views[a].item_id;
                        break
                    }
            this.current_listening = -1,
            this.root.getChildByName("no_info").visible = 0 == this.items.length,
            this.scrollview.reset(),
            this.scrollview.addItem(this.items.length)
        }
        ,
        e.prototype.close = function() {
            var e = this;
            this.when_change = null,
            this.current_listening >= 0 && (view.AudioMgr.StopMusic(0),
            view.AudioMgr.PlayMusic("music/lobby.mp3")),
            t.UIBase.anim_pop_hide(this.root, Laya.Handler.create(this, function() {
                e.me.visible = !1
            }))
        }
        ,
        e.prototype.render_item = function(t) {
            var e = this
              , i = t.index
              , n = t.container
              , a = n.getChildByName("btn");
            a.clickHandler = Laya.Handler.create(this, function() {
                e.when_change && e.when_change.runWith(e.items[i]),
                e.close()
            }, null, !1);
            var r = a.getChildByName("icon");
            game.LoadMgr.setImgSkin(r, cfg.item_definition.item.get(this.items[i]).icon);
            a.getChildByName("using").visible = this.current_using_item_id == this.items[i];
            var s = a.getChildByName("img_play");
            i == this.current_listening ? s.skin = game.Tools.localUISrc("myres/sushe/bf_pause.png") : s.skin = game.Tools.localUISrc("myres/sushe/bf_play.png");
            n.getChildByName("btn_play").clickHandler = Laya.Handler.create(this, function() {
                i == e.current_listening ? (e.current_listening = -1,
                view.AudioMgr.StopMusic(0),
                view.AudioMgr.PlayMusic("music/lobby.mp3")) : (e.current_listening = i,
                view.AudioMgr.PlayLiqiBgm(cfg.item_definition.item.get(e.items[i]).sargs[0])),
                e.scrollview.wantToRefreshAll()
            }, null, !1)
        }
        ,
        e
    }()
      , l = function() {
        function e(t) {
            var e = this;
            this.skins = [],
            this.me = t,
            this.root = t.getChildByName("root"),
            this.root.getChildByName("btn_close").clickHandler = Laya.Handler.create(this, function() {
                e.close()
            }, null, !1),
            this.scrollview = this.root.scriptMap["capsui.CScrollView"],
            this.scrollview.init_scrollview(Laya.Handler.create(this, this.render_item, null, !1), -1, 3)
        }
        return e.prototype.show = function(e, i) {
            this.me.visible = !0,
            t.UIBase.anim_pop_out(this.root, null),
            this.chara_info = e,
            this.when_change = i,
            this.skins = [];
            var n = cfg.item_definition.character.get(e.charid);
            if (this.skins.push(n.init_skin),
            n.can_marry && this.skins.push(n.full_fetter_skin),
            n.skin_lib)
                for (var a = 0; a < n.skin_lib.length; a++)
                    n.skin_lib[a] && this.skins.push(n.skin_lib[a]);
            this.scrollview.reset(),
            this.scrollview.addItem(this.skins.length)
        }
        ,
        e.prototype.close = function() {
            var e = this;
            this.when_change = null,
            t.UIBase.anim_pop_hide(this.root, Laya.Handler.create(this, function() {
                e.me.visible = !1
            }))
        }
        ,
        e.prototype.render_item = function(e) {
            var i = this
              , n = e.index
              , a = e.container
              , r = e.cache_data
              , s = a.getChildByName("btn");
            r.skin || (r.skin = new t.UI_Character_Skin(s.getChildByName("icon")));
            a.getChildByName("using").visible = this.skins[n] == this.chara_info.skin;
            var o = cfg.item_definition.skin.get(this.skins[n]);
            r.skin.setSkin(this.skins[n], "smallhead");
            var l = s.getChildByName("locked");
            t.UI_Sushe.skin_owned(this.skins[n]) ? (l.visible = !1,
            s.clickHandler = Laya.Handler.create(this, function() {
                i.skins[n] != i.chara_info.skin && i.when_change && i.when_change.runWith(i.skins[n]),
                i.close()
            }, null, !1)) : (l.visible = !0,
            l.getChildByName("info").text = o["lock_tips_" + GameMgr.client_language],
            s.clickHandler = null)
        }
        ,
        e
    }()
      , h = function() {
        function t(t) {
            var e = this;
            this.locking = !1,
            this.me = t,
            this.info = this.me.getChildByName("info"),
            this.me.on("mousedown", this, function() {
                e.locking || e.close()
            })
        }
        return t.prototype.show = function(t) {
            var e = this;
            this.info.text = t,
            this.me.height = 120 + this.info.textField.textHeight,
            this.me.visible = !0,
            this.locking = !0,
            this.me.scaleY = 0,
            Laya.timer.clearAll(this),
            Laya.Tween.to(this.me, {
                scaleY: 1
            }, 150, null, Laya.Handler.create(this, function() {
                e.locking = !1
            })),
            Laya.timer.once(3e3, this, function() {
                e.close()
            })
        }
        ,
        t.prototype.close = function() {
            var t = this;
            this.locking = !0,
            Laya.timer.clearAll(this),
            Laya.Tween.to(this.me, {
                scaleY: 0
            }, 150, null, Laya.Handler.create(this, function() {
                t.locking = !1,
                t.me.visible = !1
            }))
        }
        ,
        t
    }()
      , c = function(e) {
        function i() {
            var t = e.call(this, new ui.lobby.visitUI) || this;
            return t.tabs = [],
            t.page_intro = null,
            t.page_effect = null,
            t.page_sound = null,
            t.block_chat = null,
            t.pop_effect = null,
            t.pop_bgm = null,
            t.pop_skin = null,
            t.locking = !1,
            t.current_page = -1,
            t.chara_info = null,
            t.tab_img_dark = "",
            t.tab_img_chosen = "",
            i.Inst = t,
            t
        }
        return __extends(i, e),
        Object.defineProperty(i.prototype, "cannot_click_say", {
            get: function() {
                return 1 == this.current_page || null != this.page_intro.block_gift.sound_channel
            },
            enumerable: !0,
            configurable: !0
        }),
        i.prototype.onCreate = function() {
            var e = this;
            this.container_top = this.me.getChildByName("top"),
            this.container_top.getChildByName("btn_back").clickHandler = Laya.Handler.create(this, function() {
                e.locking || e.back2select()
            }, null, !1),
            "chs" == GameMgr.client_language ? (this.tab_img_chosen = game.Tools.localUISrc("myres/sushe/bf_chosen.png"),
            this.tab_img_dark = game.Tools.localUISrc("myres/sushe/bf_unchooesd.png")) : (this.tab_img_chosen = game.Tools.localUISrc("myres/sushe/bf_chosen_en.png"),
            this.tab_img_dark = game.Tools.localUISrc("myres/sushe/bf_unchooesd_en.png")),
            this.container_right = this.me.getChildByName("right");
            for (var i = function(t) {
                "chs" == GameMgr.client_language ? (c.tabs.push(c.container_right.getChildByName("btn_page" + t)),
                c.container_right.getChildByName("btn_page" + t + "_en").visible = !1) : (c.container_right.getChildByName("btn_page" + t).visible = !1,
                c.tabs.push(c.container_right.getChildByName("btn_page" + t + "_en"))),
                c.tabs[t].clickHandler = Laya.Handler.create(c, function() {
                    e.locking || e.current_page != t && e.change_page(t)
                }, null, !1)
            }, c = this, u = 0; u < 3; u++)
                i(u);
            this.page_intro = new n(this.container_right.getChildByName("page_intro")),
            this.page_effect = new a(this.container_right.getChildByName("effect")),
            this.page_sound = new r(this.container_right.getChildByName("sound")),
            this.block_chat = new t.UI_Character_Chat(this.me.getChildByName("chat")),
            this.block_chat.me.visible = !1,
            this.pop_effect = new s(this.me.getChildByName("pop_effect")),
            this.pop_bgm = new o(this.me.getChildByName("pop_bgm")),
            this.pop_skin = new l(this.me.getChildByName("pop_skin")),
            this.info_levelup = new h(this.me.getChildByName("levelup"))
        }
        ,
        i.prototype.show = function(e, i) {
            var n = this;
            this.chara_info = e;
            for (var a = 0; a < this.tabs.length; a++)
                this.tabs[a].skin = this.tab_img_dark;
            this.page_intro.close(),
            this.page_effect.close(),
            this.page_sound.close(),
            this.current_page = -1,
            this.change_page(0),
            this.block_chat.me.visible = !1,
            this.pop_effect.me.visible = !1,
            this.pop_bgm.me.visible = !1,
            this.pop_skin.me.visible = !1,
            this.info_levelup.me.visible = !1,
            this.me.visible = !0,
            this.locking = !0,
            t.UIBase.anim_alpha_in(this.container_top, {
                y: -30
            }, 150),
            t.UIBase.anim_alpha_in(this.container_right, {
                x: 30
            }, 150),
            t.UIBase.anim_alpha_in(this.block_chat.me, {
                y: 30
            }, 150),
            Laya.timer.once(150, this, function() {
                n.locking = !1
            }),
            i && Laya.timer.once(150, this, function() {
                n.chara_info.is_upgraded ? n.info_levelup.show(game.Tools.strOfLocalization(2196)) : n.info_levelup.show(cfg.level_definition.character.get(n.chara_info.level)["unlock_desc_" + GameMgr.client_language])
            })
        }
        ,
        i.prototype.close = function() {
            var e = this;
            this.locking = !0,
            t.UIBase.anim_alpha_out(this.container_top, {
                y: -30
            }, 150),
            t.UIBase.anim_alpha_out(this.container_right, {
                x: 30
            }, 150),
            t.UIBase.anim_alpha_out(this.block_chat.me, {
                y: 30
            }, 150),
            Laya.timer.once(150, this, function() {
                e.locking = !1,
                e.me.visible = !1,
                e.page_sound.me.visible && e.page_sound.close(),
                e.pop_bgm.me.visible && e.pop_bgm.close(),
                e.page_intro.block_gift.close_audio()
            })
        }
        ,
        i.prototype.back2select = function() {
            this.close(),
            Laya.timer.once(150, this, function() {
                t.UI_Sushe.Inst.show_page_select()
            })
        }
        ,
        i.prototype.change_page = function(t) {
            if (this.current_page >= 0)
                switch (this.tabs[this.current_page].skin = this.tab_img_dark,
                this.current_page) {
                case 0:
                    this.page_intro.close();
                    break;
                case 1:
                    this.page_sound.close();
                    break;
                case 2:
                    this.page_effect.close()
                }
            if (this.current_page = t,
            this.current_page >= 0)
                switch (this.tabs[this.current_page].skin = this.tab_img_chosen,
                this.current_page) {
                case 0:
                    this.page_intro.show(this.chara_info);
                    break;
                case 1:
                    this.page_sound.show(this.chara_info);
                    break;
                case 2:
                    this.page_effect.show(this.chara_info)
                }
        }
        ,
        i.prototype.open_skin = function(t) {
            this.pop_skin.show(this.chara_info, t)
        }
        ,
        i.prototype.pop_effect_choose = function(t, e) {
            this.pop_effect.show(this.chara_info, t, e)
        }
        ,
        i.prototype.show_pop_bgm = function(t) {
            this.pop_bgm.show(this.chara_info, t)
        }
        ,
        i.prototype.chat = function(t) {
            this.block_chat.show(t)
        }
        ,
        i.prototype.closechat = function(t) {
            this.block_chat.close(t)
        }
        ,
        i
    }(t.UIBase);
    t.UI_Sushe_Visit = c
}(uiscript || (uiscript = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), uiscript;
!function(t) {
    var e = function() {
        function e(e, i) {
            var n = this;
            this.me = e,
            this.effect_root = i,
            this.btn_next = e.getChildByName("btn_next"),
            this.btn_next.clickHandler = Laya.Handler.create(this, this.close, [!1], !1),
            this.bg_sakura = e.getChildByName("bg_sakura"),
            this.container_item = e.getChildByName("item");
            var a = this.container_item.getChildByName("btn");
            a.clickHandler = Laya.Handler.create(this, function() {
                t.UI_ItemDetail.Inst.show(n.item_id)
            }, null, !1),
            this.icon = new t.UI_Item_Skin(a.getChildByName("icon_origin")),
            this.label_count = this.icon.me.getChildByName("count"),
            this.label_name = this.container_item.getChildByName("name_origin")
        }
        return e.prototype.show = function(e, i) {
            var n = this;
            this.item_id = e;
            var r = cfg.item_definition.item.get(e);
            this.icon.setSkin(r.icon),
            r.category == t.EItemCategory.common_view || r.category == t.EItemCategory.character_view ? (this.bg_sakura.visible = !0,
            Laya.timer.once(250, this, function() {
                var t = game.FrontEffect.Inst.create_ui_effect(n.effect_root, "scene/effect_get_zhuangban.lh", new Laya.Point(0,0), 1);
                Laya.timer.once(2e3, null, function() {
                    t.destory()
                }),
                view.AudioMgr.PlayAudio(110)
            })) : (this.bg_sakura.visible = !1,
            Laya.timer.once(250, this, function() {
                view.AudioMgr.PlayAudio(109)
            })),
            i > 1 ? (this.label_count.visible = !0,
            this.label_count.text = i.toString()) : this.label_count.visible = !1,
            this.label_name.text = r["name_" + GameMgr.client_language],
            this.me.visible = !0,
            this.me.alpha = 1,
            this.me.y = 574,
            a.Inst.me.WPin.play(0, !1),
            this.btn_next.visible = !1,
            Laya.timer.once(10 / 24 * 1e3 + 200, this, function() {
                n.btn_next.visible = !0,
                a.Inst.btn_pass.visible = !0,
                a.Inst.btn_pass.clickHandler = Laya.Handler.create(n, function() {
                    a.Inst.btn_pass.visible = !1,
                    n.close(!0)
                }, null, !1)
            })
        }
        ,
        e.prototype.close = function(t) {
            var e = this;
            a.Inst.btn_pass.visible = !1,
            this.btn_next.visible = !1,
            a.Inst.me.WPout.play(0, !1),
            Laya.timer.once(5 / 24 * 1e3 + 500, this, function() {
                e.me.visible = !1,
                t ? a.Inst.show_result() : a.Inst.show_next()
            })
        }
        ,
        e
    }()
      , i = function() {
        function e(e, i) {
            this.me = e,
            this.effect_root = i,
            this.btn_next = this.me.getChildByName("btn_next"),
            this.btn_next.clickHandler = Laya.Handler.create(this, this.close, [!1], !1);
            var n = e.getChildByName("jianying");
            this.jianying_girl = n.getChildByName("jianying_girl"),
            this.jianying_boy = n.getChildByName("jianying_boy");
            var a = e.getChildByName("container_illust");
            this.illust = new t.UI_Character_Skin(a.getChildByName("illust"));
            var r = null;
            "chs" == GameMgr.client_language ? (r = a.getChildByName("container_name_chs"),
            a.getChildByName("container_name_en").visible = !1) : (r = a.getChildByName("container_name_en"),
            a.getChildByName("container_name_chs").visible = !1),
            this.label_name = r.getChildByName("label_name"),
            this.label_cv = r.getChildByName("label_cv"),
            this.chat = new t.UI_Character_Chat(a.getChildByName("chat"))
        }
        return e.prototype.close_sound = function() {
            this.sound_channel && (this.sound_channel.stop(),
            Laya.SoundManager.removeChannel(this.sound_channel),
            this.sound_channel = null)
        }
        ,
        e.prototype.show = function(t) {
            var e = this;
            this.character_id = t;
            var i = cfg.item_definition.character.get(t);
            this.illust.setSkin(i.init_skin, "full"),
            this.label_name.text = i["name_" + GameMgr.client_language],
            this.label_cv.text = "cv:" + i["desc_cv_" + GameMgr.client_language],
            this.chat.close(!0),
            this.jianying_boy.visible = 2 == i.sex,
            this.jianying_girl.visible = 1 == i.sex,
            this.close_sound(),
            this.btn_next.visible = !1,
            this.illust.me.parent.alpha = 1,
            this.illust.me.parent.y = -8,
            this.me.visible = !0,
            a.Inst.me.JSin.play(0, !1),
            Laya.timer.once(100 / 24 * 1e3, this, function() {
                e.effect = game.FrontEffect.Inst.create_ui_effect(e.effect_root, "scene/effect_get_character.lh", new Laya.Point(0,0), 1),
                view.AudioMgr.PlayAudio(107)
            }),
            Laya.timer.once(6450, this, function() {
                var t = ""
                  , n = ""
                  , r = 0;
                cfg.voice.sound.getGroup(i.sound).forEach(function(e) {
                    "lobby_selfintro" == e.type && (t = e.path,
                    n = e["words_" + GameMgr.client_language],
                    r = e.time_length)
                }),
                "" != t && (e.sound_channel = view.AudioMgr.PlaySound(t, i.sound_volume, Laya.Handler.create(e, function() {
                    e.sound_channel = null
                }))),
                "" != n && e.chat.show(n),
                e.btn_next.visible = !0,
                a.Inst.btn_pass.visible = !0,
                a.Inst.btn_pass.clickHandler = Laya.Handler.create(e, function() {
                    a.Inst.btn_pass.visible = !1,
                    e.close(!0)
                }, null, !1)
            })
        }
        ,
        e.prototype.close = function(t) {
            var e = this;
            a.Inst.btn_pass.visible = !1,
            this.btn_next.visible = !1,
            a.Inst.me.JSout.play(0, !1),
            this.chat.close(!1),
            this.close_sound(),
            Laya.timer.once(800, this, function() {
                e.me.visible = !1,
                e.illust.clear(),
                t ? a.Inst.show_result() : a.Inst.show_next()
            }),
            this.effect && (this.effect.destory(),
            this.effect = null)
        }
        ,
        e
    }()
      , n = function() {
        function e(t) {
            var e = this;
            this.effects = [],
            this.me = t;
            var i = t.getChildByName("tubiao");
            this.single_item = i.getChildByName("item1"),
            this.container10 = i.getChildByName("container10"),
            this.btn_confirm = t.getChildByName("confirm"),
            this.btn_confirm.clickHandler = Laya.Handler.create(this, function() {
                e.close(),
                a.Inst.close()
            }, null, !1)
        }
        return e.prototype.show = function(t) {
            if (Laya.timer.clearAll(this),
            1 == t.length)
                this.single_item.visible = !0,
                this.container10.visible = !1,
                this.render_item(t[0], this.single_item);
            else {
                this.single_item.visible = !1,
                this.container10.visible = !0;
                for (var e = 0; e < this.container10.numChildren; e++) {
                    var i = this.container10.getChildAt(e);
                    e < t.length ? (i.visible = !0,
                    this.render_item(t[e], i)) : i.visible = !1
                }
            }
            this.me.visible = !0,
            a.Inst.me.XMJGin.play(0, !1)
        }
        ,
        e.prototype.close = function() {
            Laya.timer.clearAll(this),
            this.me.visible = !1;
            for (var t = 0; t < this.effects.length; t++)
                this.effects[t].destory();
            this.effects = []
        }
        ,
        e.prototype.render_item = function(e, i) {
            var n = this
              , a = i.getChildByName("btn");
            a.clickHandler = Laya.Handler.create(this, function() {
                30 == Math.floor(e.reward.id / 1e4) && t.UI_ItemDetail.Inst.show(e.reward.id)
            }, null, !1);
            var r = a.getChildByName("icon_origin")
              , s = a.getChildByName("icon_final")
              , o = i.getChildByName("name_orgin")
              , l = i.getChildByName("name_final")
              , h = a.getChildByName("gold_bg");
            if (h.visible = !1,
            20 == Math.floor(e.reward.id / 1e4)) {
                var c = cfg.item_definition.character.get(e.reward.id)
                  , u = cfg.item_definition.skin.get(c.init_skin);
                game.LoadMgr.setImgSkin(r, u.path + "/smallhead.png"),
                r.getChildByName("count").visible = !1,
                o.text = c["name_" + GameMgr.client_language],
                Laya.timer.once(10 / 24 * 1e3, this, function() {
                    h.visible = !0,
                    n.effects.push(game.FrontEffect.Inst.create_ui_effect(h, n.container10.visible ? "scene/effect_item_shine.lh" : "scene/effect_item_shine_big.lh", new Laya.Point(0,0), 1, !0))
                })
            } else {
                _ = cfg.item_definition.item.get(e.reward.id);
                game.LoadMgr.setImgSkin(r, _.icon);
                d = r.getChildByName("count");
                e.reward.count > 1 ? (d.visible = !0,
                d.text = e.reward.count.toString()) : d.visible = !1,
                o.text = _["name_" + GameMgr.client_language],
                h.visible = !1
            }
            if (e.replace) {
                if (s.visible = !0,
                l.visible = !0,
                20 == Math.floor(e.replace.id / 1e4)) {
                    var c = cfg.item_definition.character.get(e.replace.id)
                      , u = cfg.item_definition.skin.get(c.init_skin);
                    game.LoadMgr.setImgSkin(s, u.path + "/smallhead.png"),
                    s.getChildByName("count").visible = !1,
                    l.text = c["name_" + GameMgr.client_language]
                } else {
                    var _ = cfg.item_definition.item.get(e.replace.id);
                    game.LoadMgr.setImgSkin(s, _.icon);
                    var d = s.getChildByName("count");
                    e.replace.count > 1 ? (d.visible = !0,
                    d.text = e.replace.count.toString()) : d.visible = !1,
                    l.text = _["name_" + GameMgr.client_language]
                }
                var f = Laya.timer.currTimer;
                r.alpha = o.alpha = 1,
                s.alpha = l.alpha = 0,
                Laya.timer.frameLoop(1, this, function() {
                    var t = Laya.timer.currTimer - f;
                    if ((t -= 2600 * Math.floor(t / 2600)) < 800)
                        r.alpha = o.alpha = 1,
                        s.alpha = l.alpha = 0;
                    else if (t < 1300) {
                        e = (t - 800) / 500;
                        r.alpha = o.alpha = 1 - e,
                        s.alpha = l.alpha = e
                    } else if (t < 2100)
                        r.alpha = o.alpha = 0,
                        s.alpha = l.alpha = 1;
                    else {
                        var e = (t - 800 - 500 - 800) / 500;
                        r.alpha = o.alpha = e,
                        s.alpha = l.alpha = 1 - e
                    }
                })
            } else
                s.visible = !1,
                l.visible = !1,
                r.alpha = 1,
                o.alpha = 1
        }
        ,
        e
    }()
      , a = function(a) {
        function r() {
            var t = a.call(this, new ui.lobby.tangfang1UI) || this;
            return r.Inst = t,
            t
        }
        return __extends(r, a),
        r.prototype.onCreate = function() {
            var t = this;
            this.btn_next = this.me.getChildByName("btn_next"),
            this.btn_next.clickHandler = Laya.Handler.create(this, function() {
                t.show_next()
            }, null, !1),
            this.tf_wupin = new e(this.me.getChildByName("tanfang_wupin"),this.me.getChildByName("effect_wuping")),
            this.tf_juese = new i(this.me.getChildByName("tanfang_juese"),this.me.getChildByName("effect_juese")),
            this.btn_pass = this.me.getChildByName("btn_pass"),
            this.btn_pass.clickHandler = Laya.Handler.create(this, function() {
                t.show_result()
            }, null, !1),
            this.final_result = new n(this.me.getChildByName("container_final_info")),
            this.left_tree = this.me.getChildByName("left_tree"),
            this.right_tree = this.me.getChildByName("right_tree"),
            this.container_liuxing = this.me.getChildByName("container_scene").getChildByName("liuxing"),
            this.container_jianying_sakura = this.me.getChildByName("tanfang_juese").getChildByName("jianying").getChildByName("scene_jianying_sakura")
        }
        ,
        r.prototype.show = function(t) {
            var e = this;
            this.results = t;
            for (r = 1; r < this.results.length; r++) {
                var i = Math.floor(Math.random() * (r + 1))
                  , n = this.results[r];
                this.results[r] = this.results[i],
                this.results[i] = n
            }
            for (var a = !1, r = 0; r < this.results.length; r++)
                if (20 == Math.floor(this.results[r].reward.id / 1e4)) {
                    a = !0;
                    break
                }
            if (this.enable = !0,
            this.tf_wupin.me.visible = !1,
            this.tf_juese.me.visible = !1,
            this.final_result.me.visible = !1,
            this.left_tree.visible = !0,
            this.right_tree.visible = !0,
            this.btn_next.visible = !1,
            this.btn_pass.visible = !1,
            this.index = 0,
            this.me.XMin_new.play(0, !1),
            Laya.timer.once(1250, this, function() {
                e.btn_next.visible = !0,
                e.btn_pass.visible = !0
            }),
            Laya.timer.once(20 / 24 * 1e3, this, function() {
                view.AudioMgr.PlayAudio(108)
            }),
            this.me.getChildByName("container_scene").getChildByName("light").visible = !1,
            Laya.timer.once(1200, this, function() {
                e.me.getChildByName("container_scene").getChildByName("light").visible = !0,
                e.me.light.play(0, !0)
            }),
            a && Math.random() < .8) {
                var s = "scene/scene_tanfang_liuxing.ls";
                Laya.loader.create(s, Laya.Handler.create(this, function() {
                    Laya.timer.once(1500, e, function() {
                        e._scene_liuxing = Laya.loader.getRes(s),
                        e.container_liuxing.addChild(e._scene_liuxing),
                        e._scene_liuxing.visible = !0
                    })
                }))
            }
            var o = "scene/scene_jianying_sakura.ls";
            Laya.loader.create(o, Laya.Handler.create(this, function() {
                e._scene_jianying_sakura = Laya.loader.getRes(o),
                e.container_jianying_sakura.addChild(e._scene_jianying_sakura),
                e._scene_jianying_sakura.visible = !1
            }))
        }
        ,
        r.prototype.close = function() {
            this.enable = !1,
            t.UI_TanfangRoot.Inst.close(),
            this._scene_liuxing && (this._scene_liuxing.destroy(!0),
            this._scene_liuxing = null),
            this._scene_jianying_sakura && (this._scene_jianying_sakura.destroy(!0),
            this._scene_jianying_sakura = null),
            this.me.light.stop(),
            t.UI_Treasure.Inst.refresh_show()
        }
        ,
        r.prototype.show_next = function() {
            var t = this;
            this.btn_next.visible = !1,
            this.btn_pass.visible = !1,
            this.index < this.results.length ? (20 == Math.floor(this.results[this.index].reward.id / 1e4) ? (this.tf_juese.show(this.results[this.index].reward.id),
            Laya.timer.once(400, this, function() {
                t._scene_jianying_sakura && (t._scene_jianying_sakura.visible = !0,
                Laya.timer.once(2500, t, function() {
                    t._scene_jianying_sakura.visible = !1
                }))
            })) : this.tf_wupin.show(this.results[this.index].reward.id, this.results[this.index].reward.count),
            this.index++) : this.show_result()
        }
        ,
        r.prototype.show_result = function() {
            this.btn_next.visible = !1,
            this.btn_pass.visible = !1,
            this.index = this.results.length,
            this.final_result.show(this.results)
        }
        ,
        r
    }(t.UIBase);
    t.UI_Tanfang = a
}(uiscript || (uiscript = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), uiscript;
!function(t) {
    var e = function(e) {
        function i() {
            var t = e.call(this, new ui.lobby.tanfang0UI) || this;
            return t.need_show_loading = !1,
            t.loadover = !1,
            t.waiting_to_show = !1,
            t.results = null,
            i.Inst = t,
            t
        }
        return __extends(i, e),
        i.prototype.onCreate = function() {
            this.loading = this.me.getChildByName("loading"),
            this.root = this.me.getChildByName("root")
        }
        ,
        i.prototype.beginload = function() {
            var e = this;
            if (!this.loadover) {
                var i = "res/atlas/";
                "chs" != GameMgr.client_language && (i += GameMgr.client_language + "/"),
                this.urls = [i + "tanfang.atlas"],
                Laya.loader.create(this.urls, Laya.Handler.create(this, function() {
                    e.root.addChild((new t.UI_Tanfang).me),
                    Laya.timer.frameOnce(8, e, function() {
                        e.loadover = !0,
                        e.waiting_to_show && e.show_result()
                    })
                }))
            }
        }
        ,
        i.prototype.show = function(e, i, n) {
            var a = this;
            this.loading.visible = !1,
            this.need_show_loading = !0,
            Laya.timer.clearAll(this),
            Laya.timer.once(500, this, function() {
                a.need_show_loading && (a.loading.visible = !0)
            }),
            this.waiting_to_show = !1,
            app.NetAgent.sendReq2Lobby("Lobby", "openChest", {
                chest_id: e,
                count: i,
                use_ticket: n
            }, function(i, n) {
                i || n.error ? (t.UIMgr.Inst.showNetReqError("openChest", i, n),
                a.close()) : (a.results = n.results,
                t.UI_Treasure.on_chest_count_change([{
                    chest_id: e,
                    total_open_count: n.total_open_count
                }]),
                a.loadover ? a.show_result() : a.waiting_to_show = !0)
            }),
            this.enable = !0
        }
        ,
        i.prototype.test = function() {
            var t = this;
            this.loading.visible = !1,
            this.need_show_loading = !0,
            Laya.timer.clearAll(this),
            Laya.timer.once(500, this, function() {
                t.need_show_loading && (t.loading.visible = !0)
            }),
            this.waiting_to_show = !1,
            this._test10(),
            this.loadover ? this.show_result() : this.waiting_to_show = !0,
            Laya.timer.once(1e3, this, function() {
                t.beginload()
            }),
            this.enable = !0
        }
        ,
        i.prototype.close = function() {
            this.need_show_loading = !1,
            this.loading.visible = !1;
            for (var t = 0; t < this.urls.length; t++)
                Laya.loader.clearTextureRes(this.urls[t].url);
            this.enable = !1,
            view.AudioMgr.PlayMusic("music/lobby.mp3")
        }
        ,
        i.prototype.show_result = function() {
            this.need_show_loading = !1,
            this.loading.visible = !1,
            t.UI_Tanfang.Inst.show(this.results),
            view.AudioMgr.StopMusic()
        }
        ,
        i.prototype._test10 = function() {
            this.results = [{
                reward: {
                    id: 200001,
                    count: 1
                }
            }, {
                reward: {
                    id: 200001,
                    count: 1
                },
                replace: {
                    id: 302002,
                    count: 75
                }
            }, {
                reward: {
                    id: 200002,
                    count: 1
                }
            }, {
                reward: {
                    id: 302007,
                    count: 3
                }
            }, {
                reward: {
                    id: 302012,
                    count: 7
                }
            }, {
                reward: {
                    id: 303041,
                    count: 10
                }
            }, {
                reward: {
                    id: 305007,
                    count: 1
                }
            }, {
                reward: {
                    id: 305002,
                    count: 1
                }
            }, {
                reward: {
                    id: 305013,
                    count: 1
                }
            }, {
                reward: {
                    id: 305017,
                    count: 1
                }
            }]
        }
        ,
        i.prototype._test1 = function() {
            this.results = [{
                reward: {
                    id: 200001,
                    count: 1
                }
            }]
        }
        ,
        i
    }(t.UIBase);
    t.UI_TanfangRoot = e
}(uiscript || (uiscript = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), uiscript;
!function(t) {
    var e = function(t) {
        function e() {
            var i = t.call(this, new ui.mj.tingpaiUI) || this;
            return i.container_tiles = null,
            i.root = null,
            i.items = [],
            i.bg = null,
            i.btn_show = null,
            i.state = -1,
            i.zhengting = !1,
            i.tingPaiDiscardInfos = [],
            i.tingPaiInfos = [],
            i.mousedowned = !1,
            e.Inst = i,
            i
        }
        return __extends(e, t),
        e.prototype.onCreate = function() {
            this.root = this.me.getChildByName("root"),
            this.container_tiles = this.root.getChildByName("container_tiles");
            for (var t = 0; t < this.container_tiles.numChildren; t++) {
                var e = this.container_tiles.getChildAt(t);
                this.items.push({
                    container: e,
                    tile: e,
                    zhengting: e.getChildByName("flag_zhenting"),
                    container_left: e.getChildByName("container_left"),
                    count: e.getChildByName("container_left").getChildAt(0),
                    noyi: e.getChildByName("noyi")
                }),
                this.items[t].container.visible = !1
            }
            this.bg = {
                bg: this.root.getChildByName("bg0"),
                bound: this.root.getChildByName("bound"),
                mask: this.root.getChildByName("bg0").mask,
                right: this.root.getChildByName("bg0").getChildByName("right"),
                bar: this.root.getChildByName("bg0").getChildByName("bar")
            },
            this.btn_show = this.me.getChildByName("btn_show"),
            this.btn_show.on("mousedown", this, this._setMouseDown, [!0]),
            this.btn_show.on("mouseup", this, this._setMouseDown, [!1]),
            this.btn_show.on("mouseout", this, this._setMouseDown, [!1]),
            this.btn_show.visible = !1,
            this.reset()
        }
        ,
        e.prototype.reset = function() {
            this.root.visible = !1,
            this.btn_show.visible = !1,
            this.mousedowned = !1,
            this.zhengting = !1,
            this.state = -1,
            this.tingPaiDiscardInfos = [],
            this.tingPaiInfos = []
        }
        ,
        e.prototype.setData0 = function(t) {
            if (view.DesktopMgr.bianjietishi)
                if (t.tingpais && t.tingpais.length > 0) {
                    this.btn_show.visible = 1 == t.tingpais.length,
                    this.tingPaiDiscardInfos = [];
                    for (var e = 0; e < t.tingpais.length; e++) {
                        for (var i = [], n = 0; n < t.tingpais[e].infos.length; n++)
                            i.push({
                                tile: mjcore.MJPai.Create(t.tingpais[e].infos[n].tile),
                                haveyi: t.tingpais[e].infos[n].haveyi
                            });
                        this.tingPaiDiscardInfos.push({
                            tile: mjcore.MJPai.Create(t.tingpais[e].tile),
                            zhengting: t.tingpais[e].zhenting,
                            infos: i
                        })
                    }
                    this.state = 0
                } else
                    this.btn_show.visible = !1,
                    this.state = -1
        }
        ,
        e.prototype.setData1 = function(t) {
            if (view.DesktopMgr.bianjietishi)
                if (t.tingpais && t.tingpais.length > 0) {
                    this.btn_show.visible = !0,
                    this.tingPaiInfos = [];
                    for (var e = 0; e < t.tingpais.length; e++)
                        this.tingPaiInfos.push({
                            tile: mjcore.MJPai.Create(t.tingpais[e].tile),
                            haveyi: t.tingpais[e].haveyi
                        });
                    this.state = 1
                } else
                    this.btn_show.visible = !1,
                    this.state = -1
        }
        ,
        e.prototype._show = function(t, e) {
            for (n = 0; n < this.items.length; n++)
                this.items[n].container.visible = !1;
            t = t.sort(function(t, e) {
                return mjcore.MJPai.Distance(t.tile, e.tile)
            });
            for (var i = "myres2/mjp/" + GameMgr.Inst.mjp_view + "/ui/", n = 0; n < t.length; n++) {
                this.items[n].container.visible = !0,
                this.items[n].zhengting.visible = e,
                this.items[n].tile.skin = game.Tools.localUISrc(i + t[n].tile.toString() + ".png"),
                this.items[n].count.text = view.DesktopMgr.Inst.getPaiLeft(t[n].tile).toString() + ("en" == GameMgr.client_language ? " " : "") + game.Tools.strOfLocalization(2197),
                this.items[n].zhengting.visible = e,
                this.items[n].container.x = 80 + 120 * n,
                this.items[n].container.y = 45;
                var a = t[n].haveyi;
                view.DesktopMgr.Inst.mainrole.during_liqi && (a = !0),
                this.items[n].noyi.visible = !a,
                this.items[n].container_left.visible = a
            }
            var r = 210 + 80 * t.length + 40 * (t.length - 1);
            this.bg.bg.width = r,
            this.bg.bound.width = r,
            this.bg.bar.width = r + 80,
            this.bg.mask.width = r,
            this.bg.right.x = r - 20,
            this.root.x = 960 - r / 2,
            this.root.visible = !0
        }
        ,
        e.prototype.onChooseTile = function(t) {
            if (0 == this.state && t && this.tingPaiDiscardInfos) {
                for (var e = -1, i = 0; i < this.tingPaiDiscardInfos.length; i++)
                    if (0 == mjcore.MJPai.Distance(this.tingPaiDiscardInfos[i].tile, t)) {
                        e = i;
                        break
                    }
                -1 == e ? this.root.visible = !1 : this._show(this.tingPaiDiscardInfos[e].infos, this.tingPaiDiscardInfos[e].zhengting)
            } else
                this.root.visible = !1
        }
        ,
        e.prototype._setMouseDown = function(t) {
            app.Log.log("_setMouseDown " + t),
            this.mousedowned != t && (this.mousedowned = t,
            t ? 1 == this.state && this.tingPaiInfos && this.tingPaiInfos.length > 0 ? this._show(this.tingPaiInfos, this.zhengting) : 0 == this.state && this.tingPaiDiscardInfos && 1 == this.tingPaiDiscardInfos.length ? this._show(this.tingPaiDiscardInfos[0].infos, this.tingPaiDiscardInfos[0].zhengting) : this.root.visible = !1 : this.root.visible = !1)
        }
        ,
        e.prototype.setZhengting = function(t) {
            this.zhengting = t
        }
        ,
        e.Inst = null,
        e
    }(t.UIBase);
    t.UI_TingPai = e
}(uiscript || (uiscript = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), uiscript;
!function(t) {
    var e = function(e) {
        function i() {
            var t = e.call(this, new ui.lobby.titlebookUI) || this;
            return t._root = null,
            t._scrollview = null,
            t._blackmask = null,
            t._locking = !1,
            t._showindexs = [],
            i.Inst = t,
            t
        }
        return __extends(i, e),
        i.Init = function() {
            var e = this;
            app.NetAgent.sendReq2Lobby("Lobby", "fetchTitleList", {}, function(i, n) {
                if (i || n.error)
                    t.UIMgr.Inst.showNetReqError("fetchTitleList", i, n);
                else {
                    e.owned_title = [];
                    for (var a = 0; a < n.title_list.length; a++)
                        e.owned_title.push(n.title_list[a]),
                        600005 == n.title_list[a] && app.PlayerBehaviorStatistic.fb_trace_pending(app.EBehaviorType.Get_The_Title1, 1)
                }
            })
        }
        ,
        i.addTitle = function(t) {
            for (var e = 0; e < t.new_titles.length; e++)
                this.owned_title.push(t.new_titles[e]),
                600005 == t.new_titles[e] && app.PlayerBehaviorStatistic.fb_trace_pending(app.EBehaviorType.Get_The_Title1, 1)
        }
        ,
        i.prototype.onCreate = function() {
            var e = this;
            this._root = this.me.getChildByName("root"),
            this._blackmask = new t.UI_BlackMask(this.me.getChildByName("bmask"),Laya.Handler.create(this, function() {
                return e._locking
            }, null, !1),Laya.Handler.create(this, this.close, null, !1)),
            this._scrollview = this._root.getChildByName("content").scriptMap["capsui.CScrollView"],
            this._scrollview.init_scrollview(Laya.Handler.create(this, function(t) {
                e.setItemValue(t.index, t.container)
            }, null, !1)),
            this._root.getChildByName("btn_close").clickHandler = Laya.Handler.create(this, function() {
                e._locking || (e._blackmask.hide(),
                e.close())
            }, null, !1),
            this._noinfo = this._root.getChildByName("noinfo")
        }
        ,
        i.prototype.show = function() {
            var e = this;
            if (this._locking = !0,
            this.enable = !0,
            this._blackmask.show(),
            i.owned_title.length > 0) {
                this._showindexs = [];
                for (var n = 0; n < i.owned_title.length; n++)
                    this._showindexs.push(n);
                this._showindexs = this._showindexs.sort(function(t, e) {
                    var n = t
                      , a = cfg.item_definition.title.get(i.owned_title[t]);
                    a && (n += 1e3 * a.priority);
                    var r = e
                      , s = cfg.item_definition.title.get(i.owned_title[e]);
                    return s && (r += 1e3 * s.priority),
                    r - n
                }),
                this._scrollview.reset(),
                this._scrollview.addItem(i.owned_title.length),
                this._scrollview.me.visible = !0,
                this._noinfo.visible = !1
            } else
                this._noinfo.visible = !0,
                this._scrollview.me.visible = !1;
            t.UIBase.anim_pop_out(this._root, Laya.Handler.create(this, function() {
                e._locking = !1
            }))
        }
        ,
        i.prototype.close = function() {
            var e = this;
            this._locking = !0,
            t.UIBase.anim_pop_hide(this._root, Laya.Handler.create(this, function() {
                e._locking = !1,
                e.enable = !1
            }))
        }
        ,
        i.prototype.onDisable = function() {
            this._scrollview.reset()
        }
        ,
        i.prototype.setItemValue = function(t, e) {
            var n = this;
            if (this.enable) {
                var a = i.owned_title[this._showindexs[t]]
                  , r = cfg.item_definition.title.find(a);
                game.LoadMgr.setImgSkin(e.getChildByName("img_title"), r.icon),
                e.getChildByName("using").visible = a == GameMgr.Inst.account_data.title,
                e.getChildByName("desc").text = r["desc_" + GameMgr.client_language];
                e.getChildByName("btn").clickHandler = Laya.Handler.create(this, function() {
                    a != GameMgr.Inst.account_data.title ? (n.changeTitle(t),
                    e.getChildByName("using").visible = !0) : (n.changeTitle(-1),
                    e.getChildByName("using").visible = !1)
                }, null, !1)
            }
        }
        ,
        i.prototype.changeTitle = function(e) {
            var n = this
              , a = GameMgr.Inst.account_data.title
              , r = 0;
            r = e >= 0 && e < this._showindexs.length ? i.owned_title[this._showindexs[e]] : 600001,
            GameMgr.Inst.account_data.title = r;
            for (var s = -1, o = 0; o < this._showindexs.length; o++)
                if (a == i.owned_title[this._showindexs[o]]) {
                    s = o;
                    break
                }
            t.UI_Lobby.Inst.enable && t.UI_Lobby.Inst.top.refresh(),
            t.UI_PlayerInfo.Inst.enable && t.UI_PlayerInfo.Inst.refreshBaseInfo(),
            -1 != s && this._scrollview.wantToRefreshItem(s),
            app.NetAgent.sendReq2Lobby("Lobby", "useTitle", {
                title: 600001 == r ? 0 : r
            }, function(i, r) {
                (i || r.error) && (t.UIMgr.Inst.showNetReqError("useTitle", i, r),
                GameMgr.Inst.account_data.title = a,
                t.UI_Lobby.Inst.enable && t.UI_Lobby.Inst.top.refresh(),
                t.UI_PlayerInfo.Inst.enable && t.UI_PlayerInfo.Inst.refreshBaseInfo(),
                n.enable && (e >= 0 && e < n._showindexs.length && n._scrollview.wantToRefreshItem(e),
                s >= 0 && s < n._showindexs.length && n._scrollview.wantToRefreshItem(s)))
            })
        }
        ,
        i.Inst = null,
        i.owned_title = [],
        i
    }(t.UIBase);
    t.UI_TitleBook = e
}(uiscript || (uiscript = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), uiscript;
!function(t) {
    var e = function() {
        function e(t) {
            var e = this;
            this.me = t,
            this.root = t.getChildByName("root"),
            this.panel = this.root.getChildByName("content"),
            this.label_info = this.panel.getChildByName("info"),
            this.panel.vScrollBarSkin = "",
            this.me.getChildByName("btn_close").clickHandler = Laya.Handler.create(this, function() {
                e.close()
            }, null, !1)
        }
        return e.prototype.show = function(e) {
            var i = cfg.chest.chest.get(e);
            this.label_info.text = i["desc_" + GameMgr.client_language],
            this.label_info.height = this.label_info.textField.textHeight,
            this.panel.refresh(),
            this.me.visible = !0,
            t.UIBase.anim_alpha_in(this.root, {
                y: 30
            }, 150)
        }
        ,
        e.prototype.showinfo = function(e) {
            this.label_info.text = e,
            this.label_info.height = this.label_info.textField.textHeight,
            this.panel.refresh(),
            this.me.visible = !0,
            t.UIBase.anim_alpha_in(this.root, {
                y: 30
            }, 150)
        }
        ,
        e.prototype.close = function() {
            var e = this;
            t.UIBase.anim_alpha_out(this.root, {
                y: 30
            }, 150, 0, Laya.Handler.create(this, function() {
                e.me.visible = !1
            }))
        }
        ,
        e
    }()
      , i = function() {
        function e(t) {
            var e = this;
            this.me = t,
            this.me.visible = !1,
            this.root = this.me.getChildByName("root"),
            this.name = this.root.getChildByName("label_name"),
            this.desc = this.root.getChildByName("desc"),
            this.root.getChildByName("btn_close").clickHandler = Laya.Handler.create(this, function() {
                e.close()
            }, null, !1),
            this.container_item = this.root.getChildByName("item"),
            this.buyed = this.container_item.getChildByName("buyed"),
            this.icon = this.container_item.getChildByName("icon"),
            this.container_price = this.root.getChildByName("price"),
            this.btn_buy = this.root.getChildByName("btn_buy"),
            this.btn_buy.clickHandler = Laya.Handler.create(this, this.on_buy, null, !1)
        }
        return e.prototype.show = function(e, i, n) {
            this.chest_shop_item_id = e,
            this.my_currency_num = n,
            this.me.visible = !0,
            t.UIBase.anim_pop_out(this.root, null);
            var a = cfg.chest.chest_shop.get(e);
            this.my_currency_num = n;
            var r = game.GameUtility.get_item_view(a.item_id);
            this.name.text = r.name,
            this.desc.text = r.desc,
            game.LoadMgr.setImgSkin(this.icon, a.icon),
            this.single_price = a.price,
            this.refresh_cost(this.single_price),
            i ? (this.buyed.visible = !0,
            this.icon.filters = [new Laya.ColorFilter(t.DARK_FILTER)],
            game.Tools.setGrayDisable(this.btn_buy, !0)) : (this.buyed.visible = !1,
            this.icon.filters = [],
            game.Tools.setGrayDisable(this.btn_buy, this.single_price > this.my_currency_num))
        }
        ,
        e.prototype.close = function() {
            var e = this;
            t.UIBase.anim_pop_hide(this.root, Laya.Handler.create(this, function() {
                e.me.visible = !1
            }))
        }
        ,
        e.prototype.refresh_cost = function(t) {
            this.container_price.getChildByName("label0"),
            this.container_price.getChildByName("icon");
            var e = this.container_price.getChildByName("count");
            e.text = t.toString(),
            e.color = t <= this.my_currency_num ? "#00ff00" : "#ff0000",
            game.Tools.child_align_center(this.container_price, [10, 5])
        }
        ,
        e.prototype.on_buy = function() {
            this.close(),
            game.Tools.setGrayDisable(this.btn_buy, !0);
            var e = this.chest_shop_item_id;
            app.NetAgent.sendReq2Lobby("Lobby", "buyFromChestShop", {
                goods_id: this.chest_shop_item_id,
                count: 1
            }, function(i, n) {
                if (i || n.error)
                    t.UIMgr.Inst.showNetReqError("buyFromChestShop", i, n);
                else {
                    var a = cfg.chest.chest_shop.get(e);
                    t.UI_LightTips.Inst.show(game.Tools.strOfLocalization(2161, [a["name_" + GameMgr.client_language]])),
                    h.on_chest_count_change([{
                        chest_id: n.chest_id,
                        consume_count: n.consume_count
                    }]),
                    h.Inst.xy.want_refresh(),
                    h.Inst.money.onEnable(),
                    h.Inst.money.label_xinyang && (h.Inst.money.label_xinyang.text = h.get_chest_currency(h.Inst.chest_id).toString())
                }
            })
        }
        ,
        e
    }()
      , n = function() {
        function e(t) {
            var e = this;
            this.me = t,
            this.me.visible = !1,
            this.root = this.me.getChildByName("root"),
            this.name = this.root.getChildByName("label_name"),
            this.desc = this.root.getChildByName("desc"),
            this.root.getChildByName("btn_close").clickHandler = Laya.Handler.create(this, function() {
                e.close()
            }, null, !1),
            this.container_item = this.root.getChildByName("item"),
            this.buyed = this.container_item.getChildByName("buyed"),
            this.icon = this.container_item.getChildByName("icon"),
            this.label_count = this.root.getChildByName("count"),
            this.container_danjia = this.root.getChildByName("danjia"),
            this.container_left_count = this.root.getChildByName("left"),
            this.label_refresh_info = this.root.getChildByName("refresh_info"),
            this.container_price = this.root.getChildByName("price"),
            this.btn_buy = this.root.getChildByName("btn_buy"),
            this.btn_buy.clickHandler = Laya.Handler.create(this, this.on_buy, null, !1);
            for (var i = ["-10", "-1", "+1", "+10"], n = function(t) {
                var n = a.root.getChildByName(i[t])
                  , r = n.getChildByName("s");
                r.alpha = 0;
                var s = !1;
                n.on("mousedown", a, function() {
                    r.alpha = 0,
                    s = !0,
                    Laya.Tween.to(r, {
                        alpha: 1
                    }, 50, null, null, 0, !0, !0)
                }),
                n.on("mouseup", a, function() {
                    if (Laya.Tween.to(r, {
                        alpha: 0
                    }, 50, null, null, 0, !0, !0),
                    s)
                        switch (t) {
                        case 0:
                            e.on_num_change(-10);
                            break;
                        case 1:
                            e.on_num_change(-1);
                            break;
                        case 2:
                            e.on_num_change(1);
                            break;
                        case 3:
                            e.on_num_change(10)
                        }
                    s = !1
                }),
                n.on("mouseout", a, function() {
                    Laya.Tween.to(r, {
                        alpha: 0
                    }, 50, null, null, 0, !0, !0),
                    s = !1
                })
            }, a = this, r = 0; r < i.length; r++)
                n(r)
        }
        return e.prototype.show = function(e, i) {
            this.chest_shop_item_id = e,
            this.my_currency_num = i,
            this.me.visible = !0,
            t.UIBase.anim_pop_out(this.root, null);
            var n = cfg.chest.chest_shop.get(e);
            this.single_price = n.price;
            var a = game.GameUtility.get_item_view(n.item_id);
            this.name.text = a.name,
            this.desc.text = a.desc,
            game.LoadMgr.setImgSkin(this.icon, n.icon),
            this.count = 1,
            this.refresh(),
            this.label_refresh_info.visible = !1,
            this.container_left_count.visible = !1,
            this.container_danjia.x = 393,
            this.container_danjia.getChildByName("price").text = this.single_price.toString()
        }
        ,
        e.prototype.close = function() {
            var e = this;
            t.UIBase.anim_pop_hide(this.root, Laya.Handler.create(this, function() {
                e.me.visible = !1
            }))
        }
        ,
        e.prototype.on_buy = function() {
            this.close(),
            game.Tools.setGrayDisable(this.btn_buy, !0);
            var e = this.chest_shop_item_id
              , i = this.count;
            app.NetAgent.sendReq2Lobby("Lobby", "buyFromChestShop", {
                goods_id: this.chest_shop_item_id,
                count: this.count
            }, function(n, a) {
                if (n || a.error)
                    t.UIMgr.Inst.showNetReqError("buyFromChestShop", n, a);
                else {
                    var r = cfg.chest.chest_shop.get(e);
                    t.UI_LightTips.Inst.show(game.Tools.strOfLocalization(2161, [r["name_" + GameMgr.client_language] + "x" + i])),
                    h.on_chest_count_change([{
                        chest_id: a.chest_id,
                        consume_count: a.consume_count
                    }]),
                    h.Inst.xy.want_refresh(),
                    h.Inst.money.onEnable(),
                    h.Inst.money.label_xinyang && (h.Inst.money.label_xinyang.text = h.get_chest_currency(h.Inst.chest_id).toString())
                }
            })
        }
        ,
        e.prototype.on_num_change = function(t) {
            this.count += t,
            this.count >= 999 && (this.count = 999),
            this.count < 1 && (this.count = 1),
            this.refresh()
        }
        ,
        e.prototype.refresh = function() {
            this.label_count.text = this.count.toString(),
            this.buyed.visible = !1,
            game.Tools.setGrayDisable(this.container_item, !1),
            game.Tools.setGrayDisable(this.btn_buy, this.single_price * this.count > this.my_currency_num),
            this.refresh_cost(this.count * this.single_price)
        }
        ,
        e.prototype.refresh_cost = function(t) {
            this.container_price.getChildByName("label0"),
            this.container_price.getChildByName("icon");
            var e = this.container_price.getChildByName("count");
            e.text = t.toString(),
            e.color = t <= this.my_currency_num ? "#00ff00" : "#ff0000",
            game.Tools.child_align_center(this.container_price, [10, 5])
        }
        ,
        e
    }()
      , a = function() {
        function e(t, e, a) {
            var r = this;
            this.me = t,
            this.buy_single = new i(e),
            this.buy_multi = new n(a),
            this.label_count = t.getChildByName("count"),
            this.scrollview = this.me.scriptMap["capsui.CScrollView"],
            this.scrollview.init_scrollview(Laya.Handler.create(this, this.render_item, null, !1), -1, 4),
            this.me.visible = !1,
            this.me.getChildByName("btn_close").clickHandler = Laya.Handler.create(this, function() {
                r.locking || r.close()
            }, null, !1)
        }
        return e.prototype.show = function(e) {
            var i = this;
            this.chest_id = e,
            this.locking = !0,
            this.me.visible = !0,
            t.UIBase.anim_alpha_in(this.me, {
                y: 30
            }, 150, null, Laya.Handler.create(this, function() {
                i.locking = !1
            })),
            this.items = [],
            cfg.chest.chest_shop.forEach(function(n) {
                n.chest_id == e && (n.check_activity && !t.UI_Activity.activity_is_running(n.check_activity) || i.items.push(n.id))
            }),
            this.refresh_currency(),
            this.scrollview.reset(),
            this.scrollview.addItem(this.items.length)
        }
        ,
        e.prototype.want_refresh = function() {
            this.scrollview.wantToRefreshAll()
        }
        ,
        e.prototype.close = function() {
            var e = this;
            this.locking = !0,
            t.UIBase.anim_alpha_out(this.me, {
                y: 30
            }, 150, null, Laya.Handler.create(this, function() {
                e.locking = !1,
                e.me.visible = !1
            }))
        }
        ,
        e.prototype.render_item = function(e) {
            var i = this
              , n = e.index
              , a = e.container
              , r = (e.cache_data,
            this.items[n])
              , s = cfg.chest.chest_shop.get(r)
              , o = !1;
            game.GameUtility.item_owned(s.item_id) && (o = !0);
            var l = a.getChildByName("btn");
            l.clickHandler = Laya.Handler.create(this, function() {
                s.need_amount ? i.buy_multi.show(r, i.currency_count) : i.buy_single.show(r, o, i.currency_count)
            }, null, !1),
            l.getChildByName("label_name").text = s["name_" + GameMgr.client_language],
            game.LoadMgr.setImgSkin(a.getChildByName("btn").getChildByName("icon"), s.icon),
            o ? (l.getChildByName("buyed").visible = !0,
            l.getChildByName("icon").filters = [new Laya.ColorFilter(t.DARK_FILTER)],
            l.getChildByName("btn_buy").filters = [new Laya.ColorFilter(t.GRAY_FILTER)]) : (l.getChildByName("buyed").visible = !1,
            l.getChildByName("icon").filters = [],
            l.getChildByName("btn_buy").filters = []),
            l.getChildByName("btn_buy").getChildByName("label_gold").text = s.price.toString(),
            game.Tools.child_align_center(l.getChildByName("btn_buy")),
            l.getChildByName("xianding").visible = null != s.check_activity && s.check_activity > 0
        }
        ,
        e.prototype.refresh_currency = function() {
            this.currency_count = h.get_chest_currency(this.chest_id),
            this.label_count.text = this.currency_count.toString()
        }
        ,
        e
    }()
      , r = function() {
        function e(t, e) {
            var i = this;
            this.cells = [],
            this.total_h = 0,
            this.charas = [],
            this.looks = [],
            this.gifts = [],
            this.used_cell_count = 0,
            this.me = t,
            this.father = e,
            this.content = this.me.getChildByName("content"),
            this.templete = this.content.getChildByName("templete"),
            this.templete.visible = !1,
            this.cells = [];
            for (var n = this.templete.scriptMap["capsui.UICopy"], a = 0; a < 150; a++) {
                var r = n.getNodeClone();
                this.cells.push(r)
            }
            this.container_character = this.content.getChildByName("container_character"),
            this.container_look = this.content.getChildByName("container_look"),
            this.container_present = this.content.getChildByName("container_present"),
            this.scrollbar = this.me.getChildByName("scrollbar").scriptMap["capsui.CScrollBar"],
            this.scrollbar.init(!0, new Laya.Handler(this,function(t) {
                i.content.vScrollBar.value = i.content.vScrollBar.max * t,
                i.onPanelScroll()
            }
            )),
            this.content.vScrollBarSkin = "",
            this.content.vScrollBar.on("change", this, this.onPanelScroll),
            this.content.getChildByName("desc_chs").visible = !1,
            this.content.getChildByName("desc_en").visible = !1,
            this.content.getChildByName("desc_jp").visible = !1,
            this.content.getChildByName("desc_" + GameMgr.client_language).visible = !0
        }
        return e.prototype.onPanelScroll = function() {
            this.total_h < this.content.height ? this.scrollbar.setVal(0, 1) : this.scrollbar.setVal(this.content.vScrollBar.value / this.content.vScrollBar.max, this.content.height / this.total_h)
        }
        ,
        e.prototype.refresh_data = function(e) {
            var i = this;
            if (0 != this.used_cell_count) {
                for (r = 0; r < this.used_cell_count; r++)
                    this.cells[r].visible = !1;
                this.used_cell_count = 0
            }
            if (this.charas = [],
            this.looks = [],
            this.gifts = [],
            cfg.chest.preview.forEach(function(n) {
                if (n.chest_id == e && (!n.check_activity || t.UI_Activity.activity_is_running(n.check_activity)))
                    switch (n.type) {
                    case "chara":
                        i.charas.push({
                            item_id: n.item_id,
                            check_activity: n.check_activity
                        });
                        break;
                    case "skin":
                        i.looks.push({
                            item_id: n.item_id,
                            check_activity: n.check_activity
                        });
                        break;
                    case "gift":
                        i.gifts.push({
                            item_id: n.item_id,
                            check_activity: n.check_activity
                        })
                    }
            }),
            this.total_h = 215,
            this.used_cell_count = 0,
            this.charas.length > 0) {
                this.container_character.visible = !0,
                this.container_character.y = this.total_h,
                this.container_character.height = 174 + 170 * (Math.ceil(this.charas.length / 6) - 1),
                this.total_h += this.container_character.height;
                for (var n = function(t) {
                    var e = a.charas[t].item_id
                      , n = a.charas[t].check_activity
                      , r = a.cells[a.used_cell_count++];
                    a.container_character.addChild(r),
                    r.x = t % 6 * 162 + 135,
                    r.y = 15 + 175 * Math.floor(t / 6),
                    r.visible = !0;
                    var s = cfg.item_definition.character.find(e)
                      , o = cfg.item_definition.skin.find(s.init_skin)
                      , l = r.getChildByName("btn");
                    l.clickHandler = Laya.Handler.create(a, function() {
                        i.me.visible = !1,
                        i.father.page_character.show(i.charas, t)
                    }, null, !1),
                    game.LoadMgr.setImgSkin(l.getChildByName("icon"), o.path + "/smallhead.png"),
                    l.getChildByName("xianding").visible = null != n && n > 0
                }, a = this, r = 0; r < this.charas.length; r++)
                    n(r);
                this.total_h += 25
            } else
                this.container_character.visible = !1;
            if (this.looks.length > 0) {
                this.container_look.visible = !0,
                this.container_look.y = this.total_h,
                this.container_look.height = 174 + 170 * (Math.ceil(this.looks.length / 6) - 1),
                this.total_h += this.container_look.height;
                for (var s = function(e) {
                    var i = o.looks[e].item_id
                      , n = o.looks[e].check_activity
                      , a = o.cells[o.used_cell_count++];
                    o.container_look.addChild(a),
                    a.x = e % 6 * 162 + 135,
                    a.y = 15 + 175 * Math.floor(e / 6),
                    a.visible = !0;
                    var r = cfg.item_definition.item.find(i)
                      , s = a.getChildByName("btn");
                    s.clickHandler = Laya.Handler.create(o, function() {
                        t.UI_ItemDetail.Inst.show(i)
                    }, null, !1),
                    game.LoadMgr.setImgSkin(s.getChildByName("icon"), r.icon),
                    s.getChildByName("xianding").visible = null != n && n > 0
                }, o = this, r = 0; r < this.looks.length; r++)
                    s(r);
                this.total_h += 25
            } else
                this.container_look.visible = !1;
            if (this.gifts.length > 0) {
                this.container_present.visible = !0,
                this.container_present.y = this.total_h,
                this.container_present.height = 174 + 170 * (Math.ceil(this.gifts.length / 6) - 1),
                this.total_h += this.container_present.height;
                for (var l = function(e) {
                    var i = h.gifts[e].item_id
                      , n = h.gifts[e].check_activity
                      , a = h.cells[h.used_cell_count++];
                    h.container_present.addChild(a),
                    a.x = e % 6 * 162 + 135,
                    a.y = 15 + 175 * Math.floor(e / 6),
                    a.visible = !0;
                    var r = cfg.item_definition.item.find(i)
                      , s = a.getChildByName("btn");
                    s.clickHandler = Laya.Handler.create(h, function() {
                        t.UI_ItemDetail.Inst.show(i)
                    }, null, !1),
                    game.LoadMgr.setImgSkin(s.getChildByName("icon"), r.icon),
                    s.getChildByName("xianding").visible = null != n && n > 0
                }, h = this, r = 0; r < this.gifts.length; r++)
                    l(r);
                this.total_h += 25
            } else
                this.container_present.visible = !1;
            for (r = this.used_cell_count; r < this.cells.length; r++)
                this.cells[r].visible = !1;
            this.content.vScrollBar.stopScroll(),
            this.content.vScrollBar.value = 0,
            this.content.refresh(),
            this.scrollbar.reset(),
            this.scrollbar.setVal(0, this.content.height / this.total_h)
        }
        ,
        e.prototype.show = function() {
            this.me.visible = !0,
            t.UIBase.anim_alpha_in(this.me, {
                y: 30
            }, 150)
        }
        ,
        e
    }()
      , s = function() {
        function e(e, i) {
            var n = this;
            this.head_cells = [],
            this.locking = !1,
            this.target_x = 0,
            this.detail_height = 0,
            this.me = e,
            this.father = i,
            this.container_right = this.me.getChildByName("right"),
            this.btn_left = this.container_right.getChildByName("btn_left"),
            this.btn_left.clickHandler = new Laya.Handler(this,function() {
                n._change_choose_target_x(n.target_x + 180)
            }
            ),
            this.btn_right = this.container_right.getChildByName("btn_right"),
            this.btn_right.clickHandler = new Laya.Handler(this,function() {
                n._change_choose_target_x(n.target_x - 180)
            }
            ),
            this.panel_choose = this.container_right.getChildByName("panel_choose"),
            this.container_choose = this.panel_choose.getChildByName("container_choose"),
            this.head_templete = this.container_choose.getChildByName("templete"),
            this.head_templete.visible = !1;
            for (var a = this.head_templete.scriptMap["capsui.UICopy"], r = 0; r < 16; r++) {
                var s = a.getNodeClone();
                s.visible = !1,
                this.head_cells.push(s)
            }
            var o = this.container_right.getChildByName("intro");
            this.intro_content = o.getChildByName("content"),
            this.intro_scorll = o.getChildByName("scrollbar").scriptMap["capsui.CScrollBar"],
            this.intro_scorll.init(!0, Laya.Handler.create(this, function(t) {
                n.intro_content.vScrollBar.value = n.intro_content.vScrollBar.max * t
            }, null, !1)),
            this.intro_content.vScrollBarSkin = "",
            this.intro_content.vScrollBar.on("change", this, function() {
                var t = n.intro_content.vScrollBar.value / n.intro_content.vScrollBar.max
                  , e = n.intro_content.height / n.detail_height;
                n.intro_scorll.setVal(t, e)
            }),
            this.container_left = this.me.getChildByName("left"),
            this.container_illust = this.container_left.getChildByName("container_illust"),
            this.illust_h = this.container_illust.getChildByName("illust_h"),
            this.illust = new t.UI_Character_Skin(this.illust_h.getChildByName("illust")),
            this.illust_x = this.container_illust.x,
            this.container_left.getChildByName("btn_back").clickHandler = Laya.Handler.create(this, function() {
                n.locking || (n.me.visible = !1,
                n.reset(),
                n.father.page_total.show())
            }, null, !1);
            var l = null;
            "chs" == GameMgr.client_language ? (l = this.container_illust.getChildByName("container_name"),
            this.container_illust.getChildByName("container_name_en").visible = !1) : (l = this.container_illust.getChildByName("container_name_en"),
            this.container_illust.getChildByName("container_name").visible = !1),
            this.label_name = l.getChildByName("label_name"),
            this.label_cv = l.getChildByName("label_CV")
        }
        return e.prototype.show = function(e, i) {
            var n = this;
            this.charas = e;
            for (var a = function(t) {
                var e = r.head_cells[t];
                if (t < r.charas.length) {
                    var a = r.charas[t].item_id
                      , s = cfg.item_definition.character.find(a)
                      , o = cfg.item_definition.skin.find(s.init_skin);
                    e.visible = !0;
                    var l = e.getChildByName("btn");
                    l.clickHandler = Laya.Handler.create(r, function() {
                        i != t && (n.head_cells[i].getChildByName("btn").getChildByName("chosen").visible = !1,
                        i = t,
                        e.getChildByName("btn").getChildByName("chosen").visible = !0,
                        n._refresh_detail(a, !1))
                    }, null, !1),
                    l.getChildByName("chosen").visible = t == i,
                    game.LoadMgr.setImgSkin(l.getChildByName("icon"), o.path + "/smallhead.png"),
                    e.x = e.width * t
                } else
                    e.visible = !1
            }, r = this, s = 0; s < this.head_cells.length; s++)
                a(s);
            this._refresh_detail(e[i].item_id, !0),
            this.container_choose.width = this.head_cells[0].width * e.length,
            this.container_choose.x = 0,
            this._refresh_leftright_btn(),
            this.me.visible = !0,
            this.locking = !0,
            t.UIBase.anim_alpha_in(this.container_left, {
                x: -30
            }, 150),
            t.UIBase.anim_alpha_in(this.container_right, {
                x: 30
            }, 150, 0, Laya.Handler.create(this, function() {
                n.locking = !1
            }))
        }
        ,
        e.prototype.reset = function() {
            this.audio_channel && (this.audio_channel.stop(),
            this.audio_channel = null),
            Laya.Tween.clearAll(this.container_choose),
            this.illust.clear()
        }
        ,
        e.prototype._refresh_detail = function(t, e) {
            var i = this;
            this.audio_channel && (this.audio_channel.stop(),
            this.audio_channel = null),
            this.illust.clear();
            var n = cfg.item_definition.character.find(t);
            this.label_name.text = n["name_" + GameMgr.client_language],
            "chs" == GameMgr.client_language ? this.label_cv.text = "CV" + n["desc_cv_" + GameMgr.client_language] : this.label_cv.text = "CV:" + n["desc_cv_" + GameMgr.client_language];
            var a = this.intro_content.getChildByName("container_text");
            if (a.getChildByName("height").text = n["desc_stature_" + GameMgr.client_language],
            a.getChildByName("birth").text = n["desc_birth_" + GameMgr.client_language],
            a.getChildByName("age").text = n["desc_age_" + GameMgr.client_language],
            a.getChildByName("bloodtype").text = n.desc_bloodtype,
            a.getChildByName("cv").text = n["desc_cv_" + GameMgr.client_language],
            a.getChildByName("hobby").text = n["desc_hobby_" + GameMgr.client_language],
            a.getChildByName("desc").text = n["desc_" + GameMgr.client_language],
            "en" == GameMgr.client_language) {
                var r = [new Laya.ColorFilter([.7, 0, 0, 0, 0, 0, .7, 0, 0, 0, 0, 0, .7, 0, 0, 0, 0, 0, 1, 0])];
                a.getChildByName("height").font = "en_shuhun",
                a.getChildByName("height").filters = r,
                a.getChildByName("birth").font = "en_shuhun",
                a.getChildByName("birth").filters = r,
                a.getChildByName("age").font = "en_shuhun",
                a.getChildByName("age").filters = r,
                a.getChildByName("bloodtype").font = "en_shuhun",
                a.getChildByName("bloodtype").filters = r,
                a.getChildByName("cv").font = "en_shuhun",
                a.getChildByName("cv").filters = r,
                a.getChildByName("hobby").font = "en_shuhun",
                a.getChildByName("hobby").filters = r,
                a.getChildByName("desc").font = "en_shuhun",
                a.getChildByName("desc").filters = r
            }
            for (f = 0; f < 12; f += 2) {
                var s = a.getChildAt(f);
                a.getChildAt(f + 1).x = s.textField.textWidth * s.scaleX + s.x + 10
            }
            var o = a.getChildByName("desc").textField.textHeight * a.getChildByName("desc").scaleY
              , l = this.intro_content.getChildByName("audio");
            l.y = 340 + o,
            this.detail_height = 560 + o;
            for (var h = ["lobby_selfintro", "lobby_playerlogin", "lobby_normal"], c = [], u = -1, _ = function(e) {
                var n = l.getChildByName("audio" + e).getChildByName("btn_play")
                  , a = n.getChildByName("img");
                a.skin = game.Tools.localUISrc("myres/sushe/bf_play.png"),
                c.push(a),
                n.clickHandler = Laya.Handler.create(d, function() {
                    if (u == e)
                        i.audio_channel && (i.audio_channel.stop(),
                        i.audio_channel = null),
                        u = -1,
                        a.skin = game.Tools.localUISrc("myres/sushe/bf_play.png");
                    else {
                        -1 != u && (i.audio_channel && (i.audio_channel.stop(),
                        i.audio_channel = null),
                        c[u].skin = game.Tools.localUISrc("myres/sushe/bf_play.png"),
                        u = -1),
                        u = e,
                        a.skin = game.Tools.localUISrc("myres/sushe/bf_pause.png");
                        var n = view.AudioMgr.PlayCharactorSound({
                            charid: t,
                            level: 1
                        }, h[e], Laya.Handler.create(i, function() {
                            i.audio_channel && (i.audio_channel.stop(),
                            i.audio_channel = null),
                            u = -1,
                            a.skin = game.Tools.localUISrc("myres/sushe/bf_play.png")
                        }));
                        i.audio_channel = n.sound
                    }
                }, null, !1)
            }, d = this, f = 0; f < 3; f++)
                _(f);
            switch (this.intro_content.vScrollBar.stopScroll(),
            this.intro_content.refresh(),
            this.intro_scorll.reset(),
            this.intro_scorll.setVal(0, this.intro_content.height / this.detail_height),
            this.intro_content.vScrollBar.value = 0,
            t) {
            case 200005:
                this.illust_h.y = -40;
                break;
            case 200006:
                this.illust_h.y = -60;
                break;
            default:
                this.illust_h.y = 0
            }
            this.illust.setSkin(n.init_skin, "full"),
            e ? (this.container_illust.alpha = 1,
            this.container_illust.x = this.illust_x) : (this.container_illust.x = this.illust_x - 50,
            this.container_illust.alpha = 0,
            Laya.Tween.to(this.container_illust, {
                x: this.illust_x,
                alpha: 1
            }, 400, Laya.Ease.strongOut, null, 0, !0))
        }
        ,
        e.prototype._refresh_leftright_btn = function() {
            this.container_choose.x >= 0 ? (this.container_choose.x = 0,
            this.btn_left.visible = !1) : this.btn_left.visible = !0,
            this.container_choose.width <= this.panel_choose.width ? this.btn_right.visible = !1 : this.container_choose.x <= this.panel_choose.width - this.container_choose.width ? (this.container_choose.x = this.panel_choose.width - this.container_choose.width,
            this.btn_right.visible = !1) : this.btn_right.visible = !0
        }
        ,
        e.prototype._change_choose_target_x = function(t) {
            var e = this;
            if (t > 0 && (t = 0),
            this.container_choose.width > this.panel_choose.width && t < this.panel_choose.width - this.container_choose.width && (t = this.panel_choose.width - this.container_choose.width),
            this._refresh_leftright_btn(),
            this.target_x = t,
            Laya.Tween.clearAll(this.container_choose),
            t != this.container_choose.x) {
                var i = Math.abs(t - this.container_choose.x) / .5;
                Laya.Tween.to(this.container_choose, {
                    x: t
                }, i, null, Laya.Handler.create(this, function() {
                    e._refresh_leftright_btn()
                }))
            }
        }
        ,
        e
    }()
      , o = function() {
        function e(t) {
            var e = this;
            this.locking = !1,
            this.me = t,
            this.btn_close = this.me.getChildByName("btn_close"),
            this.btn_close.clickHandler = Laya.Handler.create(this, function() {
                e.locking || e.close()
            }, null, !1),
            this.page_total = new r(this.me.getChildByName("page_total"),this),
            this.page_character = new s(this.me.getChildByName("page_character"),this)
        }
        return e.prototype.show = function(e) {
            var i = this;
            this.chest_id = e,
            this.page_total.refresh_data(e),
            this.page_total.me.visible = !0,
            this.page_character.me.visible = !1,
            this.locking = !0,
            this.me.visible = !0,
            t.UIBase.anim_alpha_in(this.me, {
                y: 30
            }, 150, 0, Laya.Handler.create(this, function() {
                i.locking = !1
            }))
        }
        ,
        e.prototype.close = function() {
            var e = this;
            this.locking = !0,
            t.UIBase.anim_alpha_out(this.me, {
                y: 30
            }, 150, 0, Laya.Handler.create(this, function() {
                e.locking = !1,
                e.me.visible = !1,
                e.page_character.reset()
            }))
        }
        ,
        e
    }()
      , l = function() {
        function e(e) {
            var i = this;
            this.locking = !1,
            this.id = 0,
            this.count = 0,
            this.me = e,
            this.root = e.getChildByName("root"),
            this.label_num0 = this.root.getChildByName("num0"),
            this.label_num1 = this.root.getChildByName("num1"),
            this.label_num2 = this.root.getChildByName("num2"),
            this.label_num3 = this.root.getChildByName("num3"),
            this.root.getChildByName("btn_close").clickHandler = new Laya.Handler(this,function() {
                i.locking || i.close()
            }
            ),
            this.root.getChildByName("btn_cancel").clickHandler = new Laya.Handler(this,function() {
                i.locking || i.close()
            }
            ),
            this.root.getChildByName("btn_cancel").filters = [new Laya.ColorFilter(t.GRAY_FILTER)],
            this.root.getChildByName("btn_confirm").clickHandler = new Laya.Handler(this,function() {
                i.locking || (app.NetAgent.sendReq2Lobby("Lobby", "exchangeChestStone", {
                    id: i.id,
                    count: i.count
                }, function(e, i) {
                    e || i.error ? t.UIMgr.Inst.showNetReqError("exchangeChestStone", e, i) : t.UI_LightTips.Inst.show(game.Tools.strOfLocalization(2191))
                }),
                i.close())
            }
            )
        }
        return e.prototype.show = function(e) {
            var i = this;
            this.id = 3001,
            this.count = Math.ceil(e / 200);
            var n = cfg.exchange.searchexchange.find(this.id);
            this.label_num0.text = (n.source_value * this.count).toString(),
            this.label_num1.text = (n.target_value * this.count).toString(),
            this.label_num2.text = (n.source_value * this.count).toString(),
            this.label_num3.text = (n.target_value * this.count).toString(),
            this.locking = !0,
            this.me.visible = !0,
            t.UIBase.anim_pop_out(this.root, Laya.Handler.create(this, function() {
                i.locking = !1
            }))
        }
        ,
        e.prototype.close = function() {
            var e = this;
            this.locking = !0,
            t.UIBase.anim_pop_hide(this.root, Laya.Handler.create(this, function() {
                e.locking = !1,
                e.me.visible = !1
            }))
        }
        ,
        e
    }()
      , h = function(i) {
        function n() {
            var t = i.call(this, new ui.lobby.treasureUI) || this;
            return n.Inst = t,
            t
        }
        return __extends(n, i),
        n.on_chest_count_change = function(t) {
            for (var e = 0; e < t.length; e++)
                this.chest_count[t[e].chest_id] || (this.chest_count[t[e].chest_id] = {
                    total: 0,
                    consume: 0
                }),
                t[e].consume_count && (this.chest_count[t[e].chest_id].consume = t[e].consume_count),
                t[e].total_open_count && (this.chest_count[t[e].chest_id].total = t[e].total_open_count);
            this.Inst && this.Inst.enable && this.Inst.refresh_currency()
        }
        ,
        n.get_chest_currency = function(t) {
            if (!this.chest_count[t])
                return 0;
            var e = this.chest_count[t].total - this.chest_count[t].consume;
            return e < 0 && (e = 0),
            e
        }
        ,
        n.prototype.onCreate = function() {
            var i = this;
            this.contianer_content = this.me.getChildByName("content"),
            this.img_head = this.contianer_content.getChildByName("head"),
            this.contianer_content.getChildByName("btn_xiangqing").clickHandler = Laya.Handler.create(this, function() {
                i.tips.show(1e3)
            }, null, !1),
            this.contianer_content.getChildByName("btn_xiangqing").visible = !1,
            this.container_top = this.me.getChildByName("top"),
            this.container_top.getChildByName("btn_back").clickHandler = Laya.Handler.create(this, function() {
                i.locking || i.close(Laya.Handler.create(i, function() {
                    t.UI_Lobby.Inst.enable = !0
                }))
            }, null, !1),
            this.money = new t.UI_Money(this.container_top,Laya.Handler.create(this, this.close, null, !1),Laya.Handler.create(this, function() {
                return i.locking
            }, null, !1)),
            this.tips = new e(this.me.getChildByName("tips")),
            this.xy = new a(this.me.getChildByName("xy"),this.me.getChildByName("pop_buy_single"),this.me.getChildByName("pop_buy_multi")),
            this.me.getChildByName("pop_buy_xunmi_chs").visible = !1,
            this.me.getChildByName("pop_buy_huiyu_jp").visible = !1,
            this.buy_xunmi = new l(this.me.getChildByName("pop_buy_xunmi_chs"));
            var n = this.contianer_content.getChildByName("container_shop");
            this.label_currency = n.getChildByName("btn_shop").getChildByName("count"),
            n.getChildByName("btn_shop").clickHandler = Laya.Handler.create(this, function() {
                i.locking || i.xy.show(i.chest_id)
            }, null, !1),
            n.getChildByName("btn_what").clickHandler = Laya.Handler.create(this, function() {
                i.tips.showinfo(game.Tools.strOfLocalization(55))
            }, null, !1),
            n.getChildByName("btn_what").visible = !1,
            this.preview = new o(this.me.getChildByName("preview")),
            this.contianer_content.getChildByName("btn_preview").clickHandler = Laya.Handler.create(this, function() {
                i.preview.show(i.chest_id)
            }, null, !1),
            this.xyexchange = this.contianer_content.getChildByName("container_shop").getChildByName("btn_xy"),
            this.locking = !1
        }
        ,
        n.prototype.show = function() {
            var e = this;
            this.enable = !0,
            this.locking = !0,
            t.UIBase.anim_alpha_in(this.contianer_content, {
                y: 30
            }, 150),
            t.UIBase.anim_alpha_in(this.container_top, {
                y: -30
            }, 150),
            this.tips.me.visible = !1,
            this.preview.me.visible = !1,
            this.xy.me.visible = !1,
            this.buy_xunmi.me.visible = !1,
            this.money.onEnable(),
            this.money.label_xinyang && (this.money.label_xinyang.text = n.get_chest_currency(this.chest_id).toString()),
            "chs" == GameMgr.client_language && (this.container_top.getChildByName("container_xinyang").visible = !1),
            Laya.timer.once(150, this, function() {
                e.locking = !1
            }),
            this.refresh_show()
        }
        ,
        n.prototype.refresh_show = function() {
            var e = this
              , i = 1e3;
            "chs" != GameMgr.client_language && (i = 1001),
            this.chest_id = i,
            this.label_currency.text = n.get_chest_currency(this.chest_id).toString();
            var a = cfg.chest.chest.get(i)
              , r = t.UI_Activity.onTreasureRateUp(this.chest_id);
            "" != r ? game.LoadMgr.setImgSkin(this.img_head, r) : game.LoadMgr.setImgSkin(this.img_head, a.img);
            var s = a.ticket_id
              , o = 0;
            s && (o = t.UI_Bag.get_item_count(s));
            var l = function(t) {
                var e = t.getChildByName("txt1")
                  , i = t.getChildByName("txt2")
                  , n = t.getChildByName("icon")
                  , a = e.textField.textWidth + 10 + n.width + 10 + i.textField.textWidth;
                e.x = 380 - a / 2,
                n.x = e.x + e.textField.textWidth + 10,
                i.x = n.x + n.width + 10
            }
              , h = this.contianer_content.getChildByName("container1");
            if (l(h),
            o >= 1) {
                u = h.getChildByName("btn_tanfang").getChildByName("price");
                game.LoadMgr.setImgSkin(u.getChildByName("icon"), cfg.item_definition.item.get(s).icon_transparent),
                u.getChildByName("count").text = "x1",
                game.Tools.child_align_center(u)
            } else {
                u = h.getChildByName("btn_tanfang").getChildByName("price");
                (_ = cfg.item_definition.item.get(a.currency)) && game.LoadMgr.setImgSkin(u.getChildByName("icon"), _.icon_transparent);
                (d = cfg.item_definition.currency.get(a.currency)) && game.LoadMgr.setImgSkin(u.getChildByName("icon"), d.icon),
                u.getChildByName("count").text = "x" + a.price,
                game.Tools.child_align_center(u)
            }
            h.getChildByName("btn_tanfang").clickHandler = Laya.Handler.create(this, function() {
                t.UI_PiPeiYuYue.Inst.enable ? t.UI_Popout.PopOutNoTitle(game.Tools.strOfLocalization(204), null) : o >= 1 ? t.UI_TanfangRoot.Inst.show(i, 1, !0) : t.UI_Bag.get_item_count(302014) < a.price ? e.buy_xunmi.show(a.price - t.UI_Bag.get_item_count(302014)) : t.UI_TanfangRoot.Inst.show(i, 1, !1)
            }, null, !1);
            var c = this.contianer_content.getChildByName("container10");
            if (l(c),
            o >= 10) {
                u = c.getChildByName("btn_tanfang").getChildByName("price");
                game.LoadMgr.setImgSkin(u.getChildByName("icon"), cfg.item_definition.item.get(s).icon_transparent),
                u.getChildByName("count").text = "x10",
                game.Tools.child_align_center(u)
            } else {
                var u = c.getChildByName("btn_tanfang").getChildByName("price")
                  , _ = cfg.item_definition.item.get(a.currency);
                _ && game.LoadMgr.setImgSkin(u.getChildByName("icon"), _.icon_transparent);
                var d = cfg.item_definition.currency.get(a.currency);
                d && game.LoadMgr.setImgSkin(u.getChildByName("icon"), d.icon),
                u.getChildByName("count").text = "x" + a.price10,
                game.Tools.child_align_center(u)
            }
            c.getChildByName("btn_tanfang").clickHandler = Laya.Handler.create(this, function() {
                t.UI_PiPeiYuYue.Inst.enable ? t.UI_Popout.PopOutNoTitle(game.Tools.strOfLocalization(204), null) : o >= 10 ? t.UI_TanfangRoot.Inst.show(i, 10, !0) : t.UI_Bag.get_item_count(302014) < a.price10 ? e.buy_xunmi.show(a.price10 - t.UI_Bag.get_item_count(302014)) : t.UI_TanfangRoot.Inst.show(i, 10, !1)
            }, null, !1),
            this.money.onEnable(),
            this.money.label_xinyang && (this.money.label_xinyang.text = n.get_chest_currency(this.chest_id).toString()),
            this.contianer_content.getChildByName("container1").getChildByName("txt1").text = game.Tools.strOfLocalization(2708),
            this.contianer_content.getChildByName("container1").getChildByName("txt2").text = game.Tools.strOfLocalization(2709),
            this.contianer_content.getChildByName("container10").getChildByName("txt1").text = game.Tools.strOfLocalization(2710),
            this.contianer_content.getChildByName("container10").getChildByName("txt2").text = game.Tools.strOfLocalization(2711),
            "jp" != GameMgr.client_language && "en" != GameMgr.client_language || this.jpproject()
        }
        ,
        n.prototype.jpproject = function() {
            var e = this
              , i = this.contianer_content.getChildByName("container_shop")
              , n = this.contianer_content.getChildByName("container1").getChildByName("txt1")
              , a = this.contianer_content.getChildByName("container1").getChildByName("txt2")
              , r = this.contianer_content.getChildByName("container10").getChildByName("txt1")
              , s = this.contianer_content.getChildByName("container10").getChildByName("txt2");
            i.getChildByName("btn_shop").visible = !1,
            i.getChildByName("btn_what").visible = !1,
            this.container_top.getChildByName("container_huishi").visible = !1,
            this.xyexchange.visible = !0,
            this.xyexchange.getChildByName("count").text = game.Tools.strOfLocalization(2712),
            this.xyexchange.clickHandler = Laya.Handler.create(this, function() {
                e.locking || e.xy.show(e.chest_id)
            }, null, !1);
            var o = this.contianer_content.getChildByName("container1").getChildByName("btn_tanfang").getChildByName("price")
              , l = this.contianer_content.getChildByName("container10").getChildByName("btn_tanfang").getChildByName("price");
            n.fontSize = 27,
            a.fontSize = 27,
            r.fontSize = 27,
            s.fontSize = 27;
            this.chest_id = 1001;
            var h = cfg.chest.chest.get(1001)
              , c = h.ticket_id
              , u = 0;
            c && (u = t.UI_Bag.get_item_count(c));
            var _ = function(t) {
                var e = t.getChildByName("txt1")
                  , i = t.getChildByName("txt2")
                  , n = t.getChildByName("icon")
                  , a = e.textField.textWidth + 10 + n.width + 10 + i.textField.textWidth;
                e.x = 360 - a / 2,
                n.x = e.x + e.textField.textWidth + 10,
                i.x = n.x + n.width + 10
            };
            _(this.contianer_content.getChildByName("container1")),
            _(this.contianer_content.getChildByName("container10")),
            u >= 1 ? (game.LoadMgr.setImgSkin(o.getChildByName("icon"), cfg.item_definition.item.get(c).icon_transparent),
            o.getChildByName("count").text = "x1",
            game.Tools.child_align_center(o)) : (game.LoadMgr.setImgSkin(o.getChildByName("icon"), cfg.item_definition.currency.find(h.currency).icon),
            o.getChildByName("count").text = "x" + h.price,
            game.Tools.child_align_center(o)),
            u >= 10 ? (game.LoadMgr.setImgSkin(l.getChildByName("icon"), cfg.item_definition.item.get(c).icon_transparent),
            l.getChildByName("count").text = "x10",
            game.Tools.child_align_center(l)) : (game.LoadMgr.setImgSkin(l.getChildByName("icon"), cfg.item_definition.currency.find(h.currency).icon),
            l.getChildByName("count").text = "x" + h.price10,
            game.Tools.child_align_center(l));
            var d = this.me.getChildByName("pop_buy_huiyu_jp").getChildByName("root");
            d.getChildByName("btn_close").clickHandler = Laya.Handler.create(this, function() {
                t.UIBase.anim_pop_hide(d, Laya.Handler.create(e, function() {
                    e.locking = !1,
                    e.me.getChildByName("pop_buy_huiyu_jp").visible = !1
                }))
            }, null, !1),
            d.getChildByName("btn_confirm").clickHandler = Laya.Handler.create(this, function() {
                e.locking || Laya.Handler.create(e, e.close, null, !1) && Laya.Handler.create(e, e.close, null, !1).runWith(Laya.Handler.create(e, function() {
                    t.UI_Recharge.Inst.show("huiyu"),
                    e.me.getChildByName("pop_buy_huiyu_jp").visible = !1
                }, null, !1))
            }),
            d.getChildByName("btn_cancel").clickHandler = Laya.Handler.create(this, function() {
                t.UIBase.anim_pop_hide(d, Laya.Handler.create(e, function() {
                    e.locking = !1,
                    e.me.getChildByName("pop_buy_huiyu_jp").visible = !1
                }))
            }, null, !1),
            d.getChildByName("btn_cancel").filters = [new Laya.ColorFilter(t.GRAY_FILTER)],
            d.getChildByName("content").text = game.Tools.strOfLocalization(2673),
            this.contianer_content.getChildByName("container1").getChildByName("btn_tanfang").clickHandler = Laya.Handler.create(this, function() {
                t.UI_PiPeiYuYue.Inst.enable ? t.UI_Popout.PopOutNoTitle(game.Tools.strOfLocalization(204), null) : u >= 1 ? t.UI_TanfangRoot.Inst.show(1001, 1, !0) : t.UI_Bag.get_item_count(100001) < h.price ? (e.me.getChildByName("pop_buy_huiyu_jp").visible = !0,
                e.locking = !0,
                t.UIBase.anim_pop_out(d, Laya.Handler.create(e, function() {
                    e.locking = !1
                }))) : t.UI_TanfangRoot.Inst.show(1001, 1, !1)
            }, null, !1),
            this.contianer_content.getChildByName("container10").getChildByName("btn_tanfang").clickHandler = Laya.Handler.create(this, function() {
                t.UI_PiPeiYuYue.Inst.enable ? t.UI_Popout.PopOutNoTitle(game.Tools.strOfLocalization(204), null) : u >= 10 ? t.UI_TanfangRoot.Inst.show(1001, 10, !0) : t.UI_Bag.get_item_count(100001) < h.price10 ? (e.me.getChildByName("pop_buy_huiyu_jp").visible = !0,
                e.locking = !0,
                t.UIBase.anim_pop_out(d, Laya.Handler.create(e, function() {
                    e.locking = !1
                }))) : t.UI_TanfangRoot.Inst.show(1001, 10, !1)
            }, null, !1)
        }
        ,
        n.prototype.close = function(e) {
            var i = this;
            this.locking = !0,
            t.UIBase.anim_alpha_out(this.contianer_content, {
                y: 30
            }, 150),
            t.UIBase.anim_alpha_out(this.container_top, {
                y: -30
            }, 150),
            this.tips.me.visible = !1,
            this.preview.me.visible && this.preview.close(),
            this.xy.me.visible && this.xy.close(),
            Laya.timer.once(150, this, function() {
                i.locking = !1,
                i.enable = !1,
                e && e.run()
            })
        }
        ,
        n.prototype.onDisable = function() {
            Laya.loader.clearTextureRes(this.img_head.skin),
            game.LoadMgr.clearImgSkin(this.img_head),
            this.img_head.skin = ""
        }
        ,
        n.prototype.refresh_currency = function() {
            this.label_currency.text = n.get_chest_currency(this.chest_id).toString(),
            this.xy.me.visible && this.xy.refresh_currency()
        }
        ,
        n.chest_count = {},
        n
    }(t.UIBase);
    t.UI_Treasure = h
}(uiscript || (uiscript = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), uiscript;
!function(t) {
    var e = function(e) {
        function i() {
            var t = e.call(this, new ui.common.user_xieyiUI) || this;
            t.current_index = 0,
            i.Inst = t;
            for (var n = [], a = 0; a < 15; a++)
                n.push("user_xieyi/" + (a + 1) + ".txt");
            return Laya.loader.load(n),
            t
        }
        return __extends(i, e),
        i.prototype.onCreate = function() {
            var t = this;
            this.root = this.me.getChildByName("root"),
            this.info = this.root.getChildByName("info"),
            this.root.getChildByName("btn").clickHandler = Laya.Handler.create(this, function() {
                t.close(!0)
            }, null, !1),
            this.btn_left = this.root.getChildByName("left"),
            this.btn_left.clickHandler = Laya.Handler.create(this, function() {
                t.current_index <= 1 || (t.current_index--,
                t.refresh())
            }, null, !1),
            this.btn_right = this.root.getChildByName("right"),
            this.btn_right.clickHandler = Laya.Handler.create(this, function() {
                t.current_index >= 15 || (t.current_index++,
                t.refresh())
            }, null, !1),
            this.root.getChildByName("btn_close").clickHandler = Laya.Handler.create(this, function() {
                t.close(!1)
            }, null, !1),
            this.root.getChildByName("btn_close").visible = "chs" != GameMgr.client_language
        }
        ,
        i.prototype.show = function(e) {
            this.complete = e,
            this.enable = !0,
            t.UIBase.anim_pop_out(this.root, null),
            this.current_index = 1,
            this.refresh()
        }
        ,
        i.prototype.refresh = function() {
            var t = Laya.loader.getRes("user_xieyi/" + this.current_index + ".txt");
            this.info.text = t || game.Tools.strOfLocalization(2198),
            this.btn_left.visible = this.current_index > 1,
            this.btn_right.visible = this.current_index < 15
        }
        ,
        i.prototype.close = function(e) {
            var i = this;
            t.UIBase.anim_pop_hide(this.root, Laya.Handler.create(this, function() {
                i.enable = !1,
                i.info.text = "",
                e && i.complete && i.complete.run()
            }))
        }
        ,
        i.prototype.onDestroy = function() {
            i.Inst = null,
            this.info.textField.destroy(!0),
            this.info.destroy(!0)
        }
        ,
        i
    }(t.UIBase);
    t.UI_User_Xieyi = e
}(uiscript || (uiscript = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), uiscript;
!function(t) {
    var e = function(e) {
        function i() {
            var t = e.call(this, new ui.common.user_xieyi_enjpUI) || this;
            return i.Inst = t,
            t
        }
        return __extends(i, e),
        i.prototype.onCreate = function() {
            var t = this;
            this.root = this.me.getChildByName("root"),
            this.label_title = this.root.getChildByName("title"),
            this.panel = this.root.getChildByName("panel"),
            this.label_content = this.panel.getChildByName("content"),
            this.scrollbar = this.root.getChildByName("scrollbar").scriptMap["capsui.CScrollBar"],
            this.scrollbar.init(!1, null),
            this.panel.vScrollBarSkin = "",
            this.panel.vScrollBar.on("change", this, function() {
                t.refresh_scroll_bar()
            }),
            this.root.getChildByName("btn_close").clickHandler = Laya.Handler.create(this, function() {
                t.locking || t.close()
            }, null, !1)
        }
        ,
        i.prototype.refresh_scroll_bar = function() {
            this.label_content.textField.textHeight > 0 ? this.scrollbar.setVal(this.panel.vScrollBar.value / this.panel.vScrollBar.max, this.panel.height / this.label_content.textField.textHeight) : this.scrollbar.setVal(0, 1)
        }
        ,
        i.prototype.show = function(e) {
            var i = this;
            this.locking = !0,
            this.me.visible = !0,
            t.UIBase.anim_pop_out(this.root, Laya.Handler.create(this, function() {
                i.locking = !1
            })),
            this.label_title.text = "",
            this.label_content.text = "loading...",
            this.label_content.height = 60,
            this.panel.refresh();
            var n = 1e5 * Math.random();
            this.id = n,
            Laya.loader.load(e, Laya.Handler.create(this, function() {
                if (i.me.visible && i.id == n) {
                    var t = Laya.loader.getRes(e);
                    if (t) {
                        var a = t.indexOf("\n");
                        i.label_title.text = t.substring(0, a),
                        i.label_content.text = t.substring(a + 1),
                        i.label_content.height = i.label_content.textField.textHeight,
                        i.panel.refresh(),
                        i.refresh_scroll_bar()
                    }
                }
            })),
            this.refresh_scroll_bar()
        }
        ,
        i.prototype.close = function() {
            var e = this;
            this.locking = !0,
            t.UIBase.anim_pop_hide(this.root, Laya.Handler.create(this, function() {
                e.locking = !1,
                e.me.visible = !1,
                e.label_content.text = ""
            }))
        }
        ,
        i
    }(t.UIBase);
    t.UI_User_Xieyi_enjp = e
}(uiscript || (uiscript = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), uiscript;
!function(t) {
    var e = function() {
        function e(t) {
            var e = this;
            this.friends = [],
            this.sortlist = [],
            this.me = t,
            this.me.visible = !1,
            this.blackbg = t.getChildByName("blackbg"),
            this.blackbg.clickHandler = Laya.Handler.create(this, function() {
                e.locking || e.close()
            }, null, !1),
            this.root = t.getChildByName("root"),
            this.scrollview = this.root.scriptMap["capsui.CScrollView"],
            this.scrollview.init_scrollview(Laya.Handler.create(this, this.render_item, null, !1)),
            this.noinfo = this.root.getChildByName("noinfo")
        }
        return e.prototype.show = function() {
            var e = this;
            this.locking = !0,
            this.me.visible = !0,
            this.scrollview.reset(),
            this.friends = [],
            this.sortlist = [];
            for (var i = game.FriendMgr.friend_list, n = 0; n < i.length; n++)
                this.sortlist.push(n);
            this.sortlist = this.sortlist.sort(function(t, e) {
                var n = i[t]
                  , a = 0;
                if (n.state.is_online) {
                    a += "" != (o = game.Tools.playState2Desc(n.state.playing)) ? 3e10 : 6e10,
                    a += -n.state.login_time
                } else
                    a += n.state.logout_time;
                var r = i[e]
                  , s = 0;
                if (r.state.is_online) {
                    var o = game.Tools.playState2Desc(r.state.playing);
                    s += "" != o ? 3e10 : 6e10,
                    s += -r.state.login_time
                } else
                    s += r.state.logout_time;
                return s - a
            });
            for (n = 0; n < i.length; n++)
                this.friends.push({
                    f: i[n],
                    invited: !1
                });
            this.noinfo.visible = 0 == this.friends.length,
            this.scrollview.addItem(this.friends.length),
            t.UIBase.anim_pop_out(this.root, Laya.Handler.create(this, function() {
                e.locking = !1
            }))
        }
        ,
        e.prototype.close = function() {
            var e = this;
            this.locking = !0,
            t.UIBase.anim_pop_hide(this.root, Laya.Handler.create(this, function() {
                e.locking = !1,
                e.me.visible = !1
            }))
        }
        ,
        e.prototype.render_item = function(e) {
            var n = e.index
              , a = e.container
              , r = e.cache_data;
            r.head || (r.head = new t.UI_Head(a.getChildByName("head")),
            r.name = a.getChildByName("label_name"),
            r.state = a.getChildByName("label_state"),
            r.btn = a.getChildByName("btn_invite"),
            r.invited = a.getChildByName("invited"));
            var s = this.friends[this.sortlist[n]];
            r.head.id = s.f.base.avatar_id,
            r.name.text = s.f.base.nickname;
            var o = !1;
            if (s.f.state.is_online) {
                var l = game.Tools.playState2Desc(s.f.state.playing);
                "" != l ? (r.state.text = game.Tools.strOfLocalization(2069, [l]),
                r.state.color = "#a9d94d",
                r.name.color = "#a9d94d") : (r.state.text = game.Tools.strOfLocalization(2071),
                r.state.color = "#58c4db",
                r.name.color = "#58c4db",
                o = !0)
            } else
                r.state.text = game.Tools.strOfLocalization(2072),
                r.state.color = "#8c8c8c",
                r.name.color = "#8c8c8c";
            s.invited ? (r.btn.visible = !1,
            r.invited.visible = !0) : (r.btn.visible = !0,
            r.invited.visible = !1,
            game.Tools.setGrayDisable(r.btn, !o),
            o && (r.btn.clickHandler = Laya.Handler.create(this, function() {
                game.Tools.setGrayDisable(r.btn, !0);
                var e = {
                    room_id: i.Inst.room_id,
                    mode: i.Inst.room_mode,
                    nickname: GameMgr.Inst.account_data.nickname,
                    account_id: GameMgr.Inst.account_id
                };
                app.NetAgent.sendReq2Lobby("Lobby", "sendClientMessage", {
                    target_id: s.f.base.account_id,
                    type: game.EFriendMsgType.room_invite,
                    content: JSON.stringify(e)
                }, function(e, i) {
                    e || i.error ? (game.Tools.setGrayDisable(r.btn, !1),
                    t.UIMgr.Inst.showNetReqError("sendClientMessage", e, i)) : (r.btn.visible = !1,
                    r.invited.visible = !0,
                    s.invited = !0)
                })
            }, null, !1)))
        }
        ,
        e
    }()
      , i = function(i) {
        function n() {
            var e = i.call(this, new ui.lobby.waitingroomUI) || this;
            return e.skin_ready = "myres/room/btn_ready.png",
            e.skin_cancel = "myres/room/btn_cancel.png",
            e.skin_start = "myres/room/btn_start.png",
            e.skin_start_no = "myres/room/btn_start_no.png",
            e.label_rommid = null,
            e.player_cells = [],
            e.btn_ok = null,
            e.btn_invite_friend = null,
            e.btn_add_robot = null,
            e.beReady = !1,
            e.room_id = -1,
            e.owner_id = -1,
            e.tournament_id = 0,
            e.max_player_count = 0,
            e.players = [],
            e.container_rules = null,
            e.container_top = null,
            e.container_right = null,
            e.locking = !1,
            e.mousein_copy = !1,
            e.popout = null,
            e.room_link = null,
            e.btn_copy_link = null,
            e.last_start_room = 0,
            e.invitefriend = null,
            e.pre_choose = null,
            e.ai_name = game.Tools.strOfLocalization(2003),
            n.Inst = e,
            app.NetAgent.AddListener2Lobby("NotifyRoomPlayerReady", Laya.Handler.create(e, function(t) {
                app.Log.log("NotifyRoomPlayerReady:" + JSON.stringify(t)),
                e.onReadyChange(t.account_id, t.ready)
            })),
            app.NetAgent.AddListener2Lobby("NotifyRoomPlayerUpdate", Laya.Handler.create(e, function(t) {
                app.Log.log("NotifyRoomPlayerUpdate:" + JSON.stringify(t)),
                e.onPlayerChange(t)
            })),
            app.NetAgent.AddListener2Lobby("NotifyRoomGameStart", Laya.Handler.create(e, function(t) {
                e.enable && (app.Log.log("NotifyRoomGameStart:" + JSON.stringify(t)),
                e.onGameStart(t))
            })),
            app.NetAgent.AddListener2Lobby("NotifyRoomKickOut", Laya.Handler.create(e, function(t) {
                app.Log.log("NotifyRoomKickOut:" + JSON.stringify(t)),
                e.onBeKictOut()
            })),
            game.LobbyNetMgr.Inst.add_connect_listener(Laya.Handler.create(e, function() {
                e.enable && e.hide(Laya.Handler.create(e, function() {
                    t.UI_Lobby.Inst.enable = !0
                }))
            }, null, !1)),
            e
        }
        return __extends(n, i),
        Object.defineProperty(n.prototype, "inRoom", {
            get: function() {
                return -1 != this.room_id
            },
            enumerable: !0,
            configurable: !0
        }),
        Object.defineProperty(n.prototype, "robot_count", {
            get: function() {
                for (var t = 0, e = 0; e < this.players.length; e++)
                    2 == this.players[e].category && t++;
                return t
            },
            enumerable: !0,
            configurable: !0
        }),
        n.prototype.resetData = function() {
            this.room_id = -1,
            this.owner_id = -1,
            this.room_mode = {},
            this.max_player_count = 0,
            this.players = []
        }
        ,
        n.prototype.updateData = function(t) {
            if (t) {
                this.room_id = t.room_id,
                this.owner_id = t.owner_id,
                this.room_mode = t.mode,
                this.public_live = t.public_live,
                this.tournament_id = 0,
                t.tournament_id && (this.tournament_id = t.tournament_id),
                this.ai_name = game.Tools.strOfLocalization(2003),
                this.room_mode.detail_rule && (1 === this.room_mode.detail_rule.ai_level && (this.ai_name = game.Tools.strOfLocalization(2003)),
                2 === this.room_mode.detail_rule.ai_level && (this.ai_name = game.Tools.strOfLocalization(2004))),
                this.max_player_count = t.max_player_count,
                this.players = [];
                for (i = 0; i < t.persons.length; i++) {
                    var e = t.persons[i];
                    e.ready = !1,
                    e.cell_index = -1,
                    e.category = 1,
                    this.players.push(e)
                }
                for (i = 0; i < t.robot_count; i++)
                    this.players.push({
                        category: 2,
                        cell_index: -1,
                        account_id: 0,
                        level: {
                            id: 10101,
                            score: 0
                        },
                        nickname: this.ai_name,
                        ready: !0,
                        title: 0,
                        avatar_id: 400101
                    });
                for (var i = 0; i < t.ready_list.length; i++)
                    for (var n = 0; n < this.players.length; n++)
                        if (this.players[n].account_id == t.ready_list[i]) {
                            this.players[n].ready = !0;
                            break
                        }
            } else
                this.resetData()
        }
        ,
        n.prototype.onReadyChange = function(t, e) {
            for (var i = 0; i < this.players.length; i++)
                if (this.players[i].account_id == t) {
                    this.players[i].ready = e,
                    this._onPlayerReadyChange(this.players[i]);
                    break
                }
        }
        ,
        n.prototype.onPlayerChange = function(t) {
            t = t.toJSON();
            for (var e = [], i = 0; i < this.players.length; i++)
                0 != this.players[i].category && e.push(this.players[i]);
            if (this.players = e,
            t.update_list)
                for (i = 0; i < t.update_list.length; i++) {
                    for (var n = t.update_list[i], a = n.account_id, r = !0, s = 0; s < this.players.length; s++)
                        if (this.players[s] && this.players[s].account_id == a) {
                            n.avatar_id && (this.players[s].avatar_id = n.avatar_id),
                            n.title && (this.players[s].avatar_id = n.title),
                            n.nickname && (this.players[s].avatar_id = n.nickname),
                            n.level && (this.players[s].level = n.level),
                            this._refreshPlayerInfo(this.players[s]),
                            r = !1;
                            break
                        }
                    if (r) {
                        var o = -1;
                        if (this.enable) {
                            for (var l = [!1, !1, !1, !1], h = 0; h < this.players.length; h++)
                                l[this.players[h].cell_index] = !0;
                            for (s = 0; s < this.max_player_count; s++)
                                if (!l[s]) {
                                    o = s;
                                    break
                                }
                        }
                        n.cell_index = o,
                        n.ready = !1,
                        n.category = 1,
                        this.players.push(n),
                        this._refreshPlayerInfo(this.players[this.players.length - 1])
                    }
                }
            if (t.remove_list)
                for (i = 0; i < t.remove_list.length; i++)
                    for (var a = t.remove_list[i], s = 0; s < this.players.length; s++)
                        if (this.players[s] && this.players[s].account_id == a) {
                            for (var c = this.players[s].cell_index, u = s; u < this.players.length - 1; u++)
                                this.players[u] = this.players[u + 1];
                            this.players.pop(),
                            this._clearCell(c);
                            break
                        }
            if (null != t.robot_count && void 0 != t.robot_count) {
                var _ = t.robot_count;
                _ < this.robot_count && this.pre_choose && 2 == this.pre_choose.category && (this.pre_choose.category = 0,
                this._clearCell(this.pre_choose.cell_index),
                this.pre_choose = null);
                for (i = 0; i < this.players.length; i++) {
                    var d = this.players[i];
                    2 == d.category && (0 == _ ? (this.players[i].category = 0,
                    this._clearCell(d.cell_index)) : _--)
                }
                for (; _ > 0; ) {
                    for (var f = -1, i = 0; i < this.players.length; i++)
                        if (0 == this.players[i].category) {
                            f = i;
                            break
                        }
                    if (-1 == f) {
                        if (!(this.players.length < this.max_player_count)) {
                            app.Log.Error("同步机器人数量有问题");
                            break
                        }
                        _--;
                        for (var c = -1, l = [!1, !1, !1, !1], i = 0; i < this.players.length; i++)
                            l[this.players[i].cell_index] = !0;
                        for (s = 0; s < this.max_player_count; s++)
                            if (!l[s]) {
                                c = s;
                                break
                            }
                        this.players.push({
                            category: 2,
                            cell_index: c,
                            account_id: 0,
                            level: {
                                id: 10101,
                                score: 0
                            },
                            nickname: this.ai_name,
                            ready: !0,
                            title: 0,
                            avatar_id: 400101
                        }),
                        this._refreshPlayerInfo(this.players[this.players.length - 1])
                    } else
                        _--,
                        this.players[f].category = 2,
                        this.players[f].cell_index = f,
                        this.players[f].account_id = 0,
                        this.players[f].level = {
                            id: 10101,
                            score: 0
                        },
                        this.players[f].nickname = this.ai_name,
                        this.players[f].ready = !0,
                        this.players[f].title = 0,
                        this.players[f].avatar_id = 400101,
                        this._refreshPlayerInfo(this.players[f])
                }
            }
            if (t.owner_id) {
                if (this.owner_id = t.owner_id,
                this.enable)
                    if (this.owner_id == GameMgr.Inst.account_id)
                        this.refreshAsOwner();
                    else
                        for (s = 0; s < this.players.length; s++)
                            if (this.players[s] && this.players[s].account_id == this.owner_id) {
                                this._refreshPlayerInfo(this.players[s]);
                                break
                            }
            } else if (this.enable)
                if (this.owner_id == GameMgr.Inst.account_id)
                    this.refreshAsOwner();
                else
                    for (s = 0; s < this.players.length; s++)
                        if (this.players[s] && this.players[s].account_id == this.owner_id) {
                            this._refreshPlayerInfo(this.players[s]);
                            break
                        }
        }
        ,
        n.prototype.onBeKictOut = function() {
            this.resetData(),
            this.enable && (this.enable = !1,
            t.UI_Lobby.Inst.enable = !0,
            t.UIMgr.Inst.ShowErrorInfo(game.Tools.strOfLocalization(52)))
        }
        ,
        n.prototype.onCreate = function() {
            var i = this;
            this.last_start_room = 0;
            var n = this.me.getChildByName("root");
            this.container_top = n.getChildByName("top"),
            this.container_right = n.getChildByName("right"),
            this.label_rommid = this.container_top.getChildByName("label_roomid");
            for (var a = function(e) {
                var a = n.getChildByName("player_" + e.toString())
                  , s = {};
                s.index = e,
                s.container = a,
                s.container_flag = a.getChildByName("flag"),
                s.container_name = a.getChildByName("container_name"),
                s.name = a.getChildByName("container_name").getChildByName("label_name"),
                s.btn_t = a.getChildByName("btn_t"),
                s.container_illust = a.getChildByName("container_illust"),
                s.illust = new t.UI_Character_Skin(a.getChildByName("container_illust").getChildByName("illust")),
                s.host = a.getChildByName("host"),
                s.title = new t.UI_PlayerTitle(a.getChildByName("container_name").getChildByName("title")),
                s.rank = new t.UI_Level(a.getChildByName("container_name").getChildByName("rank")),
                s.is_robot = !1;
                var o = 0;
                s.btn_t.clickHandler = Laya.Handler.create(r, function() {
                    if (!(i.locking || Laya.timer.currTimer < o)) {
                        o = Laya.timer.currTimer + 500;
                        for (var t = 0; t < i.players.length; t++)
                            if (i.players[t].cell_index == e) {
                                i.kickPlayer(t);
                                break
                            }
                    }
                }, null, !1),
                s.btn_info = a.getChildByName("btn_info"),
                s.btn_info.clickHandler = Laya.Handler.create(r, function() {
                    if (!i.locking)
                        for (var n = 0; n < i.players.length; n++)
                            if (i.players[n].cell_index == e) {
                                i.players[n].account_id && i.players[n].account_id > 0 && t.UI_OtherPlayerInfo.Inst.show(i.players[n].account_id);
                                break
                            }
                }, null, !1),
                r.player_cells.push(s)
            }, r = this, s = 0; s < 4; s++)
                a(s);
            this.btn_ok = n.getChildByName("btn_ok"),
            this.btn_ok.clickHandler = Laya.Handler.create(this, function() {
                i.owner_id == GameMgr.Inst.account_id ? i.getStart() : i.switchReady()
            }, null, !1),
            this.container_top.getChildByName("btn_leave").clickHandler = Laya.Handler.create(this, function() {
                i.leaveRoom()
            }, null, !1),
            this.btn_invite_friend = this.container_right.getChildByName("btn_friend"),
            this.btn_invite_friend.clickHandler = Laya.Handler.create(this, function() {
                i.locking || i.invitefriend.show()
            }, null, !1),
            this.btn_add_robot = this.container_right.getChildByName("btn_robot");
            var o = 0;
            this.btn_add_robot.clickHandler = Laya.Handler.create(this, function() {
                i.locking || Laya.timer.currTimer < o || (o = Laya.timer.currTimer + 1e3,
                app.NetAgent.sendReq2Lobby("Lobby", "modifyRoom", {
                    robot_count: i.robot_count + 1
                }, function(e, i) {
                    (e || i.error && 1111 != i.error.code) && t.UIMgr.Inst.showNetReqError("modifyRoom_add", e, i),
                    o = 0
                }))
            }, null, !1),
            this.container_right.getChildByName("btn_help").clickHandler = Laya.Handler.create(this, function() {
                i.locking || t.UI_Rules.Inst.show()
            }, null, !1);
            var l = this.container_right.getChildByName("btn_copy");
            l.on("mouseover", this, function() {
                i.mousein_copy = !0
            }),
            l.on("mouseout", this, function() {
                i.mousein_copy = !1
            }),
            l.clickHandler = Laya.Handler.create(this, function() {
                i.popout.visible || (GameMgr.Inst.BehavioralStatistics(12),
                i.popout.visible = !0,
                t.UIBase.anim_pop_out(i.popout, null))
            }, null, !1),
            this.container_rules = this.container_right.getChildByName("container_rules"),
            this.container_rules.visible = !0,
            this.popout = this.me.getChildByName("pop"),
            this.room_link = this.popout.getChildByName("input").getChildByName("txtinput"),
            this.room_link.editable = !1,
            this.btn_copy_link = this.popout.getChildByName("btn_copy"),
            this.btn_copy_link.visible = !1,
            GameMgr.inConch ? (this.btn_copy_link.visible = !0,
            this.btn_copy_link.clickHandler = Laya.Handler.create(this, function() {
                Laya.PlatformClass.createClass("layaair.majsoul.mjmgr").call("setSysClipboardText", i.room_link.text),
                t.UIBase.anim_pop_hide(i.popout, Laya.Handler.create(i, function() {
                    i.popout.visible = !1
                })),
                t.UI_FlyTips.ShowTips(game.Tools.strOfLocalization(2125))
            }, null, !1)) : GameMgr.iniOSWebview && (this.btn_copy_link.visible = !0,
            this.btn_copy_link.clickHandler = Laya.Handler.create(this, function() {
                Laya.Browser.window.wkbridge.callNative("copy2clip", i.room_link.text, function() {}),
                t.UIBase.anim_pop_hide(i.popout, Laya.Handler.create(i, function() {
                    i.popout.visible = !1
                })),
                t.UI_FlyTips.ShowTips(game.Tools.strOfLocalization(2125))
            }, null, !1)),
            this.popout.visible = !1,
            this.popout.getChildByName("btn_cancel").clickHandler = Laya.Handler.create(this, function() {
                t.UIBase.anim_pop_hide(i.popout, Laya.Handler.create(i, function() {
                    i.popout.visible = !1
                }))
            }, null, !1),
            this.invitefriend = new e(this.me.getChildByName("invite_friend"))
        }
        ,
        n.prototype.show = function() {
            var e = this;
            game.Scene_Lobby.Inst.change_bg("indoor", !1),
            this.mousein_copy = !1,
            this.beReady = !1,
            this.invitefriend.me.visible = !1,
            this.btn_add_robot.visible = !1,
            this.btn_invite_friend.visible = !1,
            this.pre_choose = null;
            for (h = 0; h < 4; h++)
                this.player_cells[h].container.visible = h < this.max_player_count;
            for (h = 0; h < this.max_player_count; h++)
                this._clearCell(h);
            for (h = 0; h < this.players.length; h++)
                this.players[h].cell_index = h,
                this._refreshPlayerInfo(this.players[h]);
            this.owner_id == GameMgr.Inst.account_id ? (this.btn_ok.skin = game.Tools.localUISrc(this.skin_start),
            this.refreshAsOwner()) : (this.btn_ok.skin = game.Tools.localUISrc(this.skin_ready),
            game.Tools.setGrayDisable(this.btn_ok, !1)),
            "en" == GameMgr.client_language ? this.label_rommid.text = "#" + this.room_id.toString() : this.label_rommid.text = this.room_id.toString(),
            this.container_rules.visible = !0;
            for (h = 0; h < this.container_rules.numChildren; h++)
                this.container_rules.getChildAt(h).visible = !1;
            var i = [];
            i.push(game.Tools.room_mode_desc(this.room_mode.mode));
            var n = this.room_mode.detail_rule;
            if (n) {
                var a = 5
                  , r = 20;
                if (null != n.time_fixed && (a = n.time_fixed),
                null != n.time_add && (r = n.time_add),
                i.push(a.toString() + "+" + r.toString() + game.Tools.strOfLocalization(2019)),
                0 != this.tournament_id) {
                    var s = cfg.tournament.tournaments.get(this.tournament_id);
                    s && i.push(s.name)
                }
                if (null != n.init_point && i.push(game.Tools.strOfLocalization(2199) + n.init_point),
                null != n.fandian && i.push(game.Tools.strOfLocalization(2094) + ":" + n.fandian),
                null != n.dora_count)
                    switch (n.dora_count) {
                    case 0:
                        i.push(game.Tools.strOfLocalization(2044));
                        break;
                    case 2:
                        i.push(game.Tools.strOfLocalization(2047));
                        break;
                    case 3:
                        i.push(game.Tools.strOfLocalization(2045));
                        break;
                    case 4:
                        i.push(game.Tools.strOfLocalization(2046))
                    }
                null != n.shiduan && 1 != n.shiduan && i.push(game.Tools.strOfLocalization(2137)),
                null != n.bianjietishi && 1 != n.bianjietishi && i.push(game.Tools.strOfLocalization(2200)),
                this.room_mode.mode >= 10 && this.room_mode.mode <= 14 && (null != n.have_zimosun && 1 != n.have_zimosun ? i.push(game.Tools.strOfLocalization(2202)) : i.push(game.Tools.strOfLocalization(2203)))
            }
            this.public_live && i.push(game.Tools.strOfLocalization(2220));
            for (h = 0; h < i.length; h++) {
                var o = this.container_rules.getChildAt(h);
                o.visible = !0,
                o.x = 6,
                o.y = 334 - 68 * (i.length - 1 - h);
                var l = o.getChildAt(0);
                l.fontSize = 40,
                i[h].length <= 5 ? l.fontSize = 40 : i[h].length <= 9 ? l.fontSize = 52.5 - 2.5 * i[h].length : l.fontSize = 30,
                l.text = i[h]
            }
            this.enable = !0,
            this.locking = !0,
            t.UIBase.anim_alpha_in(this.container_top, {
                y: -30
            }, 200);
            for (var h = 0; h < this.player_cells.length; h++)
                t.UIBase.anim_alpha_in(this.player_cells[h].container, {
                    x: 80
                }, 150, 150 + 50 * h, null, Laya.Ease.backOut);
            t.UIBase.anim_alpha_in(this.btn_ok, {}, 100, 600),
            t.UIBase.anim_alpha_in(this.container_right, {
                x: 20
            }, 100, 500),
            Laya.timer.once(600, this, function() {
                e.locking = !1
            });
            var c = game.Tools.room_mode_desc(this.room_mode.mode);
            this.room_link.text = game.Tools.strOfLocalization(2221, [this.room_id.toString()]),
            "" != c && (this.room_link.text += "(" + c + ")"),
            this.room_link.text += ": " + GameMgr.Inst.link_url + "?room=" + this.room_id
        }
        ,
        n.prototype.leaveRoom = function() {
            var e = this;
            this.locking || app.NetAgent.sendReq2Lobby("Lobby", "leaveRoom", {}, function(i, n) {
                i || n.error ? t.UIMgr.Inst.showNetReqError("leaveRoom", i, n) : e.hide(Laya.Handler.create(e, function() {
                    t.UI_Lobby.Inst.enable = !0
                }))
            })
        }
        ,
        n.prototype.tryToClose = function(e) {
            var i = this;
            app.NetAgent.sendReq2Lobby("Lobby", "leaveRoom", {}, function(n, a) {
                n || a.error ? (t.UIMgr.Inst.showNetReqError("leaveRoom", n, a),
                e.runWith(!1)) : (i.enable = !1,
                e.runWith(!0))
            })
        }
        ,
        n.prototype.hide = function(e) {
            var i = this;
            this.locking = !0,
            t.UIBase.anim_alpha_out(this.container_top, {
                y: -30
            }, 150);
            for (var n = 0; n < this.player_cells.length; n++)
                t.UIBase.anim_alpha_out(this.player_cells[n].container, {
                    x: 80
                }, 150, 0, null);
            t.UIBase.anim_alpha_out(this.btn_ok, {}, 150),
            t.UIBase.anim_alpha_out(this.container_right, {
                x: 20
            }, 150),
            Laya.timer.once(200, this, function() {
                i.locking = !1,
                i.enable = !1,
                e && e.run()
            }),
            document.getElementById("layaCanvas").onclick = null
        }
        ,
        n.prototype.onDisbale = function() {
            Laya.timer.clearAll(this);
            for (var t = 0; t < this.player_cells.length; t++)
                Laya.loader.clearTextureRes(this.player_cells[t].illust.skin);
            document.getElementById("layaCanvas").onclick = null
        }
        ,
        n.prototype.switchReady = function() {
            this.owner_id != GameMgr.Inst.account_id && (this.beReady = !this.beReady,
            this.btn_ok.skin = game.Tools.localUISrc(this.beReady ? this.skin_cancel : this.skin_ready),
            app.NetAgent.sendReq2Lobby("Lobby", "readyPlay", {
                ready: this.beReady
            }, function(t, e) {}))
        }
        ,
        n.prototype.getStart = function() {
            this.owner_id == GameMgr.Inst.account_id && (Laya.timer.currTimer < this.last_start_room + 2e3 || (this.last_start_room = Laya.timer.currTimer,
            app.NetAgent.sendReq2Lobby("Lobby", "startRoom", {}, function(e, i) {
                (e || i.error) && t.UIMgr.Inst.showNetReqError("startRoom", e, i)
            })))
        }
        ,
        n.prototype.kickPlayer = function(e) {
            if (this.owner_id == GameMgr.Inst.account_id) {
                var i = this.players[e];
                1 == i.category ? app.NetAgent.sendReq2Lobby("Lobby", "kickPlayer", {
                    account_id: this.players[e].account_id
                }, function(t, e) {}) : 2 == i.category && (this.pre_choose = i,
                app.NetAgent.sendReq2Lobby("Lobby", "modifyRoom", {
                    robot_count: this.robot_count - 1
                }, function(e, i) {
                    (e || i.error) && t.UIMgr.Inst.showNetReqError("modifyRoom_minus", e, i)
                }))
            }
        }
        ,
        n.prototype._clearCell = function(t) {
            if (!(t < 0 || t >= this.player_cells.length)) {
                var e = this.player_cells[t];
                e.container_flag.visible = !1,
                e.container_illust.visible = !1,
                e.name.visible = !1,
                e.container_name.visible = !1,
                e.btn_t.visible = !1,
                e.host.visible = !1
            }
        }
        ,
        n.prototype._refreshPlayerInfo = function(t) {
            var e = t.cell_index;
            if (!(e < 0 || e >= this.player_cells.length)) {
                var i = this.player_cells[e];
                i.container_illust.visible = !0,
                i.container_name.visible = !0,
                i.name.visible = !0,
                i.name.text = t.nickname,
                i.btn_t.visible = this.owner_id == GameMgr.Inst.account_id && t.account_id != GameMgr.Inst.account_id,
                this.owner_id == t.account_id && (i.container_flag.visible = !0,
                i.host.visible = !0),
                i.illust.setSkin(t.avatar_id, "waitingroom"),
                i.title.id = game.Tools.titleLocalization(t.account_id, t.title),
                i.rank.id = t.level.id,
                this._onPlayerReadyChange(t)
            }
        }
        ,
        n.prototype._onPlayerReadyChange = function(t) {
            var e = t.cell_index;
            if (!(e < 0 || e >= this.player_cells.length)) {
                var i = this.player_cells[e];
                this.owner_id == t.account_id ? i.container_flag.visible = !0 : i.container_flag.visible = t.ready,
                this.refreshStart()
            }
        }
        ,
        n.prototype.refreshAsOwner = function() {
            if (this.owner_id == GameMgr.Inst.account_id) {
                for (var t = 0, e = 0; e < this.players.length; e++)
                    0 != this.players[e].category && (this._refreshPlayerInfo(this.players[e]),
                    t++);
                this.btn_add_robot.visible = !0,
                this.btn_invite_friend.visible = !0,
                game.Tools.setGrayDisable(this.btn_add_robot, t == this.max_player_count),
                this.refreshStart()
            }
        }
        ,
        n.prototype.refreshStart = function() {
            if (this.owner_id == GameMgr.Inst.account_id) {
                this.btn_ok.skin = game.Tools.localUISrc(this.skin_start);
                for (var t = 0, e = 0; e < this.players.length; e++)
                    if (0 != this.players[e].category && (!this.players[e] || this.players[e].account_id != this.owner_id)) {
                        if (!this.players[e] || null == this.players[e].ready || void 0 == this.players[e].ready || !this.players[e].ready)
                            return void game.Tools.setGrayDisable(this.btn_ok, !0);
                        t++
                    }
                game.Tools.setGrayDisable(this.btn_ok, t + 1 != this.max_player_count)
            }
        }
        ,
        n.prototype.onGameStart = function(t) {
            game.Tools.setGrayDisable(this.btn_ok, !0),
            this.enable = !1,
            game.MJNetMgr.Inst.OpenConnect(t.connect_token, t.game_uuid, t.location, !1, null)
        }
        ,
        n.Inst = null,
        n
    }(t.UIBase);
    t.UI_WaitingRoom = i
}(uiscript || (uiscript = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), uiscript;
!function(t) {
    var e = function(e) {
        function i() {
            var t = e.call(this, new ui.lobby.waitobUI) || this;
            return t._sec = 0,
            t._start_time = 0,
            i.Inst = t,
            t
        }
        return __extends(i, e),
        i.prototype.onCreate = function() {
            var t = this;
            this.root = this.me.getChildByName("root"),
            this.label_sec = this.root.getChildByName("sec"),
            this.root.getChildByName("btn_confirm").clickHandler = Laya.Handler.create(this, function() {
                t.locking || t.close(Laya.Handler.create(t, function() {
                    t._func && t._func.runWith({
                        success: !1
                    })
                }))
            }, null, !1)
        }
        ,
        i.prototype.show = function(e, i, n) {
            var a = this;
            this._func = n,
            this.label_sec.text = i.toString(),
            this._sec = i,
            this.locking = !0,
            this.enable = !0,
            t.UIBase.anim_pop_out(this.root, Laya.Handler.create(this, function() {
                a.locking = !1,
                a._start_time = Laya.timer.currTimer,
                Laya.timer.loop(100, a, function() {
                    var i = Math.ceil((1e3 * a._sec - (Laya.timer.currTimer - a._start_time)) / 1e3);
                    i <= 0 && (i = 0),
                    a.label_sec.text = i.toString(),
                    0 == i && a.close(Laya.Handler.create(a, function() {
                        t.UI_Live_Broadcast.fetchInfo(e, n)
                    }))
                })
            }))
        }
        ,
        i.prototype.close = function(e) {
            var i = this;
            Laya.timer.clearAll(this),
            this.locking = !0,
            t.UIBase.anim_pop_hide(this.root, Laya.Handler.create(this, function() {
                i.locking = !1,
                i.enable = !1,
                e && e.run()
            }))
        }
        ,
        i.prototype.onDisable = function() {
            Laya.timer.clearAll(this)
        }
        ,
        i
    }(t.UIBase);
    t.UI_WaitOb = e
}(uiscript || (uiscript = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), uiscript;
!function(t) {
    var e = function() {
        return function() {}
    }()
      , i = function(i) {
        function n() {
            var t = i.call(this, new ui.mj.winUI) || this;
            return t.root = null,
            t.label_chang = null,
            t.label_winner_name = null,
            t.img_mode = null,
            t.container_hand = null,
            t.img_hands = [],
            t.container_dora = null,
            t.img_doras = [],
            t.container_lidora = null,
            t.img_lidoras = [],
            t.container_fan_yiman = null,
            t.container_fan_liuju = null,
            t.container_fan_8 = null,
            t.container_fan_12 = null,
            t.container_fan_15 = null,
            t.fan_imgs = [],
            t.fu_imgs = [],
            t.img_yiman = null,
            t.score_imgs = [],
            t.btn_confirm = null,
            t.container_title = null,
            t.container_score = null,
            t.container_fan = null,
            t.container_fu = null,
            t.count_down = null,
            t.illust = null,
            t.illust_rect = null,
            t.liujumanguan = !1,
            t.data = null,
            t.current_index = 0,
            t.effect_yiman = null,
            n.Inst = t,
            t
        }
        return __extends(n, i),
        n.prototype.onCreate = function() {
            this.root = this.me.getChildByName("root"),
            this.label_winner_name = this.root.getChildByName("container_name").getChildAt(0),
            this.img_mode = this.root.getChildByName("he"),
            this.container_hand = this.root.getChildByName("container_hand"),
            this.illust = this.root.getChildByName("xiaojiejie"),
            this.illust_rect = t.UIRect.CreateFromSprite(this.illust),
            this.img_hands = [];
            for (i = 0; i < this.container_hand.numChildren; i++) {
                (e = this.container_hand.getChildAt(i)).visible = !1,
                this.img_hands.push(e)
            }
            this.container_dora = this.root.getChildByName("container_dora"),
            this.img_doras = [];
            for (i = 0; i < 5; i++) {
                e = this.container_dora.getChildByName("img" + i);
                this.img_doras.push(e)
            }
            this.container_lidora = this.root.getChildByName("container_lidora"),
            this.img_lidoras = [];
            for (i = 0; i < 5; i++) {
                var e = this.container_lidora.getChildByName("img" + i);
                this.img_lidoras.push(e)
            }
            this.container_fan_yiman = this.root.getChildByName("container_fan_yiman"),
            this.container_fan_liuju = this.root.getChildByName("container_fan_liuju"),
            this.container_fan_8 = this.root.getChildByName("container_fan_8"),
            this.container_fan_12 = this.root.getChildByName("container_fan_12"),
            this.container_fan_15 = this.root.getChildByName("container_fan_15"),
            this.btn_confirm = this.root.getChildByName("btn_confirm"),
            this.count_down = this.btn_confirm.getChildByName("countdown"),
            this.container_title = this.root.getChildByName("container_title"),
            this.container_score = this.root.getChildByName("container_score");
            for (i = 0; i < 6; i++)
                this.score_imgs.push(this.container_score.getChildByName("s" + i.toString()));
            this.img_yiman = this.root.getChildByName("container_fanfu").getChildByName("yiman"),
            this.container_fan = this.root.getChildByName("container_fanfu").getChildByName("fan");
            for (i = 0; i < 2; i++)
                this.fan_imgs.push(this.container_fan.getChildByName("n" + i.toString()));
            this.container_fu = this.root.getChildByName("container_fanfu").getChildByName("fu");
            for (var i = 0; i < 3; i++)
                this.fu_imgs.push(this.container_fu.getChildByName("n" + i.toString()));
            this.btn_confirm.clickHandler = new laya.utils.Handler(this,this.onConfirm)
        }
        ,
        n.prototype.show = function(t, e) {
            this.liujumanguan = e,
            this.data = t,
            this.current_index = 0,
            this.liujumanguan ? this._showLiuJuManGuan(t[0]) : this._showHule(t.hules[0]),
            this.enable = !0
        }
        ,
        n.prototype.onConfirm = function() {
            if (Laya.timer.clearAll(this),
            this.btn_confirm.disabled = !0,
            Laya.loader.clearTextureRes(this.illust.skin),
            this.effect_yiman && (this.effect_yiman.destory(),
            this.effect_yiman = null),
            this.liujumanguan)
                if (this.current_index < this.data.length - 1)
                    this.current_index++,
                    this._showLiuJuManGuan(this.data[this.current_index]);
                else {
                    this.enable = !1;
                    for (var e = [], i = 0; i < view.DesktopMgr.Inst.player_count; i++)
                        e.push({
                            old_score: this.data[0].old_scores[i],
                            delta: 0
                        });
                    for (i = 0; i < this.data.length; i++)
                        for (var n = 0; n < view.DesktopMgr.Inst.player_count; n++)
                            e[n].delta += this.data[i].delta_scores[n];
                    t.UI_ScoreChange.Inst.show(e)
                }
            else if (this.current_index < this.data.hules.length - 1)
                this.current_index++,
                this._showHule(this.data.hules[this.current_index]);
            else {
                this.enable = !1,
                t.UI_DesktopInfo.Inst.setLiqibang(0);
                for (var e = [], i = 0; i < view.DesktopMgr.Inst.player_count; i++)
                    e.push({
                        old_score: this.data.old_scores[i],
                        delta: this.data.delta_scores[i]
                    });
                t.UI_ScoreChange.Inst.show(e)
            }
        }
        ,
        n.prototype.setTitle = function(t) {
            for (n = 0; n < this.container_title.numChildren; n++)
                this.container_title.getChildAt(n).visible = !1;
            if ("chs" == GameMgr.client_language) {
                e = [];
                switch (t) {
                case mjcore.E_Dadian_Title.E_Dadian_Title_manguan:
                    e = ["", "", "man", "guan"];
                    break;
                case mjcore.E_Dadian_Title.E_Dadian_Title_tiaoman:
                    e = ["", "", "tiao", "man"];
                    break;
                case mjcore.E_Dadian_Title.E_Dadian_Title_beiman:
                    e = ["", "", "bei", "man"];
                    break;
                case mjcore.E_Dadian_Title.E_Dadian_Title_sanbeiman:
                    e = ["", "san", "bei", "man"];
                    break;
                case mjcore.E_Dadian_Title.E_Dadian_Title_leijiyiman:
                    e = ["lei", "ji", "yi", "man"];
                    break;
                case mjcore.E_Dadian_Title.E_Dadian_Title_yiman:
                    e = ["", "", "yi", "man"];
                    break;
                case mjcore.E_Dadian_Title.E_Dadian_Title_yiman2:
                    e = ["liang", "bei", "yi", "man"];
                    break;
                case mjcore.E_Dadian_Title.E_Dadian_Title_yiman3:
                    e = ["san", "bei", "yi", "man"];
                    break;
                case mjcore.E_Dadian_Title.E_Dadian_Title_yiman4:
                    e = ["si", "bei", "yi", "man"];
                    break;
                case mjcore.E_Dadian_Title.E_Dadian_Title_yiman5:
                    e = ["wu", "bei", "yi", "man"];
                    break;
                case mjcore.E_Dadian_Title.E_Dadian_Title_yiman6:
                    e = ["liu", "bei", "yi", "man"]
                }
                (i = this.container_title.getChildByName("chs")).visible = !0;
                for (n = 0; n < i.numChildren; n++)
                    i.getChildAt(n).visible = !1;
                for (n = 0; n < e.length; n++)
                    if ("" != e[n]) {
                        (a = i.getChildAt(n)).visible = !0,
                        a.skin = "myres/word_" + e[n] + ".png"
                    }
            } else if ("en" == GameMgr.client_language) {
                (i = this.container_title.getChildByName("en")).visible = !0;
                a = i.getChildAt(0);
                switch (t) {
                case mjcore.E_Dadian_Title.E_Dadian_Title_manguan:
                    a.skin = "en/myres/Mangan.png";
                    break;
                case mjcore.E_Dadian_Title.E_Dadian_Title_tiaoman:
                    a.skin = "en/myres/Haneman.png";
                    break;
                case mjcore.E_Dadian_Title.E_Dadian_Title_beiman:
                    a.skin = "en/myres/Baiman.png";
                    break;
                case mjcore.E_Dadian_Title.E_Dadian_Title_sanbeiman:
                    a.skin = "en/myres/Sanbaiman.png";
                    break;
                case mjcore.E_Dadian_Title.E_Dadian_Title_leijiyiman:
                case mjcore.E_Dadian_Title.E_Dadian_Title_yiman:
                    a.skin = "en/myres/Yakuman.png";
                    break;
                case mjcore.E_Dadian_Title.E_Dadian_Title_yiman2:
                    a.skin = "en/myres/Double Yakuman.png";
                    break;
                case mjcore.E_Dadian_Title.E_Dadian_Title_yiman3:
                    a.skin = "en/myres/Triple Yakuman.png";
                    break;
                case mjcore.E_Dadian_Title.E_Dadian_Title_yiman4:
                    a.skin = "en/myres/Quadruple Yakuman.png";
                    break;
                case mjcore.E_Dadian_Title.E_Dadian_Title_yiman5:
                    a.skin = "en/myres/Quintuple Yakuman.png";
                    break;
                case mjcore.E_Dadian_Title.E_Dadian_Title_yiman6:
                    a.skin = "en/myres/Sextuple Yakuman.png"
                }
            } else if ("jp" == GameMgr.client_language) {
                var e = [];
                switch (t) {
                case mjcore.E_Dadian_Title.E_Dadian_Title_manguan:
                    e = ["", "", "man", "guan"];
                    break;
                case mjcore.E_Dadian_Title.E_Dadian_Title_tiaoman:
                    e = ["", "", "tiao", "man"];
                    break;
                case mjcore.E_Dadian_Title.E_Dadian_Title_beiman:
                    e = ["", "", "bei", "man"];
                    break;
                case mjcore.E_Dadian_Title.E_Dadian_Title_sanbeiman:
                    e = ["", "san", "bei", "man"];
                    break;
                case mjcore.E_Dadian_Title.E_Dadian_Title_leijiyiman:
                    e = ["shu", "ji", "yi", "man"];
                    break;
                case mjcore.E_Dadian_Title.E_Dadian_Title_yiman:
                    e = ["", "", "yi", "man"];
                    break;
                case mjcore.E_Dadian_Title.E_Dadian_Title_yiman2:
                    e = ["er", "bei", "yi", "man"];
                    break;
                case mjcore.E_Dadian_Title.E_Dadian_Title_yiman3:
                    e = ["san", "bei", "yi", "man"];
                    break;
                case mjcore.E_Dadian_Title.E_Dadian_Title_yiman4:
                    e = ["si", "bei", "yi", "man"];
                    break;
                case mjcore.E_Dadian_Title.E_Dadian_Title_yiman5:
                    e = ["wu", "bei", "yi", "man"];
                    break;
                case mjcore.E_Dadian_Title.E_Dadian_Title_yiman6:
                    e = ["liu", "bei", "yi", "man"]
                }
                var i = this.container_title.getChildByName("chs");
                i.visible = !0;
                for (n = 0; n < i.numChildren; n++)
                    i.getChildAt(n).visible = !1;
                for (var n = 0; n < e.length; n++)
                    if ("" != e[n]) {
                        var a;
                        (a = i.getChildAt(n)).visible = !0,
                        a.skin = "jp/myres/word_" + e[n] + ".png"
                    }
            }
        }
        ,
        n.prototype.setFanFu = function(t, e) {
            this.container_fan.visible = this.container_fu.visible = !0,
            this.container_fan.alpha = this.container_fu.alpha = 0;
            for (i = 0; i < 2; i++)
                if (0 == t)
                    this.fan_imgs[i].visible = !1;
                else {
                    n = t % 10;
                    t = Math.floor(t / 10),
                    this.fan_imgs[i].visible = !0,
                    this.fan_imgs[i].skin = game.Tools.localUISrc("myres/mjdesktop/h_" + n.toString() + ".png")
                }
            for (var i = 0; i < 3; i++)
                if (0 == e)
                    this.fu_imgs[i].visible = !1;
                else {
                    var n = e % 10;
                    e = Math.floor(e / 10),
                    this.fu_imgs[i].visible = !0,
                    this.fu_imgs[i].skin = game.Tools.localUISrc("myres/mjdesktop/ww_" + n.toString() + ".png")
                }
            Laya.Tween.to(this.container_fan, {
                alpha: 1
            }, 200),
            Laya.Tween.to(this.container_fu, {
                alpha: 1
            }, 200)
        }
        ,
        n.prototype._showInfo_mj = function(t) {
            var e = this;
            this.root.alpha = 0,
            Laya.Tween.to(this.root, {
                alpha: 1
            }, 500);
            this.label_winner_name.text = view.DesktopMgr.Inst.player_datas[t.seat].nickname;
            var i = view.DesktopMgr.Inst.player_datas[t.seat].character;
            game.Tools.charaPart(view.DesktopMgr.Inst.player_datas[t.seat].avatar_id, this.illust, "full", this.illust_rect),
            2 == t.mode ? this.img_mode.visible = !1 : (this.img_mode.visible = !0,
            0 == t.mode ? this.img_mode.skin = game.Tools.localUISrc("myres/mjdesktop/pg_zimo.png") : this.img_mode.skin = game.Tools.localUISrc("myres/mjdesktop/pg_he.png"));
            for (var n = "myres2/mjp/" + GameMgr.Inst.mjp_view + "/ui/", a = this.img_hands[0].width, r = .5 * a, s = 0; s < this.img_hands.length; s++)
                this.img_hands[s].visible = !1;
            for (var o = 0, l = 0, h = [], s = 0; s < t.hand.length; s++)
                h.push(mjcore.MJPai.Create(t.hand[s]));
            h = h.sort(mjcore.MJPai.Distance);
            for (s = 0; s < h.length; s++)
                this.img_hands[o].skin = game.Tools.localUISrc(n + h[s].toString() + ".png"),
                this.img_hands[o].x = l,
                this.img_hands[o].y = 0,
                l += a,
                this.img_hands[o].visible = !0,
                o++;
            if (t.ming && t.ming.length > 0) {
                l += r;
                for (s = 0; s < t.ming.length; s++) {
                    var c = t.ming[s];
                    if (")" != c.charAt(c.length - 1)) {
                        if (1 == (_ = c.split("|")).length) {
                            p = _[0].charAt(1);
                            "0" == (f = _[0].charAt(0)) && (f = "5");
                            for (v = 0; v < 4; v++) {
                                x = "";
                                x = 0 == v || 3 == v ? "back" : 1 == v && "5" == f && "z" != p ? "0" + p : f + p,
                                this.img_hands[o].skin = game.Tools.localUISrc(n + x + ".png"),
                                this.img_hands[o].x = l,
                                this.img_hands[o].y = 0,
                                l += a,
                                this.img_hands[o].visible = !0,
                                o++
                            }
                        } else
                            for (v = 0; v < _.length; v++) {
                                x = _[v].toString();
                                this.img_hands[o].skin = game.Tools.localUISrc(n + x + ".png"),
                                this.img_hands[o].x = l,
                                this.img_hands[o].y = 0,
                                l += a,
                                this.img_hands[o].visible = !0,
                                o++
                            }
                    } else {
                        for (var u = "", _ = [], d = 0; d < c.length; d++)
                            if ("(" == c.charAt(d)) {
                                u = c.substring(0, d),
                                _ = c.substring(d + 1, c.length - 1).split(",");
                                break
                            }
                        if ("angang" == u) {
                            for (var f = _[0].charAt(0), p = _[0].charAt(1), m = 0, g = 0; g < _.length; g++)
                                "0" == _[g].charAt(0) && m++;
                            m > 0 && (f = "5");
                            for (var y = 0; y < _.length; y++) {
                                x = "";
                                x = 0 == y || 3 == y ? "back" : y <= m ? "0" + p : f + p,
                                this.img_hands[o].skin = game.Tools.localUISrc(n + x + ".png"),
                                this.img_hands[o].x = l,
                                this.img_hands[o].y = 0,
                                l += a,
                                this.img_hands[o].visible = !0,
                                o++
                            }
                        } else
                            for (var v = 0; v < _.length; v++) {
                                x = _[v];
                                this.img_hands[o].skin = game.Tools.localUISrc(n + x + ".png"),
                                this.img_hands[o].x = l,
                                this.img_hands[o].y = 0,
                                l += a,
                                this.img_hands[o].visible = !0,
                                o++
                            }
                    }
                }
            }
            l += r,
            2 != t.mode && (this.img_hands[o].skin = game.Tools.localUISrc(n + t.hupai + ".png"),
            this.img_hands[o].x = l,
            this.img_hands[o].y = 0,
            l += a,
            this.img_hands[o].visible = !0,
            o++);
            var b = (.72 - .92) * (o - 14) / 4 + .92;
            this.container_hand.scaleX = this.container_hand.scaleY = b;
            for (s = 0; s < 5; s++) {
                x = "back";
                s < t.doras.length && (x = t.doras[s]),
                this.img_doras[s].skin = game.Tools.localUISrc(n + x + ".png"),
                this.img_doras[s].x = s * a,
                this.img_doras[s].y = 0
            }
            if (t.lidoras && 2 != t.mode) {
                this.container_lidora.visible = !0;
                for (s = 0; s < 5; s++) {
                    x = "back";
                    s < t.lidoras.length && (x = t.lidoras[s]),
                    this.img_lidoras[s].skin = game.Tools.localUISrc(n + x + ".png"),
                    this.img_lidoras[s].x = s * a,
                    this.img_lidoras[s].y = 0
                }
            } else {
                this.container_lidora.visible = !0;
                for (s = 0; s < 5; s++) {
                    var x = "back";
                    this.img_lidoras[s].skin = game.Tools.localUISrc(n + x + ".png"),
                    this.img_lidoras[s].x = s * a,
                    this.img_lidoras[s].y = 0
                }
            }
            var w = t.fan_names.length
              , C = 100;
            this.container_fan_yiman.visible = !1,
            this.container_fan_8.visible = !1,
            this.container_fan_15.visible = !1,
            this.container_fan_12.visible = !1,
            this.container_fan_liuju.visible = !1,
            this.container_fan_yiman.visible = !1,
            this.container_fan_8.visible = !1,
            this.container_fan_15.visible = !1,
            this.container_fan_12.visible = !1,
            this.container_fan_liuju.visible = !1;
            var I = null;
            (I = 2 == t.mode ? this.container_fan_liuju : t.yiman ? this.container_fan_yiman : w <= 8 ? this.container_fan_8 : w <= 12 ? this.container_fan_12 : this.container_fan_15).visible = !0;
            for (s = 0; s < I.numChildren; s++)
                I.getChildAt(s).visible = !1;
            for (var S = [], s = 0; s < t.fan_names.length; s++) {
                var T = t.fan_names[s]
                  , M = 0
                  , E = t.fan_ids[s];
                9999 != E && (M = cfg.fan.fan.get(E).show_index);
                var L = {
                    name: T,
                    index: M
                };
                if (t.fan_value && t.fan_value.length > s && (L.value = t.fan_value[s]),
                10 == E)
                    switch ((t.seat - view.DesktopMgr.Inst.index_ju + view.DesktopMgr.Inst.player_count) % view.DesktopMgr.Inst.player_count) {
                    case 0:
                        L.sound = "fan_dong";
                        break;
                    case 1:
                        L.sound = "fan_nan";
                        break;
                    case 2:
                        L.sound = "fan_xi";
                        break;
                    case 3:
                        L.sound = "fan_bei"
                    }
                else if (11 == E)
                    if (view.DesktopMgr.Inst.index_change % 4 == (t.seat - view.DesktopMgr.Inst.index_ju + view.DesktopMgr.Inst.player_count) % view.DesktopMgr.Inst.player_count)
                        switch (view.DesktopMgr.Inst.index_change % 4) {
                        case 0:
                            L.sound = "fan_doubledong";
                            break;
                        case 1:
                            L.sound = "fan_doublenan";
                            break;
                        case 2:
                            L.sound = "fan_doublexi";
                            break;
                        case 3:
                            L.sound = "fan_doublebei"
                        }
                    else
                        switch (view.DesktopMgr.Inst.index_change % 4) {
                        case 0:
                            L.sound = "fan_dong";
                            break;
                        case 1:
                            L.sound = "fan_nan";
                            break;
                        case 2:
                            L.sound = "fan_xi";
                            break;
                        case 3:
                            L.sound = "fan_bei"
                        }
                else if (E >= 31 && E <= 34) {
                    var D = L.value;
                    D > 13 && (D = 13),
                    L.sound = 0 == D ? "" : "fan_dora" + D
                } else
                    9999 == E ? L.sound = "fan_liujumanguan" : E >= 0 && (L.sound = cfg.fan.fan.get(E).sound);
                S.push(L)
            }
            S = S.sort(function(t, e) {
                return t.index - e.index
            }),
            C += 500;
            for (var A = function(t) {
                var e = game.Tools.get_chara_audio(i, S[t].sound);
                Laya.timer.once(C, N, function() {
                    var i = I.getChildAt(t)
                      , n = i.getChildByName("l_name");
                    if (n.text = S[t].name,
                    n.width = 242,
                    game.Tools.labelLocalizationSize(n, 242, .8),
                    void 0 !== S[t].value && null !== S[t].value) {
                        i.getChildAt(2).visible = !0;
                        var a = S[t].value.toString();
                        2 == a.length ? (i.getChildAt(3).skin = game.Tools.localUISrc("myres/mjdesktop/h_" + a[1] + ".png"),
                        i.getChildAt(3).visible = !0,
                        i.getChildAt(4).skin = game.Tools.localUISrc("myres/mjdesktop/h_" + a[0] + ".png"),
                        i.getChildAt(4).visible = !0) : (i.getChildAt(3).skin = game.Tools.localUISrc("myres/mjdesktop/h_" + a[0] + ".png"),
                        i.getChildAt(3).visible = !0,
                        i.getChildAt(4).visible = !1)
                    }
                    i.visible = !0,
                    Laya.Tween.from(i, {
                        x: 169,
                        y: 184,
                        alpha: 0
                    }, 100, Laya.Ease.strongOut),
                    e ? (view.AudioMgr.PlaySound(e.path, e.volume),
                    view.AudioMgr.PlayAudio(211, 1, .5)) : view.AudioMgr.PlayAudio(211, 1, 1)
                }),
                C += e && e.time_length > 500 ? e.time_length : 500
            }, N = this, s = 0; s < w && s < I.numChildren; s++)
                A(s);
            this.container_fan.visible = !1,
            this.container_fu.visible = !1,
            this.img_yiman.visible = !1,
            t.fan && t.fu ? (C += 300,
            Laya.timer.once(C, this, function() {
                view.AudioMgr.PlayAudio(208),
                e.setFanFu(t.fan, t.fu)
            })) : t.yiman && (C += 700,
            Laya.timer.once(C, this, function() {
                view.AudioMgr.PlayAudio(208),
                e.img_yiman.alpha = 0,
                e.img_yiman.visible = !0,
                Laya.Tween.to(e.img_yiman, {
                    alpha: 1
                }, 200)
            })),
            this.container_score.alpha = 0;
            for (s = 0; s < this.score_imgs.length; s++)
                this.score_imgs[s].visible = !1;
            if (C += 700,
            this.container_score.scaleX = this.container_score.scaleY = 2,
            Laya.timer.once(C, this, function() {
                for (var i = 0, n = t.score; 0 != n; ) {
                    var a = n % 10;
                    if (n = Math.floor(n / 10),
                    e.score_imgs[i].skin = game.Tools.localUISrc("myres/mjdesktop/ww_" + a.toString() + ".png"),
                    e.score_imgs[i].visible = !0,
                    ++i >= e.score_imgs.length)
                        break
                }
                Laya.Tween.to(e.container_score, {
                    alpha: 1,
                    scaleX: 1.2,
                    scaleY: 1.2
                }, 200, Laya.Ease.strongIn),
                view.AudioMgr.PlayAudio(221)
            }),
            this.container_title.visible = !1,
            t.title_id) {
                C += 700;
                var R = 0
                  , B = 0
                  , k = "";
                switch (t.title_id) {
                case mjcore.E_Dadian_Title.E_Dadian_Title_manguan:
                    k = "gameend_manguan",
                    R = 214;
                    break;
                case mjcore.E_Dadian_Title.E_Dadian_Title_tiaoman:
                    k = "gameend_tiaoman",
                    R = 214;
                    break;
                case mjcore.E_Dadian_Title.E_Dadian_Title_beiman:
                    k = "gameend_beiman",
                    R = 201;
                    break;
                case mjcore.E_Dadian_Title.E_Dadian_Title_sanbeiman:
                    k = "gameend_sanbeiman",
                    R = 201;
                    break;
                case mjcore.E_Dadian_Title.E_Dadian_Title_leijiyiman:
                    k = "gameend_leijiyiman",
                    B = 2,
                    R = 226;
                    break;
                case mjcore.E_Dadian_Title.E_Dadian_Title_yiman:
                    k = "gameend_yiman1",
                    B = 1,
                    R = 226;
                    break;
                case mjcore.E_Dadian_Title.E_Dadian_Title_yiman2:
                    k = "gameend_yiman2",
                    B = 2,
                    R = 226;
                    break;
                case mjcore.E_Dadian_Title.E_Dadian_Title_yiman3:
                    k = "gameend_yiman3",
                    B = 2,
                    R = 226;
                    break;
                case mjcore.E_Dadian_Title.E_Dadian_Title_yiman4:
                    k = "gameend_yiman4",
                    B = 2,
                    R = 226;
                    break;
                case mjcore.E_Dadian_Title.E_Dadian_Title_yiman5:
                    k = "gameend_yiman5",
                    B = 2,
                    R = 226;
                    break;
                case mjcore.E_Dadian_Title.E_Dadian_Title_yiman6:
                    k = "gameend_yiman6",
                    B = 2,
                    R = 226
                }
                var P = game.Tools.get_chara_audio(i, k);
                Laya.timer.once(C, this, function() {
                    e.setTitle(t.title_id),
                    e.container_title.visible = !0,
                    e.container_title.alpha = 0,
                    e.container_title.scaleX = e.container_title.scaleY = 3,
                    Laya.Tween.to(e.container_title, {
                        alpha: 1,
                        scaleX: 1.2,
                        scaleY: 1.2
                    }, 300, Laya.Ease.strongIn),
                    Laya.timer.once(300, e, function() {
                        0 != R && view.AudioMgr.PlayAudio(R)
                    }),
                    P && Laya.timer.once(500, e, function() {
                        view.AudioMgr.PlaySound(P.path, P.volume)
                    }),
                    0 != B && Laya.timer.once(300, e, function() {
                        var t, i;
                        "en" == GameMgr.client_language ? (t = e.root.getChildByName("effect_yiman_en"),
                        i = "scene/effect_yiman2.lh") : 1 == B ? (t = e.root.getChildByName("effect_yiman"),
                        i = "scene/effect_yiman.lh") : (t = e.root.getChildByName("effect_yiman2"),
                        i = "scene/effect_yiman2.lh"),
                        e.effect_yiman = game.FrontEffect.Inst.create_ui_effect(t, i, new Laya.Point(0,0), 25)
                    })
                }),
                (t.yiman || "累积役满" == t.title) && (C += 500)
            }
            this.btn_confirm.visible = !1,
            C += 300,
            this.btn_confirm.disabled = !0,
            Laya.timer.once(C, this, function() {
                e.btn_confirm.visible = !0,
                e.btn_confirm.alpha = 1,
                Laya.Tween.from(e.btn_confirm, {
                    alpha: 0
                }, 200),
                e.btn_confirm.disabled = !1;
                for (var t = function(t) {
                    Laya.timer.once(1e3 * t, e, function() {
                        e.btn_confirm.disabled || (e.count_down.text = "(" + (3 - t).toString() + ")")
                    })
                }, i = 0; i < 3; i++)
                    t(i);
                Laya.timer.once(3e3, e, function() {
                    e.btn_confirm.disabled || e.onConfirm()
                })
            })
        }
        ,
        n.prototype._showInfo_record = function(t) {
            this.root.alpha = 0,
            Laya.Tween.to(this.root, {
                alpha: 1
            }, 300);
            this.label_winner_name.text = view.DesktopMgr.Inst.player_datas[t.seat].nickname,
            game.Tools.charaPart(view.DesktopMgr.Inst.player_datas[t.seat].avatar_id, this.illust, "full", this.illust_rect),
            2 == t.mode ? this.img_mode.visible = !1 : (this.img_mode.visible = !0,
            0 == t.mode ? this.img_mode.skin = game.Tools.localUISrc("myres/mjdesktop/pg_zimo.png") : this.img_mode.skin = game.Tools.localUISrc("myres/mjdesktop/pg_he.png"));
            for (var e = "myres2/mjp/" + GameMgr.Inst.mjp_view + "/ui/", i = this.img_hands[0].width, n = .5 * i, a = 0; a < this.img_hands.length; a++)
                this.img_hands[a].visible = !1;
            for (var r = 0, s = 0, o = [], a = 0; a < t.hand.length; a++)
                o.push(mjcore.MJPai.Create(t.hand[a]));
            o = o.sort(mjcore.MJPai.Distance);
            for (a = 0; a < o.length; a++)
                this.img_hands[r].skin = game.Tools.localUISrc(e + o[a].toString() + ".png"),
                this.img_hands[r].x = s,
                this.img_hands[r].y = 0,
                s += i,
                this.img_hands[r].visible = !0,
                r++;
            if (t.ming && t.ming.length > 0) {
                s += n;
                for (a = 0; a < t.ming.length; a++) {
                    var l = t.ming[a];
                    if (")" != l.charAt(l.length - 1)) {
                        if (1 == (c = l.split("|")).length) {
                            d = c[0].charAt(1);
                            "0" == (_ = c[0].charAt(0)) && (_ = "5");
                            for (g = 0; g < 4; g++) {
                                v = "";
                                v = 0 == g || 3 == g ? "back" : 1 == g && "5" == _ && "z" != d ? "0" + d : _ + d,
                                this.img_hands[r].skin = game.Tools.localUISrc(e + v + ".png"),
                                this.img_hands[r].x = s,
                                this.img_hands[r].y = 0,
                                s += i,
                                this.img_hands[r].visible = !0,
                                r++
                            }
                        } else
                            for (g = 0; g < c.length; g++) {
                                v = c[g].toString();
                                this.img_hands[r].skin = game.Tools.localUISrc(e + v + ".png"),
                                this.img_hands[r].x = s,
                                this.img_hands[r].y = 0,
                                s += i,
                                this.img_hands[r].visible = !0,
                                r++
                            }
                    } else {
                        for (var h = "", c = [], u = 0; u < l.length; u++)
                            if ("(" == l.charAt(u)) {
                                h = l.substring(0, u),
                                c = l.substring(u + 1, l.length - 1).split(",");
                                break
                            }
                        if ("angang" == h) {
                            for (var _ = c[0].charAt(0), d = c[0].charAt(1), f = 0, p = 0; p < c.length; p++)
                                "0" == c[p].charAt(0) && f++;
                            f > 0 && (_ = "5");
                            for (var m = 0; m < c.length; m++) {
                                v = "";
                                v = 0 == m || 3 == m ? "back" : m <= f ? "0" + d : _ + d,
                                this.img_hands[r].skin = game.Tools.localUISrc(e + v + ".png"),
                                this.img_hands[r].x = s,
                                this.img_hands[r].y = 0,
                                s += i,
                                this.img_hands[r].visible = !0,
                                r++
                            }
                        } else
                            for (var g = 0; g < c.length; g++) {
                                v = c[g];
                                this.img_hands[r].skin = game.Tools.localUISrc(e + v + ".png"),
                                this.img_hands[r].x = s,
                                this.img_hands[r].y = 0,
                                s += i,
                                this.img_hands[r].visible = !0,
                                r++
                            }
                    }
                }
            }
            s += n,
            2 != t.mode && (this.img_hands[r].skin = game.Tools.localUISrc(e + t.hupai + ".png"),
            this.img_hands[r].x = s,
            this.img_hands[r].y = 0,
            s += i,
            this.img_hands[r].visible = !0,
            r++);
            var y = (.72 - .92) * (r - 14) / 4 + .92;
            this.container_hand.scaleX = this.container_hand.scaleY = y;
            for (a = 0; a < 5; a++) {
                v = "back";
                a < t.doras.length && (v = t.doras[a]),
                this.img_doras[a].skin = game.Tools.localUISrc(e + v + ".png"),
                this.img_doras[a].x = a * i,
                this.img_doras[a].y = 0
            }
            if (t.lidoras && 2 != t.mode) {
                this.container_lidora.visible = !0;
                for (a = 0; a < 5; a++) {
                    v = "back";
                    a < t.lidoras.length && (v = t.lidoras[a]),
                    this.img_lidoras[a].skin = game.Tools.localUISrc(e + v + ".png"),
                    this.img_lidoras[a].x = a * i,
                    this.img_lidoras[a].y = 0
                }
            } else {
                this.container_lidora.visible = !0;
                for (a = 0; a < 5; a++) {
                    var v = "back";
                    this.img_lidoras[a].skin = game.Tools.localUISrc(e + v + ".png"),
                    this.img_lidoras[a].x = a * i,
                    this.img_lidoras[a].y = 0
                }
            }
            var b = t.fan_names.length;
            this.container_fan_yiman.visible = !1,
            this.container_fan_8.visible = !1,
            this.container_fan_15.visible = !1,
            this.container_fan_12.visible = !1,
            this.container_fan_liuju.visible = !1,
            this.container_fan_yiman.visible = !1,
            this.container_fan_8.visible = !1,
            this.container_fan_15.visible = !1,
            this.container_fan_12.visible = !1,
            this.container_fan_liuju.visible = !1;
            var x = null;
            (x = 2 == t.mode ? this.container_fan_liuju : t.yiman ? this.container_fan_yiman : b <= 8 ? this.container_fan_8 : b <= 12 ? this.container_fan_12 : this.container_fan_15).visible = !0;
            for (a = 0; a < x.numChildren; a++)
                x.getChildAt(a).visible = !1;
            for (var w = [], a = 0; a < t.fan_names.length; a++) {
                var C = t.fan_names[a]
                  , I = t.fan_ids[a]
                  , S = 0;
                9999 != I && (S = cfg.fan.fan.get(I).show_index);
                var T = {
                    name: C,
                    index: S
                };
                t.fan_value && t.fan_value.length > a && (T.value = t.fan_value[a]),
                w.push(T)
            }
            w = w.sort(function(t, e) {
                return t.index - e.index
            });
            for (a = 0; a < b && a < x.numChildren; a++) {
                var M = x.getChildAt(a)
                  , E = M.getChildByName("l_name");
                if (E.text = w[a].name,
                E.width = 242,
                game.Tools.labelLocalizationSize(E, 242, .8),
                void 0 !== w[a].value && null !== w[a].value) {
                    M.getChildAt(2).visible = !0;
                    var L = w[a].value.toString();
                    2 == L.length ? (M.getChildAt(3).skin = game.Tools.localUISrc("myres/mjdesktop/h_" + L[1] + ".png"),
                    M.getChildAt(3).visible = !0,
                    M.getChildAt(4).skin = game.Tools.localUISrc("myres/mjdesktop/h_" + L[0] + ".png"),
                    M.getChildAt(4).visible = !0) : (M.getChildAt(3).skin = game.Tools.localUISrc("myres/mjdesktop/h_" + L[0] + ".png"),
                    M.getChildAt(3).visible = !0,
                    M.getChildAt(4).visible = !1)
                }
                M.visible = !0
            }
            this.container_fan.visible = !1,
            this.container_fu.visible = !1,
            this.img_yiman.visible = !1,
            t.fan && t.fu ? this.setFanFu(t.fan, t.fu) : t.yiman && (this.img_yiman.alpha = 0,
            this.img_yiman.visible = !0,
            Laya.Tween.to(this.img_yiman, {
                alpha: 1
            }, 200));
            for (a = 0; a < this.score_imgs.length; a++)
                this.score_imgs[a].visible = !1;
            for (var D = t.score.toString(), a = 0; a < D.length && !(a >= this.score_imgs.length); a++)
                this.score_imgs[a].skin = game.Tools.localUISrc("myres/mjdesktop/ww_" + D.charAt(D.length - 1 - a) + ".png"),
                this.score_imgs[a].visible = !0;
            this.container_score.alpha = 1,
            this.container_score.scaleX = this.container_score.scaleY = 1.2,
            this.container_title.visible = !1,
            t.title_id && (this.setTitle(t.title_id),
            this.container_title.visible = !0,
            this.container_title.alpha = 1,
            this.container_title.scaleX = this.container_title.scaleY = 1.2),
            this.count_down.text = "",
            this.btn_confirm.visible = !0,
            this.btn_confirm.disabled = !1,
            this.btn_confirm.alpha = 1
        }
        ,
        n.prototype._showHule = function(t) {
            var i = new e;
            if (i.seat = t.seat,
            i.hand = t.hand,
            t.ming && (i.ming = t.ming),
            i.hupai = t.hu_tile,
            i.mode = t.zimo ? 0 : 1,
            i.fan_names = [],
            i.fan_ids = [],
            t.yiman) {
                for (var n = t.fans, a = function(t) {
                    var e = ""
                      , a = -1;
                    n[t].id ? (a = n[t].id,
                    e = cfg.fan.fan.get(a)["name_" + GameMgr.client_language]) : (e = n[t].name,
                    cfg.fan.fan.forEach(function(t) {
                        t.name_chs == e && (a = t.id,
                        e = t["name_" + GameMgr.client_language])
                    })),
                    i.fan_ids.push(a),
                    i.fan_names.push(e)
                }, r = 0; r < n.length; r++)
                    a(r);
                i.fan = 0,
                i.fu = 0,
                i.yiman = !0
            } else {
                i.fan_value = [];
                for (var n = t.fans, s = function(t) {
                    var e = ""
                      , a = -1;
                    n[t].id ? (a = n[t].id,
                    e = cfg.fan.fan.get(a)["name_" + GameMgr.client_language]) : (e = n[t].name,
                    cfg.fan.fan.forEach(function(t) {
                        t.name_chs == e && (a = t.id,
                        e = t["name_" + GameMgr.client_language])
                    })),
                    i.fan_ids.push(a),
                    i.fan_names.push(e),
                    i.fan_value.push(n[t].val)
                }, r = 0; r < n.length; r++)
                    s(r);
                i.fan = t.count,
                i.fu = t.fu,
                i.yiman = !1
            }
            if (t.title && "" != t.title)
                switch (i.title = t.title,
                i.title) {
                case "满贯":
                    i.title_id = mjcore.E_Dadian_Title.E_Dadian_Title_manguan;
                    break;
                case "跳满":
                    i.title_id = mjcore.E_Dadian_Title.E_Dadian_Title_tiaoman;
                    break;
                case "倍满":
                    i.title_id = mjcore.E_Dadian_Title.E_Dadian_Title_beiman;
                    break;
                case "三倍满":
                    i.title_id = mjcore.E_Dadian_Title.E_Dadian_Title_sanbeiman;
                    break;
                case "累积役满":
                    i.title_id = mjcore.E_Dadian_Title.E_Dadian_Title_leijiyiman;
                    break;
                case "役满":
                    i.title_id = mjcore.E_Dadian_Title.E_Dadian_Title_yiman;
                    break;
                case "两倍役满":
                    i.title_id = mjcore.E_Dadian_Title.E_Dadian_Title_yiman2;
                    break;
                case "三倍役满":
                    i.title_id = mjcore.E_Dadian_Title.E_Dadian_Title_yiman3;
                    break;
                case "四倍役满":
                    i.title_id = mjcore.E_Dadian_Title.E_Dadian_Title_yiman4;
                    break;
                case "五倍役满":
                    i.title_id = mjcore.E_Dadian_Title.E_Dadian_Title_yiman5;
                    break;
                case "六倍役满":
                    i.title_id = mjcore.E_Dadian_Title.E_Dadian_Title_yiman6
                }
            t.title_id && (i.title_id = t.title_id);
            var o = 0;
            o = t.zimo ? view.DesktopMgr.Inst.rule_mode == view.ERuleMode.Liqi4 ? t.qinjia ? 3 * t.point_zimo_xian : t.point_zimo_qin + 2 * t.point_zimo_xian : t.qinjia ? 2 * t.point_zimo_xian : t.point_zimo_qin + t.point_zimo_xian : t.point_rong,
            i.score = o,
            i.doras = t.doras,
            t.liqi && (i.lidoras = t.li_doras),
            view.DesktopMgr.Inst.mode == view.EMJMode.play ? this._showInfo_mj(i) : view.DesktopMgr.Inst.mode == view.EMJMode.paipu ? (1 & view.DesktopMgr.Inst.paipu_config) > 0 ? this._showInfo_mj(i) : this._showInfo_record(i) : view.DesktopMgr.Inst.mode == view.EMJMode.live_broadcast && this._showInfo_mj(i)
        }
        ,
        n.prototype._showLiuJuManGuan = function(t) {
            var i = new e;
            i.seat = t.seat,
            i.hand = t.hand,
            i.ming = t.ming,
            i.mode = 2,
            i.fan_names = [game.Tools.strOfLocalization(2105)],
            i.fan_ids = [9999],
            i.fan = i.fu = 0,
            i.score = t.score,
            i.title_id = mjcore.E_Dadian_Title.E_Dadian_Title_manguan,
            i.doras = t.doras,
            i.yiman = !1,
            view.DesktopMgr.Inst.mode == view.EMJMode.play ? this._showInfo_mj(i) : view.DesktopMgr.Inst.mode == view.EMJMode.paipu ? this._showInfo_record(i) : view.DesktopMgr.Inst.mode == view.EMJMode.live_broadcast && this._showInfo_mj(i)
        }
        ,
        n.prototype.onDisable = function() {
            Laya.timer.clearAll(this)
        }
        ,
        n
    }(t.UIBase);
    t.UI_Win = i
}(uiscript || (uiscript = {}));
var __extends = this && this.__extends || function() {
    var t = Object.setPrototypeOf || {
        __proto__: []
    }instanceof Array && function(t, e) {
        t.__proto__ = e
    }
    || function(t, e) {
        for (var i in e)
            e.hasOwnProperty(i) && (t[i] = e[i])
    }
    ;
    return function(e, i) {
        function n() {
            this.constructor = e
        }
        t(e, i),
        e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype,
        new n)
    }
}(), uiscript;
!function(t) {
    var e = function() {
        function e(e) {
            var i = this;
            this.btn_next_flag = 0,
            this.btn_prev_flag = 0,
            this.maskflag = 0,
            this.locking = !1,
            this.loadover = [],
            this.pageid = [],
            this.pageindex = 0,
            this.pagecorrect = 0,
            this.pagewrong = 0,
            this.effectnext = 1,
            this.effectprev = 0,
            this.container_chat = null,
            this.chat_block = null,
            this.me = e,
            this.blackground = this.me.getChildByName("bg"),
            this.page = this.me.getChildByName("content").getChildByName("content"),
            this.skip_text = this.me.getChildByName("skipimg"),
            this.img_correct = this.me.getChildByName("content").getChildByName("correct"),
            this.img_error = this.me.getChildByName("content").getChildByName("error"),
            this.btn_next = this.me.getChildByName("nextbutton"),
            this.btn_next_flag = 0,
            this.btn_prev = this.me.getChildByName("prevbutton"),
            this.btn_prev_flag = 0,
            this.btn_exit = this.me.getChildByName("exit"),
            this.btn_back = this.me.getChildByName("back"),
            this.loading = this.me.getChildByName("loading"),
            this.buttonCrew = this.me.getChildByName("buttonCrew"),
            this.btn1 = this.buttonCrew.getChildByName("btn1"),
            this.btn2 = this.buttonCrew.getChildByName("btn2"),
            this.btn3 = this.buttonCrew.getChildByName("btn3"),
            this.buttonCrew.visible = !1,
            this.yijibg = this.me.getChildByName("yjbg"),
            this.Dialogue = this.me.getChildByName("Dialogue"),
            this.Dtext = this.Dialogue.getChildByName("info").getChildByName("info"),
            this.Dnamet = this.Dialogue.getChildByName("name"),
            this.Dnamet.scaleX = this.Dnamet.scaleY = "en" == GameMgr.client_language ? 1.8 : 1.3,
            this.Shead = this.Dialogue.getChildByName("head"),
            this.mask = this.me.getChildByName("content").mask,
            this.container_chat = this.me.getChildByName("Dialogue").getChildByName("info"),
            this.chat_block = new t.UI_Character_Chat(this.container_chat),
            this.btn_prev.clickHandler = Laya.Handler.create(this, function() {
                i.locking || 0 != i.pageindex && i.data && i.data.datas && (i.effectprev = 1,
                i.btn_next_flag = 0,
                i.btnprev())
            }, null, !1),
            this.btn_next.clickHandler = Laya.Handler.create(this, function() {
                if (!i.locking && i.data && i.data.datas && i.pageindex != i.data.datas.length - 1) {
                    i.effectnext = 1;
                    var t;
                    if (i.btn_prev_flag = 0,
                    0 == i.btn_next_flag) {
                        for (var e = 0; e < i.data.datas.length; e++)
                            i.data.datas[e].page_id == i.data.datas[i.pageindex].next && (i.pagecorrect = e,
                            0 == (t = parseFloat(i.data.datas[e].effect)) && (t = 2),
                            1 == t && (t = 0));
                        i.showPage(i.pagecorrect, t)
                    } else
                        i.btn_next_flag = 0,
                        i.showPage(i.pagecorrect, 0)
                }
            }, null, !1),
            this.btn1.clickHandler = Laya.Handler.create(this, function() {
                i.locking || i.changepage(i.pageindex, 0)
            }, null, !1),
            this.btn2.clickHandler = Laya.Handler.create(this, function() {
                i.locking || i.changepage(i.pageindex, 1)
            }, null, !1),
            this.btn3.clickHandler = Laya.Handler.create(this, function() {
                i.locking || i.changepage(i.pageindex, 2)
            }, null, !1),
            this.btn_back.clickHandler = Laya.Handler.create(this, function() {
                i.locking || 0 != i.pageindex && i.data && i.data.datas && (i.effectprev = 1,
                i.btnprev())
            }, null, !1)
        }
        return e.prototype.btnvisible = function(t, e) {
            this.buttonCrew.visible != e && (e ? i.Inst.me.ani1.play(0, !0) : i.Inst.me.ani1.stop()),
            this.buttonCrew.visible = e;
            for (var n = 1; n < t + 1; n++) {
                var a = "btn" + n;
                this.buttonCrew.getChildByName(a).visible = e
            }
        }
        ,
        e.prototype.btnprev = function() {
            var t;
            if (this.data.datas[this.pageindex].prev) {
                for (e = 0; e < this.data.datas.length; e++)
                    this.data.datas[e].page_id == this.data.datas[this.pageindex].prev && (t = parseFloat(this.data.datas[this.pageindex].effect),
                    this.pageindex = e,
                    0 == t && (t = 2));
                this.showPage(this.pageindex, t)
            } else if (0 == this.btn_prev_flag) {
                for (var e = 0; e < this.pageid.length; e++)
                    this.pageid[e] == this.pageindex && (this.pageindex = this.pageid[e - 1]);
                this.showPage(this.pageindex, 1)
            } else
                this.btn_prev_flag = 0,
                this.showPage(this.pagewrong, 2)
        }
        ,
        e.prototype.show = function() {
            var t = this;
            game.Scene_Lobby.Inst.change_bg("indoor", !1),
            this.effectnext = 1,
            this.effectprev = 0,
            this.me.visible = !0;
            var e = "res/atlas/" + game.Tools.localUISrc("myres/course_ui.atlas");
            Laya.loader.load(e, Laya.Handler.create(this, function() {
                t.blackground.skin = game.Tools.localUISrc("myres/course_ui/blackboard.png"),
                t.img_correct.getChildByName("text").skin = game.Tools.localUISrc("myres/course_ui/correct.png"),
                t.img_correct.getChildByName("circle").skin = game.Tools.localUISrc("myres/course_ui/correct_circle.png"),
                t.img_error.getChildByName("text").skin = game.Tools.localUISrc("myres/course_ui/error.png"),
                t.img_error.getChildByName("circle").skin = game.Tools.localUISrc("myres/course_ui/error_circle.png"),
                t.btn_next.getChildByName("next").skin = game.Tools.localUISrc("myres/course_ui/arrow.png"),
                t.btn_prev.getChildByName("next").skin = game.Tools.localUISrc("myres/course_ui/arrow.png"),
                t.Dialogue.getChildByName("textbg").skin = game.Tools.localUISrc("myres/course_ui/bubble.png"),
                t.Dialogue.getChildByName("textbg").sizeGrid = "51,41,65,128",
                t.Dialogue.getChildByName("namebg").skin = game.Tools.localUISrc("myres/course_ui/bg_name.png"),
                t.me.getChildByName("skipimg").skin = game.Tools.localUISrc("myres/course_ui/skip.png"),
                t.mask.skin = game.Tools.localUISrc("myres/course_ui/Maskimg.png");
                for (var e = t.me.getChildByName("buttonCrew").getChildByName("choose_shine"), i = 0; i < e.numChildren; i++) {
                    e.getChildAt(i).skin = game.Tools.localUISrc("myres/course_ui/choose_box_shine.png")
                }
            }));
            var i = "docs/xinshouyindao_" + GameMgr.client_language + ".json";
            this.data = null,
            Laya.loader.load(i, Laya.Handler.create(this, function() {
                t.data = Laya.loader.getRes(i);
                for (var e = 0, n = function(i) {
                    t.data.datas[i].page_id.length <= 13 && (t.pageid[e] = i,
                    e++),
                    t.loadover.push(!1);
                    var n = game.Tools.localUISrc(t.data.datas[i].img);
                    Laya.loader.load(n, Laya.Handler.create(t, function() {
                        Laya.timer.frameOnce(3, t, function() {
                            t.loadover[i] = !0,
                            t.me.visible && t.pageindex == i && (t.loading.visible = !1,
                            t.page.source = Laya.loader.getRes(n),
                            t.page.visible = !0),
                            t.me.visible || Laya.loader.clearTextureRes(n)
                        })
                    }))
                }, a = 0; a < t.data.datas.length; a++)
                    n(a);
                t.loadover[0] = !0,
                t.showPage(t.pageindex, 0)
            }))
        }
        ,
        e.prototype.showPage = function(t, e) {
            this.pageindex = t,
            this.btn_prev.visible = 0 != t,
            this.btn_next.visible = t != this.data.page_count - 1,
            this.yijibg.visible = !1,
            this.btn_exit.visible = !1,
            this.btn_back.visible = !1,
            this.btnvisible(3, !1),
            this.img_correct.visible = !1,
            this.img_error.visible = !1,
            t > 0 ? (this.blackground.visible = !0,
            this.skip_text.visible = !1,
            this.btn_prev.visible = !0) : (this.blackground.visible = !1,
            this.skip_text.visible = !0),
            t == this.data.datas.length - 1 && (this.btn_exit.visible = !0),
            this.chat_block.show(this.data.datas[t].text, "en" == GameMgr.client_language ? 10 : 5),
            this.Dnamet.text = this.data.datas[t].name;
            var i = "extendRes/emo/" + this.data.datas[t].head;
            game.LoadMgr.setImgSkin(this.Shead, i),
            this.loadover[t] ? ("1" == this.data.datas[t].bg ? (i = "extendRes/charactor/" + this.data.datas[t].img,
            game.LoadMgr.setImgSkin(this.yijibg, i),
            this.yijibg.scaleX = parseFloat(this.data.datas[t].flip),
            this.blackground.visible = !1,
            this.yijibg.visible = !0,
            this.page.visible = !1) : (this.page.visible = !0,
            this.page.source = Laya.loader.getRes(game.Tools.localUISrc(this.data.datas[t].img))),
            this.loading.visible = !1) : (this.page.visible = !1,
            this.loading.visible = !0),
            this.data.datas[t].answers && null != this.data.datas[t].answers && this.buttonChoose(t),
            this.pinshan(t, e),
            t == this.data.datas.length - 1 && (app.PlayerBehaviorStatistic.fb_trace_pending(app.EBehaviorType.CompleteTutorial, 1),
            0 == app.PlayerBehaviorStatistic.get_val(app.EBehaviorType.XinShouYinDao) && app.PlayerBehaviorStatistic.update_val(app.EBehaviorType.XinShouYinDao, 1))
        }
        ,
        e.prototype.pinshan = function(t, e) {
            var i = this
              , n = this.buttonCrew.visible;
            this.btn_next.mouseEnabled = !1,
            this.btn_prev.mouseEnabled = !1,
            this.buttonCrew.visible = !1,
            1 == e ? (this.mask.x = 1700,
            Laya.Tween.to(this.mask, {
                x: -260
            }, 250, null, Laya.Handler.create(this, function() {
                i.btn_next.mouseEnabled = !0,
                i.btn_prev.mouseEnabled = !0,
                i.buttonCrew.visible = n,
                i.effectnext = 0
            }))) : 0 == e ? (this.mask.x = -2220,
            Laya.Tween.to(this.mask, {
                x: -260
            }, 250, null, Laya.Handler.create(this, function() {
                i.btn_next.mouseEnabled = !0,
                i.btn_prev.mouseEnabled = !0,
                i.buttonCrew.visible = n,
                i.effectprev = 0
            }))) : (this.mask.visible = !1,
            this.mask.x = -260,
            this.btn_next.mouseEnabled = !0,
            this.btn_prev.mouseEnabled = !0,
            this.buttonCrew.visible = n)
        }
        ,
        e.prototype.buttonChoose = function(t) {
            this.btnvisible(3, !0),
            this.btn_next.visible = !1;
            for (var e = 0; e < 3; e++)
                if (null != this.data.datas[t].answers[e].flag) {
                    if ("correct" == this.data.datas[t].answers[e].flag) {
                        this.img_correct.x = this.data.datas[t].answers[e].x,
                        this.img_correct.y = this.data.datas[t].answers[e].y,
                        this.img_correct.visible = !0,
                        this.btn_next.visible = !0,
                        this.btn_next_flag = 1,
                        this.btnvisible(3, !1),
                        i.Inst.me.correct.play(0, !1);
                        for (n = 0; n < this.data.datas.length; n++)
                            this.data.datas[n].page_id == this.data.datas[t].next && (this.pagecorrect = n,
                            this.btn_prev.visible = !0,
                            this.btn_prev_flag = 1,
                            this.pagewrong = this.pagecorrect - 4)
                    }
                    if ("wrong" == this.data.datas[t].answers[e].flag) {
                        this.img_error.x = this.data.datas[t].answers[e].x,
                        this.img_error.y = this.data.datas[t].answers[e].y,
                        this.img_error.visible = !0,
                        this.btn_back.visible = !0,
                        i.Inst.me.error.play(0, !1);
                        for (var n = 0; n < this.data.datas.length; n++)
                            this.data.datas[n].page_id == this.data.datas[t].next && (this.btn_prev_flag = 1,
                            this.pagewrong = n);
                        this.btnvisible(3, !1)
                    }
                }
        }
        ,
        e.prototype.changepage = function(t, e) {
            for (var i = 0; i < this.data.datas.length; i++)
                this.data.datas[i].page_id == this.data.datas[t].answers[e].jump && (this.pageindex = i);
            this.showPage(this.pageindex, 2)
        }
        ,
        e.prototype.onEnter = function() {
            this.pageindex = 0,
            this.btn_back.mouseEnabled = !0,
            this.btn_prev.mouseEnabled = !0,
            this.mask.visible = !0
        }
        ,
        e.prototype.close = function() {
            this.me.visible = !1;
            for (var t = 0; t < this.data.datas.length; t++)
                this.loadover[t] && Laya.loader.clearTextureRes(game.Tools.localUISrc(this.data.datas[t].img));
            this.loadover = [],
            Laya.loader.clearTextureRes("res/atlas/" + game.Tools.localUISrc("myres/course_ui.atlas")),
            game.Scene_Lobby.Inst.change_bg("yard", !1),
            this.chat_block.close(!1),
            this.mask.visible = !1
        }
        ,
        e
    }()
      , i = function(i) {
        function n() {
            var t = i.call(this, new ui.lobby.xinshouyindaoUI) || this;
            return t.root = null,
            t.blackmask = null,
            t.page_course = null,
            t.locking = !1,
            t.func_close = null,
            n.Inst = t,
            t
        }
        return __extends(n, i),
        n.pre_load = function() {
            var t = this
              , e = "res/atlas/" + game.Tools.localUISrc("myres/course_ui.atlas");
            Laya.loader.load(e, Laya.Handler.create(this, function() {}));
            var i = "docs/xinshouyindao_" + GameMgr.client_language + ".json";
            Laya.loader.load(i, Laya.Handler.create(this, function() {
                for (var e = Laya.loader.getRes(i), n = 0; n < e.datas.length; n++) {
                    var a = game.Tools.localUISrc(e.datas[n].img);
                    Laya.loader.load(a, Laya.Handler.create(t, function() {}))
                }
            }))
        }
        ,
        n.prototype.onCreate = function() {
            var t = this;
            this.root = this.me.getChildByName("root"),
            this.blackmask = this.me.getChildByName("bmask"),
            this.page_course = new e(this.root.getChildByName("xinshouzhidao")),
            this.root.getChildByName("skipbutton").clickHandler = Laya.Handler.create(this, function() {
                t.close()
            }, null, !1),
            this.root.getChildByName("xinshouzhidao").getChildByName("exit").clickHandler = Laya.Handler.create(this, function() {
                t.close()
            }, null, !1)
        }
        ,
        n.prototype.show = function(e, i) {
            var n = this;
            void 0 === e && (e = 0),
            void 0 === i && (i = null),
            this.locking = !0,
            this.enable = !0,
            this.page_course.onEnter(),
            t.UIBase.anim_alpha_in(this.root, {
                y: 0
            }, 300, 0, Laya.Handler.create(this, function() {
                n.locking = !1
            })),
            this.blackmask.alpha = 0,
            Laya.Tween.to(this.blackmask, {
                alpha: .3
            }, 150),
            this.changeTab(),
            this.func_close = i
        }
        ,
        n.prototype.changeTab = function() {
            this.page_course.show()
        }
        ,
        n.prototype.onDisable = function() {
            this.page_course.close()
        }
        ,
        n.prototype.close = function() {
            var e = this;
            this.locking = !0,
            Laya.Tween.to(this.blackmask, {
                alpha: 0
            }, 150),
            t.UIBase.anim_alpha_out(this.root, {
                y: 0
            }, 150, 0, Laya.Handler.create(this, function() {
                e.locking = !1,
                e.enable = !1,
                e.func_close && e.func_close.run()
            }))
        }
        ,
        n.Inst = null,
        n
    }(t.UIBase);
    t.UI_XinShouYinDao = i
}(uiscript || (uiscript = {}));
var GameMgr = function() {
    function t() {
        var e = this;
        this.stage = null,
        this.uimgr = null,
        this.root_ui = null,
        this.root_scene = null,
        this.root_front_scene_effect = null,
        this.root_front_effect = null,
        this.logined = !1,
        this.link_url = "",
        this.account = "",
        this.password = "",
        this.sociotype = 0,
        this.player_name = "",
        this.access_token = "",
        this.account_id = -1,
        this.account_setting = {},
        this.account_data = null,
        this.account_numerical_resource = null,
        this.yostar_accessToken = "",
        this.player_in_haiwai = !1,
        this.commonview_slot = {},
        this.mjp_view = "",
        this.mjp_item_id = 0,
        this.mj_server_location = "",
        this.mj_game_token = "",
        this.mj_game_uuid = "",
        this.ingame = !1,
        this.beinvited_roomid = -1,
        this.outsee_paipuid = "",
        this.custom_match_id = 0,
        this.account_refresh_time = 0,
        this._current_scene = null,
        this._scene_lobby = null,
        this._scene_mj = null,
        this.duringPaipu = !1,
        this._statisticinfo = {},
        this._last_heatbeat_time = 0,
        this._pre_mouse_point = new Laya.Point(0,0),
        this._fastin = !1,
        this.comment_allow = 0,
        this.server_time_delta = 0,
        this.client_endpoint = null,
        this._ad_str = "",
        this._mail_account = "",
        t.Inst = this,
        Laya3D.init(1920, 1080, !0),
        Laya.stage.scaleMode = Laya.Stage.SCALE_SHOWALL,
        Laya.Browser.onMobile ? Laya.stage.screenMode = Laya.Stage.SCREEN_HORIZONTAL : Laya.stage.screenMode = Laya.Stage.SCREEN_NONE,
        Laya.stage.alignH = Laya.Stage.ALIGN_CENTER,
        Laya.stage.alignV = Laya.Stage.ALIGN_MIDDLE,
        Laya.stage.bgColor = "#000000",
        t._inRelease || Laya.Stat.show(),
        this.pendinglink() ? Laya.Browser.window.location.href = this.link_url : (Laya.loader.load("client_language.txt", Laya.Handler.create(this, function() {
            var i = Laya.loader.getRes("client_language.txt");
            t.client_language = "en" === i ? "en" : "jp" === i ? "jp" : "chs",
            e.init(),
            t.iniOSWebview ? Laya.timer.once(500, e, function() {
                e.load0()
            }) : e.load0()
        })),
        this._statisticinfo = {},
        Laya.timer.loop(1e4, this, function() {
            if (game.LobbyNetMgr.Inst.connect_state == game.EConnectState.connecting) {
                var t = [];
                for (var i in e._statisticinfo)
                    t.push({
                        key: parseInt(i),
                        value: e._statisticinfo[i]
                    });
                t.length > 0 && (e._statisticinfo = {})
            }
        }, null, !1))
    }
    return Object.defineProperty(t, "inRelease", {
        get: function() {
            return this._inRelease
        },
        enumerable: !0,
        configurable: !0
    }),
    Object.defineProperty(t, "inConch", {
        get: function() {
            return Laya.Browser.window.conch
        },
        enumerable: !0,
        configurable: !0
    }),
    Object.defineProperty(t, "iniOSWebview", {
        get: function() {
            return Laya.Browser.window.wkbridge
        },
        enumerable: !0,
        configurable: !0
    }),
    Object.defineProperty(t, "inHttps", {
        get: function() {
            return this.iniOSWebview || "https:" == Laya.Browser.window.location.protocol
        },
        enumerable: !0,
        configurable: !0
    }),
    Object.defineProperty(t, "inChina", {
        get: function() {
            return this._in_china
        },
        enumerable: !0,
        configurable: !0
    }),
    Object.defineProperty(t, "inGooglePlay", {
        get: function() {
            return this._in_google_play
        },
        enumerable: !0,
        configurable: !0
    }),
    Object.defineProperty(t, "ClientRegion", {
        get: function() {
            return this._client_region
        },
        enumerable: !0,
        configurable: !0
    }),
    t.encodeP = function(t) {
        return CryptoJS.HmacSHA256(t, "lailai").toString()
    }
    ,
    t.prototype.init = function() {
        var e = Laya.LocalStorage.getItem("fpsmode");
        e && "" != e || (e = !Laya.Browser.onMobile || t.inConch || t.iniOSWebview ? "fast" : "slow",
        Laya.LocalStorage.setItem("fpsmode", e)),
        Laya.stage.frameRate = e;
        var i = Laya.LocalStorage.getItem("dddddcv");
        i && "" != i || (i = game.Tools.generateUUID(),
        Laya.LocalStorage.setItem("dddddcv", i)),
        t.device_id = i,
        Laya.Browser.window.onerror = this.handleWindowError,
        this.root_scene = new Laya.Sprite,
        this.root_ui = new Laya.Sprite,
        this.root_front_effect = new Laya.Sprite,
        Laya.stage.addChild(this.root_scene),
        Laya.stage.addChild(this.root_ui),
        Laya.stage.addChild(this.root_front_effect),
        this.logined = !1,
        this._current_scene = null,
        this.duringPaipu = !1,
        this._scene_lobby = new game.Scene_Lobby,
        this._scene_mj = new game.Scene_MJ,
        view.AudioMgr.init();
        var n = Laya.LocalStorage.getItem("click_prefer");
        view.DesktopMgr.click_prefer = n && "1" == n ? 1 : 0;
        var a = Laya.LocalStorage.getItem("double_click_pass");
        if (view.DesktopMgr.double_click_pass = a && "1" == a ? 1 : 0,
        "en" == t.client_language) {
            view.DesktopMgr.en_mjp = !0;
            "false" == game.LocalStorage.getItem("en_mjp") && (view.DesktopMgr.en_mjp = !1)
        } else
            view.DesktopMgr.en_mjp = !1;
        var r = Laya.LocalStorage.getItem("_pre_room");
        if (r && "" != r && (this.beinvited_roomid = parseInt(r)),
        this.outsee_paipuid = Laya.LocalStorage.getItem("_pre_paipu"),
        this.outsee_paipuid || (this.outsee_paipuid = ""),
        this.trasform_storage(),
        Laya.Browser.window.conch) {
            var s = Laya.PlatformClass.createClass("layaair.majsoul.mjmgr")
              , o = s.newObject();
            o.callWithBack(function(t) {
                var e = JSON.parse(t);
                e.type && (this._fastin = !0,
                Laya.LocalStorage.setItem("_pre_sociotype", e.type),
                Laya.LocalStorage.setItem("_pre_code", e.code)),
                Laya.LocalStorage.setItem("_pre_st", "")
            }, "getSocioCode"),
            s.call("clearSocioCode"),
            s.call("initWXPay", "wxa81767d38cb2f4ff"),
            o.callWithBack(function(e) {
                t._in_china = !0,
                "ingoogleplay" == e && (t._in_google_play = !0,
                t._in_china = !1)
            }, "getAppConfig")
        }
    }
    ,
    t.prototype.trasform_storage = function() {
        (t = Laya.LocalStorage.getItem("_pre_st")) && "" != t && (this._fastin = !0,
        Laya.LocalStorage.setItem("_pre_sociotype", t),
        Laya.LocalStorage.setItem("_pre_st", ""));
        (t = Laya.LocalStorage.getItem("_pre_xdsfdl")) && "" != t && (this._fastin = !0,
        Laya.LocalStorage.setItem("_pre_sociotype", t),
        Laya.LocalStorage.setItem("_pre_xdsfdl", ""));
        (t = Laya.LocalStorage.getItem("_pre_uid")) && "" != t && (game.LocalStorage.setItem("yostar_uid", t),
        Laya.LocalStorage.removeItem("_pre_uid"));
        var t = Laya.LocalStorage.getItem("_pre_token");
        t && "" != t && (game.LocalStorage.setItem("yostar_token", t),
        Laya.LocalStorage.removeItem("_pre_token"));
        var e = Laya.LocalStorage.getItem("_pre_state");
        e && "" != e && "xdsfdl3" == e && (this._fastin = !0,
        Laya.LocalStorage.setItem("_pre_sociotype", "3"),
        Laya.LocalStorage.setItem("_pre_st", "")),
        Laya.LocalStorage.setItem("_pre_state", "")
    }
    ,
    t.prototype.load0 = function() {
        var e = this;
        window && window.conch && window.loadingView.loading(30),
        t.iniOSWebview && Laya.Browser.window.wkbridge.callNative && Laya.Browser.window.wkbridge.callNative("setloadrate", "30", function() {});
        t._client_region = "mainland",
        game.ResourceVersion.init(Laya.Handler.create(e, function() {
            window && window.conch && window.loadingView.loading(40),
            t.iniOSWebview && Laya.Browser.window.wkbridge.callNative("setloadrate", "40", function() {});
            var i = "res/atlas/bitmapfont.atlas";
            "jp" == t.client_language ? i = "res/atlas/bitmapfont/jp.atlas" : "en" == t.client_language && (i = "res/atlas/bitmapfont/en.atlas"),
            Laya.loader.create(i, Laya.Handler.create(e, function() {
                var i = [];
                i = "jp" == t.client_language ? ["jp_haolong", "jp_jiye"] : "en" == t.client_language ? ["en_haolong", "en_hanyi", "en_shuhun"] : ["fengyu", "hanyi", "haolong", "youyuan", "youyuan_bold"];
                var n = 0
                  , a = function() {
                    n++,
                    window && window.conch && window.loadingView.loading(Math.floor(40 + n / i.length * 20)),
                    t.iniOSWebview && Laya.Browser.window.wkbridge.callNative("setloadrate", Math.floor(40 + n / i.length * 20).toString(), function() {}),
                    n == i.length && Laya.timer.frameOnce(2, e, e.load1)
                };
                if ("chs" == t.client_language)
                    for (var r = function(t) {
                        var n = new Laya.BitmapFont;
                        n.loadFont("bitmapfont/" + i[t] + ".fnt", Laya.Handler.create(e, function() {
                            n.setSpaceWidth(10),
                            Laya.Text.registerBitmapFont(i[t], n),
                            a()
                        }))
                    }, s = 0; s < i.length; s++)
                        r(s);
                else
                    for (var o = function(n) {
                        var r = new Laya.BitmapFont;
                        r.loadFont("bitmapfont/" + t.client_language + "/" + i[n] + ".fnt", Laya.Handler.create(e, function() {
                            r.setSpaceWidth(10),
                            Laya.Text.registerBitmapFont(i[n], r),
                            a()
                        }))
                    }, s = 0; s < i.length; s++)
                        o(s)
            }))
        }))
    }
    ,
    t.prototype.load1 = function() {
        var e = this
          , i = "";
        i = "uiconfig/ui_" + t.client_language + ".json",
        "chs" != t.client_language && this.loadUStarLogin(),
        Laya.loader.load(i, Laya.Handler.create(this, function() {
            var n = Laya.loader.getRes(i);
            Laya.View.uiMap = n,
            game.LoadMgr.httpload("config.json", "json", !1, Laya.Handler.create(e, function(i) {
                if (window && window.conch && window.loadingView.loading(70),
                t.iniOSWebview && Laya.Browser.window.wkbridge.callNative("setloadrate", "70", function() {}),
                i.success) {
                    var n = i.data;
                    t.config_data = n,
                    Laya.loader.load("res/proto/liqi.json", new Laya.Handler(e,function() {
                        window && window.conch && window.loadingView.loading(80),
                        t.iniOSWebview && Laya.Browser.window.wkbridge.callNative("setloadrate", "80", function() {});
                        var i = Laya.loader.getRes("res/proto/liqi.json");
                        i ? (net.ProtobufManager.loadProto(i),
                        net.MessageWrapper.initWrapper(),
                        app.NetAgent.init(),
                        window && window.conch && window.loadingView.loading(85),
                        t.iniOSWebview && Laya.Browser.window.wkbridge.callNative("setloadrate", "85", function() {}),
                        (new caps.ShaderInitor).init(Laya.Handler.create(e, function() {
                            window && window.conch && window.loadingView.loading(100),
                            t.iniOSWebview && Laya.Browser.window.wkbridge.callNative("setloadrate", "100", function() {}),
                            e.initUIRoot()
                        }))) : console.error("load protobuf failed: liqiDescriptor is null")
                    }
                    ))
                } else
                    app.Log.Error("未找到配置文件：config.json")
            }))
        }))
    }
    ,
    t.prototype.loadUStarLogin = function() {
        var t = document.createElement("script");
        t.src = "https://passport.mahjongsoul.com/js/yo_acc.prod_ja.js";
        var e = document.getElementsByTagName("script")[0];
        e.parentNode.insertBefore(t, e)
    }
    ,
    t.prototype.loadExcel = function(t) {
        var e = this;
        Laya.loader.load("res/proto/config.proto", new Laya.Handler(this,function() {
            uiscript.UI_Remind.Inst && uiscript.UI_Remind.Inst.setprocess(1);
            Laya.loader.load("res/config/lqc.lqbin", new Laya.Handler(e,function() {
                uiscript.UI_Remind.Inst && uiscript.UI_Remind.Inst.setprocess(2);
                var e = Laya.loader.getRes("res/proto/config.proto");
                if (e) {
                    uiscript.UI_Remind.Inst && uiscript.UI_Remind.Inst.setprocess(3);
                    var i = Laya.loader.getRes("res/config/lqc.lqbin");
                    if (i) {
                        uiscript.UI_Remind.Inst && uiscript.UI_Remind.Inst.setprocess(4);
                        var n = new Laya.Byte;
                        n.writeArrayBuffer(i);
                        var a = new bin.BinParser;
                        a.parseSync(e, n.getUint8Array(0, n.length)),
                        uiscript.UI_Remind.Inst && uiscript.UI_Remind.Inst.setprocess(5);
                        var r = new bin.TSDataFormat(a.exportSchema(),a.exportData());
                        cfg.load(r.toFormat()),
                        uiscript.UI_Remind.Inst && uiscript.UI_Remind.Inst.setprocess(6),
                        t && t.run()
                    } else
                        console.error("load bincontent failed: bindata is null")
                } else
                    console.error("load configProto failed: configProto is null")
            }
            ), null, Laya.Loader.BUFFER)
        }
        ))
    }
    ,
    t.prototype.pendinglink = function() {
        var e = "";
        document.getElementById("game_link") && (e = document.getElementById("game_link").innerText),
        e && (this.link_url = e),
        t.inConch && (this.link_url = "https://majsoul.union-game.com/0/");
        var i = Laya.Browser.window.location.href
          , n = {};
        if (i) {
            i.indexOf("#") > 0 && (i = i.substr(0, i.indexOf("#")));
            var a = i.indexOf("?");
            if (a >= 0) {
                e || (this.link_url = i.substr(0, a));
                for (var r = i.substring(a + 1, i.length), s = (r = (r = r.replace("#_=_", "")).replace("#", "")).split("&"), o = 0; o < s.length; o++)
                    if ((a = s[o].indexOf("=")) > 0) {
                        var l = s[o].substring(0, a)
                          , h = s[o].substring(a + 1, s[o].length);
                        n[l] = h
                    }
            } else
                this.beinvited_roomid = -1,
                this.outsee_paipuid = "";
            e || (this.link_url.indexOf("index.html") >= 0 && (this.link_url = this.link_url.substr(0, this.link_url.indexOf("index.html"))),
            "/" != this.link_url.charAt(this.link_url.length - 1) && (this.link_url += "/"))
        }
        var c = !1;
        for (var u in n) {
            var _ = "";
            "mv_" == u.substr(0, 3) || ("utm_" == u.substr(0, 4) ? ("" != _ && (_ += "&"),
            _ += u + "=" + n[u]) : Laya.LocalStorage.setItem("_pre_" + u, n[u])),
            _ && Laya.LocalStorage.setItem("__ad_s", _),
            c = !0
        }
        return c
    }
    ,
    t.prototype.addScene = function(t) {
        this.root_scene.addChild(t)
    }
    ,
    t.prototype.addUI = function(t) {
        this.root_ui.addChild(t)
    }
    ,
    t.prototype.initUIRoot = function() {
        if (this.uimgr = new uiscript.UIMgr,
        this.uimgr.init(),
        t.iniOSWebview) {
            var e = this;
            Laya.Browser.window.wkbridge.callNative("getappversion", "", function(t) {
                game.LoadMgr.httpload("iOSver", "text", !1, Laya.Handler.create(e, function(i) {
                    Laya.Browser.window.wkbridge.callNative("closeloadview", "", function() {}),
                    i.success ? parseInt(t) < parseInt(i.data) ? uiscript.UI_IOS_Webview_Update.show(game.Tools.strOfLocalization(2001)) : e.showEntrance() : uiscript.UI_IOS_Webview_Update.show(game.Tools.strOfLocalization(2002))
                }))
            })
        } else
            this.showEntrance()
    }
    ,
    t.prototype.showEntrance = function() {
        var e = this;
        uiscript.UI_ChooseServer.show(Laya.Handler.create(this, function() {
            if (e._fastin)
                e.loadExcel(Laya.Handler.create(e, function() {
                    game.LoadMgr.loadRes(game.E_LoadType.entrance, Laya.Handler.create(e, function() {
                        e.uimgr.showEntrance(),
                        game.LoadMgr.loadConfig(),
                        e._scene_lobby.init(null)
                    }))
                }));
            else {
                var i = "res/atlas" + ("chs" == t.client_language ? "" : "/" + t.client_language) + "/myres/start_show.atlas";
                Laya.loader.create(i, Laya.Handler.create(e, function() {
                    e.uimgr.showRemind();
                    var t = Laya.timer.currTimer;
                    e.loadExcel(Laya.Handler.create(e, function() {
                        uiscript.UI_Remind.Inst && uiscript.UI_Remind.Inst.setprocess(7),
                        game.LoadMgr.loadRes(game.E_LoadType.entrance, Laya.Handler.create(e, function() {
                            uiscript.UI_Remind.Inst && uiscript.UI_Remind.Inst.setprocess(8);
                            var i = t + 3e3 - Laya.timer.currTimer;
                            i <= 60 && (i = 60),
                            Laya.timer.once(i, e, function() {
                                uiscript.UI_Remind.Inst && uiscript.UI_Remind.Inst.setprocess(9),
                                e.uimgr.showEntrance(),
                                game.LoadMgr.loadConfig(),
                                e._scene_lobby.init(null)
                            })
                        }))
                    }))
                }))
            }
        }))
    }
    ,
    t.prototype.fetch_login_info = function() {
        var t = this;
        game.FriendMgr.init(),
        uiscript.UI_Mail.Init(),
        uiscript.UI_Activity_Xuanshang.Init(),
        uiscript.UI_Activity_Jiuji.Init(),
        uiscript.UI_TitleBook.Init(),
        uiscript.UI_Bag.init(),
        uiscript.UI_Shop.init(),
        uiscript.UI_Activity.init(),
        uiscript.UI_Recharge.init(),
        app.NetAgent.sendReq2Lobby("Lobby", "fetchCommentSetting", {}, function(e, i) {
            e || i.error ? uiscript.UIMgr.Inst.showNetReqError("fetchCommentSetting", e, i) : t.comment_allow = i.comment_allow
        }),
        this.commonview_slot = {},
        app.NetAgent.sendReq2Lobby("Lobby", "fetchCommonView", {}, function(e, i) {
            if (e || i.error)
                uiscript.UIMgr.Inst.showNetReqError("fetchCommonView", e, i);
            else {
                if (i.slots)
                    for (var n = 0; n < i.slots.length; n++)
                        t.commonview_slot[i.slots[n].slot] = i.slots[n].value;
                var a = 0;
                t.commonview_slot.hasOwnProperty(game.ECommonView.mjp.toString()) && (a = t.commonview_slot[game.ECommonView.mjp.toString()]),
                t.load_mjp_view(a)
            }
        }),
        app.NetAgent.sendReq2Lobby("Lobby", "fetchAccountSettings", {}, function(e, i) {
            if (e || i.error)
                ;
            else if (t.account_setting = [],
            i.settings)
                for (var n = 0; n < i.settings.length; n++)
                    t.account_setting[i.settings[n].key] = i.settings[n].value
        }),
        this.last_mod_name_time = 0,
        app.NetAgent.sendReq2Lobby("Lobby", "fetchModNicknameTime", {}, function(e, i) {
            e || i.error || i.last_mod_time && (t.last_mod_name_time = i.last_mod_time)
        }),
        app.NetAgent.sendReq2Lobby("Lobby", "fetchMisc", {}, function(t, e) {
            if (t || e.error)
                cfg.mall.goods.forEach(function(t) {
                    uiscript.UI_Recharge.new_recharge_list[t.cny] = 1
                });
            else {
                if (e.recharged_list)
                    for (var i = 0; i < e.recharged_list.length; i++)
                        uiscript.UI_Recharge.new_recharge_list[e.recharged_list[i]] = 1;
                e.chests && uiscript.UI_Treasure.on_chest_count_change(e.chests)
            }
        }),
        app.NetAgent.sendReq2Lobby("Lobby", "fetchIDCardInfo", {}, function(e, i) {
            e || i.error ? uiscript.UI_ShiMingRenZheng.renzhenged = !1 : "CN" == i.country ? (t.player_in_haiwai = !1,
            uiscript.UI_ShiMingRenZheng.renzhenged = i.is_authed) : (t.player_in_haiwai = !0,
            uiscript.UI_ShiMingRenZheng.renzhenged = i.is_authed)
        })
    }
    ,
    t.prototype.gameInit = function() {
        var t = this;
        app.NetAgent.sendReq2Lobby("Lobby", "fetchServerTime", {}, function(e, i) {
            e || i.error ? uiscript.UIMgr.Inst.showNetReqError("fetchServerTime", e, i) : t.server_time_delta = 1e3 * i.server_time - Laya.timer.currTimer
        }),
        app.NetAgent.sendReq2Lobby("Lobby", "fetchServerSettings", {}, function(t, e) {
            if (t || e.error)
                uiscript.UIMgr.Inst.showNetReqError("fetchServerSettings", t, e);
            else if (uiscript.UI_Recharge.open_payment = !1,
            uiscript.UI_Recharge.payment_info = "",
            uiscript.UI_Recharge.open_wx = !0,
            uiscript.UI_Recharge.wx_type = 0,
            uiscript.UI_Recharge.open_alipay = !0,
            uiscript.UI_Recharge.alipay_type = 0,
            e.settings && e.settings.payment_setting) {
                var i = e.settings.payment_setting;
                i.open_payment && (uiscript.UI_Recharge.open_payment = !0),
                null != i.payment_info_show_type && (uiscript.UI_Recharge.payment_info_show_type = i.payment_info_show_type),
                null != i.payment_info && (uiscript.UI_Recharge.payment_info = i.payment_info),
                i.wechat && (i.wechat.disable_create && (uiscript.UI_Recharge.open_wx = !1),
                null != i.wechat.payment_source_platform && (uiscript.UI_Recharge.wx_type = i.wechat.payment_source_platform)),
                i.alipay && (i.alipay.disable_create && (uiscript.UI_Recharge.open_alipay = !1),
                null != i.alipay.payment_source_platform && (uiscript.UI_Recharge.alipay_type = i.alipay.payment_source_platform))
            }
        }),
        app.NetAgent.sendReq2Lobby("Lobby", "fetchConnectionInfo", {}, function(e, i) {
            e || i.error || (t.client_endpoint = i.client_endpoint)
        }),
        app.PlayerBehaviorStatistic.init(),
        this.account_data.nickname && this.fetch_login_info(),
        uiscript.UI_Info.Init(),
        app.NetAgent.AddListener2Lobby("NotifyAccountUpdate", Laya.Handler.create(this, function(e) {
            app.Log.log("NotifyAccountUpdate :" + JSON.stringify(e));
            var i = e.update;
            if (i) {
                if (i.numerical)
                    for (var n = 0; n < i.numerical.length; n++) {
                        var a = i.numerical[n].id
                          , r = i.numerical[n].final;
                        switch (a) {
                        case 100001:
                            t.account_data.diamond = r;
                            break;
                        case 100002:
                            t.account_data.gold = r;
                            break;
                        case 100099:
                            t.account_data.vip = r
                        }
                        (a >= 101001 || a <= 101999) && (t.account_numerical_resource[a] = r)
                    }
                uiscript.UI_Sushe.on_data_updata(i),
                i.daily_task && uiscript.UI_Activity_Xuanshang.dataUpdate(i.daily_task),
                i.title && uiscript.UI_TitleBook.addTitle(i.title),
                i.new_recharged_list && uiscript.UI_Recharge.on_new_recharge_refresh(i),
                i.activity_task && uiscript.UI_Activity.accountUpdate(i)
            }
        }, null, !1)),
        app.NetAgent.AddListener2Lobby("NotifyAnotherLogin", Laya.Handler.create(this, function(t) {
            uiscript.UI_AnotherLogin.Inst.show()
        })),
        app.NetAgent.AddListener2Lobby("NotifyAccountLogout", Laya.Handler.create(this, function(t) {
            uiscript.UI_Hanguplogout.Inst.show()
        })),
        app.NetAgent.AddListener2Lobby("NotifyClientMessage", Laya.Handler.create(this, function(t) {
            app.Log.log("收到消息：" + JSON.stringify(t)),
            t.type == game.EFriendMsgType.room_invite && uiscript.UI_Invite.onNewInvite(t.content)
        })),
        app.NetAgent.AddListener2Lobby("NotifyServerSetting", Laya.Handler.create(this, function(t) {
            if (uiscript.UI_Recharge.open_payment = !1,
            uiscript.UI_Recharge.payment_info = "",
            uiscript.UI_Recharge.open_wx = !0,
            uiscript.UI_Recharge.wx_type = 0,
            uiscript.UI_Recharge.open_alipay = !0,
            uiscript.UI_Recharge.alipay_type = 0,
            t.settings && t.settings.payment_setting) {
                var e = t.settings.payment_setting;
                e.open_payment && (uiscript.UI_Recharge.open_payment = !0),
                null != e.payment_info_show_type && (uiscript.UI_Recharge.payment_info_show_type = e.payment_info_show_type),
                null != e.payment_info && (uiscript.UI_Recharge.payment_info = e.payment_info),
                e.wechat && (e.wechat.disable_create && (uiscript.UI_Recharge.open_wx = !1),
                null != e.wechat.payment_source_platform && (uiscript.UI_Recharge.wx_type = e.wechat.payment_source_platform)),
                e.alipay && (e.alipay.disable_create && (uiscript.UI_Recharge.open_alipay = !1),
                null != e.alipay.payment_source_platform && (uiscript.UI_Recharge.alipay_type = e.alipay.payment_source_platform))
            }
        })),
        app.NetAgent.AddListener2Lobby("NotifyVipLevelChange", Laya.Handler.create(this, function(t) {
            uiscript.UI_Sushe.send_gift_limit = t.gift_limit,
            game.FriendMgr.friend_max_count = t.friend_max_count,
            uiscript.UI_Shop.shopinfo.zhp.free_refresh.limit = t.zhp_free_refresh_limit,
            uiscript.UI_Shop.shopinfo.zhp.cost_refresh.limit = t.zhp_cost_refresh_limit
        })),
        Laya.timer.loop(36e4, this, function() {
            if (game.LobbyNetMgr.Inst.isOK) {
                var e = (Laya.timer.currTimer - t._last_heatbeat_time) / 1e3;
                app.NetAgent.sendReq2Lobby("Lobby", "heatbeat", {
                    no_operation_counter: e
                }, function() {}),
                e >= 3e3 && uiscript.UI_Hanguplogout.Inst.show()
            }
        }),
        Laya.timer.loop(1e3, this, function() {
            var e = Laya.stage.getMousePoint();
            e.x == t._pre_mouse_point.x && e.y == t._pre_mouse_point.y || (t.clientHeatBeat(),
            t._pre_mouse_point.x = e.x,
            t._pre_mouse_point.y = e.y)
        }),
        Laya.timer.loop(1e3, this, function() {
            Laya.LocalStorage.setItem("dolllt", game.Tools.currentTime.toString())
        })
    }
    ,
    t.prototype.afterLogin = function() {
        var e = this;
        this.gameInit(),
        this.logined = !0;
        Laya.LocalStorage.setItem("_pre_room", ""),
        Laya.LocalStorage.setItem("_pre_paipu", ""),
        t.Inst.account_data.nickname && "" != t.Inst.account_data.nickname || uiscript.UI_XinShouYinDao.pre_load(),
        this._scene_lobby.addLoadListenter(Laya.Handler.create(this, function() {
            game.FrontEffect.init(),
            uiscript.UI_Sushe.init(Laya.Handler.create(e, function() {
                uiscript.UI_Loading.Inst.setProgressVal(1),
                Laya.timer.once(500, e, function() {
                    e.EnterLobby()
                })
            }))
        }), Laya.Handler.create(this, function(t) {
            return uiscript.UI_Loading.Inst.setProgressVal(.2 + .7 * t)
        }, null, !1)),
        10102 === t.Inst.account_data.level.id && app.PlayerBehaviorStatistic.fb_trace_pending(app.EBehaviorType.Level_2, 1),
        10103 === t.Inst.account_data.level.id && app.PlayerBehaviorStatistic.fb_trace_pending(app.EBehaviorType.Level_3, 1)
    }
    ,
    t.prototype.updateAccountInfo = function() {
        var e = this;
        app.NetAgent.sendReq2Lobby("Lobby", "fetchAccountInfo", {}, function(i, n) {
            if (i || n.error)
                uiscript.UIMgr.Inst.showNetReqError("fetchAccountInfo", i, n);
            else {
                app.Log.log("UpdateAccount: " + JSON.stringify(n)),
                t.Inst.account_refresh_time = Laya.timer.currTimer;
                for (var a in n.account)
                    if (t.Inst.account_data[a] = n.account[a],
                    "platform_diamond" == a)
                        for (var r = n.account[a], s = 0; s < r.length; s++)
                            e.account_numerical_resource[r[s].id] = r[s].count;
                uiscript.UI_Lobby.Inst.refreshInfo(),
                n.account.room_id && t.Inst.updateRoom(),
                10102 === t.Inst.account_data.level.id && app.PlayerBehaviorStatistic.fb_trace_pending(app.EBehaviorType.Level_2, 1),
                10103 === t.Inst.account_data.level.id && app.PlayerBehaviorStatistic.fb_trace_pending(app.EBehaviorType.Level_3, 1)
            }
        })
    }
    ,
    t.prototype.updateRoom = function() {
        app.NetAgent.sendReq2Lobby("Lobby", "fetchRoom", {}, function(t, e) {
            t || e.error ? uiscript.UIMgr.Inst.showNetReqError("fetchRoom", t, e) : uiscript.UI_WaitingRoom.Inst.updateData(e.room)
        })
    }
    ,
    t.prototype.EnterMJ = function() {
        this._current_scene !== this._scene_mj && (this._current_scene && (this._current_scene.active = !1),
        this._current_scene = this._scene_mj,
        this._current_scene.active = !0)
    }
    ,
    t.prototype.EnterLobby = function() {
        var t = this;
        this._current_scene !== this._scene_lobby ? (this._current_scene && (this._current_scene.active = !1),
        this._current_scene = this._scene_lobby,
        uiscript.UI_Loading.Inst.show("enter_lobby"),
        this._scene_lobby.buildScene(Laya.Handler.create(this, function() {
            uiscript.UI_Loading.Inst.close(),
            t._current_scene.active = !0,
            game.Scene_MJ.Inst.load_common_texture2d()
        }), Laya.Handler.create(this, function(t) {
            return uiscript.UI_Loading.Inst.setProgressVal(t)
        }, null, !1))) : (uiscript.UI_Loading.Inst.close(),
        this._current_scene.active = !0)
    }
    ,
    t.prototype.checkPaiPu = function(t, e, i) {
        var n = this;
        app.Log.log("checkPaiPu game_uuid:" + t + " account_id:" + e.toString() + " paipu_config:" + i),
        this.duringPaipu ? app.Log.Error("已经在看牌谱了") : (this.duringPaipu = !0,
        uiscript.UI_Loading.Inst.show("enter_mj"),
        app.NetAgent.sendReq2Lobby("Lobby", "fetchGameRecord", {
            game_uuid: t
        }, function(t, a) {
            if (t || a.error)
                uiscript.UIMgr.Inst.showNetReqError("fetchGameRecord", t, a),
                uiscript.UI_Loading.Inst.close(null),
                uiscript.UIMgr.Inst.showLobby(),
                n.duringPaipu = !1;
            else {
                uiscript.UI_Loading.Inst.setProgressVal(.1);
                var r = a.head
                  , s = [null, null, null, null]
                  , o = game.Tools.strOfLocalization(2003)
                  , l = r.config.mode;
                l.extendinfo && (o = game.Tools.strOfLocalization(2004)),
                l.detail_rule && l.detail_rule.ai_level && (1 === l.detail_rule.ai_level && (o = game.Tools.strOfLocalization(2003)),
                2 === l.detail_rule.ai_level && (o = game.Tools.strOfLocalization(2004)));
                for (c = 0; c < r.accounts.length; c++) {
                    var h = r.accounts[c];
                    h.character ? s[h.seat] = h : (h.character = {
                        charid: h.avatar_id,
                        level: 0,
                        exp: 0,
                        views: [],
                        skin: cfg.item_definition.character.get(h.avatar_id).init_skin,
                        is_upgraded: !1
                    },
                    h.avatar_id = h.character.skin,
                    s[h.seat] = h)
                }
                for (var c = 0; c < s.length; c++)
                    null == s[c] && (s[c] = {
                        nickname: o,
                        avatar_id: 400101,
                        level: {
                            id: 10101
                        },
                        character: {
                            charid: 200001,
                            level: 0,
                            exp: 0,
                            views: [],
                            skin: 400101,
                            is_upgraded: !1
                        }
                    });
                var u = Laya.Handler.create(n, function(t) {
                    game.Scene_MJ.Inst.openMJRoom(s, Laya.Handler.create(n, function() {
                        n.duringPaipu = !1,
                        view.DesktopMgr.Inst.initRoom(r.config, s, e, view.EMJMode.paipu, Laya.Handler.create(n, function() {
                            view.DesktopMgr.Inst.paipu_config = i,
                            uiscript.UI_Replay.Inst.initData(t),
                            uiscript.UI_Replay.Inst.enable = !0,
                            Laya.timer.once(1e3, n, function() {
                                n.EnterMJ()
                            }),
                            Laya.timer.once(1500, n, function() {
                                view.DesktopMgr.player_link_state = [view.ELink_State.READY, view.ELink_State.READY, view.ELink_State.READY, view.ELink_State.READY],
                                uiscript.UI_DesktopInfo.Inst.refreshLinks(),
                                uiscript.UI_Loading.Inst.close()
                            }),
                            Laya.timer.once(1e3, n, function() {
                                uiscript.UI_Replay.Inst.nextStep(!0)
                            })
                        }))
                    }), Laya.Handler.create(n, function(t) {
                        return uiscript.UI_Loading.Inst.setProgressVal(.1 + .9 * t)
                    }, null, !1))
                })
                  , _ = {};
                _.record = r,
                a.data && a.data.length ? (_.game = net.MessageWrapper.decodeMessage(a.data),
                u.runWith(_)) : game.LoadMgr.httpload(a.data_url, "arraybuffer", !1, Laya.Handler.create(n, function(t) {
                    if (t.success) {
                        var e = new Laya.Byte;
                        e.writeArrayBuffer(t.data);
                        var i = net.MessageWrapper.decodeMessage(e.getUint8Array(0, e.length));
                        _.game = i,
                        u.runWith(_)
                    } else
                        uiscript.UIMgr.Inst.ShowErrorInfo(game.Tools.strOfLocalization(2005) + a.data_url),
                        uiscript.UI_Loading.Inst.close(null),
                        uiscript.UIMgr.Inst.showLobby(),
                        n.duringPaipu = !1
                }))
            }
        }))
    }
    ,
    t.prototype.BehavioralStatistics = function(t, e) {
        void 0 === e && (e = 1);
        var i = t.toString();
        this._statisticinfo.hasOwnProperty[i] || (this._statisticinfo[i] = 0),
        this._statisticinfo[i] += e
    }
    ,
    t.prototype.clientHeatBeat = function() {
        (Laya.timer.currTimer - this._last_heatbeat_time) / 1e3 > 2400 && game.LobbyNetMgr.Inst.isOK && app.NetAgent.sendReq2Lobby("Lobby", "heatbeat", {
            no_operation_counter: 0
        }, function() {}),
        this._last_heatbeat_time = Laya.timer.currTimer
    }
    ,
    t.prototype.getHangUpTime = function() {
        return Laya.timer.currTimer - this._last_heatbeat_time
    }
    ,
    t.prototype.onFatalError = function(e, i) {
        void 0 === i && (i = !0),
        app.Log.Error("onFatalError");
        var n = {};
        n.timestamp = Math.floor(Date.now() / 1e3),
        n.fatal = !0,
        n.lobby_ip = app.NetAgent.lobby_ip,
        n.mj_ip = app.NetAgent.mj_ip,
        t.Inst && (n.account_id = t.Inst.account_id),
        n.client_version = game.ResourceVersion.version,
        n.device = game.Tools.deviceInfo;
        var a = {};
        if (a.standardinfo = n,
        a.fatalerror = e,
        t.inRelease && (a.logs = app.Log.getCacheLog()),
        t.inRelease) {
            (new Laya.HttpRequest).send(t.error_url, "data=" + JSON.stringify(a), "post")
        } else
            app.Log.Error(JSON.stringify(a));
        i && uiscript.UIMgr.Inst.showFatalError()
    }
    ,
    t.prototype.onXiangGongError = function(e) {
        app.Log.Error("相公了");
        var i = {};
        if (i.timestamp = Math.floor(Date.now() / 1e3),
        i.type = "xiangong",
        t.Inst && (i.account_id = t.Inst.account_id),
        i.client_version = game.ResourceVersion.version,
        i.device = game.Tools.deviceInfo,
        t.inRelease && (i.logs = app.Log.getCacheLog()),
        i.detail = e,
        t.inRelease) {
            (new Laya.HttpRequest).send(t.error_url, "data=" + JSON.stringify(i), "post")
        } else
            app.Log.Error(JSON.stringify(i))
    }
    ,
    t.prototype.postInfo2Server = function(e) {
        if (t.inRelease) {
            (new Laya.HttpRequest).send(t.error_url, "data=" + JSON.stringify(e), "post")
        } else
            app.Log.Error(JSON.stringify(e))
    }
    ,
    t.prototype.handleWindowError = function(t, e, i, n, a) {
        return !1
    }
    ,
    t.prototype.load_mjp_view = function(e) {
        var i = "mjp_default"
          , n = cfg.item_definition.view.get(e);
        if (n && (i = n.res_name),
        view.DesktopMgr.en_mjp && (i += "_0"),
        this.mjp_item_id = e,
        i != this.mjp_view) {
            var a = "res/atlas/";
            "chs" != t.client_language && (a += t.client_language + "/"),
            "" != this.mjp_view && Laya.loader.clearRes(a + "myres2/mjp/" + this.mjp_view + "/ui.atlas"),
            this.mjp_view = i,
            Laya.loader.load([a + "myres2/mjp/" + this.mjp_view + "/ui.atlas"])
        }
    }
    ,
    t._inRelease = !0,
    t.error_url = "http://47.98.236.52:5031/api/v0/client_report_message",
    t.Inst = null,
    t.config_data = {},
    t.device_id = "",
    t._in_china = !0,
    t._in_google_play = !1,
    t._client_region = "mainland",
    t.client_language = "chs",
    t
}();
new GameMgr;
